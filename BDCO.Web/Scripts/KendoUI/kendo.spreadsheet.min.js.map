{"version":3,"sources":["kendo.spreadsheet.js"],"names":["f","define","kendo","UndoRedoStack","Observable","extend","init","options","fn","call","this","clear","events","push","command","stack","slice","currentCommandIndex","undo","canUndo","trigger","redo","canRedo","length","deepExtend","util","amd","a1","a2","a3","defined","value","UNDEFINED","round","precision","power","pow","math","p","limitValue","min","max","rad","degrees","DEG_TO_RAD","deg","radians","isNumber","val","isNaN","valueOrDefault","defaultValue","sqr","objectKey","object","key","parts","sort","join","hashKey","str","i","hash","charCodeAt","hashObject","arrayLimits","arr","MAX_NUM","MIN_NUM","arrayMin","arrayMax","sparseArrayMin","sparseArrayLimits","sparseArrayMax","n","isFinite","undefined","last","array","append","first","second","apply","renderTemplate","text","template","useWithBlock","paramName","renderAttr","name","renderAllAttr","attrs","output","renderStyle","renderSize","size","renderPos","pos","result","toHyphens","split","isTransparent","color","arabicToRoman","literals",1,10,100,2,20,200,3,30,300,4,40,400,5,50,500,6,60,600,7,70,700,8,80,800,9,90,900,1000,"values","roman","shift","romanToArabic","r","digits","prev","v","toLowerCase","x","l","c","d","m","charAt","memoize","cache","Object","create","id","arguments","ucs2decode","string","extra","counter","ucs2encode","map","String","fromCharCode","Math","window","PI","Number","MAX_VALUE","now","Date","getTime","drawing","dataviz","$","zeroSize","width","height","baseline","measureText","style","measureBox","TextMetrics","current","measure","loadFonts","fonts","callback","promises","document","font","load","e","logToConsole","Promise","all","then","doc","Class","LRUCache","_size","_length","_map","put","lru","entry","_head","_tail","newer","older","get","defaultMeasureBox","_cache","_initOptions","baselineMarkerSize","box","styleKey","cacheKey","cachedResult","baselineMarker","_baselineMarker","cloneNode","appendChild","body","offsetWidth","offsetHeight","offsetTop","parentNode","removeChild","jQuery","CODE","out","UCS2","code","parse","data","callbacks","readChar","index","croak","msg","Error","readWhile","pred","a","readAsciiWhile","STRING","skipWhitespace","isWhitespace","eat","save","skip","isDigit","isHexDigit","isNameStart","isName","xmlComment","END_COMMENT","xmlTag","QUESTION_MARK","xmlDecl","START_COMMENT","xmlName","xmlAttrs","END_SHORT_TAG","GREATER_THAN","xmlContent","pop","END_TAG","START_CDATA","END_CDATA","LESS_THAN","AMPERSAND","xmlEntity","xmlString","quote","QUOTE","APOSTROPHE","SHARP","LOWERCASE_X","UPPERCASE_X","parseInt","ENTITIES","SEMICOLON","END_DECLARATION","$tag","EQUAL","what","thing","arg1","arg2","is","selector","j","exit","EXIT","tmp","amp","lt","gt","quot","nbsp","parseXML","ex","encodeBase64","input","chr1","chr2","chr3","enc1","enc2","enc3","enc4","encodeUTF8","KEY_STR","inArray","ObserversMixin","observers","_observers","addObserver","element","removeObserver","splice","methodName","event","observer","idx","_suspended","optionsChange","geometryChange","suspend","resume","_observerField","field","mixins","Command","PropertyChangeCommand","ApplyFilterCommand","DeleteCommand","AddCommand","support","browser","msie","version","spreadsheet","_workbook","workbook","_property","property","_state","range","_range","exec","setState","getState","_forEachCell","ref","_ref","forEach","sheet","toRangeRef","bind","_value","ClearContentCommand","clearContent","EditCommand","rejectState","validationState","title","message","reason","type","_getValidationState","ex1","calc","ParseError","ex2","TextWrapCommand","rowHeight","forEachRow","topLeft","row","_rowHeight","AdjustDecimalsCommand","_decimals","decimals","formatting","batch","forEachCell","col","cell","format","adjustDecimals","BorderChangeCommand","_type","border","_style","noBorders","borderLeft","borderTop","borderRight","borderBottom","allBorders","leftBorder","leftColumn","rightBorder","rightColumn","topBorder","topRow","bottomBorder","bottomRow","outsideBorders","insideBorders","insideHorizontalBorders","insideVerticalBorders","MergeCellCommand","activate","activeCell","unmerge","cells","merge","horizontally","vertically","forEachColumn","FreezePanesCommand","_topLeft","panes","frozenColumns","frozenRows","rows","columns","unfreeze","PasteCommand","_clipboard","clipboard","activeSheet","pasteRef","status","canPaste","menuInvoked","paste","_adjustRowHeight","pasteOnMerged","overflow","AdjustRowHeightCommand","rowIndex","ToolbarPasteCommand","_view","focus","select","execCommand","CopyCommand","noop","canCopy","copy","multiSelection","ToolbarCopyCommand","textarea","createElement","addClass","html","appendTo","remove","CutCommand","cut","AutoFillCommand","origin","_origin","fillFrom","ToolbarCutCommand","FilterCommand","filter","hasFilter","intersectingMerged","SortCommand","column","ascending","expandRange","Range","_sheetRef","clearFilter","filterRule","exists","valueFilter","ValueFilter","customFilter","CustomFilter","eq","ClearFilterCommand","HideLineCommand","axis","setAxisState","getAxisState","axisManager","hideSelectedRows","hideSelectedColumns","UnHideLineCommand","unhideSelectedRows","unhideSelectedColumns","DeleteRowCommand","deleteSelectedRows","DeleteColumnCommand","deleteSelectedColumns","AddColumnCommand","addColumnLeft","addColumnRight","AddRowCommand","canAddRow","addRowAbove","addRowBelow","EditValidationCommand","validation","OpenCommand","file","match","fromFile","SaveAsCommand","fileName","extension","saveAsExcel","saveAsPDF","pdf","classNames","FormulaBar","wrapper","ui","Widget","formulaInput","FormulaInput","destroy","isOpenParen","ch","isCloseParen","isMatchingParen","close","open","touches","target","begin","end","knownFunction","runtime","FUNCS","isEqualToken","tok1","tok2","ns","keys","styles","KEY_NAMES","PRIVATE_FORMULA_CHECK","listWrapper",27,37,39,35,36,32,"attr","autoScale","on","scale","_highlightedRefs","_staticTokens","_formulaSource","_formulaList","_popup","_tooltip","_keydown","_keyup","_blur","_input","_focus","filterOperator","scalePadding","minLength","enable","toggleClass","getPos","lookup","lookupNode","loop","node","nodeType","firstChild","nextSibling","nodeValue","div","sel","getSelection","focusNode","focusOffset","b","anchorNode","anchorOffset","collapsed","setPos","differ","startOffset","endOffset","startContainer","endContainer","len","el","currentRange","eiv","createRange","setStart","setEnd","getRangeAt","removeAllRanges","addRange","home","test","toUpperCase","formulaSource","DataSource","list","StaticList","insertAfter","autoBind","selectable","change","_formulaListChange","dataSource","dataValueField","preventDefault","activeToken","completion","ctx","tokenCtx","_tokenContext","_mute","token","replace","nextToken","_replaceAt","popup","Popup","anchor","clearTimeout","_focusId","_isFormula","keyCode","_navigated","_move","_keyDownTimeout","setTimeout","_syntaxHighlight","view","visible","focusFirst","_focusTimeout","pressed","DOWN","focusNext","UP","focusPrev","focusLast","ENTER","TAB","PAGEUP","PAGEDOWN","tokens","tok","point","tokenize","_sync","_editorToSync","isActive","_textContainer","computedStyles","getComputedStyles","position","visibility","whiteSpace","top","left","_span","css","_cellTooltip","tooltip","toggleTooltip","show","toggle","_activeElement","operator","hide","rectangle","resize","canInsertRef","isKeyboardAction","_canInsertRef","afterPoint","canReplace","canInsertBetween","right","strictMode","refAtPoint","simplify","newValue","rest","substr","syncWith","iehandler","self","eventName","handler","off","highlightedRefs","refClasses","Pane","series","refIndex","parens","active","cls","colorClass","unshift","reverse","htmlEncode","substring","_setStaticTokens","Mac","isAlphaNum","keyName","EventListener",13,38,33,34,46,113,"navigator","platform","indexOf","handlers","_handlers","_observer","keyDownProxy","keyDown","mouseProxy","mouse","threshold","_pressLocation","documentElement","handleEvent","rightClick","dx","dy","distance","which","button","pageX","y","pageY","sqrt","catchAllHandler","eventKey","mod","metaKey","ctrlKey","shiftKey","passThrough","skew","level","temp","insert","NilNode","RangeTreeNode","start","diff","heir","intersecting","ranges","intersects","tree","root","RangeTree","RangeList","Iterator","SparseRangeList","findrange","clone","firstRange","lastRange","rangeValue","rangeStart","rangeEnd","expandedValues","rangeIndex","sortedIndices","valueComparer","indices","comparer","sourceStart","sourceEnd","targetStart","iterator","state","unique","at","lastRangeStart","ValueRange","toExcelFormat","Property","JsonProperty","ValueProperty","set","dst","JSON","stringify","formats","validations","prototype","dateToNumber","culture","calendar","patterns","PropertyBag","specs","sortable","serializable","depends","cellCount","properties","lists","spec","fromJSON","si","iterators","forEachProperty","ALL_PROPERTIES","columnName","colIndex","letter","floor","displaySheet","displayRef","rel","aa","Ref","NULL","NameRef","CellRef","RangeRef","UnionRef","hasSheet","_hasSheet","setSheet","absolute","relative","adjust","toString","print","obj","intersect","isCell","toRow","toColumn","rangeAt","nextRangeIndex","previousRangeIndex","reference","refs1","refs2","r1","r2","bottomRight","single","refs","concat","replaceAt","forEachColumnIndex","forEachAxisIndex","forEachRowIndex","sorted","method","valid","display","ret","trow","tcol","abs","arow","acol","forRow","delta","tl","br","endSheet","normalize","_containsRange","_containsCell","contains","Array","that","some","_intersectRange","a_left","a_top","a_right","a_bottom","b_left","b_top","b_right","b_bottom","c1","c2","rr1","rc1","rr2","rc2","changes","relTL","relBR","collapse","startRow","endRow","startCol","endCol","union","topLeftRow","topLeftCol","bottomRightRow","bottomRightCol","modified","num","limit","bottom","move","cols","tr","u","reduce","empty","theRef","newRefs","NULLREF","SHEETREF","Infinity","FIRSTREF","AutoFillCalculator","grid","_grid","rectIsVertical","startRect","endRect","autoFillDest","selection","cursor","quadrant","pivot","opposite","cornerResult","expanding","bottomLeft","topRight","lower","further","EdgeNavigator","SheetNavigator","rangeGetter","prevLeft","prevVisible","nextRight","nextVisible","nextLeft","prevRight","boundary","_sheet","_columns","autoFillCalculator","colEdge","columnRange","rowEdge","_rows","rowRange","_viewPortHeight","unionWithMerged","leftCol","rightCol","selectionIncludesMergedCells","_mergedCells","setSelectionValue","selectAll","mode","addToExisting","refForMode","rowRef","colRef","startSelection","startAutoFill","completeSelection","selectForContextMenu","modifySelection","action","scrollInto","newSelection","direction","determineDirection","viewPortHeight","originalSelection","currentOriginalSelectionRange","prevPage","nextPage","firstVisible","lastVisible","updateCurrentSelectionRange","moveActiveCell","originalActiveCell","navigateInSelection","currentNavigationRange","selTopLeft","selBottomRight","done","nextNavigationRange","previousNavigationRange","shouldSkip","singleCellSelection","extendSelection","resizeAutoFill","isMerged","forEachMergedCell","merged","hint","preview","props","_autoFillOrigin","dest","punch","_previewFillFrom","updateAutoFill","currentSelectionRange","leftMode","rightMode","topMode","bottomMode","originalSelect","selectionRangeIndex","subset","bottomCol","AxisManager","forEachSelectedColumn","layout","recalc","forEachSelectedRow","includesHiddenColumns","includesHidden","includesHiddenRows","selectionIncludesHiddenColumns","selectionIncludesHiddenRows","deleteColumn","deleteRow","hideColumn","hideRow","unhideColumn","unhideRow","insertColumn","rowCount","canInsertRow","insertRow","Clipboard","iframe","className","_external","_uid","guid","external","hasOwnProperty","intersectsMerged","_count","stateRangeRef","contents","destination","originActiveCell","rowDelta","colDelta","address","_isInternal","triggerChange","plain","table","mergedCells","contentWindow","write","find","_parseHTML","_parseTSV","_cellState","tbody","each","td","ci","ri","rowspan","colspan","blankCell","after","cellState","internalHTML","internalPlain","getComputedStyle","borders","_borderObject","fontSize","background","underline","italic","bold","_strippedStyle","textAlign","verticalAlign","wrap","prefixes","prefix","borderObject","looksLikeANumber","getTextHeight","font-size","word-break","white-space","complement","_normalize","_set","noTrigger","_get","_resizedRef","_border","_collapsedBorder","collapsedBorderTop","collapsedBorderRight","collapsedBorderBottom","collapsedBorderLeft","formula","t1","t2","existingFormat","compile","editorChange","isInEditMode","numberToDate","_","toJSON","_validation","_merge","mergedRef","vi","_properties","setProp","line","propName","propValue","clearAll","contentsOnly","formatOnly","clearFormat","isSortable","_sortBy","isFilterable","clearFilters","_filterBy","_filter","propertyName","maxHeight","cellRange","totalWidth","columnWidth","hasValue","flag","draw","CalcError","argmax","compileArgumentChecks","functionName","args","comp","allowError","isArray","arrayArgs","resolve","cond","force","canBeArrayArg","hasArrayArgs","typeCheck","forced","haveForced","err","main","Function","withErrorHandling","makeSyncFunction","check","doit","xargs","Matrix","arrays","makeAsyncFunction","count","makeCallback","defineFunction","func","log","console","kendoSpreadsheetArgs","argsAsync","dateToJulianDays","julianDaysToDate","jd","year","month","date","day","ord","ORDINAL_ADD_DAYS","isLeapYear","yr","daysInYear","daysInMonth","mo","DAYS_IN_MONTH","unpackDate","serial","BASE_DATE","packDate","unpackTime","ms","hours","minutes","seconds","frac","MS_IN_DAY","MS_IN_HOUR","MS_IN_MIN","milliseconds","serialToDate","t","packTime","hh","mm","ss","dateToSerial","time","getHours","getMinutes","getSeconds","getMilliseconds","getFullYear","getMonth","getDate","parseDate","binaryCompare","exports","Context","Formula","NUMBER_OR_ZERO","ARGS_NUMERIC","ARGS_ANYVALUE","parent","resolveCells","getRefData","_resolve","onFormula","fetch","context","pending","add","formulas","getRefCells","cellValues","fname","bool","asMatrix","h","isRange","hiddenInfo","getData","includeEmpty","eachRow","eachCol","mapRow","mapCol","transpose","unit","multiply","s","va","vb","adds","sign","determinant","C","L","k","inverse","imax","augment","printer","absrefs","onReady","lcsheet","parentContext","reset","renameSheet","oldSheetName","newSheetName","affectedSheet","operation","formulaRow","formulaCol","formulaSheet","formulaMoves","newFormulaRow","newFormulaCol","co","th","comatrix","thmatrix","elmatrix","defineAlias","alias","orig","kendoSpreadsheetAliases","compileValidation","validationHandler","parsedFromDate","parsedToDate","from","dataType","TRANSPOSE_FORMAT","DATE_FORMAT","fromIsDateValue","parseFormula","to","toIsDateValue","validationComparers","custom","comparerType","valueToCompare","toValue","allowNulls","_getListData","Validation","tooltipMessageTemplate","tooltipTitleTemplate","messageTemplate","titleTemplate","_formatMessages","fromFormula","toFormula","_setMessages","tooltipTitle","tooltipMessage","cube","_getOptions","compareValue","compareFormat","calculateFromCallBack","greaterThan","lessThan","between","equalTo","notEqualTo","greaterThanOrEqualTo","lessThanOrEqualTo","notBetween","Selection","Sheet","_activeCell","currentOriginalNavigationRange","expanded","changeActiveCell","columnCount","headerHeight","headerWidth","Axis","_frozenRows","_frozenColumns","_suspendChanges","Grid","_sorter","Sorter","_viewSelection","_editSelection","_formulaSelections","showGridLines","_selectionState","_inEdit","_navigator","_axisManager","_name","_sheetName","accessor","_field","suspendChanges","setDataSource","dataSourceBinder","SheetDataSourceBinder","columnIndex","unhide","isHiddenColumn","hidden","_copyRange","sourceRangeRef","targetRef","nextRefTopLeft","nextRefBottomRight","nextIndex","nextBottomIndex","targetIndex","_adjustReferences","_sheets","_forFormulas","_forValidations","adjustNames","nextRef","isEnabledRow","isEnabledColumn","isHiddenRow","numRows","numColumns","parseReference","forEachFilterHeader","columnRef","startCellIndex","endCellIndex","startResizing","initialPosition","_initialPosition","_resizeInProgress","_autoFillInProgress","_autoFillDest","_autoFillPunch","_autoFillHint","_autoFillDirection","autoFillRef","autoFillPunch","autoFillInProgress","resizingInProgress","completeResizing","hintPosition","handlePosition","resizeHintPosition","resizeHandlePosition","_resizeHandlePosition","location","_resizeHintPosition","removeResizeHandle","positionResizeHandle","_selectionInProgress","execute","operatingRange","selectionInProgress","expandedRef","selectionState","isAxis","trim","trims","activeCellSelection","selectedHeaders","allCols","allRows","rowSelection","colSelection","rowState","colState","isInEdit","_setFormulaSelections","_viewActiveCell","json","positions","viewSelection","parseColor","toCss","_sort","activeCellRef","_compileFormula","_compileValidation","Filter","_refreshFilter","cellRefIndex","resetFormulas","resetValidations","next","revalidate","cellRef","_copyValuesInRange","suspended","sortBy","prepare","matches","filterColumn","filterRef","_clearFilter","ALL_REASONS","currentRef","DOT","EMPTYCHAR","sheetsBarClassNames","SheetsBar","sheetsBarWrapper","sheetsBarSheetsWrapper","sheetsBarActive","sheetsBarInactive","sheetsBarAdd","sheetsBarRemove","sheetsBarItems","sheetsBarEditor","sheetsBarScrollable","sheetsBarNext","sheetsBarPrev","sheetsBarKItem","sheetsBarKActive","sheetsBarKTextbox","sheetsBarKLink","sheetsBarKIcon","sheetsBarKFontIcon","sheetsBarKButton","sheetsBarKButtonBare","sheetsBarKArrowW","sheetsBarKArrowE","sheetsBarKReset","sheetsBarKIconX","sheetsBarKSprite","sheetsBarKIconPlus","sheetsBarHintWrapper","sheetsBarKResetItems","_tree","dom","Tree","render","_addButton","_createSheetsWrapper","_toggleScrollEvents","_createSortable","_sortable","_onSheetReorderStart","_onSheetReorderEnd","_onSheetRemove","_onSheetSelect","_createEditor","_onAddSelect","scrollable","_editor","_renderSheets","_selectedIndex","_onEditorKeydown","_onEditorBlur","_destroyEditor","renderSheets","sheets","selectedIndex","wrapperOffsetWidth","sheetsGroupScrollWidth","sheetsWrapper","scrollPrevButton","scrollNextButton","gapWidth","addButton","addButtonWidth","scrollPrevButtonWidth","sheetsGroup","scrollNextButtonRight","_isRtl","isRtl","_renderHtml","_scrollableAllowed","_sheetsWrapper","children","outerWidth","_sheetsGroup","marginLeft","scrollWidth","ceil","parseFloat","_scrollableModeActive","_nowScrollingSheets","marginRight","_toggleScrollButtons","ul","scrollLeft","_scrollSheetsByDelta","renderScrollButtons","isSelectedSheet","elementContent","deleteIcon","sheetElements","maxlength","baseButtonClass","childrenElements","Sortable","container","animation","ignore","draggable","closest","_onSheetRename","oldIndex","newIndex","removedSheetName","editorValue","selectedSheetText","_scrollSheetsToItem","isAddButton","sheetIndex","item","currentScrollOffset","itemWidth","itemOffset","sheetsGroupWidth","sheetsGroupPadding","itemPosition","finish","animate","scrLeft","getcol","getrow","noThrow","stream","OUT","TokenStream","eof","addReference","peek","parseExpression","commas","maybeBinary","maybeIntersect","parseAtom","parseSymbol","upper","TRUE","FALSE","parseFuncall","fixReference","exp","parseArray","op","maybePercent","my_prec","his_prec","OPERATORS","ast","makePrinter","prec","withParens","needParens","parenthesize","arg","makeClosure","toCPS","cps","cpsAtom","cpsUnary","cpsBinary","cpsFunc","cpsLambda","cpsMatrix","cpsIf","makeContinuation","thenK","gensym","elseK","vars","cpsAnd","cpsOr","cont","elements","isMatrix","GENSYM","makeFormula","js","jsArray","FORMULA_CACHE","identity","readNext","ahead","refRange3D","refCell3D","refSheetRange","refSheetCell","refRange","refCell","funcall","toCell","isFirst","forEditor","fixCell","g","space","addPos","RawTokenStream","InputStream","startToken","endToken","isIdStart","isId","isOpChar","isPunc","readNumber","has_dot","number","symbol","getRC","negative","readSymbol","lookingAt","readString","readEscaped","readSheetName","readOperator","readPunc","EOF","forward","RegExp","escaped","predicate","rx","repeat","FORMAT_PARSERS","registerFormatParser","ops","comma","numberFormat","dot","currency","readExcel","deferred","reader","FileReader","onload","zip","JSZip","readWorkbook","readAsArrayBuffer","strings","readStrings","relationships","readRelationships","theme","readTheme","byType","readStyles","items","enter","tag","relId","dim","SEL_SHEET","byId","sheetDimensions","SEL_VIEW","activeTab","integer","SEL_DEFINED_NAME","vbProcedure","defineName","loadSheets","recalcSheets","ready","Deferred","promise","insertSheet","queueSheet","progress","notify","readSheet","defaultColWidth","toColWidth","defaultRowHeight","toRowHeight","SEL_ROW","maximumDigitWidth","fraction","pts","formulaRange","nCols","prevCellRef","styleIndex","stop","acRef","SEL_CELL","applyStyle","SEL_MERGE","SEL_COL","ht","SEL_SELECTION","SEL_PANE","xSplit","ySplit","SEL_SHEET_VIEW","leave","_refresh","SEL_VALUE","SEL_STRING","SEL_FORMULA","setFormat","formatCode","setFill","setFont","fontFamily","setBorder","side","prop","BORDER_WIDTHS","shouldSet","applyName","xf","base","inlineStyles","xfId","namedStyles","fills","numFmts","DEFAULT_FORMATS","part","files","asUint8Array","SEL_SHARED_STRING","SEL_TEXT","entries","Id","Target","Type","getXf","addBool","borderId","fillId","fontId","numFmtId","pivotButton","quotePrefix","getColor","themeColor","tint","rgb","toCSSColor","indexed","INDEXED_COLORS","colorScheme","toHSL","toCssRgba","fill","closed","SEL_NUM_FMT","SEL_FONT","SEL_FILL","patternType","SEL_BORDER","SEL_NAMED_STYLE","SEL_INLINE_STYLE","horizontal","vertical","wrapText","swap","scheme","SEL_SCHEME_SYSCLR","SEL_SCHEME_RGBCLR","def","none","thin","medium","dashed","dotted","thick","double","hair","mediumDashed","dashDot","mediumDashDot","dashDotDot","mediumDashDotDot","slantDashDot",0,11,12,14,15,16,17,18,19,21,22,45,47,48,49,"_readSheet","_readStrings","_readStyles","_readTheme","_readWorkbook","Workbook","_sheetsSearchCache","undoRedoStack","_onUndoRedo","_context","FormulaContext","_validationContext","ValidationFormulaContext","_names","unbind","_sheetChange","_inputForRef","commandOptions","editActiveCell","refresh","sheetByName","moveSheetToIndex","toIndex","fromIndex","sheetSelection","insertIndex","sheetName","getUniqueSheetName","sheetNameSuffix","sheetByIndex","removeSheet","newSheet","reject","excel","ooxml","saveAs","dataURI","toDataURL","proxyURL","forceProxy","group","undefineName","nameValue","PDFMixin","_drawPDF","exportPDF","proxyTarget","fail","area","states","currentFormula","_formulaContextRefresh","toActionSelector","selectors","alphaNumRegExp","ACTIONS","ENTRY_ACTIONS","CONTAINER_EVENTS","CLIPBOARD_EVENTS","EDITOR_EVENTS","FORMULABAR_EVENTS","FORMULAINPUT_EVENTS","SELECTION_MODES","COMPOSITE_UNAVAILABLE_ACTION_SELECTORS","UNHIDE_ACTION_SELECTORS","ACTION_KEYS","SHIFT_ACTION_KEYS","ENTRY_ACTION_KEYS","Controller","up","down","ctrl+left","ctrl+right","ctrl+up","ctrl+down","ctrl+home","ctrl+end","pageup","pagedown","tab","shift+tab","shift+enter","delete","backspace","shift+:alphanum",":alphanum","ctrl+:alphanum",":edit","wheel","*+mousedown","contextmenu","*+mousedrag","*+mouseup","*+dblclick","mousemove","*+pageup","*+pagedown","mouseup","*+cut","*+paste","*+copy","esc","rowheader","columnheader","topcorner","autofill","clipboardElement","cellContextMenu","rowHeaderContextMenu","colHeaderContextMenu","scroller","tabstrip","sheetsbar","editor","onEditorChange","onEditorActivate","onEditorDeactivate","onEditorUpdate","onScroll","listener","keyListener","barKeyListener","barElement","inputKeyListener","cellElement","onSheetBarSelect","onSheetBarReorder","onSheetBarRename","onSheetBarRemove","onContextMenuSelect","onCommandRequest","onDialogRequest","_execute","editorClose","showError","openDialog","_activeTooltip","clientHeight","onWheel","deltaX","originalEvent","deltaY","deltaMode","scrollWith","onAction","onPageUp","scrollDown","onPageDown","onEntryAction","shouldPrevent","disabled","rect","activeCellRectangle","onShiftAction","appendSelection","onMouseMove","objectAt","onMouseDown","pane","originFrame","_selectionMode","deactivate","openFilterMenu","onContextMenu","menu","isComposite","showUnhide","showUnmerge","prevent","constrainResize","resizeHandle","onMouseDrag","frame","startAutoScroll","selectToLocation","scrollTop","onMouseUp","stopAutoScroll","activeEditor","onDblClick","onCut","detach","clipBoardValue","onPaste","hasHTML","hasPlainText","clipboardData","DOMStringList","types","onCopy","scrollRight","offset","coordinates","cellLocation","lastKnownCellLocation","autoScroll","_autoScrollTarget","boundaries","scrollStep","finalLocation","viewObject","_scrollInterval","setInterval","clearInterval","filterMenu","createFilterMenu","openFor","onEditorBarFocus","onEditorCellFocus","onEditorEsc","onEditorBlur","isFiltered","onEditorAction","onEditorShiftAction","exportOptions","pdfExport","excelExport","selectElementContents","selectNodeContents","cellBefore","trs","cellAbove","prevRow","cellBorder","drawCell","collection","hBorders","vBorders","showGrid","defaultBorder","shouldDrawCell","toHSV","backgroundColor","textDecoration","fontStyle","fontWeight","wordBreak","__dataType","paneClassNames","addCell","sibling","borderRightColor","borderBottomColor","borderLeftColor","borderTopColor","within","RESIZE_HANDLE_WIDTH","viewClassNames","VIEW_MESAGES","HtmlTable","CELL_CONTEXT_MENU","ROW_HEADER_CONTEXT_MENU","COL_HEADER_CONTEXT_MENU","VIEW_CONTENTS","View","fixedContainer","viewSize","cellEditor","barEditor","topCorner","filterHeadersWrapper","filterRange","filterButton","filterButtonActive","icon","iconFilterDefault","sheetsBar","messages","errors","openUnsupported","shiftingNonblankCells","filterRangeContainingMerges","sortRangeContainingMerges","validationError","tabs","_height","_width","addColumn","addRow","Node","toDomTree","ContextMenu","contextMenuConfig","scrollbar","_chrome","_dialogs","_formulaInput","clipboardContents","SheetEditor","_sheetsbar","showOn","clientWidth","_resize","tabstripHeight","outerHeight","formulaBarHeight","formulaBar","sheetsBarHeight","quickAccessAdjust","prependTo","toolbar","_tabstrip","content","TabStrip","dataTextField","dataContentField","toolbarOptions","_executeCommand","cellRectangle","_rectangle","boundingRectangle","isColumnResizer","handleWidth","_headerWidth","isRowResizer","_headerHeight","isFilterIcon","filterIconRect","isAutoFill","frozen","paneAt","containingPane","theGrid","refreshTools","totalHeight","_pane","_destroyFilterMenu","_filterMenu","FilterMenu","selectClipBoardContents","scrollIntoView","willScroll","scrollBoundaries","scrollBottom","_destroyDialog","dialog","dialogs","errorMessages","focusLastActive","_filterMenuColumn","renderResizeHint","renderClipboardContents","resizeHint","resizeHintVertical","resizeHintHandle","resizeHintMarker","selectionView","primaryMergedCells","secondaryMergedCells","rangeDimensions","mergedCell","vaxis","haxis","rowHeader","columnHeader","mergedCellsWrapper","selectionWrapper","autoFillWrapper","selectionHighlight","isVisible","paneClasses","_currentView","_currentRect","_selectedHeaders","renderData","renderSelection","renderAutoFill","renderEditorSelection","renderFilterHeaders","hasRowHeader","rowOffset","headerClassName","hasColumnHeader","columnOffset","renderResizeHandler","itemSelection","allHeaders","doLayout","forScreen","xCoords","yCoords","hb","BUTTON_SIZE","BUTTON_OFFSET","Rectangle","filtered","classes","_addDiv","selections","activeCellClasses","selectionClasses","activeFormulaColor","_activeFormulaColor","_directionClasses","_addTable","cssClass","autoFillRectangle","toDiv","activeFormulaSelection","colorClasses","cellClasses","mergedCellLeft","mergedCellTop","PaneGrid","sum","total","PaneAxis","rangeRef","headerSize","hasHeader","paneSegment","_viewSize","widthCompensation","heightCompensation","_hidden","scrollBarSize","pageSize","firstHidden","lastHidden","startIndex","endIndex","startSegment","endSegment","lastPage","_pixelValues","_axis","_start","quarter","sameYear","today","setFullYear","sameMonth","firstDayOfMonth","setMonth","sameWeek","firstWeek","secondWeek","dayOfWeek","constructor","_values","_dates","_blanks","blanks","dates","_logic","logic","criteria","_criteria","expression","Query","filterExpr","filters","_matches","criterionValue","criterionType","valueType","TopFilter","DynamicFilter","_predicate","_average","aboveAverage","belowAverage","tomorrow","addDays","isToday","yesterday","nextWeek","thisWeek","lastWeek","nextMonth","thisMonth","lastMonth","nextQuarter","thisQuarter","lastQuarter","nextYear","thisYear","lastYear","yearToDate","cultures","months","names","_lists","ascendingComparer","descendingComparer","li","typeA","typeB","localeCompare","addPlainText","sections","maybeColor","RX_COLORS","maybeCondition","RX_CONDITION","readFormat","maybeFraction","sep","decimal","decimalPart","am","pm","readSection","haveConditional","sec","printSection","printToken","fmt","padLeft","adjusted","restart","compileFormatPart","checkComma","scaleCount","hasDate","hasTime","hasAmpm","percentCount","separeThousands","declen","intFormat","decFormat","condition","preamble","CACHE","calendars","standard","days","namesAbbr","ampm","fraclen","toFixed","eltime","formatInt","iv","chf","formatDec","span","textAndColor","_cosh","_sinh","_tanh","_gcd","_lcm","forIFS","chunks","matrix","parseCriteria","COL","_avg","numbers","_var_sp","divisor","avg","_stdev_sp","_percentrank","exc","nlt","ngt","found","_covariance","ax","ay","_percentile","rank","_percentile_inc","_percentile_exc","fetchValuesForAggregate","opt_ignore_hidden_rows","opt_ignore_errors","opt_use_aggregates","fetchValues","_binom_dist","cumulative","_combinations","weeksInYear","_days_360","d1","d2","numericPredicate","descending","ARGS_COUNTIFS","ARGS_SUMIFS","ARGS_SUMIF","ARGS_PERCENTRANK","_fact","AGGREGATE_FUNCS","RX_NON_PRINTABLE","cos","sin","atan","tan","mult","prod","coef","seen","m1","sumRange","nth","error","res","discard","bins","asc","variance","stddev","significance","fact","f1","f2","p1","p2","funcId","ignoreHidden","alpha","s2","approx","resultCol","areanum","cmp","resultRow","fw","sy","dow","wk","holidays","inc","random","rom","radix","minLen","dec","noCommas","newText","oldText","valueIfError","makeComparator","lc","compLT","compLTE","compGT","compGTE","compNE","compEQ","RXCACHE","ERF","S","an","f_abs","ERFC","GAMMALN","cof","ser","GAMMA","pi","BETALN","BETA","gamma_inc","g_series","g_contfrac","ap","gln","MAX_IT","EPS","FP_MIN","aj","bj","GAMMA_DIST","GAMMA_INV","M","ab","q","NORM_S_DIST","NORM_S_INV","plow","phigh","NORM_DIST","NORM_INV","betastd_pdf","betastd_cdf","beta_lentz","m2","del","qab","qap","qam","betastd_inv","BETADIST","BETA_DIST","cdf","BETA_INV","chisq_left","cds","chisq_right","chisq_left_inv","chisq_right_inv","chisq_test","obsv","expect","eij","expon","poisson","lnf","Fdist","Fdist_right","Finv_right","Finv","_mean","me","_var_sq","Ftest","arr1","arr2","n1","n2","va1","va2","fisher","fisherinv","e2","Tdist","Tdist_right","Tdist_2tail","Tdist_inv","Tdist_2tail_inv","Tdist_test","gr1","gr2","tail","t_st","df","md","v1","v2","u1","u2","q1","q2","confidence_t","confidence_norm","gauss","z","phi","lognorm_dist","lognorm_inv","prob","x_","p_","lw","slope","y_","mx","my","b1","b2","intercept","pearson","s1","s3","rsq","steyx","forecast","_mat_mean","Mat","_mat_devsq","mean","sq","linest","Y","X","konst","stats","Xt","B","line_1","Y1","y_y1","mp","SSreg","SSresid","line_5","R2","degfre","err_est","line_3","F_sta","line_4","SCP","line_2","logest","trend","W","growth","new_X","root_newton","guess","max_it","eps","f_d","FV","rate","nper","pmt","pv","h1","h2","PV","fv","PMT","NPER","RATE","xfd","IPMT","per","ipmt","PPMT","CUMPRINC","tn","ts","te","monthlyPayment","remainingBalanceAtStart","remainingBalanceAtEnd","CUMIPMT","cip","NPV","flows","npv","IRR","npv1","EFFECT","nominal_rate","npery","NOMINAL","effect_rate","XNPV","XIRR","ISPMT","DB","cost","salvage","life","period","db","DDB","factor","prior","dep","SLN","SYD","VDB","no_switch","_getGDA","gda","oldValue","interest","_interVDB","life1","term","remValue","intEnd","lia","vdb","nowLia","intStart","_edate","_daysBetween","basis","_borderCoupons","settlement","maturity","freq","sett","periods","_borderCoupons_fw","COUPDAYBS","frequency","COUPDAYS","settl","matur","COUPDAYSNC","COUPPCD","COUPNCD","COUPNUM","mat","ACCRINTM","issue","par","year_days","ACCRINT","_numCoupons","annual","brace","prev1","next1","nrc","accr","DISC","pr","redemption","INTRATE","investment","RECEIVED","discount","PRICE","yld","N","beg_settl","settl_end","beg_end","den","yf","PRICEDISC","dsm","COUPS_ARGS","ll","ac","BORDER_TYPES","BORDER_PALETTE_MESSAGES","ColorChooser","BorderPalette","borderPalette","customColor","cancel","_resetButton","_colorPalette","_customColorPalette","_customColorButton","resetButton","resetColor","customColorButton","colorPalette","flatColorPicker","_change","class","kendoColorPalette","palette","viewModel","kendoWindow","resizable","maximizable","modal","center","one","_hueSlider","kendoFlatColorPicker","observable","_borderTypePalette","_borderColorPalette","_click","colorChooser","buttons","_colorChange","currentTarget","ToolBar","MESSAGES","defaultTools","toolDefaults","SpreadsheetToolBar","DropDownTool","PopupTool","OverflowDialogButton","ColorPicker","ColorPickerButton","FONT_SIZES","DEFAULT_FONT_SIZE","FontSize","FontSizeButton","FONT_FAMILIES","DEFAULT_FONT_FAMILY","FontFamily","FontFamilyButton","defaultFormats","Format","FormatButton","BorderChangeTool","BorderChangeButton","AlignmentTool","AlignmentButton","MergeTool","MergeButton","FreezeTool","FreezeButton","Sort","SortButton","FilterButton","Open","alignment","alignmentButtons","justtifyLeft","justifyCenter","justifyRight","justifyFull","alignTop","alignMiddle","alignBottom","colorPicker","formatTypes","automatic","percent","financial","dateTime","duration","moreFormats","formatDecreaseDecimal","formatIncreaseDecimal","freeze","freezeButtons","freezePanes","freezeRows","freezeColumns","mergeButtons","mergeCells","mergeHorizontally","mergeVertically","quickAccess","exportAs","sortAsc","sortDesc","sortButtons","sortSheetAsc","sortSheetDesc","sortRangeAsc","sortRangeDesc","textColor","textWrap","iconClass","dialogName","togglable","separator","formatCells","_expandTools","tools","toolbarName","handleClick","_addSeparators","click","groups","before","expandTool","toolName","isPlainObject","spriteCssClass","typeDefaults","splitButton","showText","toolIcon","tool","attributes","menuButtons","commandType","checked","setToggle","update","_tools","isFunction","toArray","_getItem","instance","Item","dropDownList","kendoDropDownList","addUidAttr","addOverflowAttr","_open","data-command","data-property","listWidth","ddl","_listWidth","sender","dataItem","popupName","kendoPopup","registerComponent","ToolBarButton","_dialogName","OverflowButton","iconName","comboBox","kendoComboBox","_valueChange","fontSizes","sizes","defaultSize","fontFamilies","defaultFont","_revertTitle","setOptions","dataValuePrimitive","valueTemplate","sample","_borderPalette","_action","_commandPalette","removeClass","_title","_reset","_quickAccessButtons","quickAccessToolBar","toolbars","contentElements","_toolbar","buttonTemplate","insertBefore","tabGroup","formattedValue","uniqueBy","ObservableObject","registry","SpreadsheetDialog","FormatCellsViewModel","FormatCellsDialog","MessageDialog","FontFamilyDialog","FontSizeDialog","BordersDialog","ColorPickerDialog","CustomColorDialog","AlignmentDialog","MergeDialog","FreezeDialog","ValidationViewModel","ValidationDialog","ExportAsDialog","ModifyMergedDialog","OverflowDialog","UseKeyboardDialog","UnsupportedSelectionDialog","okText","formatCellsDialog","categories","fontFamilyDialog","fontSizeDialog","bordersDialog","alignmentDialog","mergeDialog","freezeDialog","validationDialog","hintMessage","hintTitle","any","comparers","comparerMessages","labels","onInvalidData","rejectInput","showWarning","showHint","ignoreBlank","placeholders","typeTitle","typeMessage","exportAsDialog","fit","saveAsType","exportArea","paperSize","margins","orientation","guidelines","modifyMergedDialog","errorMessage","overflowDialog","useKeyboardDialog","forCopy","forCut","forPaste","unsupportedSelectionDialog","register","dialogClass","_dialog","_onDialogClose","_onDialogActivate","_onDialogDeactivate","useCategory","category","formatCurrency","currencies","allFormats","useFirstFormat","info","_currency","iso","convert","categoryFilter","pattern","abbr","defaultOptions","_generateFormats","calendarPatterns","currenciesFrom","numberFormats","dateFormats","currencyFilter","roleSelector","description","messageId","getter","_list","_colorPicker","ValidationCellsViewModel","criterion","setHintMessageTemplate","shouldBuild","buildMessages","hintTitleTemplate","hintMessageTemplate","setComparers","defaultHintTitle","text_comparers","defaultComparers","defaultHintMessage","isAny","showToForNumber","showTo","showToForDate","isDate","isText","isList","isCustom","showRemove","fromValidationObject","useCustomMessages","toValidationObject","errorTemplate","validatable","Validator","validateOnBlur","validate","fileFormats","author","subject","keywords","creator","fitWidth","areas","paperSizes","margin","landscape","hCenter","vCenter","_normalizeColumns","_dataSource","_header","_sheetChangeHandler","_sheetDeleteRowHandler","_sheetDeleteRow","_sheetInsertRowHandler","_sheetInsertRow","model","_skipRebind","record","valueIndex","colValueIndex","_changeHandler","getters","getterIdx","distinctValues","query","itemVisible","anyVisibleChildren","hasVisibleChildren","HierarchicalDataSource","uncheckAll","hasChildren","flattenOperators","operators","FILTERMENU_MESSAGES","Details","templates","FilterMenuViewModel","FilterMenuController","details","detailsSummary","detailsContent","iconCollapse","iconExpand","iconSearch","textbox","filterByCondition","filterByValue","valuesTreeViewWrapper","actionButtons","_summary","_toggle","_icon","_container","fx","expand","sortAscending","sortDescending","search","addToCurrent","operatorNone","and","or","doesnotcontain","startswith","endswith","neq","gte","lte","binders","spreadsheetFilterValue","Binder","bindings","proxy","widget","binding","menuItem","valuesChange","valuesDataSource","lastIndexOf","appendToSearch","valueSelect","hasActiveSearch","filterValues","operatorChange","isNone","isString","valuesTree","filterType","topValue","filterForColumn","allFilters","columnFilters","_filterInit","_filterByCondition","_filterByValue","_actionButtons","valuesTreeView","_active","activeFilter","copyAnchorStyles","dir","kendoMenu","_appendTemplate","compiledTemplate","_detailToggle","not","isExpanded","activeContainer","hasClass","notEqual","oldRect","newRect","barInput","cellInput","_triggerUpdate","lastActive","activeElement","_rect","inputType","linearRegression","findSeries","findStep","forEachSeries","formatType","getType","lst","findStringList","stringLists","strl","MSG_INCOMPATIBLE","MSG_NO_DIRECTION","srcRange","src","srcIdx","destRange","distributeCoords","heights","pageHeight","curr","getMergedCells","primary","secondary","pageWidth","scaleFactor","boxWidth","boxHeight","rowHeights","colWidths","maxRow","maxCol","nonEmpty","relrow","relcol","emptyCells","orlast","normalOrder","drawLayout","addPage","page","endbottom","endright","Group","clip","Path","fromRect","geo","Rect","multiplyCopy","translate","transform","moveTo","lineTo","stroke","GUIDELINE_WIDTH","ncols","nrows","r2d2","drawText","vtrans","rect_left","rect_top","rect_width","rect_height","makeFontDef","lines","text_height","lineBreak","Text","htrans","eol","sub","paper","getPaperOptions","multiPage","geometry","NS","Spreadsheet","_controller","_autoRefresh","_bindWorkbookEvents","_resizeHandler","_workbookChange","autoRefresh","blob","_workbookExcelExport","_workbookExcelImport","_initProgress","loading","pb","kendoProgressBar","chunkCount","always","_workbookPdfExport","plugin"],"mappings":"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","file":"kendo.spreadsheet.min.js","sourcesContent":["/*!\n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n\n*/\n(function (f, define) {\n    define('util/undoredostack', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        var UndoRedoStack = kendo.Observable.extend({\n            init: function (options) {\n                kendo.Observable.fn.init.call(this, options);\n                this.clear();\n            },\n            events: [\n                'undo',\n                'redo'\n            ],\n            push: function (command) {\n                this.stack = this.stack.slice(0, this.currentCommandIndex + 1);\n                this.currentCommandIndex = this.stack.push(command) - 1;\n            },\n            undo: function () {\n                if (this.canUndo()) {\n                    var command = this.stack[this.currentCommandIndex--];\n                    command.undo();\n                    this.trigger('undo', { command: command });\n                }\n            },\n            redo: function () {\n                if (this.canRedo()) {\n                    var command = this.stack[++this.currentCommandIndex];\n                    command.redo();\n                    this.trigger('redo', { command: command });\n                }\n            },\n            clear: function () {\n                this.stack = [];\n                this.currentCommandIndex = -1;\n            },\n            canUndo: function () {\n                return this.currentCommandIndex >= 0;\n            },\n            canRedo: function () {\n                return this.currentCommandIndex != this.stack.length - 1;\n            }\n        });\n        kendo.deepExtend(kendo, { util: { UndoRedoStack: UndoRedoStack } });\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('util/main', ['kendo.core'], f);\n}(function () {\n    (function () {\n        var math = Math, kendo = window.kendo, deepExtend = kendo.deepExtend;\n        var DEG_TO_RAD = math.PI / 180, MAX_NUM = Number.MAX_VALUE, MIN_NUM = -Number.MAX_VALUE, UNDEFINED = 'undefined';\n        function defined(value) {\n            return typeof value !== UNDEFINED;\n        }\n        function round(value, precision) {\n            var power = pow(precision);\n            return math.round(value * power) / power;\n        }\n        function pow(p) {\n            if (p) {\n                return math.pow(10, p);\n            } else {\n                return 1;\n            }\n        }\n        function limitValue(value, min, max) {\n            return math.max(math.min(value, max), min);\n        }\n        function rad(degrees) {\n            return degrees * DEG_TO_RAD;\n        }\n        function deg(radians) {\n            return radians / DEG_TO_RAD;\n        }\n        function isNumber(val) {\n            return typeof val === 'number' && !isNaN(val);\n        }\n        function valueOrDefault(value, defaultValue) {\n            return defined(value) ? value : defaultValue;\n        }\n        function sqr(value) {\n            return value * value;\n        }\n        function objectKey(object) {\n            var parts = [];\n            for (var key in object) {\n                parts.push(key + object[key]);\n            }\n            return parts.sort().join('');\n        }\n        function hashKey(str) {\n            var hash = 2166136261;\n            for (var i = 0; i < str.length; ++i) {\n                hash += (hash << 1) + (hash << 4) + (hash << 7) + (hash << 8) + (hash << 24);\n                hash ^= str.charCodeAt(i);\n            }\n            return hash >>> 0;\n        }\n        function hashObject(object) {\n            return hashKey(objectKey(object));\n        }\n        var now = Date.now;\n        if (!now) {\n            now = function () {\n                return new Date().getTime();\n            };\n        }\n        function arrayLimits(arr) {\n            var length = arr.length, i, min = MAX_NUM, max = MIN_NUM;\n            for (i = 0; i < length; i++) {\n                max = math.max(max, arr[i]);\n                min = math.min(min, arr[i]);\n            }\n            return {\n                min: min,\n                max: max\n            };\n        }\n        function arrayMin(arr) {\n            return arrayLimits(arr).min;\n        }\n        function arrayMax(arr) {\n            return arrayLimits(arr).max;\n        }\n        function sparseArrayMin(arr) {\n            return sparseArrayLimits(arr).min;\n        }\n        function sparseArrayMax(arr) {\n            return sparseArrayLimits(arr).max;\n        }\n        function sparseArrayLimits(arr) {\n            var min = MAX_NUM, max = MIN_NUM;\n            for (var i = 0, length = arr.length; i < length; i++) {\n                var n = arr[i];\n                if (n !== null && isFinite(n)) {\n                    min = math.min(min, n);\n                    max = math.max(max, n);\n                }\n            }\n            return {\n                min: min === MAX_NUM ? undefined : min,\n                max: max === MIN_NUM ? undefined : max\n            };\n        }\n        function last(array) {\n            if (array) {\n                return array[array.length - 1];\n            }\n        }\n        function append(first, second) {\n            first.push.apply(first, second);\n            return first;\n        }\n        function renderTemplate(text) {\n            return kendo.template(text, {\n                useWithBlock: false,\n                paramName: 'd'\n            });\n        }\n        function renderAttr(name, value) {\n            return defined(value) && value !== null ? ' ' + name + '=\\'' + value + '\\' ' : '';\n        }\n        function renderAllAttr(attrs) {\n            var output = '';\n            for (var i = 0; i < attrs.length; i++) {\n                output += renderAttr(attrs[i][0], attrs[i][1]);\n            }\n            return output;\n        }\n        function renderStyle(attrs) {\n            var output = '';\n            for (var i = 0; i < attrs.length; i++) {\n                var value = attrs[i][1];\n                if (defined(value)) {\n                    output += attrs[i][0] + ':' + value + ';';\n                }\n            }\n            if (output !== '') {\n                return output;\n            }\n        }\n        function renderSize(size) {\n            if (typeof size !== 'string') {\n                size += 'px';\n            }\n            return size;\n        }\n        function renderPos(pos) {\n            var result = [];\n            if (pos) {\n                var parts = kendo.toHyphens(pos).split('-');\n                for (var i = 0; i < parts.length; i++) {\n                    result.push('k-pos-' + parts[i]);\n                }\n            }\n            return result.join(' ');\n        }\n        function isTransparent(color) {\n            return color === '' || color === null || color === 'none' || color === 'transparent' || !defined(color);\n        }\n        function arabicToRoman(n) {\n            var literals = {\n                1: 'i',\n                10: 'x',\n                100: 'c',\n                2: 'ii',\n                20: 'xx',\n                200: 'cc',\n                3: 'iii',\n                30: 'xxx',\n                300: 'ccc',\n                4: 'iv',\n                40: 'xl',\n                400: 'cd',\n                5: 'v',\n                50: 'l',\n                500: 'd',\n                6: 'vi',\n                60: 'lx',\n                600: 'dc',\n                7: 'vii',\n                70: 'lxx',\n                700: 'dcc',\n                8: 'viii',\n                80: 'lxxx',\n                800: 'dccc',\n                9: 'ix',\n                90: 'xc',\n                900: 'cm',\n                1000: 'm'\n            };\n            var values = [\n                1000,\n                900,\n                800,\n                700,\n                600,\n                500,\n                400,\n                300,\n                200,\n                100,\n                90,\n                80,\n                70,\n                60,\n                50,\n                40,\n                30,\n                20,\n                10,\n                9,\n                8,\n                7,\n                6,\n                5,\n                4,\n                3,\n                2,\n                1\n            ];\n            var roman = '';\n            while (n > 0) {\n                if (n < values[0]) {\n                    values.shift();\n                } else {\n                    roman += literals[values[0]];\n                    n -= values[0];\n                }\n            }\n            return roman;\n        }\n        function romanToArabic(r) {\n            r = r.toLowerCase();\n            var digits = {\n                i: 1,\n                v: 5,\n                x: 10,\n                l: 50,\n                c: 100,\n                d: 500,\n                m: 1000\n            };\n            var value = 0, prev = 0;\n            for (var i = 0; i < r.length; ++i) {\n                var v = digits[r.charAt(i)];\n                if (!v) {\n                    return null;\n                }\n                value += v;\n                if (v > prev) {\n                    value -= 2 * prev;\n                }\n                prev = v;\n            }\n            return value;\n        }\n        function memoize(f) {\n            var cache = Object.create(null);\n            return function () {\n                var id = '';\n                for (var i = arguments.length; --i >= 0;) {\n                    id += ':' + arguments[i];\n                }\n                if (id in cache) {\n                    return cache[id];\n                }\n                return f.apply(this, arguments);\n            };\n        }\n        function ucs2decode(string) {\n            var output = [], counter = 0, length = string.length, value, extra;\n            while (counter < length) {\n                value = string.charCodeAt(counter++);\n                if (value >= 55296 && value <= 56319 && counter < length) {\n                    extra = string.charCodeAt(counter++);\n                    if ((extra & 64512) == 56320) {\n                        output.push(((value & 1023) << 10) + (extra & 1023) + 65536);\n                    } else {\n                        output.push(value);\n                        counter--;\n                    }\n                } else {\n                    output.push(value);\n                }\n            }\n            return output;\n        }\n        function ucs2encode(array) {\n            return array.map(function (value) {\n                var output = '';\n                if (value > 65535) {\n                    value -= 65536;\n                    output += String.fromCharCode(value >>> 10 & 1023 | 55296);\n                    value = 56320 | value & 1023;\n                }\n                output += String.fromCharCode(value);\n                return output;\n            }).join('');\n        }\n        deepExtend(kendo, {\n            util: {\n                MAX_NUM: MAX_NUM,\n                MIN_NUM: MIN_NUM,\n                append: append,\n                arrayLimits: arrayLimits,\n                arrayMin: arrayMin,\n                arrayMax: arrayMax,\n                defined: defined,\n                deg: deg,\n                hashKey: hashKey,\n                hashObject: hashObject,\n                isNumber: isNumber,\n                isTransparent: isTransparent,\n                last: last,\n                limitValue: limitValue,\n                now: now,\n                objectKey: objectKey,\n                round: round,\n                rad: rad,\n                renderAttr: renderAttr,\n                renderAllAttr: renderAllAttr,\n                renderPos: renderPos,\n                renderSize: renderSize,\n                renderStyle: renderStyle,\n                renderTemplate: renderTemplate,\n                sparseArrayLimits: sparseArrayLimits,\n                sparseArrayMin: sparseArrayMin,\n                sparseArrayMax: sparseArrayMax,\n                sqr: sqr,\n                valueOrDefault: valueOrDefault,\n                romanToArabic: romanToArabic,\n                arabicToRoman: arabicToRoman,\n                memoize: memoize,\n                ucs2encode: ucs2encode,\n                ucs2decode: ucs2decode\n            }\n        });\n        kendo.drawing.util = kendo.util;\n        kendo.dataviz.util = kendo.util;\n    }());\n    return window.kendo;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('util/text-metrics', [\n        'kendo.core',\n        'util/main'\n    ], f);\n}(function () {\n    (function ($) {\n        var doc = document, kendo = window.kendo, Class = kendo.Class, util = kendo.util, defined = util.defined;\n        var LRUCache = Class.extend({\n            init: function (size) {\n                this._size = size;\n                this._length = 0;\n                this._map = {};\n            },\n            put: function (key, value) {\n                var lru = this, map = lru._map, entry = {\n                        key: key,\n                        value: value\n                    };\n                map[key] = entry;\n                if (!lru._head) {\n                    lru._head = lru._tail = entry;\n                } else {\n                    lru._tail.newer = entry;\n                    entry.older = lru._tail;\n                    lru._tail = entry;\n                }\n                if (lru._length >= lru._size) {\n                    map[lru._head.key] = null;\n                    lru._head = lru._head.newer;\n                    lru._head.older = null;\n                } else {\n                    lru._length++;\n                }\n            },\n            get: function (key) {\n                var lru = this, entry = lru._map[key];\n                if (entry) {\n                    if (entry === lru._head && entry !== lru._tail) {\n                        lru._head = entry.newer;\n                        lru._head.older = null;\n                    }\n                    if (entry !== lru._tail) {\n                        if (entry.older) {\n                            entry.older.newer = entry.newer;\n                            entry.newer.older = entry.older;\n                        }\n                        entry.older = lru._tail;\n                        entry.newer = null;\n                        lru._tail.newer = entry;\n                        lru._tail = entry;\n                    }\n                    return entry.value;\n                }\n            }\n        });\n        var defaultMeasureBox = $('<div style=\\'position: absolute !important; top: -4000px !important; width: auto !important; height: auto !important;' + 'padding: 0 !important; margin: 0 !important; border: 0 !important;' + 'line-height: normal !important; visibility: hidden !important; white-space: nowrap!important;\\' />')[0];\n        function zeroSize() {\n            return {\n                width: 0,\n                height: 0,\n                baseline: 0\n            };\n        }\n        var TextMetrics = Class.extend({\n            init: function (options) {\n                this._cache = new LRUCache(1000);\n                this._initOptions(options);\n            },\n            options: { baselineMarkerSize: 1 },\n            measure: function (text, style, box) {\n                if (!text) {\n                    return zeroSize();\n                }\n                var styleKey = util.objectKey(style), cacheKey = util.hashKey(text + styleKey), cachedResult = this._cache.get(cacheKey);\n                if (cachedResult) {\n                    return cachedResult;\n                }\n                var size = zeroSize();\n                var measureBox = box ? box : defaultMeasureBox;\n                var baselineMarker = this._baselineMarker().cloneNode(false);\n                for (var key in style) {\n                    var value = style[key];\n                    if (defined(value)) {\n                        measureBox.style[key] = value;\n                    }\n                }\n                $(measureBox).text(text);\n                measureBox.appendChild(baselineMarker);\n                doc.body.appendChild(measureBox);\n                if ((text + '').length) {\n                    size.width = measureBox.offsetWidth - this.options.baselineMarkerSize;\n                    size.height = measureBox.offsetHeight;\n                    size.baseline = baselineMarker.offsetTop + this.options.baselineMarkerSize;\n                }\n                if (size.width > 0 && size.height > 0) {\n                    this._cache.put(cacheKey, size);\n                }\n                measureBox.parentNode.removeChild(measureBox);\n                return size;\n            },\n            _baselineMarker: function () {\n                return $('<div class=\\'k-baseline-marker\\' ' + 'style=\\'display: inline-block; vertical-align: baseline;' + 'width: ' + this.options.baselineMarkerSize + 'px; height: ' + this.options.baselineMarkerSize + 'px;' + 'overflow: hidden;\\' />')[0];\n            }\n        });\n        TextMetrics.current = new TextMetrics();\n        function measureText(text, style, measureBox) {\n            return TextMetrics.current.measure(text, style, measureBox);\n        }\n        function loadFonts(fonts, callback) {\n            var promises = [];\n            if (fonts.length > 0 && document.fonts) {\n                try {\n                    promises = fonts.map(function (font) {\n                        return document.fonts.load(font);\n                    });\n                } catch (e) {\n                    kendo.logToConsole(e);\n                }\n                Promise.all(promises).then(callback, callback);\n            } else {\n                callback();\n            }\n        }\n        kendo.util.TextMetrics = TextMetrics;\n        kendo.util.LRUCache = LRUCache;\n        kendo.util.loadFonts = loadFonts;\n        kendo.util.measureText = measureText;\n    }(window.kendo.jQuery));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('util/parse-xml', [\n        'kendo.core',\n        'util/main'\n    ], f);\n}(function () {\n    'use strict';\n    var STRING = String.fromCharCode;\n    var ENTITIES = {\n        'amp': 38,\n        'lt': 60,\n        'gt': 62,\n        'quot': 34,\n        'nbsp': 160\n    };\n    function CODE(str) {\n        var out = [];\n        for (var i = 0; i < str.length; ++i) {\n            out.push(str.charCodeAt(i));\n        }\n        return out;\n    }\n    function UCS2(out, code) {\n        if (code > 65535) {\n            code -= 65536;\n            out.push(code >>> 10 & 1023 | 55296, 56320 | code & 1023);\n        } else {\n            out.push(code);\n        }\n    }\n    var START_CDATA = CODE('<![CDATA[');\n    var END_CDATA = CODE(']]>');\n    var END_COMMENT = CODE('-->');\n    var START_COMMENT = CODE('!--');\n    var END_SHORT_TAG = CODE('/>');\n    var END_TAG = CODE('</');\n    var END_DECLARATION = CODE('?>');\n    var QUESTION_MARK = CODE('?');\n    var LESS_THAN = CODE('<');\n    var GREATER_THAN = CODE('>');\n    var SEMICOLON = CODE(';');\n    var EQUAL = CODE('=');\n    var AMPERSAND = CODE('&');\n    var QUOTE = CODE('\"');\n    var APOSTROPHE = CODE('\\'');\n    var SHARP = CODE('#');\n    var LOWERCASE_X = CODE('x');\n    var UPPERCASE_X = CODE('X');\n    var EXIT = {};\n    function parse(data, callbacks) {\n        var index = 0;\n        var stack = [];\n        var object = {\n            is: function (selector) {\n                var i = stack.length, j = selector.length;\n                while (--i >= 0 && --j >= 0) {\n                    if (stack[i].$tag != selector[j] && selector[j] != '*') {\n                        return false;\n                    }\n                }\n                return j < 0 ? stack[stack.length - 1] : null;\n            },\n            exit: function () {\n                throw EXIT;\n            },\n            stack: stack\n        };\n        function readChar(body) {\n            var code = data[index++];\n            if (!(code & 240 ^ 240)) {\n                UCS2(body, (code & 3) << 18 | (data[index++] & 63) << 12 | (data[index++] & 63) << 6 | data[index++] & 63);\n            } else if (!(code & 224 ^ 224)) {\n                UCS2(body, (code & 15) << 12 | (data[index++] & 63) << 6 | data[index++] & 63);\n            } else if (!(code & 192 ^ 192)) {\n                UCS2(body, (code & 31) << 6 | data[index++] & 63);\n            } else {\n                body.push(code);\n            }\n        }\n        function croak(msg) {\n            throw new Error(msg + ', at ' + index);\n        }\n        function readWhile(pred) {\n            var a = [];\n            while (index < data.length && pred(data[index])) {\n                a.push(data[index++]);\n            }\n            return a;\n        }\n        function readAsciiWhile(pred) {\n            return STRING.apply(0, readWhile(pred));\n        }\n        function skipWhitespace() {\n            readWhile(isWhitespace);\n        }\n        function eat(a) {\n            var save = index;\n            for (var i = 0; i < a.length; ++i) {\n                if (data[index++] != a[i]) {\n                    index = save;\n                    return false;\n                }\n            }\n            return a;\n        }\n        function skip(code) {\n            if (!eat(code)) {\n                croak('Expecting ' + code.join(', '));\n            }\n        }\n        function isWhitespace(code) {\n            return code == 9 || code == 10 || code == 13 || code == 32;\n        }\n        function isDigit(code) {\n            return code >= 48 && code <= 57;\n        }\n        function isHexDigit(code) {\n            return code >= 48 && code <= 57 || (code |= 32) >= 97 && code <= 102;\n        }\n        function isNameStart(code) {\n            return code == 58 || code == 95 || (code |= 32) >= 97 && code <= 122;\n        }\n        function isName(code) {\n            return code == 45 || isDigit(code) || isNameStart(code);\n        }\n        function xmlComment() {\n            var body = [];\n            while (index < data.length) {\n                if (eat(END_COMMENT)) {\n                    return call('comment', STRING.apply(0, body));\n                }\n                readChar(body);\n            }\n        }\n        function xmlTag() {\n            var name, attrs;\n            if (eat(QUESTION_MARK)) {\n                xmlDecl();\n            } else if (eat(START_COMMENT)) {\n                xmlComment();\n            } else {\n                name = xmlName();\n                attrs = xmlAttrs(name);\n                stack.push(attrs);\n                if (eat(END_SHORT_TAG)) {\n                    call('enter', name, attrs, true);\n                } else {\n                    skip(GREATER_THAN);\n                    call('enter', name, attrs);\n                    xmlContent(name);\n                    if (name != xmlName()) {\n                        croak('Bad closing tag');\n                    }\n                    call('leave', name, attrs);\n                    skipWhitespace();\n                    skip(GREATER_THAN);\n                }\n                stack.pop();\n            }\n        }\n        function xmlContent(name) {\n            var body = [];\n            while (index < data.length) {\n                if (eat(END_TAG)) {\n                    return body.length && call('text', STRING.apply(0, body));\n                } else if (eat(START_CDATA)) {\n                    while (index < data.length && !eat(END_CDATA)) {\n                        readChar(body);\n                    }\n                } else if (eat(LESS_THAN)) {\n                    if (body.length) {\n                        call('text', STRING.apply(0, body));\n                    }\n                    xmlTag();\n                    body = [];\n                } else if (eat(AMPERSAND)) {\n                    xmlEntity(body);\n                } else {\n                    readChar(body);\n                }\n            }\n            croak('Unclosed tag ' + name);\n        }\n        function xmlName() {\n            if (!isNameStart(data[index])) {\n                croak('Expecting XML name');\n            }\n            return readAsciiWhile(isName);\n        }\n        function xmlString() {\n            var quote = eat(QUOTE) || eat(APOSTROPHE);\n            if (!quote) {\n                croak('Expecting string');\n            }\n            var body = [];\n            while (index < data.length) {\n                if (eat(quote)) {\n                    return STRING.apply(0, body);\n                } else if (eat(AMPERSAND)) {\n                    xmlEntity(body);\n                } else {\n                    readChar(body);\n                }\n            }\n            croak('Unfinished string');\n        }\n        function xmlEntity(body) {\n            var code;\n            if (eat(SHARP)) {\n                if (eat(LOWERCASE_X) || eat(UPPERCASE_X)) {\n                    code = parseInt(readAsciiWhile(isHexDigit), 16);\n                } else {\n                    code = parseInt(readAsciiWhile(isDigit), 10);\n                }\n                if (isNaN(code)) {\n                    croak('Bad numeric entity');\n                }\n            } else {\n                var name = xmlName();\n                code = ENTITIES[name];\n                if (code === undefined) {\n                    croak('Unknown entity ' + name);\n                }\n            }\n            UCS2(body, code);\n            skip(SEMICOLON);\n        }\n        function xmlDecl() {\n            call('decl', xmlName(), xmlAttrs());\n            skip(END_DECLARATION);\n        }\n        function xmlAttrs(name) {\n            var map = { $tag: name };\n            while (index < data.length) {\n                skipWhitespace();\n                var code = data[index];\n                if (code == 63 || code == 62 || code == 47) {\n                    break;\n                }\n                map[xmlName()] = (skip(EQUAL), xmlString());\n            }\n            return map;\n        }\n        function call(what, thing, arg1, arg2) {\n            var f = callbacks && callbacks[what];\n            if (f) {\n                f.call(object, thing, arg1, arg2);\n            }\n        }\n        var tmp = [];\n        readChar(tmp);\n        if (tmp[0] != 65279) {\n            index = 0;\n        }\n        while (index < data.length) {\n            skipWhitespace();\n            skip(LESS_THAN);\n            xmlTag();\n            skipWhitespace();\n        }\n    }\n    kendo.util.parseXML = function parseXML() {\n        try {\n            return parse.apply(this, arguments);\n        } catch (ex) {\n            if (ex !== EXIT) {\n                throw ex;\n            }\n        }\n    };\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('util/base64', ['util/main'], f);\n}(function () {\n    (function () {\n        var kendo = window.kendo, deepExtend = kendo.deepExtend, fromCharCode = String.fromCharCode;\n        var KEY_STR = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n        function encodeBase64(input) {\n            var output = '';\n            var chr1, chr2, chr3, enc1, enc2, enc3, enc4;\n            var i = 0;\n            input = encodeUTF8(input);\n            while (i < input.length) {\n                chr1 = input.charCodeAt(i++);\n                chr2 = input.charCodeAt(i++);\n                chr3 = input.charCodeAt(i++);\n                enc1 = chr1 >> 2;\n                enc2 = (chr1 & 3) << 4 | chr2 >> 4;\n                enc3 = (chr2 & 15) << 2 | chr3 >> 6;\n                enc4 = chr3 & 63;\n                if (isNaN(chr2)) {\n                    enc3 = enc4 = 64;\n                } else if (isNaN(chr3)) {\n                    enc4 = 64;\n                }\n                output = output + KEY_STR.charAt(enc1) + KEY_STR.charAt(enc2) + KEY_STR.charAt(enc3) + KEY_STR.charAt(enc4);\n            }\n            return output;\n        }\n        function encodeUTF8(input) {\n            var output = '';\n            for (var i = 0; i < input.length; i++) {\n                var c = input.charCodeAt(i);\n                if (c < 128) {\n                    output += fromCharCode(c);\n                } else if (c < 2048) {\n                    output += fromCharCode(192 | c >>> 6);\n                    output += fromCharCode(128 | c & 63);\n                } else if (c < 65536) {\n                    output += fromCharCode(224 | c >>> 12);\n                    output += fromCharCode(128 | c >>> 6 & 63);\n                    output += fromCharCode(128 | c & 63);\n                }\n            }\n            return output;\n        }\n        deepExtend(kendo.util, {\n            encodeBase64: encodeBase64,\n            encodeUTF8: encodeUTF8\n        });\n    }());\n    return window.kendo;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('mixins/observers', ['kendo.core'], f);\n}(function () {\n    (function ($) {\n        var math = Math, kendo = window.kendo, deepExtend = kendo.deepExtend, inArray = $.inArray;\n        var ObserversMixin = {\n            observers: function () {\n                this._observers = this._observers || [];\n                return this._observers;\n            },\n            addObserver: function (element) {\n                if (!this._observers) {\n                    this._observers = [element];\n                } else {\n                    this._observers.push(element);\n                }\n                return this;\n            },\n            removeObserver: function (element) {\n                var observers = this.observers();\n                var index = inArray(element, observers);\n                if (index != -1) {\n                    observers.splice(index, 1);\n                }\n                return this;\n            },\n            trigger: function (methodName, event) {\n                var observers = this._observers;\n                var observer;\n                var idx;\n                if (observers && !this._suspended) {\n                    for (idx = 0; idx < observers.length; idx++) {\n                        observer = observers[idx];\n                        if (observer[methodName]) {\n                            observer[methodName](event);\n                        }\n                    }\n                }\n                return this;\n            },\n            optionsChange: function (e) {\n                this.trigger('optionsChange', e);\n            },\n            geometryChange: function (e) {\n                this.trigger('geometryChange', e);\n            },\n            suspend: function () {\n                this._suspended = (this._suspended || 0) + 1;\n                return this;\n            },\n            resume: function () {\n                this._suspended = math.max((this._suspended || 0) - 1, 0);\n                return this;\n            },\n            _observerField: function (field, value) {\n                if (this[field]) {\n                    this[field].removeObserver(this);\n                }\n                this[field] = value;\n                value.addObserver(this);\n            }\n        };\n        deepExtend(kendo, { mixins: { ObserversMixin: ObserversMixin } });\n    }(window.kendo.jQuery));\n    return window.kendo;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/commands', [\n        'kendo.core',\n        'kendo.binder',\n        'kendo.window',\n        'kendo.list',\n        'kendo.tabstrip'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Command = kendo.spreadsheet.Command = kendo.Class.extend({\n            init: function (options) {\n                this.options = options;\n                this._workbook = options.workbook;\n                this._property = options && options.property;\n                this._state = {};\n            },\n            range: function (range) {\n                if (range !== undefined) {\n                    this._range = range;\n                }\n                return this._range;\n            },\n            redo: function () {\n                this.exec();\n            },\n            undo: function () {\n                this.range().setState(this._state);\n            },\n            getState: function () {\n                this._state = this.range().getState(this._property);\n            },\n            _forEachCell: function (callback) {\n                var range = this.range();\n                var ref = range._ref;\n                ref.forEach(function (ref) {\n                    range.sheet().forEach(ref.toRangeRef(), callback.bind(this));\n                }.bind(this));\n            }\n        });\n        var PropertyChangeCommand = kendo.spreadsheet.PropertyChangeCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            exec: function () {\n                var range = this.range();\n                this.getState();\n                range[this._property](this._value);\n            }\n        });\n        kendo.spreadsheet.ClearContentCommand = Command.extend({\n            exec: function () {\n                this.getState();\n                this.range().clearContent();\n            }\n        });\n        kendo.spreadsheet.EditCommand = PropertyChangeCommand.extend({\n            init: function (options) {\n                options.property = 'input';\n                PropertyChangeCommand.fn.init.call(this, options);\n            },\n            rejectState: function (validationState) {\n                this.undo();\n                return {\n                    title: validationState.title,\n                    body: validationState.message,\n                    reason: 'error',\n                    type: 'validationError'\n                };\n            },\n            exec: function () {\n                var range = this.range();\n                var value = this._value;\n                this.getState();\n                try {\n                    range.input(value);\n                    var validationState = range._getValidationState();\n                    if (validationState) {\n                        return this.rejectState(validationState);\n                    }\n                } catch (ex1) {\n                    if (ex1 instanceof kendo.spreadsheet.calc.ParseError) {\n                        try {\n                            range.input(value + ')');\n                            var validationState = range._getValidationState();\n                            if (validationState) {\n                                return this.rejectState(validationState);\n                            }\n                        } catch (ex2) {\n                            if (ex2 instanceof kendo.spreadsheet.calc.ParseError) {\n                                range.input('\\'' + value);\n                                return {\n                                    title: 'Error in formula',\n                                    body: ex1 + '',\n                                    reason: 'error'\n                                };\n                            }\n                        }\n                    } else {\n                        throw ex1;\n                    }\n                }\n            }\n        });\n        kendo.spreadsheet.TextWrapCommand = PropertyChangeCommand.extend({\n            init: function (options) {\n                options.property = 'wrap';\n                PropertyChangeCommand.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            getState: function () {\n                var rowHeight = {};\n                this.range().forEachRow(function (range) {\n                    var index = range.topLeft().row;\n                    rowHeight[index] = range.sheet().rowHeight(index);\n                });\n                this._state = this.range().getState(this._property);\n                this._rowHeight = rowHeight;\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                var rowHeight = this._rowHeight;\n                this.range().setState(this._state);\n                for (var row in rowHeight) {\n                    sheet.rowHeight(row, rowHeight[row]);\n                }\n            }\n        });\n        kendo.spreadsheet.AdjustDecimalsCommand = Command.extend({\n            init: function (options) {\n                this._decimals = options.value;\n                options.property = 'format';\n                Command.fn.init.call(this, options);\n            },\n            exec: function () {\n                var sheet = this.range().sheet();\n                var decimals = this._decimals;\n                var formatting = kendo.spreadsheet.formatting;\n                this.getState();\n                sheet.batch(function () {\n                    this.range().forEachCell(function (row, col, cell) {\n                        var format = cell.format;\n                        if (format || decimals > 0) {\n                            format = formatting.adjustDecimals(format || '#', decimals);\n                            sheet.range(row, col).format(format);\n                        }\n                    });\n                }.bind(this));\n            }\n        });\n        kendo.spreadsheet.BorderChangeCommand = Command.extend({\n            init: function (options) {\n                options.property = 'border';\n                Command.fn.init.call(this, options);\n                this._type = options.border;\n                this._style = options.style;\n            },\n            exec: function () {\n                this.getState();\n                this[this._type](this._style);\n            },\n            noBorders: function () {\n                var range = this.range();\n                range.sheet().batch(function () {\n                    range.borderLeft(null).borderTop(null).borderRight(null).borderBottom(null);\n                }.bind(this), {});\n            },\n            allBorders: function (style) {\n                var range = this.range();\n                range.sheet().batch(function () {\n                    range.borderLeft(style).borderTop(style).borderRight(style).borderBottom(style);\n                }.bind(this), {});\n            },\n            leftBorder: function (style) {\n                this.range().leftColumn().borderLeft(style);\n            },\n            rightBorder: function (style) {\n                this.range().rightColumn().borderRight(style);\n            },\n            topBorder: function (style) {\n                this.range().topRow().borderTop(style);\n            },\n            bottomBorder: function (style) {\n                this.range().bottomRow().borderBottom(style);\n            },\n            outsideBorders: function (style) {\n                var range = this.range();\n                range.sheet().batch(function () {\n                    range.leftColumn().borderLeft(style);\n                    range.topRow().borderTop(style);\n                    range.rightColumn().borderRight(style);\n                    range.bottomRow().borderBottom(style);\n                }.bind(this), {});\n            },\n            insideBorders: function (style) {\n                this.range().sheet().batch(function () {\n                    this.allBorders(style);\n                    this.outsideBorders(null);\n                }.bind(this), {});\n            },\n            insideHorizontalBorders: function (style) {\n                var range = this.range();\n                range.sheet().batch(function () {\n                    range.borderBottom(style);\n                    range.bottomRow().borderBottom(null);\n                }.bind(this), {});\n            },\n            insideVerticalBorders: function (style) {\n                var range = this.range();\n                range.sheet().batch(function () {\n                    range.borderRight(style);\n                    range.rightColumn().borderRight(null);\n                }.bind(this), {});\n            }\n        });\n        kendo.spreadsheet.MergeCellCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._type = options.value;\n            },\n            exec: function () {\n                this.getState();\n                this[this._type]();\n            },\n            activate: function (ref) {\n                this.range().sheet().activeCell(ref);\n            },\n            getState: function () {\n                this._state = this.range().getState();\n            },\n            undo: function () {\n                if (this._type !== 'unmerge') {\n                    this.range().unmerge();\n                    this.activate(this.range().topLeft());\n                }\n                this.range().setState(this._state);\n            },\n            cells: function () {\n                var range = this.range();\n                var ref = range._ref;\n                range.merge();\n                this.activate(ref);\n            },\n            horizontally: function () {\n                var ref = this.range().topRow()._ref;\n                this.range().forEachRow(function (range) {\n                    range.merge();\n                });\n                this.activate(ref);\n            },\n            vertically: function () {\n                var ref = this.range().leftColumn()._ref;\n                this.range().forEachColumn(function (range) {\n                    range.merge();\n                });\n                this.activate(ref);\n            },\n            unmerge: function () {\n                var range = this.range();\n                var ref = range._ref.topLeft;\n                range.unmerge();\n                this.activate(ref);\n            }\n        });\n        kendo.spreadsheet.FreezePanesCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._type = options.value;\n            },\n            exec: function () {\n                this.getState();\n                this._topLeft = this.range().topLeft();\n                this[this._type]();\n            },\n            getState: function () {\n                this._state = this.range().sheet().getState();\n            },\n            undo: function () {\n                this.range().sheet().setState(this._state);\n            },\n            panes: function () {\n                var topLeft = this._topLeft;\n                var sheet = this.range().sheet();\n                sheet.frozenColumns(topLeft.col).frozenRows(topLeft.row);\n            },\n            rows: function () {\n                var topLeft = this._topLeft;\n                var sheet = this.range().sheet();\n                sheet.frozenRows(topLeft.row);\n            },\n            columns: function () {\n                var topLeft = this._topLeft;\n                var sheet = this.range().sheet();\n                sheet.frozenColumns(topLeft.col);\n            },\n            unfreeze: function () {\n                var sheet = this.range().sheet();\n                sheet.frozenRows(0).frozenColumns(0);\n            }\n        });\n        kendo.spreadsheet.PasteCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = this._workbook.clipboard();\n            },\n            getState: function () {\n                this._range = this._workbook.activeSheet().range(this._clipboard.pasteRef());\n                this._state = this._range.getState();\n            },\n            exec: function () {\n                var status = this._clipboard.canPaste();\n                this._clipboard.menuInvoked = true;\n                if (!status.canPaste) {\n                    if (status.menuInvoked) {\n                        return { reason: 'useKeyboard' };\n                    }\n                    if (status.pasteOnMerged) {\n                        return { reason: 'modifyMerged' };\n                    }\n                    if (status.overflow) {\n                        return { reason: 'overflow' };\n                    }\n                    return {};\n                }\n                this.getState();\n                this._clipboard.paste();\n                var range = this._workbook.activeSheet().range(this._clipboard.pasteRef());\n                range._adjustRowHeight();\n                return {};\n            }\n        });\n        kendo.spreadsheet.AdjustRowHeightCommand = Command.extend({\n            exec: function () {\n                var options = this.options;\n                var sheet = this._workbook.activeSheet();\n                var range = options.range || sheet.range(options.rowIndex);\n                range._adjustRowHeight();\n            }\n        });\n        kendo.spreadsheet.ToolbarPasteCommand = Command.extend({\n            exec: function () {\n                if (kendo.support.clipboard.paste) {\n                    this._workbook._view.clipboard.focus().select();\n                    document.execCommand('paste');\n                } else {\n                    return { reason: 'useKeyboard' };\n                }\n            }\n        });\n        kendo.spreadsheet.CopyCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n            },\n            undo: $.noop,\n            exec: function () {\n                var status = this._clipboard.canCopy();\n                this._clipboard.menuInvoked = true;\n                if (!status.canCopy) {\n                    if (status.menuInvoked) {\n                        return { reason: 'useKeyboard' };\n                    } else if (status.multiSelection) {\n                        return { reason: 'unsupportedSelection' };\n                    }\n                    return;\n                }\n                this._clipboard.copy();\n            }\n        });\n        kendo.spreadsheet.ToolbarCopyCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n            },\n            undo: $.noop,\n            exec: function () {\n                if (kendo.support.clipboard.copy) {\n                    var clipboard = this._workbook._view.clipboard;\n                    var textarea = document.createElement('textarea');\n                    $(textarea).addClass('k-spreadsheet-clipboard').val(clipboard.html()).appendTo(document.body).focus().select();\n                    document.execCommand('copy');\n                    clipboard.trigger('copy');\n                    $(textarea).remove();\n                } else {\n                    return { reason: 'useKeyboard' };\n                }\n            }\n        });\n        kendo.spreadsheet.CutCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n            },\n            exec: function () {\n                if (this._clipboard.canCopy()) {\n                    this.getState();\n                    this._clipboard.cut();\n                }\n            }\n        });\n        kendo.spreadsheet.AutoFillCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n            },\n            origin: function (origin) {\n                this._origin = origin;\n            },\n            exec: function () {\n                this.getState();\n                this.range().fillFrom(this._origin);\n            }\n        });\n        kendo.spreadsheet.ToolbarCutCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n            },\n            exec: function () {\n                if (kendo.support.clipboard.copy) {\n                    var clipboard = this._workbook._view.clipboard;\n                    var textarea = document.createElement('textarea');\n                    $(textarea).val(clipboard.html()).appendTo(document.body).focus().select();\n                    document.execCommand('copy');\n                    clipboard.trigger('cut');\n                    $(textarea).remove();\n                } else {\n                    return { reason: 'useKeyboard' };\n                }\n            }\n        });\n        kendo.spreadsheet.FilterCommand = Command.extend({\n            undo: function () {\n                this.range().filter(this._state);\n            },\n            exec: function () {\n                var range = this.range();\n                this._state = range.hasFilter();\n                if (range.hasFilter()) {\n                    range.filter(false);\n                } else if (!range.intersectingMerged().length) {\n                    range.filter(true);\n                } else {\n                    return {\n                        reason: 'error',\n                        type: 'filterRangeContainingMerges'\n                    };\n                }\n            }\n        });\n        kendo.spreadsheet.SortCommand = Command.extend({\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.setState(this._state);\n            },\n            exec: function () {\n                var range = this.range();\n                var sheet = range.sheet();\n                var activeCell = sheet.activeCell();\n                var col = this.options.sheet ? activeCell.topLeft.col : this.options.column || 0;\n                var ascending = this.options.value === 'asc' ? true : false;\n                this._state = sheet.getState();\n                if (this.options.sheet) {\n                    range = this.expandRange();\n                }\n                if (!range.intersectingMerged().length) {\n                    range.sort({\n                        column: col,\n                        ascending: ascending\n                    });\n                } else {\n                    return {\n                        reason: 'error',\n                        type: 'sortRangeContainingMerges'\n                    };\n                }\n            },\n            expandRange: function () {\n                var sheet = this.range().sheet();\n                return new kendo.spreadsheet.Range(sheet._sheetRef, sheet);\n            }\n        });\n        var ApplyFilterCommand = kendo.spreadsheet.ApplyFilterCommand = Command.extend({\n            column: function () {\n                return this.options.column || 0;\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.clearFilter(this.column());\n                if (this._state.length) {\n                    this.range().filter(this._state);\n                }\n            },\n            getState: function () {\n                var sheet = this.range().sheet();\n                var current = sheet.filter();\n                if (current) {\n                    this._state = current.columns.filter(function (c) {\n                        return c.index == this.column();\n                    }.bind(this));\n                }\n            },\n            exec: function () {\n                var range = this.range();\n                var column = this.column();\n                var current = range.sheet().filter();\n                var options;\n                var filterRule;\n                var exists = false;\n                if (this.options.valueFilter) {\n                    filterRule = {\n                        column: column,\n                        filter: new kendo.spreadsheet.ValueFilter(this.options.valueFilter)\n                    };\n                } else if (this.options.customFilter) {\n                    filterRule = {\n                        column: column,\n                        filter: new kendo.spreadsheet.CustomFilter(this.options.customFilter)\n                    };\n                }\n                this.getState();\n                if (current && current.ref.eq(range._ref) && current.columns.length) {\n                    current.columns.forEach(function (element) {\n                        if (element.index === column) {\n                            exists = true;\n                        }\n                    });\n                    options = current.columns.map(function (element) {\n                        return element.index === column ? filterRule : {\n                            column: element.index,\n                            filter: element.filter\n                        };\n                    });\n                    if (!exists) {\n                        options.push(filterRule);\n                    }\n                } else {\n                    options = filterRule;\n                }\n                range.filter(options);\n            }\n        });\n        kendo.spreadsheet.ClearFilterCommand = ApplyFilterCommand.extend({\n            exec: function () {\n                var range = this.range();\n                var column = this.column();\n                this.getState();\n                range.clearFilter(column);\n            }\n        });\n        kendo.spreadsheet.HideLineCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this.axis = options.axis;\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.setAxisState(this._state);\n            },\n            exec: function () {\n                var sheet = this.range().sheet();\n                this._state = sheet.getAxisState();\n                if (this.axis == 'row') {\n                    sheet.axisManager().hideSelectedRows();\n                } else {\n                    sheet.axisManager().hideSelectedColumns();\n                }\n            }\n        });\n        kendo.spreadsheet.UnHideLineCommand = kendo.spreadsheet.HideLineCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                this._state = sheet.getAxisState();\n                if (this.axis == 'row') {\n                    sheet.axisManager().unhideSelectedRows();\n                } else {\n                    sheet.axisManager().unhideSelectedColumns();\n                }\n            }\n        });\n        var DeleteCommand = kendo.spreadsheet.DeleteCommand = Command.extend({\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.setState(this._state);\n            }\n        });\n        kendo.spreadsheet.DeleteRowCommand = DeleteCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                this._state = sheet.getState();\n                sheet.axisManager().deleteSelectedRows();\n            }\n        });\n        kendo.spreadsheet.DeleteColumnCommand = DeleteCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                this._state = sheet.getState();\n                sheet.axisManager().deleteSelectedColumns();\n            }\n        });\n        var AddCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.setState(this._state);\n            }\n        });\n        kendo.spreadsheet.AddColumnCommand = AddCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                this._state = sheet.getState();\n                if (this._value === 'left') {\n                    sheet.axisManager().addColumnLeft();\n                } else {\n                    sheet.axisManager().addColumnRight();\n                }\n            }\n        });\n        kendo.spreadsheet.AddRowCommand = AddCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                if (!sheet.axisManager().canAddRow()) {\n                    return {\n                        reason: 'error',\n                        type: 'shiftingNonblankCells'\n                    };\n                }\n                this._state = sheet.getState();\n                if (this._value === 'above') {\n                    sheet.axisManager().addRowAbove();\n                } else {\n                    sheet.axisManager().addRowBelow();\n                }\n            }\n        });\n        kendo.spreadsheet.EditValidationCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            exec: function () {\n                this.range().validation(this._value);\n            }\n        });\n        kendo.spreadsheet.OpenCommand = Command.extend({\n            exec: function () {\n                var file = this.options.file;\n                if (file.name.match(/.xlsx$/i) === null) {\n                    return {\n                        reason: 'error',\n                        type: 'openUnsupported'\n                    };\n                }\n                this.options.workbook.fromFile(this.options.file);\n            }\n        });\n        kendo.spreadsheet.SaveAsCommand = Command.extend({\n            exec: function () {\n                var fileName = this.options.name + this.options.extension;\n                if (this.options.extension === '.xlsx') {\n                    this.options.workbook.saveAsExcel({ fileName: fileName });\n                } else if (this.options.extension === '.pdf') {\n                    this.options.workbook.saveAsPDF($.extend(this.options.pdf, {\n                        workbook: this.options.workbook,\n                        fileName: fileName\n                    }));\n                }\n            }\n        });\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/formulabar', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var classNames = { wrapper: 'k-spreadsheet-formula-bar' };\n        var FormulaBar = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                kendo.ui.Widget.call(this, element, options);\n                element = this.element.addClass(FormulaBar.classNames.wrapper);\n                this.formulaInput = new kendo.spreadsheet.FormulaInput($('<div/>').appendTo(element));\n            },\n            destroy: function () {\n                if (this.formulaInput) {\n                    this.formulaInput.destroy();\n                }\n                this.formulaInput = null;\n            }\n        });\n        kendo.spreadsheet.FormulaBar = FormulaBar;\n        $.extend(true, FormulaBar, { classNames: classNames });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/formulainput', ['kendo.core'], f);\n}(function () {\n    (function (kendo, window) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Widget = kendo.ui.Widget;\n        var ns = '.kendoFormulaInput';\n        var keys = kendo.keys;\n        var classNames = {\n            wrapper: 'k-spreadsheet-formula-input',\n            listWrapper: 'k-spreadsheet-formula-list'\n        };\n        var styles = [\n            'font-family',\n            'font-size',\n            'font-stretch',\n            'font-style',\n            'font-weight',\n            'letter-spacing',\n            'text-transform',\n            'line-height'\n        ];\n        var KEY_NAMES = {\n            27: 'esc',\n            37: 'left',\n            39: 'right',\n            35: 'end',\n            36: 'home',\n            32: 'spacebar'\n        };\n        var PRIVATE_FORMULA_CHECK = /(^_|[^a-z0-9]$)/i;\n        var FormulaInput = Widget.extend({\n            init: function (element, options) {\n                Widget.call(this, element, options);\n                element = this.element;\n                element.addClass(FormulaInput.classNames.wrapper).attr('contenteditable', true).attr('spellcheck', false);\n                if (this.options.autoScale) {\n                    element.on('input', this.scale.bind(this));\n                }\n                this._highlightedRefs = [];\n                this._staticTokens = [];\n                this._formulaSource();\n                this._formulaList();\n                this._popup();\n                this._tooltip();\n                element.on('keydown', this._keydown.bind(this)).on('keyup', this._keyup.bind(this)).on('blur', this._blur.bind(this)).on('input click', this._input.bind(this)).on('focus', this._focus.bind(this));\n            },\n            options: {\n                name: 'FormulaInput',\n                autoScale: false,\n                filterOperator: 'startswith',\n                scalePadding: 30,\n                minLength: 1\n            },\n            events: [\n                'keyup',\n                'focus'\n            ],\n            enable: function (enable) {\n                if (enable === undefined) {\n                    return this.element.attr('contenteditable') === 'false' ? false : true;\n                }\n                this.element.attr('contenteditable', enable).toggleClass('k-state-disabled', !enable);\n            },\n            getPos: function () {\n                var div = this.element[0];\n                var sel = window.getSelection();\n                var a = lookup(sel.focusNode, sel.focusOffset);\n                var b = lookup(sel.anchorNode, sel.anchorOffset);\n                if (a != null && b != null) {\n                    if (a > b) {\n                        var tmp = a;\n                        a = b;\n                        b = tmp;\n                    }\n                    return {\n                        begin: a,\n                        end: b,\n                        collapsed: a == b\n                    };\n                }\n                function lookup(lookupNode, pos) {\n                    try {\n                        (function loop(node) {\n                            if (node === lookupNode) {\n                                throw pos;\n                            } else if (node.nodeType == 1) {\n                                for (var i = node.firstChild; i; i = i.nextSibling) {\n                                    loop(i);\n                                }\n                            } else if (node.nodeType == 3) {\n                                pos += node.nodeValue.length;\n                            }\n                        }(div));\n                    } catch (index) {\n                        return index;\n                    }\n                }\n            },\n            setPos: function (begin, end) {\n                var eiv = this.element[0];\n                begin = lookup(eiv, begin);\n                if (end != null) {\n                    end = lookup(eiv, end);\n                } else {\n                    end = begin;\n                }\n                if (begin && end) {\n                    var range = document.createRange();\n                    range.setStart(begin.node, begin.pos);\n                    range.setEnd(end.node, end.pos);\n                    var sel = window.getSelection();\n                    var currentRange = sel.getRangeAt(0);\n                    if (differ(range, currentRange)) {\n                        sel.removeAllRanges();\n                        sel.addRange(range);\n                    }\n                }\n                function differ(a, b) {\n                    return a.startOffset != b.startOffset || a.endOffset != b.endOffset || a.startContainer != b.endContainer || a.endContainer != b.endContainer;\n                }\n                function lookup(node, pos) {\n                    try {\n                        (function loop(node) {\n                            if (node.nodeType == 3) {\n                                var len = node.nodeValue.length;\n                                if (len >= pos) {\n                                    throw node;\n                                }\n                                pos -= len;\n                            } else if (node.nodeType == 1) {\n                                for (var i = node.firstChild; i; i = i.nextSibling) {\n                                    loop(i);\n                                }\n                            }\n                        }(node));\n                    } catch (el) {\n                        return {\n                            node: el,\n                            pos: pos\n                        };\n                    }\n                }\n            },\n            end: function () {\n                this.setPos(this.length());\n            },\n            home: function () {\n                this.setPos(0);\n            },\n            length: function () {\n                return this.value().length;\n            },\n            _formulaSource: function () {\n                var result = [];\n                var value;\n                for (var key in kendo.spreadsheet.calc.runtime.FUNCS) {\n                    if (!PRIVATE_FORMULA_CHECK.test(key)) {\n                        value = key.toUpperCase();\n                        result.push({\n                            value: value,\n                            text: value\n                        });\n                    }\n                }\n                this.formulaSource = new kendo.data.DataSource({ data: result });\n            },\n            _formulaList: function () {\n                this.list = new kendo.ui.StaticList($('<ul />').addClass(FormulaInput.classNames.listWrapper).insertAfter(this.element), {\n                    autoBind: false,\n                    selectable: true,\n                    change: this._formulaListChange.bind(this),\n                    dataSource: this.formulaSource,\n                    dataValueField: 'value',\n                    template: '#:data.value#'\n                });\n                this.list.element.on('mousedown', function (e) {\n                    e.preventDefault();\n                });\n            },\n            _formulaListChange: function () {\n                var tokenCtx = this._tokenContext();\n                if (!tokenCtx || this._mute) {\n                    return;\n                }\n                var activeToken = tokenCtx.token;\n                var completion = this.list.value()[0];\n                var ctx = {\n                    replace: true,\n                    token: activeToken,\n                    end: activeToken.end\n                };\n                if (!tokenCtx.nextToken || tokenCtx.nextToken.value != '(') {\n                    completion += '(';\n                }\n                this._replaceAt(ctx, completion);\n                this.popup.close();\n            },\n            _popup: function () {\n                this.popup = new kendo.ui.Popup(this.list.element, { anchor: this.element });\n            },\n            _blur: function () {\n                this.popup.close();\n                clearTimeout(this._focusId);\n            },\n            _isFormula: function () {\n                return /^=/.test(this.value());\n            },\n            _keydown: function (e) {\n                var key = e.keyCode;\n                if (KEY_NAMES[key]) {\n                    this.popup.close();\n                    this._navigated = true;\n                } else if (this._move(key)) {\n                    this._navigated = true;\n                    e.preventDefault();\n                }\n                this._keyDownTimeout = setTimeout(this._syntaxHighlight.bind(this));\n            },\n            _keyup: function () {\n                var popup = this.popup;\n                var value;\n                if (this._isFormula() && !this._navigated) {\n                    value = ((this._tokenContext() || {}).token || {}).value;\n                    this.filter(value);\n                    if (!value || !this.formulaSource.view().length) {\n                        popup.close();\n                    } else {\n                        popup[popup.visible() ? 'position' : 'open']();\n                        this.list.focusFirst();\n                    }\n                }\n                this._navigated = false;\n                this._syntaxHighlight();\n                this.trigger('keyup');\n            },\n            _input: function () {\n                this._syntaxHighlight();\n            },\n            _focus: function () {\n                this._focusTimeout = setTimeout(this._syntaxHighlight.bind(this));\n                this.trigger('focus');\n            },\n            _move: function (key) {\n                var list = this.list;\n                var pressed = false;\n                var popup = this.popup;\n                if (key === keys.DOWN) {\n                    list.focusNext();\n                    if (!list.focus()) {\n                        list.focusFirst();\n                    }\n                    pressed = true;\n                } else if (key === keys.UP) {\n                    list.focusPrev();\n                    if (!list.focus()) {\n                        list.focusLast();\n                    }\n                    pressed = true;\n                } else if (key === keys.ENTER) {\n                    if (popup.visible()) {\n                        list.select(list.focus());\n                    }\n                    popup.close();\n                    pressed = true;\n                } else if (key === keys.TAB) {\n                    list.select(list.focus());\n                    popup.close();\n                    pressed = true;\n                } else if (key === keys.PAGEUP) {\n                    list.focusFirst();\n                    pressed = true;\n                } else if (key === keys.PAGEDOWN) {\n                    list.focusLast();\n                    pressed = true;\n                }\n                return pressed;\n            },\n            _tokenContext: function () {\n                var point = this.getPos();\n                var value = this.value();\n                if (!value || !point || !point.collapsed) {\n                    return null;\n                }\n                var tokens = kendo.spreadsheet.calc.tokenize(value, this.row(), this.col());\n                var tok;\n                for (var i = 0; i < tokens.length; ++i) {\n                    tok = tokens[i];\n                    if (touches(tok, point) && /^(?:str|sym|func)$/.test(tok.type)) {\n                        return {\n                            token: tok,\n                            nextToken: tokens[i + 1]\n                        };\n                    }\n                }\n                return null;\n            },\n            _sync: function () {\n                if (this._editorToSync && this.isActive()) {\n                    this._editorToSync.value(this.value());\n                }\n            },\n            _textContainer: function () {\n                var computedStyles = kendo.getComputedStyles(this.element[0], styles);\n                computedStyles.position = 'absolute';\n                computedStyles.visibility = 'hidden';\n                computedStyles.whiteSpace = 'pre';\n                computedStyles.top = -3333;\n                computedStyles.left = -3333;\n                this._span = $('<span/>').css(computedStyles).insertAfter(this.element);\n            },\n            _tooltip: function () {\n                this._cellTooltip = $('<div class=\"k-widget k-tooltip\" style=\"position:absolute; display:none\">A1</div>').insertAfter(this.element);\n            },\n            tooltip: function (value) {\n                this._cellTooltip.text(value);\n            },\n            toggleTooltip: function (show) {\n                this._cellTooltip.toggle(show);\n            },\n            isActive: function () {\n                return this.element[0] === kendo._activeElement();\n            },\n            filter: function (value) {\n                if (!value || value.length < this.options.minLength) {\n                    return;\n                }\n                this._mute = true;\n                this.list.select(-1);\n                this._mute = false;\n                this.formulaSource.filter({\n                    field: this.list.options.dataValueField,\n                    operator: this.options.filterOperator,\n                    value: value\n                });\n            },\n            hide: function () {\n                this.element.hide();\n                this._cellTooltip.hide();\n            },\n            show: function () {\n                this.element.show();\n            },\n            row: function () {\n                if (this.activeCell) {\n                    return this.activeCell.row;\n                }\n            },\n            col: function () {\n                if (this.activeCell) {\n                    return this.activeCell.col;\n                }\n            },\n            position: function (rectangle) {\n                if (!rectangle) {\n                    return;\n                }\n                this.element.show().css({\n                    'top': rectangle.top + 1 + 'px',\n                    'left': rectangle.left + 1 + 'px'\n                });\n                this._cellTooltip.css({\n                    'top': rectangle.top - this._cellTooltip.height() - 10 + 'px',\n                    'left': rectangle.left\n                });\n            },\n            resize: function (rectangle) {\n                if (!rectangle) {\n                    return;\n                }\n                this.element.css({\n                    width: rectangle.width - 1,\n                    height: rectangle.height - 1\n                });\n            },\n            canInsertRef: function (isKeyboardAction) {\n                var result = this._canInsertRef(isKeyboardAction);\n                var token = result && result.token;\n                var idx;\n                if (token) {\n                    for (idx = 0; idx < this._staticTokens.length; idx++) {\n                        if (isEqualToken(token, this._staticTokens[idx])) {\n                            return null;\n                        }\n                    }\n                }\n                return result;\n            },\n            _canInsertRef: function (isKeyboardAction) {\n                if (this.popup.visible()) {\n                    return null;\n                }\n                var strictMode = isKeyboardAction;\n                var point = this.getPos();\n                var tokens, tok;\n                if (point && this._isFormula()) {\n                    if (point.begin === 0) {\n                        return null;\n                    }\n                    tokens = kendo.spreadsheet.calc.tokenize(this.value(), this.row(), this.col());\n                    for (var i = 0; i < tokens.length; ++i) {\n                        tok = tokens[i];\n                        if (touches(tok, point)) {\n                            return canReplace(tok);\n                        }\n                        if (afterPoint(tok)) {\n                            return canInsertBetween(tokens[i - 1], tok);\n                        }\n                    }\n                    return canInsertBetween(tok, null);\n                }\n                return null;\n                function afterPoint(tok) {\n                    return tok.begin > point.begin;\n                }\n                function canReplace(tok) {\n                    if (tok) {\n                        if (/^(?:num|str|bool|sym|ref)$/.test(tok.type)) {\n                            return {\n                                replace: true,\n                                token: tok,\n                                end: tok.end\n                            };\n                        }\n                        if (/^(?:op|punc|startexp)$/.test(tok.type)) {\n                            if (tok.end == point.end) {\n                                return canInsertBetween(tok, tokens[i + 1]);\n                            }\n                            return canInsertBetween(tokens[i - 1], tok);\n                        }\n                    }\n                }\n                function canInsertBetween(left, right) {\n                    if (left == null) {\n                        return null;\n                    }\n                    if (right == null) {\n                        if (/^(?:op|startexp)$/.test(left.type) || isOpenParen(left.value)) {\n                            return {\n                                token: left,\n                                end: point.end\n                            };\n                        }\n                        return null;\n                    }\n                    if (strictMode) {\n                        if (left.type == 'op' && /^(?:punc|op)$/.test(right.type)) {\n                            return {\n                                token: left,\n                                end: point.end\n                            };\n                        }\n                    } else {\n                        if (left.type == 'startexp') {\n                            return {\n                                token: left,\n                                end: point.end\n                            };\n                        }\n                        if (/^(?:ref|op|punc)$/.test(left.type)) {\n                            return {\n                                token: left,\n                                end: point.end\n                            };\n                        }\n                        if (/^(?:punc|op)$/.test(left.type)) {\n                            return /^[,;({]$/.test(left.value) ? {\n                                token: left,\n                                end: point.end\n                            } : null;\n                        }\n                    }\n                    return false;\n                }\n            },\n            refAtPoint: function (ref) {\n                var x = this._canInsertRef();\n                if (x) {\n                    this._replaceAt(x, ref.simplify().toString());\n                }\n            },\n            _replaceAt: function (ctx, newValue) {\n                var value = this.value();\n                var tok = ctx.token;\n                var rest = value.substr(ctx.end);\n                value = value.substr(0, ctx.replace ? tok.begin : ctx.end) + newValue;\n                var point = value.length;\n                value += rest;\n                this._value(value);\n                this.setPos(point);\n                this.scale();\n                this._syntaxHighlight();\n                this._sync();\n            },\n            syncWith: function (formulaInput) {\n                var self = this;\n                var eventName = 'input' + ns;\n                var handler = self._sync.bind(self), iehandler;\n                if (kendo.support.browser.msie) {\n                    eventName = 'keydown' + ns;\n                    iehandler = function () {\n                        setTimeout(handler);\n                    };\n                }\n                self._editorToSync = formulaInput;\n                self.element.off(eventName).on(eventName, iehandler || handler);\n            },\n            scale: function () {\n                var element = this.element;\n                var width;\n                if (!this._span) {\n                    this._textContainer();\n                }\n                this._span.html(element.html());\n                width = this._span.width() + this.options.scalePadding;\n                if (width > element.width()) {\n                    element.width(width);\n                }\n            },\n            _value: function (value) {\n                this.element.text(value);\n            },\n            value: function (value) {\n                if (value === undefined) {\n                    return this.element.text();\n                }\n                this._value(value);\n                this._syntaxHighlight();\n            },\n            highlightedRefs: function () {\n                return this._highlightedRefs.slice();\n            },\n            _syntaxHighlight: function () {\n                var pos = this.getPos();\n                var value = this.value();\n                var refClasses = kendo.spreadsheet.Pane.classNames.series;\n                var highlightedRefs = [];\n                var refIndex = 0;\n                var parens = [];\n                var tokens = [];\n                var activeToken;\n                if (pos && !pos.collapsed) {\n                    return;\n                }\n                if (!/^=/.test(value)) {\n                    if (this.element.html() != value) {\n                        this.element.text(value);\n                    }\n                    if (this.popup) {\n                        this.popup.close();\n                    }\n                } else {\n                    tokens = kendo.spreadsheet.calc.tokenize(value, this.row(), this.col());\n                    tokens.forEach(function (tok) {\n                        tok.active = false;\n                        tok.cls = ['k-syntax-' + tok.type];\n                        if (tok.type == 'ref') {\n                            tok.colorClass = refClasses[refIndex++ % refClasses.length];\n                            tok.cls.push(tok.colorClass);\n                            highlightedRefs.push(tok);\n                        }\n                        if (pos && tok.type == 'punc') {\n                            if (isOpenParen(tok.value)) {\n                                parens.unshift(tok);\n                            } else if (isCloseParen(tok.value)) {\n                                var open = parens.shift();\n                                if (open) {\n                                    if (isMatchingParen(tok.value, open.value)) {\n                                        if (touches(tok, pos) || touches(open, pos)) {\n                                            tok.cls.push('k-syntax-paren-match');\n                                            open.cls.push('k-syntax-paren-match');\n                                        }\n                                    } else {\n                                        tok.cls.push('k-syntax-error');\n                                        open.cls.push('k-syntax-error');\n                                    }\n                                } else {\n                                    tok.cls.push('k-syntax-error');\n                                }\n                            }\n                        }\n                        if (pos && touches(tok, pos)) {\n                            tok.cls.push('k-syntax-at-point');\n                            tok.active = true;\n                            activeToken = tok;\n                        }\n                        if (tok.type == 'func' && !knownFunction(tok.value) && (!pos || !touches(tok, pos))) {\n                            tok.cls.push('k-syntax-error');\n                        }\n                    });\n                    tokens.reverse().forEach(function (tok) {\n                        var begin = tok.begin, end = tok.end;\n                        var text = kendo.htmlEncode(value.substring(begin, end));\n                        value = value.substr(0, begin) + '<span class=\\'' + tok.cls.join(' ') + '\\'>' + text + '</span>' + value.substr(end);\n                    });\n                    this.element.html(value);\n                }\n                if (pos) {\n                    this.setPos(pos.begin, pos.end);\n                }\n                if (activeToken && /^(?:startexp|op|punc)$/.test(activeToken.type)) {\n                    this._setStaticTokens(tokens);\n                }\n                this._highlightedRefs = highlightedRefs;\n            },\n            _setStaticTokens: function (tokens) {\n                var idx, tok;\n                this._staticTokens = [];\n                for (idx = 0; idx < tokens.length; idx++) {\n                    tok = tokens[idx];\n                    if (/^(?:num|str|bool|sym|ref)$/.test(tok.type)) {\n                        this._staticTokens.push(tok);\n                    }\n                }\n            },\n            destroy: function () {\n                this._editorToSync = null;\n                this.element.off(ns);\n                clearTimeout(this._focusTimeout);\n                clearTimeout(this._keyDownTimeout);\n                this._cellTooltip = null;\n                this._span = null;\n                this.popup.destroy();\n                this.popup = null;\n                Widget.fn.destroy.call(this);\n            }\n        });\n        function isOpenParen(ch) {\n            return ch == '(' || ch == '[' || ch == '{';\n        }\n        function isCloseParen(ch) {\n            return ch == ')' || ch == ']' || ch == '}';\n        }\n        function isMatchingParen(close, open) {\n            return open == '(' ? close == ')' : open == '[' ? close == ']' : open == '{' ? close == '}' : false;\n        }\n        function touches(pos, target) {\n            return pos.begin <= target.begin && pos.end >= target.end;\n        }\n        function knownFunction(name) {\n            return kendo.spreadsheet.calc.runtime.FUNCS[name.toLowerCase()];\n        }\n        function isEqualToken(tok1, tok2) {\n            if (!tok1 || !tok2) {\n                return false;\n            }\n            if (tok1.type == 'ref' && tok2.type == 'ref') {\n                return tok1.ref.eq(tok2.ref);\n            } else {\n                return tok1.value === tok2.value;\n            }\n        }\n        kendo.spreadsheet.FormulaInput = FormulaInput;\n        $.extend(true, FormulaInput, { classNames: classNames });\n    }(kendo, window));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/eventlistener', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var KEY_NAMES = {\n            8: 'backspace',\n            9: 'tab',\n            13: 'enter',\n            27: 'esc',\n            37: 'left',\n            38: 'up',\n            39: 'right',\n            40: 'down',\n            35: 'end',\n            36: 'home',\n            32: 'spacebar',\n            33: 'pageup',\n            34: 'pagedown',\n            46: 'delete',\n            113: ':edit'\n        };\n        var Mac = navigator.platform.toUpperCase().indexOf('MAC') >= 0;\n        var isAlphaNum = function (keyCode) {\n            if (keyCode > 47 && keyCode < 58 || keyCode > 64 && keyCode < 91 || keyCode > 95 && keyCode < 112 || keyCode > 185 && keyCode < 193 || keyCode > 218 && keyCode < 223) {\n                return true;\n            }\n            return false;\n        };\n        var keyName = function (keyCode) {\n            var name = KEY_NAMES[keyCode];\n            if (!name && isAlphaNum(keyCode)) {\n                name = ':alphanum';\n            }\n            return name;\n        };\n        var EventListener = kendo.Class.extend({\n            init: function (target, observer, handlers) {\n                this._handlers = {};\n                this.target = target;\n                this._observer = observer || window;\n                this.keyDownProxy = this.keyDown.bind(this);\n                this.mouseProxy = this.mouse.bind(this);\n                this.threshold = 5;\n                this._pressLocation = null;\n                target.on('keydown', this.keyDownProxy);\n                target.on('contextmenu mousedown cut copy paste scroll wheel click dblclick focus', this.mouseProxy);\n                $(document.documentElement).on('mousemove mouseup', this.mouseProxy);\n                if (handlers) {\n                    for (var key in handlers) {\n                        this.on(key, handlers[key]);\n                    }\n                }\n            },\n            keyDown: function (e) {\n                this.handleEvent(e, keyName(e.keyCode));\n            },\n            mouse: function (e) {\n                var rightClick;\n                if (e.which) {\n                    rightClick = e.which == 3;\n                } else if (e.button) {\n                    rightClick = e.button == 2;\n                }\n                var type = e.type;\n                if (type === 'mousedown') {\n                    if (rightClick) {\n                        type = 'rightmousedown';\n                    } else {\n                        this._pressLocation = {\n                            x: e.pageX,\n                            y: e.pageY\n                        };\n                    }\n                }\n                if (type === 'mouseup') {\n                    if (!rightClick) {\n                        this._pressLocation = null;\n                    }\n                }\n                if (type === 'mousemove' && this._pressLocation) {\n                    var dx = this._pressLocation.x - e.pageX;\n                    var dy = this._pressLocation.y - e.pageY;\n                    var distance = Math.sqrt(dx * dx + dy * dy);\n                    if (distance > this.threshold) {\n                        type = 'mousedrag';\n                    }\n                }\n                this.handleEvent(e, type);\n            },\n            handleEvent: function (e, name) {\n                var eventKey = '';\n                e.mod = Mac ? e.metaKey : e.ctrlKey;\n                if (e.shiftKey) {\n                    eventKey += 'shift+';\n                }\n                if (e.ctrlKey) {\n                    eventKey += 'ctrl+';\n                }\n                eventKey += name;\n                var catchAllHandler = this._handlers['*+' + name];\n                if (catchAllHandler) {\n                    catchAllHandler.call(this._observer, e, eventKey);\n                }\n                var handler = this._handlers[eventKey];\n                if (handler) {\n                    handler.call(this._observer, e, eventKey);\n                }\n            },\n            on: function (event, callback) {\n                var handlers = this._handlers;\n                if (typeof callback === 'string') {\n                    callback = this._observer[callback];\n                }\n                if (typeof event === 'string') {\n                    event = event.split(',');\n                }\n                event.forEach(function (e) {\n                    handlers[e] = callback;\n                });\n            },\n            destroy: function () {\n                this.target.off('keydown', this.keyDownProxy);\n                this.target.off('keydown', this.mouseProxy);\n                $(document.documentElement).off('mousemove mouseup', this.mouseProxy);\n            }\n        });\n        kendo.spreadsheet.EventListener = EventListener;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/rangelist', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var RangeTreeNode = kendo.Class.extend({\n            init: function Node(level, value, left, right) {\n                this.level = level;\n                this.value = value;\n                this.left = left;\n                this.right = right;\n            }\n        });\n        var NilNode = new function NIL() {\n            this.left = this;\n            this.right = this;\n            this.level = 0;\n        }();\n        function passThrough(value) {\n            return value;\n        }\n        function skew(node) {\n            if (node.left.level === node.level) {\n                var temp = node;\n                node = node.left;\n                temp.left = node.right;\n                node.right = temp;\n            }\n            return node;\n        }\n        function split(node) {\n            if (node.right.right.level === node.level) {\n                var temp = node;\n                node = node.right;\n                temp.right = node.left;\n                node.left = temp;\n                node.level += 1;\n            }\n            return node;\n        }\n        function insert(node, value) {\n            if (node === NilNode) {\n                return new RangeTreeNode(1, value, NilNode, NilNode);\n            } else if (node.value.start - value.start > 0) {\n                node.left = insert(node.left, value);\n            } else {\n                node.right = insert(node.right, value);\n            }\n            return split(skew(node));\n        }\n        function remove(node, value) {\n            if (node === NilNode) {\n                return node;\n            }\n            var diff = node.value.start - value.start;\n            if (diff === 0) {\n                if (node.left !== NilNode && node.right !== NilNode) {\n                    var heir = node.left;\n                    while (heir.right !== NilNode) {\n                        heir = heir.right;\n                    }\n                    node.value = heir.value;\n                    node.left = remove(node.left, node.value);\n                } else if (node.left === NilNode) {\n                    node = node.right;\n                } else {\n                    node = node.left;\n                }\n            } else if (diff > 0) {\n                node.left = remove(node.left, value);\n            } else {\n                node.right = remove(node.right, value);\n            }\n            if (node.left.level < node.level - 1 || node.right.level < node.level - 1) {\n                node.level -= 1;\n                if (node.right.level > node.level) {\n                    node.right.level = node.level;\n                }\n                node = skew(node);\n                node.right = skew(node.right);\n                node.right.right = skew(node.right.right);\n                node = split(node);\n                node.right = split(node.right);\n            }\n            return node;\n        }\n        var Range = kendo.Class.extend({\n            init: function Value(start, end, value) {\n                this.start = start;\n                this.end = end;\n                this.value = value;\n            },\n            intersects: function (range) {\n                return range.start <= this.end && range.end >= this.start;\n            }\n        });\n        var RangeTree = kendo.Class.extend({\n            init: function () {\n                this.root = NilNode;\n            },\n            insert: function (value) {\n                this.root = insert(this.root, value);\n            },\n            remove: function (value) {\n                this.root = remove(this.root, value);\n            },\n            findrange: function (value) {\n                var node = this.root;\n                while (node != NilNode) {\n                    if (value < node.value.start) {\n                        node = node.left;\n                    } else if (value > node.value.end) {\n                        node = node.right;\n                    } else {\n                        return node.value;\n                    }\n                }\n                return null;\n            },\n            values: function () {\n                var result = [];\n                values(this.root, result);\n                return result;\n            },\n            intersecting: function (start, end) {\n                var ranges = [];\n                intersecting(this.root, new Range(start, end), ranges);\n                return ranges;\n            },\n            map: function (callback) {\n                var tree = new RangeTree();\n                map(tree, this.root, callback);\n                return tree;\n            },\n            clone: function () {\n                return this.map(passThrough);\n            },\n            first: function () {\n                var first = this.root;\n                while (first.left != NilNode) {\n                    first = first.left;\n                }\n                return first;\n            },\n            last: function () {\n                var last = this.root;\n                while (last.right != NilNode) {\n                    last = last.right;\n                }\n                return last;\n            }\n        });\n        function values(node, result) {\n            if (node === NilNode) {\n                return;\n            }\n            values(node.left, result);\n            result.push(node.value);\n            values(node.right, result);\n        }\n        function intersecting(node, range, ranges) {\n            if (node === NilNode) {\n                return;\n            }\n            var value = node.value;\n            if (range.start < value.start) {\n                intersecting(node.left, range, ranges);\n            }\n            if (value.intersects(range)) {\n                ranges.push(value);\n            }\n            if (range.end > value.end) {\n                intersecting(node.right, range, ranges);\n            }\n        }\n        function map(tree, root, callback) {\n            if (root === NilNode) {\n                return;\n            }\n            map(tree, root.left, callback);\n            tree.insert(callback(root.value));\n            map(tree, root.right, callback);\n        }\n        var RangeList = kendo.Class.extend({\n            init: function (start, end, value) {\n                if (end === undefined) {\n                    this.tree = start;\n                } else {\n                    this.tree = new RangeTree();\n                    this.tree.insert(new Range(start, end, value));\n                }\n            },\n            values: function () {\n                return this.tree.values();\n            },\n            map: function (callback) {\n                return new RangeList(this.tree.map(callback));\n            },\n            intersecting: function (start, end) {\n                return this.tree.intersecting(start, end);\n            },\n            first: function () {\n                return this.tree.first().value;\n            },\n            last: function () {\n                return this.tree.last().value;\n            },\n            insert: function (start, end, value) {\n                return this.tree.insert(new Range(start, end, value));\n            },\n            value: function (start, end, value) {\n                if (value === undefined) {\n                    if (end === undefined) {\n                        end = start;\n                    }\n                    return this.intersecting(start, end)[0].value;\n                }\n                var ranges = this.tree.intersecting(start - 1, end + 1);\n                if (ranges.length) {\n                    var firstRange = ranges[0], lastRange = ranges[ranges.length - 1];\n                    if (firstRange.end < start) {\n                        if (firstRange.value === value) {\n                            start = firstRange.start;\n                        } else {\n                            ranges.shift();\n                        }\n                    }\n                    if (lastRange.start > end) {\n                        if (lastRange.value === value) {\n                            end = lastRange.end;\n                        } else {\n                            ranges.pop();\n                        }\n                    }\n                    for (var i = 0, length = ranges.length; i < length; i++) {\n                        var range = ranges[i];\n                        var rangeValue = range.value;\n                        var rangeStart = range.start;\n                        var rangeEnd = range.end;\n                        this.tree.remove(range);\n                        if (rangeStart < start) {\n                            if (rangeValue !== value) {\n                                this.insert(rangeStart, start - 1, rangeValue);\n                            } else {\n                                start = rangeStart;\n                            }\n                        }\n                        if (rangeEnd > end) {\n                            if (rangeValue !== value) {\n                                this.insert(end + 1, rangeEnd, rangeValue);\n                            } else {\n                                end = rangeEnd;\n                            }\n                        }\n                    }\n                }\n                this.insert(start, end, value);\n            },\n            expandedValues: function (start, end) {\n                var ranges = this.intersecting(start, end);\n                var result = [];\n                var rangeIndex = 0;\n                for (var i = start; i <= end; i++) {\n                    if (ranges[rangeIndex].end < i) {\n                        rangeIndex++;\n                    }\n                    result.push({\n                        index: i - start,\n                        value: ranges[rangeIndex].value\n                    });\n                }\n                return result;\n            },\n            sortedIndices: function (start, end, valueComparer, indices) {\n                var result = this.expandedValues(start, end);\n                var comparer = function (a, b) {\n                    if (a.value === b.value) {\n                        return a.index - b.index;\n                    }\n                    return valueComparer(a.value, b.value);\n                };\n                if (indices) {\n                    comparer = function (a, b) {\n                        var x = indices[a.index];\n                        var y = indices[b.index];\n                        if (x.value === y.value) {\n                            return valueComparer(a.value, b.value);\n                        }\n                        return a.index - b.index;\n                    };\n                }\n                result.sort(comparer);\n                return result;\n            },\n            sort: function (start, end, indices) {\n                if (this.intersecting(start, end).length === 1) {\n                    return;\n                }\n                var values = this.expandedValues(start, end);\n                for (var i = 0, len = indices.length; i < len; i++) {\n                    this.value(i + start, i + start, values[indices[i].index].value);\n                }\n            },\n            copy: function (sourceStart, sourceEnd, targetStart) {\n                var values = this.intersecting(sourceStart, sourceEnd);\n                var start = targetStart;\n                var end;\n                for (var i = 0, len = values.length; i < len; i++) {\n                    var rangeStart = values[i].start;\n                    if (rangeStart < sourceStart) {\n                        rangeStart = sourceStart;\n                    }\n                    var rangeEnd = values[i].end;\n                    if (rangeEnd > sourceEnd) {\n                        rangeEnd = sourceEnd;\n                    }\n                    end = start + (rangeEnd - rangeStart);\n                    this.value(start, end, values[i].value);\n                    start = ++end;\n                }\n            },\n            iterator: function (start, end) {\n                return new Iterator(start, end, this.intersecting(start, end));\n            },\n            getState: function () {\n                return this.tree.clone();\n            },\n            setState: function (state) {\n                this.tree = state;\n            }\n        });\n        var Iterator = kendo.Class.extend({\n            init: function (start, end, ranges) {\n                this.start = start;\n                this.end = end;\n                this.index = 0;\n                this.ranges = ranges;\n            },\n            unique: function () {\n                return this.ranges.map(function (range) {\n                    return range.value;\n                });\n            },\n            at: function (index) {\n                while (this.ranges[this.index].end < index) {\n                    this.index++;\n                }\n                return this.ranges[this.index].value;\n            },\n            forEach: function (callback) {\n                for (var i = this.start; i <= this.end; i++) {\n                    callback(this.at(i), i);\n                }\n                this.index = 0;\n            }\n        });\n        var SparseRangeList = RangeList.extend({\n            init: function (start, end, value) {\n                this.tree = new RangeTree();\n                this.range = new Range(start, end, value);\n            },\n            intersecting: function (start, end) {\n                var ranges = this.tree.intersecting(start, end);\n                var result = [];\n                var range;\n                if (!ranges.length) {\n                    return [this.range];\n                }\n                for (var i = 0, len = ranges.length; i < len; i++) {\n                    range = ranges[i];\n                    if (range.start > start) {\n                        result.push(new Range(start, range.start - 1, this.range.value));\n                    }\n                    result.push(range);\n                    start = range.end + 1;\n                }\n                if (range.end < end) {\n                    result.push(new Range(range.end + 1, end, this.range.value));\n                }\n                return result;\n            },\n            insert: function (start, end, value) {\n                if (value !== this.range.value) {\n                    this.tree.insert(new Range(start, end, value));\n                }\n            },\n            lastRangeStart: function () {\n                var node = this.tree.root;\n                if (node === NilNode) {\n                    return this.range.start;\n                }\n                while (node.right !== NilNode) {\n                    node = node.right;\n                }\n                return node.value.end + 1;\n            }\n        });\n        kendo.spreadsheet.RangeTree = RangeTree;\n        kendo.spreadsheet.RangeList = RangeList;\n        kendo.spreadsheet.SparseRangeList = SparseRangeList;\n        kendo.spreadsheet.ValueRange = Range;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/propertybag', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Property = kendo.Class.extend({\n            init: function (list) {\n                this.list = list;\n            },\n            get: function (index) {\n                return this.parse(this.list.value(index, index));\n            },\n            set: function (start, end, value) {\n                if (value === undefined) {\n                    value = end;\n                    end = start;\n                }\n                this.list.value(start, end, value);\n            },\n            parse: function (value) {\n                return value;\n            },\n            copy: function (start, end, dst) {\n                this.list.copy(start, end, dst);\n            },\n            iterator: function (start, end) {\n                return this.list.iterator(start, end);\n            }\n        });\n        var JsonProperty = Property.extend({\n            set: function (start, end, value) {\n                this.list.value(start, end, JSON.stringify(value));\n            },\n            parse: function (value) {\n                return JSON.parse(value);\n            }\n        });\n        var ValueProperty = Property.extend({\n            init: function (values, formats, validations) {\n                Property.prototype.init.call(this, values);\n                this.validations = validations;\n                this.formats = formats;\n            },\n            set: function (start, end, value) {\n                if (value instanceof Date) {\n                    value = kendo.spreadsheet.dateToNumber(value);\n                    this.formats.value(start, end, toExcelFormat(kendo.culture().calendar.patterns.d));\n                }\n                this.list.value(start, end, value);\n            }\n        });\n        function toExcelFormat(format) {\n            return format.replace(/M/g, 'm').replace(/'/g, '\"').replace(/tt/, 'am/pm');\n        }\n        kendo.spreadsheet.PropertyBag = kendo.Class.extend({\n            specs: [\n                {\n                    property: ValueProperty,\n                    name: 'value',\n                    value: null,\n                    sortable: true,\n                    serializable: true,\n                    depends: 'format'\n                },\n                {\n                    property: Property,\n                    name: 'format',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'formula',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'background',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: JsonProperty,\n                    name: 'borderBottom',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: JsonProperty,\n                    name: 'borderRight',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: JsonProperty,\n                    name: 'borderLeft',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: JsonProperty,\n                    name: 'borderTop',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'color',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'fontFamily',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'underline',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'fontSize',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'italic',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'bold',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'textAlign',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'verticalAlign',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'wrap',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'validation',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'enable',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                }\n            ],\n            init: function (cellCount) {\n                this.properties = {};\n                this.lists = {};\n                this.specs.forEach(function (spec) {\n                    this.lists[spec.name] = new kendo.spreadsheet.SparseRangeList(0, cellCount, spec.value);\n                }, this);\n                this.specs.forEach(function (spec) {\n                    this.properties[spec.name] = new spec.property(this.lists[spec.name], this.lists[spec.depends]);\n                }, this);\n            },\n            getState: function () {\n                var state = {};\n                this.specs.forEach(function (spec) {\n                    state[spec.name] = this.lists[spec.name].getState();\n                }, this);\n                return state;\n            },\n            setState: function (state) {\n                this.specs.forEach(function (spec) {\n                    this.lists[spec.name].setState(state[spec.name]);\n                }, this);\n            },\n            get: function (name, index) {\n                if (index === undefined) {\n                    return this.lists[name];\n                }\n                return this.properties[name].get(index);\n            },\n            set: function (name, start, end, value) {\n                this.properties[name].set(start, end, value);\n            },\n            fromJSON: function (index, value) {\n                for (var si = 0; si < this.specs.length; si++) {\n                    var spec = this.specs[si];\n                    if (spec.serializable) {\n                        if (value[spec.name] !== undefined) {\n                            this.set(spec.name, index, index, value[spec.name], false);\n                        }\n                    }\n                }\n            },\n            copy: function (sourceStart, sourceEnd, targetStart) {\n                this.specs.forEach(function (spec) {\n                    this.properties[spec.name].copy(sourceStart, sourceEnd, targetStart);\n                }, this);\n            },\n            iterator: function (name, start, end) {\n                return this.properties[name].iterator(start, end);\n            },\n            sortable: function () {\n                return this.specs.filter(function (spec) {\n                    return spec.sortable;\n                }).map(function (spec) {\n                    return this.lists[spec.name];\n                }, this);\n            },\n            iterators: function (start, end) {\n                var specs = this.specs.filter(function (spec) {\n                    return spec.serializable;\n                });\n                return specs.map(function (spec) {\n                    var iterator = this.iterator(spec.name, start, end);\n                    return {\n                        name: spec.name,\n                        value: spec.value,\n                        at: function (index) {\n                            return spec.property.fn.parse(iterator.at(index));\n                        }\n                    };\n                }, this);\n            },\n            forEach: function (start, end, callback) {\n                var iterators = this.iterators(start, end);\n                for (var index = start; index <= end; index++) {\n                    var values = {};\n                    for (var i = 0; i < iterators.length; i++) {\n                        var iterator = iterators[i];\n                        var value = iterator.at(index);\n                        if (value !== iterator.value) {\n                            values[iterator.name] = value;\n                        }\n                    }\n                    callback(values);\n                }\n            },\n            forEachProperty: function (callback) {\n                for (var name in this.properties) {\n                    callback(this.properties[name]);\n                }\n            }\n        });\n        kendo.spreadsheet.ALL_PROPERTIES = $.map(kendo.spreadsheet.PropertyBag.prototype.specs, function (spec) {\n            return spec.name;\n        });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/references', ['kendo.core'], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var Class = kendo.Class;\n    function columnName(colIndex) {\n        var letter = Math.floor(colIndex / 26) - 1;\n        return (letter >= 0 ? columnName(letter) : '') + String.fromCharCode(65 + colIndex % 26);\n    }\n    function displaySheet(sheet) {\n        if (/^[a-z0-9_]*$/i.test(sheet)) {\n            return sheet;\n        }\n        return '\\'' + sheet.replace(/\\x27/g, '\\\\\\'') + '\\'';\n    }\n    function displayRef(sheet, row, col, rel) {\n        var aa = '';\n        ++row;\n        if (!isFinite(row)) {\n            row = '';\n        } else if (rel != null && !(rel & 2)) {\n            row = '$' + row;\n        }\n        if (!isFinite(col)) {\n            col = '';\n        } else {\n            aa = columnName(col);\n            if (rel != null && !(rel & 1)) {\n                aa = '$' + aa;\n            }\n        }\n        if (sheet) {\n            return displaySheet(sheet) + '!' + aa + row;\n        } else {\n            return aa + row;\n        }\n    }\n    var Ref = Class.extend({\n        type: 'ref',\n        hasSheet: function () {\n            return this._hasSheet;\n        },\n        simplify: function () {\n            return this;\n        },\n        setSheet: function (sheet, hasSheet) {\n            this.sheet = sheet;\n            if (hasSheet != null) {\n                this._hasSheet = hasSheet;\n            }\n            return this;\n        },\n        absolute: function () {\n            return this;\n        },\n        relative: function () {\n            return this;\n        },\n        adjust: function () {\n            return this;\n        },\n        toString: function () {\n            return this.relative(0, 0, 3, 3).print(0, 0);\n        },\n        forEach: function (callback, obj) {\n            callback.call(obj, this);\n        },\n        map: function (callback, obj) {\n            return callback.call(obj, this);\n        },\n        intersects: function (ref) {\n            return this.intersect(ref) !== NULL;\n        },\n        isCell: function () {\n            return false;\n        },\n        toRow: function () {\n            return this;\n        },\n        toColumn: function () {\n            return this;\n        },\n        first: function () {\n            return this;\n        },\n        lastRange: function () {\n            return this;\n        },\n        size: function () {\n            return 1;\n        },\n        rangeAt: function () {\n            return this;\n        },\n        nextRangeIndex: function () {\n            return 0;\n        },\n        previousRangeIndex: function () {\n            return 0;\n        },\n        eq: function (reference) {\n            var r1 = this;\n            var r2 = reference;\n            if (r1 === NULL || r2 === NULL) {\n                return r1 === r2;\n            }\n            if (r2 instanceof CellRef || r2 instanceof RangeRef && !(r1 instanceof CellRef)) {\n                r1 = reference;\n                r2 = this;\n            }\n            if (r1 instanceof CellRef) {\n                r2 = r2.simplify();\n                return r2 instanceof CellRef && r1.row == r2.row && r1.col == r2.col && r1.sheet == r2.sheet;\n            } else if (r1 instanceof RangeRef) {\n                if (r2 instanceof RangeRef) {\n                    return r2.topLeft.eq(r1.topLeft) && r2.bottomRight.eq(r1.bottomRight);\n                }\n                if (r2 instanceof UnionRef) {\n                    return r2.single() && r1.eq(r2.refs[0]);\n                }\n            } else if (r1 instanceof UnionRef && r2 instanceof UnionRef) {\n                var refs1 = r1.refs;\n                var refs2 = r2.refs;\n                if (refs1.length != refs2.length) {\n                    return false;\n                }\n                for (var i = 0, len = refs1.length; i < len; i++) {\n                    if (!refs1[i].eq(refs2[i])) {\n                        return false;\n                    }\n                }\n                return true;\n            }\n            return r1 === r2;\n        },\n        concat: function (ref) {\n            return new UnionRef([\n                this,\n                ref\n            ]);\n        },\n        replaceAt: function (index, ref) {\n            return ref;\n        },\n        forEachColumnIndex: function (callback) {\n            this.forEachAxisIndex('col', callback);\n        },\n        forEachRowIndex: function (callback) {\n            this.forEachAxisIndex('row', callback);\n        },\n        forEachAxisIndex: function (axis, callback) {\n            var sorted = [];\n            var method = axis === 'row' ? 'forEachRow' : 'forEachColumn';\n            this[method](function (ref) {\n                var index = ref.first()[axis];\n                if (sorted.indexOf(index) === -1) {\n                    sorted.push(index);\n                }\n            });\n            sorted.sort(function (a, b) {\n                return a > b ? 1 : a < b ? -1 : 0;\n            }).forEach(callback);\n        },\n        valid: function () {\n            return false;\n        }\n    });\n    Ref.display = displayRef;\n    var NULL = new (Ref.extend({\n        init: function NullRef() {\n        },\n        print: function () {\n            return '#NULL!';\n        },\n        clone: function () {\n            return this;\n        },\n        eq: function (ref) {\n            return ref === this;\n        },\n        forEach: function () {\n        }\n    }))();\n    var NameRef = Ref.extend({\n        ref: 'name',\n        init: function NameRef(name) {\n            this.name = name;\n        },\n        print: function () {\n            var ret = displaySheet(this.name);\n            if (this.hasSheet()) {\n                ret = displaySheet(this.sheet) + '!' + ret;\n            }\n            return ret;\n        }\n    });\n    var CellRef = Ref.extend({\n        ref: 'cell',\n        init: function CellRef(row, col, rel) {\n            this.row = row;\n            this.col = col;\n            this.rel = rel || 0;\n        },\n        clone: function () {\n            return new CellRef(this.row, this.col, this.rel).setSheet(this.sheet, this.hasSheet());\n        },\n        intersect: function (ref) {\n            if (ref instanceof CellRef) {\n                if (this.eq(ref)) {\n                    return this;\n                } else {\n                    return NULL;\n                }\n            }\n            return ref.intersect(this);\n        },\n        print: function (trow, tcol) {\n            var col = this.col, row = this.row, rel = this.rel, abs;\n            if (trow == null) {\n                if (isFinite(col)) {\n                    col = rel & 1 ? 'C[' + col + ']' : 'C' + (col + 1);\n                } else {\n                    col = '';\n                }\n                if (isFinite(row)) {\n                    row = rel & 2 ? 'R[' + row + ']' : 'R' + (row + 1);\n                } else {\n                    row = '';\n                }\n                return row + col;\n            } else {\n                abs = this.absolute(trow, tcol);\n                return abs.valid() ? displayRef(this._hasSheet && this.sheet, abs.row, abs.col, rel) : '#REF!';\n            }\n        },\n        absolute: function (arow, acol) {\n            var ret = this.clone();\n            if (ret.rel & 3 === 0) {\n                return ret;\n            }\n            if (ret.rel & 1) {\n                ret.col += acol;\n            }\n            if (ret.rel & 2) {\n                ret.row += arow;\n            }\n            ret.rel = 0;\n            return ret;\n        },\n        toRangeRef: function () {\n            return new RangeRef(this, this);\n        },\n        relative: function (arow, acol, rel) {\n            if (rel == null) {\n                rel = this.rel;\n            }\n            var row = rel & 2 ? this.row - arow : this.row;\n            var col = rel & 1 ? this.col - acol : this.col;\n            return new CellRef(row, col, rel).setSheet(this.sheet, this.hasSheet());\n        },\n        height: function () {\n            return 1;\n        },\n        width: function () {\n            return 1;\n        },\n        toString: function () {\n            return displayRef(null, this.row, this.col, 3);\n        },\n        isCell: function () {\n            return true;\n        },\n        leftColumn: function () {\n            return this;\n        },\n        rightColumn: function () {\n            return this;\n        },\n        topRow: function () {\n            return this;\n        },\n        bottomRow: function () {\n            return this;\n        },\n        forEachRow: function (callback) {\n            callback(this.toRangeRef());\n        },\n        forEachColumn: function (callback) {\n            callback(this.toRangeRef());\n        },\n        adjust: function (row, col, trow, tcol, forRow, start, delta) {\n            var ref = this.absolute(row, col);\n            if (forRow) {\n                if (ref.row >= start) {\n                    if (delta < 0 && ref.row < start - delta) {\n                        return NULL;\n                    }\n                    ref.row += delta;\n                }\n            } else {\n                if (ref.col >= start) {\n                    if (delta < 0 && ref.col < start - delta) {\n                        return NULL;\n                    }\n                    ref.col += delta;\n                }\n            }\n            if (trow != null && tcol != null) {\n                ref = ref.relative(trow, tcol, this.rel);\n            }\n            return ref;\n        },\n        valid: function () {\n            if (this.rel) {\n                throw new Error('valid() called on relative reference');\n            }\n            var col = this.col, row = this.row;\n            return !(isFinite(col) && col < 0 || isFinite(row) && row < 0);\n        }\n    });\n    var RangeRef = Ref.extend({\n        ref: 'range',\n        init: function RangeRef(tl, br) {\n            if (tl._hasSheet && br._hasSheet && tl.sheet.toLowerCase() != br.sheet.toLowerCase()) {\n                this.endSheet = br.sheet;\n            }\n            this.topLeft = new CellRef(tl.row, tl.col, tl.rel);\n            this.bottomRight = new CellRef(br.row, br.col, br.rel);\n            this.normalize();\n        },\n        clone: function () {\n            return new RangeRef(this.topLeft.clone(), this.bottomRight.clone()).setSheet(this.sheet, this.hasSheet());\n        },\n        _containsRange: function (range) {\n            return this._containsCell(range.topLeft) && this._containsCell(range.bottomRight);\n        },\n        _containsCell: function (cell) {\n            return cell.sheet == this.sheet && cell.row >= this.topLeft.row && cell.col >= this.topLeft.col && cell.row <= this.bottomRight.row && cell.col <= this.bottomRight.col;\n        },\n        contains: function (ref) {\n            if (ref instanceof Array) {\n                var that = this;\n                return ref.some(function (_ref) {\n                    return that.contains(_ref);\n                });\n            }\n            if (ref instanceof CellRef) {\n                return this._containsCell(ref);\n            }\n            if (ref instanceof RangeRef) {\n                return this._containsRange(ref);\n            }\n            return false;\n        },\n        _intersectRange: function (ref) {\n            if (this.sheet != ref.sheet) {\n                return NULL;\n            }\n            var a_left = this.topLeft.col;\n            var a_top = this.topLeft.row;\n            var a_right = this.bottomRight.col;\n            var a_bottom = this.bottomRight.row;\n            var b_left = ref.topLeft.col;\n            var b_top = ref.topLeft.row;\n            var b_right = ref.bottomRight.col;\n            var b_bottom = ref.bottomRight.row;\n            if (a_left <= b_right && b_left <= a_right && a_top <= b_bottom && b_top <= a_bottom) {\n                return new RangeRef(new CellRef(Math.max(a_top, b_top), Math.max(a_left, b_left)), new CellRef(Math.min(a_bottom, b_bottom), Math.min(a_right, b_right))).setSheet(this.sheet, this.hasSheet());\n            } else {\n                return NULL;\n            }\n        },\n        intersect: function (ref) {\n            if (ref === NULL) {\n                return ref;\n            }\n            if (ref instanceof CellRef) {\n                return this._containsCell(ref) ? ref : NULL;\n            }\n            if (ref instanceof RangeRef) {\n                return this._intersectRange(ref).simplify();\n            }\n            if (ref instanceof UnionRef) {\n                return ref.intersect(this);\n            }\n            throw new Error('Unknown reference');\n        },\n        simplify: function () {\n            if (this.isCell()) {\n                return new CellRef(this.topLeft.row, this.topLeft.col, this.topLeft.rel).setSheet(this.sheet, this.hasSheet());\n            }\n            return this;\n        },\n        normalize: function () {\n            var a = this.topLeft, b = this.bottomRight;\n            var r1 = a.row, c1 = a.col, r2 = b.row, c2 = b.col;\n            var rr1 = a.rel & 2, rc1 = a.rel & 1;\n            var rr2 = b.rel & 2, rc2 = b.rel & 1;\n            var tmp, changes = false;\n            if (r1 > r2) {\n                changes = true;\n                tmp = r1;\n                r1 = r2;\n                r2 = tmp;\n                tmp = rr1;\n                rr1 = rr2;\n                rr2 = tmp;\n            }\n            if (c1 > c2) {\n                changes = true;\n                tmp = c1;\n                c1 = c2;\n                c2 = tmp;\n                tmp = rc1;\n                rc1 = rc2;\n                rc2 = tmp;\n            }\n            if (changes) {\n                this.topLeft = new CellRef(r1, c1, rc1 | rr1);\n                this.bottomRight = new CellRef(r2, c2, rc2 | rr2);\n            }\n            return this;\n        },\n        print: function (trow, tcol) {\n            var abs = this.absolute(trow, tcol);\n            if (abs.valid()) {\n                var ret = this.topLeft.print(trow, tcol) + ':' + this.bottomRight.print(trow, tcol);\n                if (this.hasSheet()) {\n                    ret = displaySheet(this.sheet) + (this.endSheet ? ':' + displaySheet(this.endSheet) : '') + '!' + ret;\n                }\n                return ret;\n            }\n            return '#REF!';\n        },\n        absolute: function (arow, acol) {\n            return new RangeRef(this.topLeft.absolute(arow, acol), this.bottomRight.absolute(arow, acol)).setSheet(this.sheet, this.hasSheet());\n        },\n        relative: function (arow, acol, relTL, relBR) {\n            if (relBR == null) {\n                relBR = relTL;\n            }\n            return new RangeRef(this.topLeft.relative(arow, acol, relTL), this.bottomRight.relative(arow, acol, relBR)).setSheet(this.sheet, this.hasSheet());\n        },\n        height: function () {\n            if (this.topLeft.rel != this.bottomRight.rel) {\n                throw new Error('Mixed relative/absolute references');\n            }\n            return this.bottomRight.row - this.topLeft.row + 1;\n        },\n        width: function () {\n            if (this.topLeft.rel != this.bottomRight.rel) {\n                throw new Error('Mixed relative/absolute references');\n            }\n            return this.bottomRight.col - this.topLeft.col + 1;\n        },\n        collapse: function () {\n            return this.topLeft.toRangeRef();\n        },\n        leftColumn: function () {\n            return new RangeRef(this.topLeft, new CellRef(this.bottomRight.row, this.topLeft.col));\n        },\n        rightColumn: function () {\n            return new RangeRef(new CellRef(this.topLeft.row, this.bottomRight.col), this.bottomRight);\n        },\n        topRow: function () {\n            return new RangeRef(this.topLeft, new CellRef(this.topLeft.row, this.bottomRight.col));\n        },\n        bottomRow: function () {\n            return new RangeRef(new CellRef(this.bottomRight.row, this.topLeft.col), this.bottomRight);\n        },\n        toRangeRef: function () {\n            return this;\n        },\n        toRow: function (row) {\n            return new RangeRef(new CellRef(this.topLeft.row + row, this.topLeft.col), new CellRef(this.topLeft.row + row, this.bottomRight.col));\n        },\n        toColumn: function (col) {\n            return new RangeRef(new CellRef(this.topLeft.row, this.topLeft.col + col), new CellRef(this.bottomRight.row, this.topLeft.col + col));\n        },\n        forEachRow: function (callback) {\n            var startRow = this.topLeft.row;\n            var endRow = this.bottomRight.row;\n            var startCol = this.topLeft.col;\n            var endCol = this.bottomRight.col;\n            for (var i = startRow; i <= endRow; i++) {\n                callback(new RangeRef(new CellRef(i, startCol), new CellRef(i, endCol)));\n            }\n        },\n        forEachColumn: function (callback) {\n            var startRow = this.topLeft.row;\n            var endRow = this.bottomRight.row;\n            var startCol = this.topLeft.col;\n            var endCol = this.bottomRight.col;\n            for (var i = startCol; i <= endCol; i++) {\n                callback(new RangeRef(new CellRef(startRow, i), new CellRef(endRow, i)));\n            }\n        },\n        intersecting: function (refs) {\n            return refs.filter(function (ref) {\n                return ref.toRangeRef().intersects(this);\n            }, this);\n        },\n        union: function (refs, callback) {\n            var intersecting = this.intersecting(refs);\n            var topLeftRow = this.topLeft.row;\n            var topLeftCol = this.topLeft.col;\n            var bottomRightRow = this.bottomRight.row;\n            var bottomRightCol = this.bottomRight.col;\n            var modified = false;\n            intersecting.forEach(function (ref) {\n                ref = ref.toRangeRef();\n                if (ref.topLeft.row < topLeftRow) {\n                    modified = true;\n                    topLeftRow = ref.topLeft.row;\n                }\n                if (ref.topLeft.col < topLeftCol) {\n                    modified = true;\n                    topLeftCol = ref.topLeft.col;\n                }\n                if (ref.bottomRight.row > bottomRightRow) {\n                    modified = true;\n                    bottomRightRow = ref.bottomRight.row;\n                }\n                if (ref.bottomRight.col > bottomRightCol) {\n                    modified = true;\n                    bottomRightCol = ref.bottomRight.col;\n                }\n                if (callback) {\n                    callback(ref);\n                }\n            });\n            var result = new RangeRef(new CellRef(topLeftRow, topLeftCol), new CellRef(bottomRightRow, bottomRightCol));\n            if (modified) {\n                return result.union(refs, callback);\n            } else {\n                return result;\n            }\n        },\n        resize: function (options) {\n            var limit = Math.max.bind(Math, 0);\n            function num(value) {\n                return value || 0;\n            }\n            var top = this.topLeft.row + num(options.top);\n            var left = this.topLeft.col + num(options.left);\n            var bottom = this.bottomRight.row + num(options.bottom);\n            var right = this.bottomRight.col + num(options.right);\n            if (left < 0 && right < 0 || top < 0 && bottom < 0) {\n                return NULL;\n            } else if (top <= bottom && left <= right) {\n                return new RangeRef(new CellRef(limit(top), limit(left)), new CellRef(limit(bottom), limit(right)));\n            } else {\n                return NULL;\n            }\n        },\n        move: function (rows, cols) {\n            return new RangeRef(new CellRef(this.topLeft.row + rows, this.topLeft.col + cols), new CellRef(this.bottomRight.row + rows, this.bottomRight.col + cols));\n        },\n        first: function () {\n            return this.topLeft;\n        },\n        isCell: function () {\n            return !this.endSheet && this.topLeft.eq(this.bottomRight);\n        },\n        toString: function () {\n            return this.topLeft + ':' + this.bottomRight;\n        },\n        adjust: function (row, col, trow, tcol, forRow, start, delta) {\n            var tl = this.topLeft.adjust(row, col, trow, tcol, forRow, start, delta);\n            var tr = this.bottomRight.adjust(row, col, trow, tcol, forRow, start, delta);\n            if (tl === NULL && tr === NULL) {\n                return NULL;\n            }\n            if (tl === NULL) {\n                tl = this.topLeft.absolute(row, col);\n                if (forRow) {\n                    tl.row = start;\n                } else {\n                    tl.col = start;\n                }\n                if (trow != null && tcol != null) {\n                    tl = tl.relative(trow, tcol, this.topLeft.rel);\n                }\n            } else if (tr === NULL) {\n                tr = this.bottomRight.absolute(row, col);\n                if (forRow) {\n                    tr.row = start - 1;\n                } else {\n                    tr.col = start - 1;\n                }\n                if (trow != null && tcol != null) {\n                    tr = tr.relative(trow, tcol, this.bottomRight.rel);\n                }\n            }\n            return new RangeRef(tl, tr).setSheet(this.sheet, this.hasSheet()).simplify();\n        },\n        valid: function () {\n            return this.topLeft.valid() && this.bottomRight.valid();\n        }\n    });\n    var UnionRef = Ref.extend({\n        init: function UnionRef(refs) {\n            this.refs = refs;\n            this.length = this.refs.length;\n        },\n        intersect: function (ref) {\n            var a = [];\n            for (var i = 0; i < this.length; ++i) {\n                var x = ref.intersect(this.refs[i]);\n                if (x !== NULL) {\n                    a.push(x);\n                }\n            }\n            if (a.length > 0) {\n                return new UnionRef(a).simplify();\n            }\n            return NULL;\n        },\n        simplify: function () {\n            var u = new UnionRef(this.refs.reduce(function (a, ref) {\n                ref = ref.simplify();\n                if (ref !== NULL) {\n                    a.push(ref);\n                }\n                return a;\n            }, []));\n            if (u.empty()) {\n                return NULL;\n            }\n            if (u.single()) {\n                return u.refs[0];\n            }\n            return u;\n        },\n        absolute: function (arow, acol) {\n            return new UnionRef(this.refs.map(function (ref) {\n                return ref.absolute(arow, acol);\n            }));\n        },\n        forEach: function (callback, obj) {\n            this.refs.forEach(callback, obj);\n        },\n        toRangeRef: function () {\n            return this.refs[0].toRangeRef();\n        },\n        contains: function (theRef) {\n            return this.refs.some(function (ref) {\n                return ref.contains(theRef);\n            });\n        },\n        map: function (callback, obj) {\n            return new UnionRef(this.refs.map(callback, obj));\n        },\n        first: function () {\n            return this.refs[0].first();\n        },\n        lastRange: function () {\n            return this.refs[this.length - 1];\n        },\n        size: function () {\n            return this.length;\n        },\n        single: function () {\n            return this.length == 1;\n        },\n        empty: function () {\n            return this.length === 0;\n        },\n        isCell: function () {\n            return this.single() && this.refs[0].isCell();\n        },\n        rangeAt: function (index) {\n            return this.refs[index];\n        },\n        nextRangeIndex: function (index) {\n            if (index === this.length - 1) {\n                return 0;\n            } else {\n                return index + 1;\n            }\n        },\n        previousRangeIndex: function (index) {\n            if (index === 0) {\n                return this.length - 1;\n            } else {\n                return index - 1;\n            }\n        },\n        concat: function (ref) {\n            return new UnionRef(this.refs.concat([ref]));\n        },\n        print: function (row, col) {\n            return this.refs.map(function (ref) {\n                return ref.print(row, col);\n            }).join(',');\n        },\n        replaceAt: function (index, ref) {\n            var newRefs = this.refs.slice();\n            newRefs.splice(index, 1, ref);\n            return new UnionRef(newRefs);\n        },\n        leftColumn: function () {\n            return this.map(function (ref) {\n                return ref.leftColumn();\n            });\n        },\n        rightColumn: function () {\n            return this.map(function (ref) {\n                return ref.rightColumn();\n            });\n        },\n        topRow: function () {\n            return this.map(function (ref) {\n                return ref.topRow();\n            });\n        },\n        bottomRow: function () {\n            return this.map(function (ref) {\n                return ref.bottomRow();\n            });\n        },\n        forEachRow: function (callback) {\n            this.forEach(function (ref) {\n                ref.forEachRow(callback);\n            });\n        },\n        forEachColumn: function (callback) {\n            this.forEach(function (ref) {\n                ref.forEachColumn(callback);\n            });\n        },\n        adjust: function (row, col, trow, tcol, forRow, start, delta) {\n            return this.map(function (ref) {\n                return ref.adjust(row, col, trow, tcol, forRow, start, delta);\n            }).simplify();\n        },\n        toString: function () {\n            return this.refs.map(function (ref) {\n                return ref.toString();\n            }).join(', ');\n        },\n        valid: function () {\n            for (var i = this.refs.length; --i >= 0;) {\n                if (this.refs[i].valid()) {\n                    return false;\n                }\n            }\n            return true;\n        }\n    });\n    spreadsheet.NULLREF = NULL;\n    spreadsheet.SHEETREF = new RangeRef(new CellRef(0, 0), new CellRef(Infinity, Infinity));\n    spreadsheet.FIRSTREF = new CellRef(0, 0);\n    spreadsheet.Ref = Ref;\n    spreadsheet.NameRef = NameRef;\n    spreadsheet.CellRef = CellRef;\n    spreadsheet.RangeRef = RangeRef;\n    spreadsheet.UnionRef = UnionRef;\n    spreadsheet.SHEETREF.print = function () {\n        return '#SHEET';\n    };\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/autofillcalculator', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var AutoFillCalculator = kendo.Class.extend({\n            init: function (grid) {\n                this._grid = grid;\n            },\n            rectIsVertical: function (start, end, x, y) {\n                var startRect = this._grid.rectangle(start.toRangeRef());\n                var endRect = this._grid.rectangle(end.toRangeRef());\n                return Math.abs(endRect[y] - startRect[y]) > Math.abs(startRect[x] - endRect[x]);\n            },\n            autoFillDest: function (selection, cursor) {\n                var topLeft = selection.topLeft;\n                var bottomRight = selection.bottomRight;\n                var quadrant;\n                var lower = cursor.row >= topLeft.row;\n                var further = cursor.col >= topLeft.col;\n                if (lower) {\n                    quadrant = further ? 4 : 3;\n                } else {\n                    quadrant = further ? 2 : 1;\n                }\n                var pivot, opposite, cornerResult, expanding;\n                if (quadrant === 4) {\n                    pivot = topLeft;\n                    opposite = bottomRight;\n                    expanding = cursor.row > opposite.row || cursor.col > opposite.col;\n                    if (expanding) {\n                        cursor = new CellRef(Math.max(cursor.row, opposite.row), Math.max(cursor.col, opposite.col));\n                    }\n                    if (this.rectIsVertical(opposite, cursor, 'right', 'bottom')) {\n                        cornerResult = new CellRef(cursor.row, opposite.col);\n                    } else {\n                        cornerResult = new CellRef(opposite.row, cursor.col);\n                    }\n                } else if (quadrant === 3) {\n                    var bottomLeft = new CellRef(topLeft.col, bottomRight.row);\n                    if (cursor.row > bottomRight.row && this.rectIsVertical(bottomLeft, cursor, 'left', 'bottom')) {\n                        pivot = topLeft;\n                        cornerResult = new CellRef(cursor.row, bottomRight.col);\n                    } else {\n                        pivot = bottomRight;\n                        cornerResult = new CellRef(topLeft.row, cursor.col);\n                    }\n                } else if (quadrant === 2) {\n                    var topRight = new CellRef(topLeft.row, bottomRight.col);\n                    if (cursor.col > bottomRight.col && !this.rectIsVertical(topRight, cursor, 'right', 'top')) {\n                        pivot = topLeft;\n                        cornerResult = new CellRef(bottomRight.row, cursor.col);\n                    } else {\n                        pivot = bottomRight;\n                        cornerResult = new CellRef(cursor.row, topLeft.col);\n                    }\n                } else {\n                    pivot = bottomRight;\n                    if (this.rectIsVertical(topLeft, cursor, 'left', 'top')) {\n                        cornerResult = new CellRef(cursor.row, topLeft.col);\n                    } else {\n                        cornerResult = new CellRef(topLeft.row, cursor.col);\n                    }\n                }\n                return this._grid.normalize(new RangeRef(pivot, cornerResult));\n            }\n        });\n        kendo.spreadsheet.AutoFillCalculator = AutoFillCalculator;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/navigator', [\n        'kendo.core',\n        'spreadsheet/autofillcalculator'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var EdgeNavigator = kendo.Class.extend({\n            init: function (field, axis, rangeGetter, union) {\n                this.rangeGetter = rangeGetter;\n                this.prevLeft = function (index) {\n                    var current = union(this.range(index));\n                    var range = this.range(axis.prevVisible(current.topLeft[field]));\n                    return union(range).topLeft[field];\n                };\n                this.nextRight = function (index) {\n                    var current = union(this.range(index));\n                    var range = this.range(axis.nextVisible(current.bottomRight[field]));\n                    return union(range).bottomRight[field];\n                };\n                this.nextLeft = function (index) {\n                    var range = union(this.range(index));\n                    return axis.nextVisible(range.bottomRight[field]);\n                };\n                this.prevRight = function (index) {\n                    var range = union(this.range(index));\n                    return axis.prevVisible(range.topLeft[field]);\n                };\n            },\n            boundary: function (top, bottom) {\n                this.top = top;\n                this.bottom = bottom;\n            },\n            range: function (index) {\n                return this.rangeGetter(index, this.top, this.bottom);\n            }\n        });\n        var SheetNavigator = kendo.Class.extend({\n            init: function (sheet) {\n                this._sheet = sheet;\n                this.columns = this._sheet._grid._columns;\n                this.autoFillCalculator = new kendo.spreadsheet.AutoFillCalculator(sheet._grid);\n                this.colEdge = new EdgeNavigator('col', this._sheet._grid._columns, this.columnRange.bind(this), this.union.bind(this));\n                this.rowEdge = new EdgeNavigator('row', this._sheet._grid._rows, this.rowRange.bind(this), this.union.bind(this));\n            },\n            height: function (height) {\n                this._viewPortHeight = height;\n            },\n            union: function (ref) {\n                return this._sheet.unionWithMerged(ref);\n            },\n            columnRange: function (col, topRow, bottomRow) {\n                return this._sheet._ref(topRow, col, bottomRow - topRow, 1);\n            },\n            rowRange: function (row, leftCol, rightCol) {\n                return this._sheet._ref(row, leftCol, 1, rightCol - leftCol);\n            },\n            selectionIncludesMergedCells: function () {\n                return this._sheet.select().contains(this._sheet._mergedCells);\n            },\n            setSelectionValue: function (value) {\n                var selection = this._sheet.selection();\n                setTimeout(function () {\n                    selection.value(value());\n                });\n            },\n            selectAll: function () {\n                this._sheet.select(this._sheet._sheetRef);\n            },\n            select: function (ref, mode, addToExisting) {\n                ref = this.refForMode(ref, mode);\n                if (addToExisting) {\n                    ref = this._sheet.select().concat(ref);\n                }\n                this._sheet.select(ref);\n            },\n            refForMode: function (ref, mode) {\n                var grid = this._sheet._grid;\n                switch (mode) {\n                case 'range':\n                    ref = grid.normalize(ref);\n                    break;\n                case 'row':\n                    ref = grid.rowRef(ref.row);\n                    break;\n                case 'column':\n                    ref = grid.colRef(ref.col);\n                    break;\n                case 'sheet':\n                    ref = this._sheet._sheetRef;\n                    break;\n                }\n                return ref;\n            },\n            startSelection: function (ref, mode, addToExisting) {\n                if (mode == 'autofill') {\n                    this._sheet.startAutoFill();\n                } else {\n                    this._sheet.startSelection();\n                    this.select(ref, mode, addToExisting);\n                }\n            },\n            completeSelection: function () {\n                this._sheet.completeSelection();\n            },\n            selectForContextMenu: function (ref, mode) {\n                var sheet = this._sheet;\n                if (!sheet.select().contains(this.refForMode(ref, mode))) {\n                    this.select(ref, mode);\n                }\n            },\n            modifySelection: function (action) {\n                var direction = this.determineDirection(action);\n                var sheet = this._sheet;\n                var viewPortHeight = this._viewPortHeight;\n                var rows = sheet._grid._rows;\n                var columns = sheet._grid._columns;\n                var originalSelection = sheet.currentOriginalSelectionRange();\n                var selection = sheet.select().toRangeRef();\n                var activeCell = sheet.activeCell();\n                var topLeft = originalSelection.topLeft.clone();\n                var bottomRight = originalSelection.bottomRight.clone();\n                var scrollInto;\n                this.colEdge.boundary(selection.topLeft.row, selection.bottomRight.row);\n                this.rowEdge.boundary(selection.topLeft.col, selection.bottomRight.col);\n                switch (direction) {\n                case 'expand-left':\n                    topLeft.col = this.colEdge.prevLeft(topLeft.col);\n                    scrollInto = topLeft;\n                    break;\n                case 'shrink-right':\n                    topLeft.col = this.colEdge.nextLeft(topLeft.col);\n                    scrollInto = topLeft;\n                    break;\n                case 'expand-right':\n                    bottomRight.col = this.colEdge.nextRight(bottomRight.col);\n                    scrollInto = bottomRight;\n                    break;\n                case 'shrink-left':\n                    bottomRight.col = this.colEdge.prevRight(bottomRight.col);\n                    scrollInto = bottomRight;\n                    break;\n                case 'expand-up':\n                    topLeft.row = this.rowEdge.prevLeft(topLeft.row);\n                    scrollInto = topLeft;\n                    break;\n                case 'shrink-down':\n                    topLeft.row = this.rowEdge.nextLeft(topLeft.row);\n                    scrollInto = topLeft;\n                    break;\n                case 'expand-down':\n                    bottomRight.row = this.rowEdge.nextRight(bottomRight.row);\n                    scrollInto = bottomRight;\n                    break;\n                case 'shrink-up':\n                    bottomRight.row = this.rowEdge.prevRight(bottomRight.row);\n                    scrollInto = bottomRight;\n                    break;\n                case 'expand-page-up':\n                    topLeft.row = rows.prevPage(topLeft.row, viewPortHeight);\n                    break;\n                case 'shrink-page-up':\n                    bottomRight.row = rows.prevPage(bottomRight.row, viewPortHeight);\n                    break;\n                case 'expand-page-down':\n                    bottomRight.row = rows.nextPage(bottomRight.row, viewPortHeight);\n                    break;\n                case 'shrink-page-down':\n                    topLeft.row = rows.nextPage(topLeft.row, viewPortHeight);\n                    break;\n                case 'first-col':\n                    topLeft.col = columns.firstVisible();\n                    bottomRight.col = activeCell.bottomRight.col;\n                    scrollInto = topLeft;\n                    break;\n                case 'last-col':\n                    bottomRight.col = columns.lastVisible();\n                    topLeft.col = activeCell.topLeft.col;\n                    scrollInto = bottomRight;\n                    break;\n                case 'first-row':\n                    topLeft.row = rows.firstVisible();\n                    bottomRight.row = activeCell.bottomRight.row;\n                    scrollInto = topLeft;\n                    break;\n                case 'last-row':\n                    bottomRight.row = rows.lastVisible();\n                    topLeft.row = activeCell.topLeft.row;\n                    scrollInto = bottomRight;\n                    break;\n                case 'last':\n                    bottomRight.row = rows.lastVisible();\n                    bottomRight.col = columns.lastVisible();\n                    topLeft = activeCell.topLeft;\n                    scrollInto = bottomRight;\n                    break;\n                case 'first':\n                    topLeft.row = rows.firstVisible();\n                    topLeft.col = columns.firstVisible();\n                    bottomRight = activeCell.bottomRight;\n                    scrollInto = topLeft;\n                    break;\n                }\n                var newSelection = new RangeRef(topLeft, bottomRight);\n                if (!this.union(newSelection).intersects(activeCell)) {\n                    this.modifySelection(direction.replace('shrink', 'expand'));\n                    return;\n                }\n                if (scrollInto) {\n                    sheet.focus(scrollInto);\n                }\n                this.updateCurrentSelectionRange(newSelection);\n            },\n            moveActiveCell: function (direction) {\n                var sheet = this._sheet;\n                var activeCell = sheet.activeCell();\n                var topLeft = activeCell.topLeft;\n                var bottomRight = activeCell.bottomRight;\n                var cell = sheet.originalActiveCell();\n                var rows = sheet._grid._rows;\n                var columns = sheet._grid._columns;\n                var row = cell.row;\n                var column = cell.col;\n                switch (direction) {\n                case 'left':\n                    column = columns.prevVisible(topLeft.col);\n                    break;\n                case 'up':\n                    row = rows.prevVisible(topLeft.row);\n                    break;\n                case 'right':\n                    column = columns.nextVisible(bottomRight.col);\n                    break;\n                case 'down':\n                    row = rows.nextVisible(bottomRight.row);\n                    break;\n                case 'first-col':\n                    column = columns.firstVisible();\n                    break;\n                case 'last-col':\n                    column = columns.lastVisible();\n                    break;\n                case 'first-row':\n                    row = rows.firstVisible();\n                    break;\n                case 'last-row':\n                    row = rows.lastVisible();\n                    break;\n                case 'last':\n                    row = rows.lastVisible();\n                    column = columns.lastVisible();\n                    break;\n                case 'first':\n                    row = rows.firstVisible();\n                    column = columns.firstVisible();\n                    break;\n                case 'next-page':\n                    row = rows.nextPage(bottomRight.row, this._viewPortHeight);\n                    break;\n                case 'prev-page':\n                    row = rows.prevPage(bottomRight.row, this._viewPortHeight);\n                    break;\n                }\n                sheet.select(new CellRef(row, column));\n            },\n            navigateInSelection: function (direction) {\n                var sheet = this._sheet;\n                var activeCell = sheet.activeCell();\n                var topLeft = activeCell.topLeft;\n                var cell = sheet.originalActiveCell();\n                var rows = sheet._grid._rows;\n                var columns = sheet._grid._columns;\n                var row = cell.row;\n                var column = cell.col;\n                var selection = sheet.currentNavigationRange();\n                var selTopLeft = selection.topLeft;\n                var selBottomRight = selection.bottomRight;\n                var done = false;\n                var topLeftCol = topLeft.col;\n                var topLeftRow = topLeft.row;\n                while (!done) {\n                    var current = new CellRef(row, column);\n                    switch (direction) {\n                    case 'next':\n                        if (selBottomRight.eq(current)) {\n                            selection = sheet.nextNavigationRange();\n                            row = selection.topLeft.row;\n                            column = selection.topLeft.col;\n                        } else {\n                            column = columns.nextVisible(topLeftCol, true);\n                            if (column > selBottomRight.col) {\n                                column = selTopLeft.col;\n                                row = rows.nextVisible(row, true);\n                            }\n                        }\n                        break;\n                    case 'previous':\n                        if (selTopLeft.eq(current)) {\n                            selection = sheet.previousNavigationRange();\n                            row = selection.bottomRight.row;\n                            column = selection.bottomRight.col;\n                        } else {\n                            column = columns.prevVisible(topLeftCol, true);\n                            if (column < selTopLeft.col) {\n                                column = selBottomRight.col;\n                                row = rows.prevVisible(row, true);\n                            }\n                        }\n                        break;\n                    case 'lower':\n                        if (selBottomRight.eq(current)) {\n                            selection = sheet.nextNavigationRange();\n                            row = selection.topLeft.row;\n                            column = selection.topLeft.col;\n                        } else {\n                            row = rows.nextVisible(topLeftRow, true);\n                            if (row > selBottomRight.row) {\n                                row = selTopLeft.row;\n                                column = columns.nextVisible(column, true);\n                            }\n                        }\n                        break;\n                    case 'upper':\n                        if (selTopLeft.eq(current)) {\n                            selection = sheet.previousNavigationRange();\n                            row = selection.bottomRight.row;\n                            column = selection.bottomRight.col;\n                        } else {\n                            row = rows.prevVisible(topLeftRow, true);\n                            if (row < selTopLeft.row) {\n                                row = selBottomRight.row;\n                                column = columns.prevVisible(column, true);\n                            }\n                        }\n                        break;\n                    default:\n                        throw new Error('Unknown entry navigation: ' + direction);\n                    }\n                    done = !this.shouldSkip(row, column);\n                    topLeftCol = column;\n                    topLeftRow = row;\n                }\n                if (sheet.singleCellSelection()) {\n                    sheet.select(new CellRef(row, column));\n                } else {\n                    sheet.activeCell(new CellRef(row, column));\n                }\n            },\n            extendSelection: function (ref, mode) {\n                var sheet = this._sheet;\n                var grid = sheet._grid;\n                if (mode === 'autofill') {\n                    this.resizeAutoFill(ref);\n                    return;\n                }\n                if (mode === 'range') {\n                    ref = grid.normalize(ref);\n                } else if (mode === 'row') {\n                    ref = grid.rowRef(ref.row).bottomRight;\n                } else if (mode === 'column') {\n                    ref = grid.colRef(ref.col).bottomRight;\n                }\n                var activeCell = sheet.originalActiveCell().toRangeRef();\n                this.updateCurrentSelectionRange(new RangeRef(activeCell.topLeft, ref));\n            },\n            shouldSkip: function (row, col) {\n                var ref = new CellRef(row, col);\n                var isMerged = false;\n                this._sheet.forEachMergedCell(function (merged) {\n                    if (merged.intersects(ref) && !merged.collapse().eq(ref)) {\n                        isMerged = true;\n                    }\n                });\n                return isMerged;\n            },\n            resizeAutoFill: function (ref) {\n                var sheet = this._sheet;\n                var selection = sheet.select();\n                var origin = sheet._autoFillOrigin;\n                var dest = this.autoFillCalculator.autoFillDest(selection, ref);\n                var punch = this.punch(selection, dest);\n                var hint, direction, row;\n                if (!punch) {\n                    var preview = sheet.range(dest)._previewFillFrom(sheet.range(origin));\n                    if (preview) {\n                        direction = preview.direction;\n                        var props = preview.props;\n                        if (direction === 0 || direction == 1) {\n                            row = props[props.length - 1];\n                            hint = row[row.length - 1].value;\n                        } else if (direction === 2) {\n                            row = props[0];\n                            hint = row[row.length - 1].value;\n                        } else if (direction === 3) {\n                            row = props[props.length - 1];\n                            hint = row[0].value;\n                        }\n                    }\n                }\n                sheet.updateAutoFill(dest, punch, hint, direction);\n            },\n            determineDirection: function (action) {\n                var selection = this._sheet.currentSelectionRange();\n                var activeCell = this._sheet.activeCell();\n                var leftMode = activeCell.topLeft.col == selection.topLeft.col;\n                var rightMode = activeCell.bottomRight.col == selection.bottomRight.col;\n                var topMode = activeCell.topLeft.row == selection.topLeft.row;\n                var bottomMode = activeCell.bottomRight.row == selection.bottomRight.row;\n                switch (action) {\n                case 'left':\n                    action = rightMode ? 'expand-left' : 'shrink-left';\n                    break;\n                case 'right':\n                    action = leftMode ? 'expand-right' : 'shrink-right';\n                    break;\n                case 'up':\n                    action = bottomMode ? 'expand-up' : 'shrink-up';\n                    break;\n                case 'down':\n                    action = topMode ? 'expand-down' : 'shrink-down';\n                    break;\n                case 'prev-page':\n                    action = bottomMode ? 'expand-page-up' : 'shrink-page-up';\n                    break;\n                case 'next-page':\n                    action = topMode ? 'expand-page-down' : 'shrink-page-down';\n                    break;\n                }\n                return action;\n            },\n            updateCurrentSelectionRange: function (ref) {\n                var sheet = this._sheet;\n                sheet.select(sheet.originalSelect().replaceAt(sheet.selectionRangeIndex(), ref), false);\n            },\n            punch: function (selection, subset) {\n                var punch;\n                if (subset.topLeft.eq(selection.topLeft)) {\n                    if (subset.bottomRight.row < selection.bottomRight.row) {\n                        var bottomRow = this.rowEdge.nextRight(subset.bottomRight.row);\n                        punch = new RangeRef(new CellRef(bottomRow, selection.topLeft.col), selection.bottomRight);\n                    } else if (subset.bottomRight.col < selection.bottomRight.col) {\n                        var bottomCol = this.colEdge.nextRight(subset.bottomRight.col);\n                        punch = new RangeRef(new CellRef(selection.topLeft.row, bottomCol), selection.bottomRight);\n                    }\n                }\n                return punch;\n            }\n        });\n        kendo.spreadsheet.SheetNavigator = SheetNavigator;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/axismanager', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var AxisManager = kendo.Class.extend({\n            init: function (sheet) {\n                this._sheet = sheet;\n            },\n            forEachSelectedColumn: function (callback) {\n                var sheet = this._sheet;\n                sheet.batch(function () {\n                    sheet.select().forEachColumnIndex(function (index, i) {\n                        callback(sheet, index, i);\n                    });\n                }, {\n                    layout: true,\n                    recalc: true\n                });\n            },\n            forEachSelectedRow: function (callback) {\n                var sheet = this._sheet;\n                sheet.batch(function () {\n                    sheet.select().forEachRowIndex(function (index, i) {\n                        callback(sheet, index, i);\n                    });\n                }, {\n                    layout: true,\n                    recalc: true\n                });\n            },\n            includesHiddenColumns: function (ref) {\n                return this._sheet._grid._columns.includesHidden(ref.topLeft.col, ref.bottomRight.col);\n            },\n            includesHiddenRows: function (ref) {\n                return this._sheet._grid._rows.includesHidden(ref.topLeft.row, ref.bottomRight.row);\n            },\n            selectionIncludesHiddenColumns: function () {\n                return this.includesHiddenColumns(this._sheet.select());\n            },\n            selectionIncludesHiddenRows: function () {\n                return this.includesHiddenRows(this._sheet.select());\n            },\n            deleteSelectedColumns: function () {\n                this.forEachSelectedColumn(function (sheet, index, i) {\n                    sheet.deleteColumn(index - i);\n                });\n            },\n            deleteSelectedRows: function () {\n                this.forEachSelectedRow(function (sheet, index, i) {\n                    sheet.deleteRow(index - i);\n                });\n            },\n            hideSelectedColumns: function () {\n                this.forEachSelectedColumn(function (sheet, index) {\n                    sheet.hideColumn(index);\n                });\n            },\n            hideSelectedRows: function () {\n                this.forEachSelectedRow(function (sheet, index) {\n                    sheet.hideRow(index);\n                });\n            },\n            unhideSelectedColumns: function () {\n                this.forEachSelectedColumn(function (sheet, index) {\n                    sheet.unhideColumn(index);\n                });\n            },\n            unhideSelectedRows: function () {\n                this.forEachSelectedRow(function (sheet, index) {\n                    sheet.unhideRow(index);\n                });\n            },\n            addColumnLeft: function () {\n                this.forEachSelectedColumn(function (sheet, index, i) {\n                    sheet.insertColumn(index - i);\n                });\n            },\n            addColumnRight: function () {\n                this.forEachSelectedColumn(function (sheet, index, i) {\n                    sheet.insertColumn(index + (i + 1));\n                });\n            },\n            canAddRow: function () {\n                var range = this._sheet.select().toRangeRef();\n                var rowCount = range.height();\n                return this._sheet.canInsertRow(0, rowCount);\n            },\n            addRowAbove: function () {\n                this.forEachSelectedRow(function (sheet, index, i) {\n                    sheet.insertRow(index - i);\n                });\n            },\n            addRowBelow: function () {\n                this.forEachSelectedRow(function (sheet, index, i) {\n                    sheet.insertRow(index + (i + 1));\n                });\n            }\n        });\n        kendo.spreadsheet.AxisManager = AxisManager;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/clipboard', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var Clipboard = kendo.Class.extend({\n            init: function (workbook) {\n                this.workbook = workbook;\n                this.origin = kendo.spreadsheet.NULLREF;\n                this.iframe = document.createElement('iframe');\n                this.iframe.className = 'k-spreadsheet-clipboard-paste';\n                this.menuInvoked = true;\n                this._external = {};\n                this._uid = kendo.guid();\n                document.body.appendChild(this.iframe);\n            },\n            canCopy: function () {\n                var status = { canCopy: true };\n                var selection = this.workbook.activeSheet().select();\n                if (selection === kendo.spreadsheet.NULLREF) {\n                    status.canCopy = false;\n                }\n                if (selection instanceof kendo.spreadsheet.UnionRef) {\n                    status.canCopy = false;\n                    status.multiSelection = true;\n                }\n                if (this.menuInvoked) {\n                    status.canCopy = false;\n                    status.menuInvoked = true;\n                }\n                return status;\n            },\n            canPaste: function () {\n                var sheet = this.workbook.activeSheet();\n                var ref = this.pasteRef();\n                var status = { canPaste: true };\n                if (ref === kendo.spreadsheet.NULLREF) {\n                    var external = this._external.hasOwnProperty('html') || this._external.hasOwnProperty('plain');\n                    status.pasteOnMerged = this.intersectsMerged();\n                    status.canPaste = status.pasteOnMerged ? false : external;\n                    return status;\n                }\n                if (!ref.eq(sheet.unionWithMerged(ref))) {\n                    status.canPaste = false;\n                    status.pasteOnMerged = true;\n                }\n                if (this.menuInvoked) {\n                    status.canPaste = false;\n                    status.menuInvoked = true;\n                }\n                if (ref.bottomRight.row >= sheet._rows._count || ref.bottomRight.col >= sheet._columns._count) {\n                    status.canPaste = false;\n                    status.overflow = true;\n                }\n                return status;\n            },\n            intersectsMerged: function () {\n                var sheet = this.workbook.activeSheet();\n                var state = this.parse(this._external);\n                this.origin = this.stateRangeRef(state);\n                var ref = this.pasteRef();\n                return !ref.eq(sheet.unionWithMerged(ref));\n            },\n            copy: function () {\n                var sheet = this.workbook.activeSheet();\n                this.origin = sheet.select();\n                this.contents = sheet.selection().getState();\n            },\n            cut: function () {\n                var sheet = this.workbook.activeSheet();\n                this.copy();\n                sheet.range(sheet.select()).clear();\n            },\n            pasteRef: function () {\n                var sheet = this.workbook.activeSheet();\n                var destination = sheet.activeCell().first();\n                var originActiveCell = this.origin.first();\n                var rowDelta = originActiveCell.row - destination.row;\n                var colDelta = originActiveCell.col - destination.col;\n                return this.origin.relative(rowDelta, colDelta, 3);\n            },\n            stateRangeRef: function (state) {\n                var rows = [];\n                var cols = [];\n                for (var key in state) {\n                    if (key === 'mergedCells' || key === 'ref') {\n                        continue;\n                    }\n                    var address = key.split(',');\n                    rows.push(address[0]);\n                    cols.push(address[1]);\n                }\n                var topLeft = new CellRef(Math.min.apply(null, rows), Math.min.apply(null, cols));\n                var bottomRight = new CellRef(Math.max.apply(null, rows), Math.max.apply(null, cols));\n                return new RangeRef(topLeft, bottomRight);\n            },\n            destroy: function () {\n                document.body.removeChild(this.iframe);\n            },\n            paste: function () {\n                var state = {};\n                var sheet = this.workbook.activeSheet();\n                if (this._isInternal()) {\n                    state = this.contents;\n                } else {\n                    state = this.parse(this._external);\n                    this.origin = this.stateRangeRef(state);\n                }\n                var pasteRef = this.pasteRef();\n                sheet.range(pasteRef).clear().setState(state);\n                sheet.triggerChange({\n                    recalc: true,\n                    ref: pasteRef\n                });\n            },\n            external: function (data) {\n                if (data.html || data.plain) {\n                    this._external = data;\n                } else {\n                    return this._external;\n                }\n            },\n            parse: function (data) {\n                var state = {\n                    ref: new CellRef(0, 0, 0),\n                    mergedCells: []\n                };\n                if (data.html) {\n                    var doc = this.iframe.contentWindow.document;\n                    doc.open();\n                    doc.write(data.html);\n                    doc.close();\n                    var table = $(doc).find('table:first');\n                    if (table.length) {\n                        state = this._parseHTML(table.find('tbody:first'));\n                    } else {\n                        if (!data.plain) {\n                            var element = $(doc.body).find(':not(style)');\n                            state['0,0'] = this._cellState(element.text());\n                        } else {\n                            state = this._parseTSV(data.plain);\n                        }\n                    }\n                } else {\n                    state = this._parseTSV(data.plain);\n                }\n                return state;\n            },\n            _parseHTML: function (tbody) {\n                var that = this;\n                var state = {\n                    ref: new CellRef(0, 0, 0),\n                    mergedCells: []\n                };\n                tbody.find('tr').each(function (rowIndex, tr) {\n                    $(tr).find('td').each(function (colIndex, td) {\n                        var rowspan = parseInt($(td).attr('rowspan'), 10) - 1 || 0;\n                        var colspan = parseInt($(td).attr('colspan'), 10) - 1 || 0;\n                        var blankCell = '<td/>';\n                        var ci;\n                        if (rowspan) {\n                            var endRow = rowIndex + rowspan;\n                            for (var ri = rowIndex; ri <= endRow; ri++) {\n                                var row = tbody.find('tr').eq(ri);\n                                if (ri > rowIndex) {\n                                    blankCell = '<td class=\\'rowspan\\'></td>';\n                                    if (colIndex === 0) {\n                                        row.find('td').eq(colIndex).after(blankCell);\n                                    } else {\n                                        var last = Math.min(row.find('td').length, colIndex);\n                                        row.find('td').eq(last - 1).after(blankCell);\n                                    }\n                                }\n                                if (colspan) {\n                                    for (ci = colIndex; ci < colspan + colIndex; ci++) {\n                                        blankCell = '<td class=\\'rowspan colspan\\'></td>';\n                                        row.find('td').eq(ci).after(blankCell);\n                                    }\n                                }\n                            }\n                        } else {\n                            if (colspan) {\n                                for (ci = colIndex; ci < colspan + colIndex; ci++) {\n                                    blankCell = '<td class=\\'colspan\\'></td>';\n                                    $(tr).find('td').eq(ci).after(blankCell);\n                                }\n                            }\n                        }\n                    });\n                });\n                tbody.find('tr').each(function (rowIndex, tr) {\n                    $(tr).find('td').each(function (colIndex, td) {\n                        var key = rowIndex + ',' + colIndex;\n                        var rowspan = parseInt($(td).attr('rowspan'), 10) - 1 || 0;\n                        var colspan = parseInt($(td).attr('colspan'), 10) - 1 || 0;\n                        var cellState = that._cellState($(td));\n                        state[key] = cellState;\n                        if (rowspan || colspan) {\n                            var startCol = String.fromCharCode(65 + colIndex);\n                            var endCol = String.fromCharCode(65 + colIndex + colspan);\n                            var address = startCol + (rowIndex + 1) + ':' + endCol + (rowIndex + 1 + rowspan);\n                            state.mergedCells.push(address);\n                        }\n                    });\n                });\n                return state;\n            },\n            _parseTSV: function (data) {\n                var state = {\n                    ref: new CellRef(0, 0, 0),\n                    mergedCells: []\n                };\n                if (data.indexOf('\\t') === -1 && data.indexOf('\\n') == -1) {\n                    state['0,0'] = { value: data };\n                } else {\n                    var rows = data.split('\\n');\n                    for (var ri = 0; ri < rows.length; ri++) {\n                        var cols = rows[ri].split('\\t');\n                        for (var ci = 0; ci < cols.length; ci++) {\n                            state[ri + ',' + ci] = { value: cols[ci] };\n                        }\n                    }\n                }\n                return state;\n            },\n            _isInternal: function () {\n                if (this._external.html === undefined) {\n                    return true;\n                }\n                var internalHTML = $('<div/>').html(this._external.html).find('table.kendo-clipboard-' + this._uid).length ? true : false;\n                var internalPlain = $('<div/>').html(this._external.plain).find('table.kendo-clipboard-' + this._uid).length ? true : false;\n                if (internalHTML || internalPlain) {\n                    return true;\n                }\n                return false;\n            },\n            _cellState: function (element) {\n                var styles = window.getComputedStyle(element[0]);\n                var text = element.text();\n                var borders = this._borderObject(styles);\n                var state = {\n                    value: text === '' ? null : text,\n                    borderBottom: borders.borderBottom,\n                    borderRight: borders.borderRight,\n                    borderLeft: borders.borderLeft,\n                    borderTop: borders.borderTop,\n                    fontSize: parseInt(styles['font-size'], 10)\n                };\n                if (styles['background-color'] !== 'rgb(0, 0, 0)' && styles['background-color'] !== 'rgba(0, 0, 0, 0)') {\n                    state.background = styles['background-color'];\n                }\n                if (styles.color !== 'rgb(0, 0, 0)' && styles.color !== 'rgba(0, 0, 0, 0)') {\n                    state.color = styles.color;\n                }\n                if (styles['text-decoration'] == 'underline') {\n                    state.underline = true;\n                }\n                if (styles['font-style'] == 'italic') {\n                    state.italic = true;\n                }\n                if (styles['font-weight'] == 'bold') {\n                    state.bold = true;\n                }\n                if (this._strippedStyle(styles['text-align']) !== 'right') {\n                    state.textAlign = this._strippedStyle(styles['text-align']);\n                }\n                if (styles['vertical-align'] !== 'middle') {\n                    state.verticalAlign = styles['vertical-align'];\n                }\n                if (styles['word-wrap'] !== 'normal') {\n                    state.wrap = true;\n                }\n                return state;\n            },\n            _strippedStyle: function (style) {\n                var prefixes = [\n                    '-ms-',\n                    '-moz-',\n                    '-webkit-'\n                ];\n                prefixes.forEach(function (prefix) {\n                    style = style.replace(prefix, '');\n                });\n                return style;\n            },\n            _borderObject: function (styles) {\n                var borderObject = {};\n                var borders = [\n                    'borderBottom',\n                    'borderRight',\n                    'borderLeft',\n                    'borderTop'\n                ];\n                borders.forEach(function (key) {\n                    if (styles[key + 'Style'] == 'none') {\n                        borderObject[key] = null;\n                        return;\n                    }\n                    borderObject[key] = {\n                        size: 1,\n                        color: styles[key + 'Color']\n                    };\n                });\n                return borderObject;\n            }\n        });\n        kendo.spreadsheet.Clipboard = Clipboard;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/range', [\n        'kendo.core',\n        'util/text-metrics'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var UnionRef = kendo.spreadsheet.UnionRef;\n        var styles = [\n            'color',\n            'fontFamily',\n            'underline',\n            'italic',\n            'bold',\n            'textAlign',\n            'verticalAlign',\n            'background'\n        ];\n        var borders = {\n            borderTop: {\n                complement: 'borderBottom',\n                direction: {\n                    top: -1,\n                    bottom: -1\n                }\n            },\n            borderLeft: {\n                complement: 'borderRight',\n                direction: {\n                    left: -1,\n                    right: -1\n                }\n            },\n            borderRight: {\n                complement: 'borderLeft',\n                direction: {\n                    left: 1,\n                    right: 1\n                }\n            },\n            borderBottom: {\n                complement: 'borderTop',\n                direction: {\n                    top: 1,\n                    bottom: 1\n                }\n            }\n        };\n        var Range = kendo.Class.extend({\n            init: function (ref, sheet) {\n                this._sheet = sheet;\n                this._ref = ref;\n            },\n            _normalize: function (ref) {\n                return this._sheet._grid.normalize(ref);\n            },\n            _set: function (name, value, noTrigger) {\n                var sheet = this._sheet;\n                this._ref.forEach(function (ref) {\n                    sheet._set(ref.toRangeRef(), name, value);\n                });\n                if (!noTrigger) {\n                    sheet.triggerChange({\n                        recalc: name == 'formula' || name == 'value' || name == 'validation',\n                        value: value,\n                        ref: this._ref\n                    });\n                }\n                return this;\n            },\n            _get: function (name) {\n                return this._sheet._get(this._ref.toRangeRef(), name);\n            },\n            _property: function (name, value) {\n                if (value === undefined) {\n                    return this._get(name);\n                } else {\n                    return this._set(name, value);\n                }\n            },\n            value: function (value) {\n                if (value !== undefined) {\n                    this._set('formula', null, true);\n                }\n                return this._property('value', value);\n            },\n            resize: function (direction) {\n                var ref = this._resizedRef(direction);\n                return new Range(ref, this._sheet);\n            },\n            _resizedRef: function (direction) {\n                return this._ref.map(function (ref) {\n                    return ref.toRangeRef().resize(direction);\n                });\n            },\n            _border: function (property, value) {\n                var result;\n                var complement = borders[property].complement;\n                var direction = borders[property].direction;\n                var sheet = this._sheet;\n                sheet.batch(function () {\n                    result = this._property(property, value);\n                    if (value !== undefined) {\n                        this._resizedRef(direction).forEach(function (ref) {\n                            if (ref !== kendo.spreadsheet.NULLREF) {\n                                new Range(ref, sheet)._property(complement, null);\n                            }\n                        });\n                    }\n                }.bind(this), {});\n                return result;\n            },\n            _collapsedBorder: function (property) {\n                var result = this._property(property);\n                var complement = borders[property].complement;\n                var direction = borders[property].direction;\n                this._resizedRef(direction).forEach(function (ref) {\n                    if (!result && ref !== kendo.spreadsheet.NULLREF) {\n                        var range = new Range(ref, this._sheet);\n                        result = range._property(complement);\n                    }\n                }.bind(this));\n                return result;\n            },\n            borderTop: function (value) {\n                return this._border('borderTop', value);\n            },\n            borderRight: function (value) {\n                return this._border('borderRight', value);\n            },\n            borderBottom: function (value) {\n                return this._border('borderBottom', value);\n            },\n            borderLeft: function (value) {\n                return this._border('borderLeft', value);\n            },\n            collapsedBorderTop: function () {\n                return this._collapsedBorder('borderTop');\n            },\n            collapsedBorderRight: function () {\n                return this._collapsedBorder('borderRight');\n            },\n            collapsedBorderBottom: function () {\n                return this._collapsedBorder('borderBottom');\n            },\n            collapsedBorderLeft: function () {\n                return this._collapsedBorder('borderLeft');\n            },\n            input: function (value) {\n                var existingFormat = this._get('format'), x;\n                if (value !== undefined) {\n                    var tl = this._ref.toRangeRef().topLeft;\n                    x = kendo.spreadsheet.calc.parse(this._sheet.name(), tl.row, tl.col, value);\n                    this._sheet.batch(function () {\n                        var formula = null;\n                        if (x.type == 'exp') {\n                            formula = kendo.spreadsheet.calc.compile(x);\n                        } else if (x.type == 'date') {\n                            this.format(x.format || toExcelFormat(kendo.culture().calendar.patterns.d));\n                        } else if (x.type == 'percent') {\n                            this.format(x.value * 100 == (x.value * 100 | 0) ? '0%' : '0.00%');\n                        } else if (x.format && !existingFormat) {\n                            this.format(x.format);\n                        }\n                        this.formula(formula);\n                        if (!formula) {\n                            this.value(x.value);\n                        }\n                    }.bind(this), {\n                        recalc: true,\n                        value: value,\n                        ref: this._ref,\n                        editorChange: this._sheet.isInEditMode()\n                    });\n                    return this;\n                } else {\n                    value = this._get('value');\n                    var formula = this._get('formula');\n                    var type = existingFormat && !formula && kendo.spreadsheet.formatting.type(value, existingFormat);\n                    if (formula) {\n                        value = '=' + formula;\n                    } else\n                        OUT: {\n                            if (existingFormat && typeof value == 'number') {\n                                var t1 = kendo.spreadsheet.formatting.text(value, existingFormat);\n                                x = kendo.spreadsheet.calc.parse(null, null, null, t1);\n                                var t2 = kendo.spreadsheet.formatting.text(x.value, existingFormat);\n                                if (t1 == t2) {\n                                    value = t1;\n                                    break OUT;\n                                }\n                            }\n                            if (type === 'date') {\n                                value = kendo.toString(kendo.spreadsheet.numberToDate(value), kendo.culture().calendar.patterns.d);\n                            } else if (type === 'percent') {\n                                value = value * 100 + '%';\n                            } else if (typeof value == 'string' && (/^[=']/.test(value) || /^(?:true|false)$/i.test(value) || looksLikeANumber(value))) {\n                                value = '\\'' + value;\n                            }\n                        }\n                    return value;\n                }\n            },\n            enable: function (value) {\n                if (value === undefined) {\n                    value = true;\n                    this._sheet.forEach(this._ref.toRangeRef(), function (_, _, data) {\n                        if (data.enable === false) {\n                            value = false;\n                        }\n                    });\n                    return value;\n                }\n                this._property('enable', value);\n            },\n            format: function (value) {\n                return this._property('format', value);\n            },\n            formula: function (value) {\n                if (value === undefined) {\n                    var f = this._get('formula');\n                    return f ? '' + f : null;\n                }\n                return this._property('formula', value);\n            },\n            validation: function (value) {\n                if (value === undefined) {\n                    var f = this._get('validation');\n                    return f ? f.toJSON() : null;\n                }\n                return this._property('validation', value);\n            },\n            _getValidationState: function () {\n                var ref = this._ref.toRangeRef();\n                var topLeftRow = ref.topLeft.row;\n                var topLeftCol = ref.topLeft.col;\n                var bottomRightRow = ref.bottomRight.row;\n                var bottomRightCol = ref.bottomRight.col;\n                var ci, ri;\n                for (ci = topLeftCol; ci <= bottomRightCol; ci++) {\n                    for (ri = topLeftRow; ri <= bottomRightRow; ri++) {\n                        var validation = this._sheet._validation(ri, ci);\n                        if (validation && validation.type === 'reject' && validation.value === false) {\n                            return validation;\n                        }\n                    }\n                }\n                return false;\n            },\n            merge: function () {\n                this._ref = this._sheet._merge(this._ref);\n                return this;\n            },\n            unmerge: function () {\n                var mergedCells = this._sheet._mergedCells;\n                this._ref.forEach(function (ref) {\n                    ref.toRangeRef().intersecting(mergedCells).forEach(function (mergedRef) {\n                        mergedCells.splice(mergedCells.indexOf(mergedRef), 1);\n                    });\n                });\n                this._sheet.triggerChange({});\n                return this;\n            },\n            select: function () {\n                this._sheet.select(this._ref);\n                return this;\n            },\n            values: function (values) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error('Unsupported for multiple ranges.');\n                }\n                if (this._ref === kendo.spreadsheet.NULLREF) {\n                    if (values !== undefined) {\n                        throw new Error('Unsupported for NULLREF.');\n                    } else {\n                        return [];\n                    }\n                }\n                var ref = this._ref.toRangeRef();\n                var topLeftRow = ref.topLeft.row;\n                var topLeftCol = ref.topLeft.col;\n                var bottomRightRow = ref.bottomRight.row;\n                var bottomRightCol = ref.bottomRight.col;\n                var ci, ri;\n                if (values === undefined) {\n                    values = new Array(ref.height());\n                    for (var vi = 0; vi < values.length; vi++) {\n                        values[vi] = new Array(ref.width());\n                    }\n                    for (ci = topLeftCol; ci <= bottomRightCol; ci++) {\n                        for (ri = topLeftRow; ri <= bottomRightRow; ri++) {\n                            values[ri - topLeftRow][ci - topLeftCol] = this._sheet._value(ri, ci);\n                        }\n                    }\n                    return values;\n                } else {\n                    for (ci = topLeftCol; ci <= bottomRightCol; ci++) {\n                        for (ri = topLeftRow; ri <= bottomRightRow; ri++) {\n                            var row = values[ri - topLeftRow];\n                            if (row) {\n                                var value = row[ci - topLeftCol];\n                                if (value !== undefined) {\n                                    this._sheet._value(ri, ci, value);\n                                }\n                            }\n                        }\n                    }\n                    this._sheet.triggerChange({ recalc: true });\n                    return this;\n                }\n            },\n            _properties: function (props) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error('Unsupported for multiple ranges.');\n                }\n                if (this._ref === kendo.spreadsheet.NULLREF) {\n                    if (props !== undefined) {\n                        throw new Error('Unsupported for NULLREF.');\n                    } else {\n                        return [];\n                    }\n                }\n                var ref = this._ref.toRangeRef();\n                var topLeftRow = ref.topLeft.row;\n                var topLeftCol = ref.topLeft.col;\n                var bottomRightRow = ref.bottomRight.row;\n                var bottomRightCol = ref.bottomRight.col;\n                var ci, ri;\n                var sheet = this._sheet;\n                if (props === undefined) {\n                    props = new Array(ref.height());\n                    sheet.forEach(ref, function (row, col, data) {\n                        row -= topLeftRow;\n                        col -= topLeftCol;\n                        var line = props[row] || (props[row] = []);\n                        line[col] = data;\n                    });\n                    return props;\n                } else {\n                    var data;\n                    ref = ref.clone();\n                    var setProp = function (propName) {\n                        var propValue = data[propName];\n                        ref.topLeft.row = ref.bottomRight.row = ri;\n                        ref.topLeft.col = ref.bottomRight.col = ci;\n                        sheet._set(ref, propName, propValue);\n                    };\n                    for (ci = topLeftCol; ci <= bottomRightCol; ci++) {\n                        for (ri = topLeftRow; ri <= bottomRightRow; ri++) {\n                            var row = props[ri - topLeftRow];\n                            if (row) {\n                                data = row[ci - topLeftCol];\n                                if (data) {\n                                    Object.keys(data).forEach(setProp);\n                                }\n                            }\n                        }\n                    }\n                    sheet.triggerChange({\n                        recalc: true,\n                        ref: this._ref\n                    });\n                    return this;\n                }\n            },\n            clear: function (options) {\n                var clearAll = !options || !Object.keys(options).length;\n                var sheet = this._sheet;\n                var reason = {\n                    recalc: clearAll || options && options.contentsOnly === true,\n                    ref: this._ref\n                };\n                sheet.batch(function () {\n                    if (reason.recalc) {\n                        this.formula(null);\n                    }\n                    if (clearAll) {\n                        this.validation(null);\n                    }\n                    if (clearAll || options && options.formatOnly === true) {\n                        styles.forEach(function (x) {\n                            this[x](null);\n                        }.bind(this));\n                        this.format(null);\n                        this.unmerge();\n                    }\n                }.bind(this), reason);\n                return this;\n            },\n            clearContent: function () {\n                return this.clear({ contentsOnly: true });\n            },\n            clearFormat: function () {\n                return this.clear({ formatOnly: true });\n            },\n            isSortable: function () {\n                return !(this._ref instanceof UnionRef || this._ref === kendo.spreadsheet.NULLREF);\n            },\n            sort: function (spec) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error('Unsupported for multiple ranges.');\n                }\n                if (this._ref === kendo.spreadsheet.NULLREF) {\n                    throw new Error('Unsupported for NULLREF.');\n                }\n                if (spec === undefined) {\n                    spec = { column: 0 };\n                }\n                spec = spec instanceof Array ? spec : [spec];\n                this._sheet._sortBy(this._ref.toRangeRef(), spec.map(function (spec, index) {\n                    if (typeof spec === 'number') {\n                        spec = { column: spec };\n                    }\n                    return {\n                        index: spec.column === undefined ? index : spec.column,\n                        ascending: spec.ascending === undefined ? true : spec.ascending\n                    };\n                }));\n                return this;\n            },\n            isFilterable: function () {\n                return !(this._ref instanceof UnionRef);\n            },\n            filter: function (spec) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error('Unsupported for multiple ranges.');\n                }\n                if (spec === false) {\n                    this.clearFilters();\n                } else {\n                    spec = spec === true ? [] : spec instanceof Array ? spec : [spec];\n                    this._sheet._filterBy(this._ref.toRangeRef(), spec.map(function (spec, index) {\n                        return {\n                            index: spec.column === undefined ? index : spec.column,\n                            filter: spec.filter\n                        };\n                    }));\n                }\n                return this;\n            },\n            clearFilter: function (spec) {\n                this._sheet.clearFilter(spec);\n            },\n            clearFilters: function () {\n                var filter = this._sheet.filter();\n                var spec = [];\n                if (filter) {\n                    for (var i = 0; i < filter.columns.length; i++) {\n                        spec.push(i);\n                    }\n                    this._sheet.batch(function () {\n                        this.clearFilter(spec);\n                        this._filter = null;\n                    }, {\n                        layout: true,\n                        filter: true\n                    });\n                }\n            },\n            hasFilter: function () {\n                var filter = this._sheet.filter();\n                return !!filter;\n            },\n            leftColumn: function () {\n                return new Range(this._ref.leftColumn(), this._sheet);\n            },\n            rightColumn: function () {\n                return new Range(this._ref.rightColumn(), this._sheet);\n            },\n            topRow: function () {\n                return new Range(this._ref.topRow(), this._sheet);\n            },\n            bottomRow: function () {\n                return new Range(this._ref.bottomRow(), this._sheet);\n            },\n            column: function (column) {\n                return new Range(this._ref.toColumn(column), this._sheet);\n            },\n            row: function (row) {\n                return new Range(this._ref.toRow(row), this._sheet);\n            },\n            forEachRow: function (callback) {\n                this._ref.forEachRow(function (ref) {\n                    callback(new Range(ref, this._sheet));\n                }.bind(this));\n            },\n            forEachColumn: function (callback) {\n                this._ref.forEachColumn(function (ref) {\n                    callback(new Range(ref, this._sheet));\n                }.bind(this));\n            },\n            sheet: function () {\n                return this._sheet;\n            },\n            topLeft: function () {\n                return this._ref.toRangeRef().topLeft;\n            },\n            intersectingMerged: function () {\n                var sheet = this._sheet;\n                var mergedCells = [];\n                sheet._mergedCells.forEach(function (ref) {\n                    if (ref.intersects(this._ref)) {\n                        mergedCells.push(ref.toString());\n                    }\n                }.bind(this));\n                return mergedCells;\n            },\n            getState: function (propertyName) {\n                var state = { ref: this._ref.first() };\n                var properties;\n                if (!propertyName) {\n                    properties = kendo.spreadsheet.ALL_PROPERTIES;\n                    state.mergedCells = this.intersectingMerged();\n                } else if (propertyName === 'input') {\n                    properties = [\n                        'value',\n                        'formula'\n                    ];\n                } else if (propertyName === 'border') {\n                    properties = [\n                        'borderLeft',\n                        'borderTop',\n                        'borderRight',\n                        'borderBottom'\n                    ];\n                } else {\n                    properties = [propertyName];\n                }\n                this.forEachCell(function (row, col, cell) {\n                    var cellState = state[row + ',' + col] = {};\n                    properties.forEach(function (property) {\n                        cellState[property] = cell[property] || null;\n                    });\n                });\n                return state;\n            },\n            setState: function (state) {\n                var sheet = this._sheet;\n                var origin = this._ref.first();\n                var rowDelta = state.ref.row - origin.row;\n                var colDelta = state.ref.col - origin.col;\n                sheet.batch(function () {\n                    if (state.mergedCells) {\n                        this.unmerge();\n                    }\n                    this.forEachCell(function (row, col) {\n                        var cellState = state[row + rowDelta + ',' + (col + colDelta)];\n                        var range = sheet.range(row, col);\n                        for (var property in cellState) {\n                            if (property != 'value') {\n                                range._set(property, cellState[property]);\n                            }\n                        }\n                        if (!cellState.formula) {\n                            range._set('value', cellState.value);\n                        }\n                    });\n                    if (state.mergedCells) {\n                        state.mergedCells.forEach(function (merged) {\n                            merged = sheet._ref(merged).relative(rowDelta, colDelta, 3);\n                            sheet.range(merged).merge();\n                        }, this);\n                    }\n                }.bind(this), { recalc: true });\n            },\n            _adjustRowHeight: function () {\n                var sheet = this._sheet;\n                var state = this.getState();\n                var mergedCells = [];\n                for (var i = 0; i < state.mergedCells.length; i++) {\n                    mergedCells.push(sheet.range(state.mergedCells[i]));\n                }\n                this.forEachRow(function (row) {\n                    var maxHeight = row.sheet().rowHeight(row.topLeft().row);\n                    row.forEachCell(function (rowIndex, colIndex, cell) {\n                        var cellRange = sheet.range(rowIndex, colIndex);\n                        var totalWidth = 0;\n                        for (var i = 0; i < mergedCells.length; i++) {\n                            if (cellRange._ref.intersects(mergedCells[i]._ref)) {\n                                totalWidth += cell.width;\n                                break;\n                            }\n                        }\n                        var width = Math.max(sheet.columnWidth(colIndex), totalWidth);\n                        maxHeight = Math.max(maxHeight, kendo.spreadsheet.util.getTextHeight(cell.value, width, cell.fontSize, cell.wrap));\n                    });\n                    sheet.rowHeight(row.topLeft().row, Math.max(sheet.rowHeight(row.topLeft().row), maxHeight));\n                });\n            },\n            forEachCell: function (callback) {\n                this._ref.forEach(function (ref) {\n                    this._sheet.forEach(ref.toRangeRef(), callback.bind(this));\n                }.bind(this));\n            },\n            hasValue: function () {\n                var result = false;\n                this.forEachCell(function (row, col, cell) {\n                    if (Object.keys(cell).length !== 0) {\n                        result = true;\n                    }\n                });\n                return result;\n            },\n            wrap: function (flag) {\n                if (flag === undefined) {\n                    return !!this._property('wrap');\n                }\n                this.forEachRow(function (range) {\n                    var maxHeight = range.sheet().rowHeight(range.topLeft().row);\n                    range.forEachCell(function (row, col, cell) {\n                        var width = this._sheet.columnWidth(col);\n                        if (cell.value !== null && cell.value !== undefined) {\n                            maxHeight = Math.max(maxHeight, kendo.spreadsheet.util.getTextHeight(cell.value, width, cell.fontSize, true));\n                        }\n                    });\n                    range.sheet().rowHeight(range.topLeft().row, maxHeight);\n                }.bind(this));\n                this._property('wrap', flag);\n                return this;\n            },\n            fontSize: function (size) {\n                if (size === undefined) {\n                    return this._property('fontSize');\n                }\n                this.forEachRow(function (range) {\n                    var maxHeight = range.sheet().rowHeight(range.topLeft().row);\n                    range.forEachCell(function (row, col, cell) {\n                        var width = this._sheet.columnWidth(col);\n                        if (cell.value !== null && cell.value !== undefined) {\n                            maxHeight = Math.max(maxHeight, kendo.spreadsheet.util.getTextHeight(cell.value, width, size, cell.wrap));\n                        }\n                    });\n                    range.sheet().rowHeight(range.topLeft().row, maxHeight);\n                }.bind(this));\n                this._property('fontSize', size);\n                return this;\n            },\n            draw: function (options, callback) {\n                this._sheet.draw(this, options, callback);\n            }\n        });\n        $.each(styles, function (i, property) {\n            Range.prototype[property] = function (value) {\n                return this._property(property, value);\n            };\n        });\n        function toExcelFormat(format) {\n            return format.replace(/M/g, 'm').replace(/'/g, '\"').replace(/tt/, 'am/pm');\n        }\n        function looksLikeANumber(str) {\n            return !/^=/.test(str) && /number|percent/.test(kendo.spreadsheet.calc.parse(null, 0, 0, str).type);\n        }\n        var measureBox = $('<div style=\"position: absolute !important; top: -4000px !important; height: auto !important;' + 'padding: 1px !important; margin: 0 !important; border: 1px solid black !important;' + 'line-height: normal !important; visibility: hidden !important;' + 'white-space: pre-wrap !important; word-break: break-all !important;\" />')[0];\n        function getTextHeight(text, width, fontSize, wrap) {\n            var styles = {\n                'baselineMarkerSize': 0,\n                'width': width + 'px',\n                'font-size': (fontSize || 12) + 'px',\n                'word-break': wrap === true ? 'break-all' : 'normal',\n                'white-space': wrap === true ? 'pre-wrap' : 'pre'\n            };\n            return kendo.util.measureText(text, styles, measureBox).height;\n        }\n        kendo.spreadsheet.util = { getTextHeight: getTextHeight };\n        kendo.spreadsheet.Range = Range;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/runtime', ['spreadsheet/references'], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var calc = {};\n    var spreadsheet = kendo.spreadsheet;\n    spreadsheet.calc = calc;\n    var exports = calc.runtime = {};\n    var Class = kendo.Class;\n    var Ref = spreadsheet.Ref;\n    var CellRef = spreadsheet.CellRef;\n    var RangeRef = spreadsheet.RangeRef;\n    var UnionRef = spreadsheet.UnionRef;\n    var NULL = spreadsheet.NULLREF;\n    function CalcError(code) {\n        if (code instanceof CalcError) {\n            return code;\n        }\n        this.code = code;\n    }\n    CalcError.prototype.toString = function () {\n        return '#' + this.code + (this.code == 'NAME' ? '?' : '!');\n    };\n    var Context = Class.extend({\n        init: function Context(callback, formula, ss, parent) {\n            this.callback = callback;\n            this.formula = formula;\n            this.ss = ss;\n            this.parent = parent;\n        },\n        resolve: function (val) {\n            var self = this;\n            if (val instanceof Ref) {\n                self.resolveCells([val], function () {\n                    val = self.getRefData(val);\n                    if (Array.isArray(val)) {\n                        val = val[0];\n                    }\n                    self._resolve(val);\n                });\n            } else {\n                self._resolve(val);\n            }\n        },\n        _resolve: function (val) {\n            if (val === undefined) {\n                val = null;\n            }\n            var f = this.formula;\n            f.value = val;\n            if (this.ss.onFormula(f) && this.callback) {\n                this.callback.call(f, val);\n            }\n        },\n        resolveCells: function (a, f) {\n            var context = this, formulas = [];\n            (function loop(a) {\n                for (var i = 0; i < a.length; ++i) {\n                    var x = a[i];\n                    if (x instanceof Ref) {\n                        add(context.getRefCells(x));\n                    }\n                    if (Array.isArray(x)) {\n                        loop(x);\n                    }\n                }\n            }(a));\n            if (!formulas.length) {\n                return f.call(context);\n            }\n            for (var pending = formulas.length, i = 0; i < formulas.length; ++i) {\n                fetch(formulas[i]);\n            }\n            function fetch(cell) {\n                cell.formula.exec(context.ss, function () {\n                    if (!--pending) {\n                        f.call(context);\n                    }\n                }, context);\n            }\n            function add(a) {\n                for (var i = 0; i < a.length; ++i) {\n                    var cell = a[i];\n                    if (cell.formula) {\n                        formulas.push(cell);\n                    }\n                }\n                return true;\n            }\n        },\n        cellValues: function (a, f) {\n            var ret = [];\n            for (var i = 0; i < a.length; ++i) {\n                var val = a[i];\n                if (val instanceof Ref) {\n                    val = this.getRefData(val);\n                    ret = ret.concat(val);\n                } else if (Array.isArray(val)) {\n                    ret = ret.concat(this.cellValues(val));\n                } else if (val instanceof Matrix) {\n                    ret = ret.concat(this.cellValues(val.data));\n                } else {\n                    ret.push(val);\n                }\n            }\n            if (f) {\n                return f.apply(this, ret);\n            }\n            return ret;\n        },\n        force: function (val) {\n            if (val instanceof Ref) {\n                return this.getRefData(val);\n            }\n            return val;\n        },\n        func: function (fname, callback, args) {\n            fname = fname.toLowerCase();\n            var f = FUNCS[fname];\n            if (f) {\n                return f.call(this, callback, args);\n            }\n            callback(new CalcError('NAME'));\n        },\n        bool: function (val) {\n            if (val instanceof Ref) {\n                val = this.getRefData(val);\n            }\n            if (typeof val == 'string') {\n                return val.toLowerCase() == 'true';\n            }\n            if (typeof val == 'number') {\n                return val !== 0;\n            }\n            if (typeof val == 'boolean') {\n                return val;\n            }\n            return val != null;\n        },\n        asMatrix: function (range) {\n            if (range instanceof Matrix) {\n                return range;\n            }\n            var self = this;\n            if (range instanceof RangeRef) {\n                var tl = range.topLeft;\n                var top = tl.row, left = tl.col;\n                var cells = self.getRefCells(range);\n                var m = new Matrix(self);\n                if (isFinite(range.width())) {\n                    m.width = range.width();\n                }\n                if (isFinite(range.height())) {\n                    m.height = range.height();\n                }\n                if (!isFinite(top)) {\n                    top = 0;\n                }\n                if (!isFinite(left)) {\n                    left = 0;\n                }\n                cells.forEach(function (cell) {\n                    m.set(cell.row - top, cell.col - left, cell.value);\n                });\n                return m;\n            }\n            if (Array.isArray(range) && range.length > 0) {\n                var m = new Matrix(self), row = 0;\n                range.forEach(function (line) {\n                    var col = 0;\n                    var h = 1;\n                    line.forEach(function (el) {\n                        var isRange = el instanceof RangeRef;\n                        if (el instanceof Ref && !isRange) {\n                            el = self.getRefData(el);\n                        }\n                        if (isRange || Array.isArray(el)) {\n                            el = self.asMatrix(el);\n                        }\n                        if (el instanceof Matrix) {\n                            el.each(function (el, r, c) {\n                                m.set(row + r, col + c, el);\n                            });\n                            h = Math.max(h, el.height);\n                            col += el.width;\n                        } else {\n                            m.set(row, col++, el);\n                        }\n                    });\n                    row += h;\n                });\n                return m;\n            }\n        },\n        getRefCells: function (refs, hiddenInfo) {\n            return this.ss.getRefCells(refs, hiddenInfo);\n        },\n        getRefData: function (ref) {\n            return this.ss.getData(ref);\n        },\n        workbook: function () {\n            return this.ss.workbook;\n        }\n    });\n    var Matrix = Class.extend({\n        init: function Matrix(context) {\n            this.context = context;\n            this.height = 0;\n            this.width = 0;\n            this.data = [];\n        },\n        clone: function () {\n            var m = new Matrix(this.context);\n            m.height = this.height;\n            m.width = this.width;\n            m.data = this.data.map(function (row) {\n                return row.slice();\n            });\n            return m;\n        },\n        get: function (row, col) {\n            var line = this.data[row];\n            var val = line ? line[col] : null;\n            return val instanceof Ref ? this.context.getRefData(val) : val;\n        },\n        set: function (row, col, data) {\n            var line = this.data[row];\n            if (line == null) {\n                line = this.data[row] = [];\n            }\n            line[col] = data;\n            if (row >= this.height) {\n                this.height = row + 1;\n            }\n            if (col >= this.width) {\n                this.width = col + 1;\n            }\n        },\n        each: function (f, includeEmpty) {\n            for (var row = 0; row < this.height; ++row) {\n                for (var col = 0; col < this.width; ++col) {\n                    var val = this.get(row, col);\n                    if (includeEmpty || val != null) {\n                        val = f.call(this.context, val, row, col);\n                        if (val !== undefined) {\n                            return val;\n                        }\n                    }\n                }\n            }\n        },\n        map: function (f, includeEmpty) {\n            var m = new Matrix(this.context);\n            this.each(function (el, row, col) {\n                m.set(row, col, f.call(this, el, row, col));\n            }, includeEmpty);\n            return m;\n        },\n        eachRow: function (f) {\n            for (var row = 0; row < this.height; ++row) {\n                var val = f.call(this.context, row);\n                if (val !== undefined) {\n                    return val;\n                }\n            }\n        },\n        eachCol: function (f) {\n            for (var col = 0; col < this.width; ++col) {\n                var val = f.call(this.context, col);\n                if (val !== undefined) {\n                    return val;\n                }\n            }\n        },\n        mapRow: function (f) {\n            var m = new Matrix(this.context);\n            this.eachRow(function (row) {\n                m.set(row, 0, f.call(this.context, row));\n            });\n            return m;\n        },\n        mapCol: function (f) {\n            var m = new Matrix(this.context);\n            this.eachCol(function (col) {\n                m.set(0, col, f.call(this.context, col));\n            });\n            return m;\n        },\n        toString: function () {\n            return JSON.stringify(this.data);\n        },\n        transpose: function () {\n            var m = new Matrix(this.context);\n            this.each(function (el, row, col) {\n                m.set(col, row, el);\n            });\n            return m;\n        },\n        unit: function (n) {\n            this.width = this.height = n;\n            var a = this.data = new Array(n);\n            for (var i = n; --i >= 0;) {\n                var row = a[i] = new Array(n);\n                for (var j = n; --j >= 0;) {\n                    row[j] = i == j ? 1 : 0;\n                }\n            }\n            return this;\n        },\n        multiply: function (b) {\n            var a = this, m = new Matrix(a.context);\n            for (var row = 0; row < a.height; ++row) {\n                for (var col = 0; col < b.width; ++col) {\n                    var s = 0;\n                    for (var i = 0; i < a.width; ++i) {\n                        var va = a.get(row, i);\n                        var vb = b.get(i, col);\n                        if (typeof va != 'number' || typeof vb != 'number') {\n                            throw new CalcError('VALUE');\n                        }\n                        s += va * vb;\n                    }\n                    m.set(row, col, s);\n                }\n            }\n            return m;\n        },\n        adds: function (b, s) {\n            var a = this, m = new Matrix(a.context);\n            var sign = s ? -1 : 1;\n            for (var row = 0; row < a.height; ++row) {\n                for (var col = 0; col < a.width; ++col) {\n                    var x = a.get(row, col), y = b.get(row, col);\n                    m.set(row, col, x + sign * y);\n                }\n            }\n            return m;\n        },\n        determinant: function () {\n            var a = this.clone().data;\n            var n = a.length;\n            var d = 1, C, L, i, k;\n            for (C = 0; C < n; C++) {\n                for (L = C; L < n && !a[L][C]; L++) {\n                }\n                if (L == n) {\n                    return 0;\n                }\n                if (L != C) {\n                    d = -d;\n                    for (k = C; k < n; k++) {\n                        var t = a[C][k];\n                        a[C][k] = a[L][k];\n                        a[L][k] = t;\n                    }\n                }\n                for (i = C + 1; i < n; i++) {\n                    for (k = C + 1; k < n; k++) {\n                        a[i][k] -= a[C][k] * a[i][C] / a[C][C];\n                    }\n                }\n                d *= a[C][C];\n            }\n            return d;\n        },\n        inverse: function () {\n            var n = this.width;\n            var m = this.augment(new Matrix(this.context).unit(n));\n            var a = m.data;\n            var tmp;\n            for (var k = 0; k < n; ++k) {\n                var imax = argmax(k, n, function (i) {\n                    return a[i][k];\n                });\n                if (!a[imax][k]) {\n                    return null;\n                }\n                if (k != imax) {\n                    tmp = a[k];\n                    a[k] = a[imax];\n                    a[imax] = tmp;\n                }\n                for (var i = k + 1; i < n; ++i) {\n                    for (var j = k + 1; j < 2 * n; ++j) {\n                        a[i][j] -= a[k][j] * a[i][k] / a[k][k];\n                    }\n                    a[i][k] = 0;\n                }\n            }\n            for (var i = 0; i < n; ++i) {\n                for (var f = a[i][i], j = 0; j < 2 * n; ++j) {\n                    a[i][j] /= f;\n                }\n            }\n            for (var k = n; --k >= 0;) {\n                for (var i = k; --i >= 0;) {\n                    if (a[i][k]) {\n                        for (var j = 2 * n; --j >= n;) {\n                            a[i][j] -= a[k][j] * a[i][k];\n                        }\n                    }\n                }\n            }\n            return m.slice(0, n, n, n);\n        },\n        augment: function (m) {\n            var ret = this.clone(), n = ret.width;\n            m.each(function (val, row, col) {\n                ret.set(row, col + n, val);\n            });\n            return ret;\n        },\n        slice: function (row, col, height, width) {\n            var m = new Matrix(this.context);\n            for (var i = 0; i < height; ++i) {\n                for (var j = 0; j < width; ++j) {\n                    m.set(i, j, this.get(row + i, col + j));\n                }\n            }\n            return m;\n        }\n    });\n    function argmax(i, end, f) {\n        var max = f(i), pos = i;\n        while (++i < end) {\n            var v = f(i);\n            if (v > max) {\n                max = v;\n                pos = i;\n            }\n        }\n        return pos;\n    }\n    var Formula = Class.extend({\n        init: function Formula(refs, handler, printer, sheet, row, col) {\n            this.refs = refs;\n            this.handler = handler;\n            this.print = printer;\n            this.absrefs = null;\n            this.sheet = sheet;\n            this.row = row;\n            this.col = col;\n            this.onReady = [];\n            this.pending = false;\n        },\n        clone: function (sheet, row, col) {\n            var lcsheet = sheet.toLowerCase();\n            var refs = this.refs;\n            if (lcsheet != this.sheet.toLowerCase()) {\n                refs = refs.map(function (ref) {\n                    if (!ref.hasSheet() && ref.sheet.toLowerCase() != lcsheet) {\n                        ref = ref.clone().setSheet(sheet);\n                    }\n                    return ref;\n                });\n            }\n            return new Formula(refs, this.handler, this.print, sheet, row, col);\n        },\n        resolve: function (val) {\n            this.pending = false;\n            this.onReady.forEach(function (callback) {\n                callback(val);\n            });\n        },\n        exec: function (ss, callback, parentContext) {\n            if ('value' in this) {\n                if (callback) {\n                    callback(this.value);\n                }\n            } else {\n                if (callback) {\n                    this.onReady.push(callback);\n                }\n                var ctx = new Context(this.resolve, this, ss, parentContext);\n                while (parentContext) {\n                    if (parentContext.formula === this) {\n                        this.pending = false;\n                        ctx.resolve(new CalcError('CIRCULAR'));\n                        return;\n                    }\n                    parentContext = parentContext.parent;\n                }\n                if (this.pending) {\n                    return;\n                }\n                this.pending = true;\n                if (!this.absrefs) {\n                    this.absrefs = this.refs.map(function (ref) {\n                        return ref.absolute(this.row, this.col);\n                    }, this);\n                }\n                this.handler.call(ctx);\n            }\n        },\n        reset: function () {\n            this.onReady = [];\n            this.pending = false;\n            delete this.value;\n        },\n        renameSheet: function (oldSheetName, newSheetName) {\n            oldSheetName = oldSheetName.toLowerCase();\n            this.absrefs = null;\n            if (this.sheet.toLowerCase() == oldSheetName) {\n                this.sheet = newSheetName;\n            }\n            this.refs.forEach(function (ref) {\n                if (ref.sheet.toLowerCase() == oldSheetName) {\n                    ref.sheet = newSheetName;\n                }\n            });\n        },\n        adjust: function (affectedSheet, operation, start, delta) {\n            affectedSheet = affectedSheet.toLowerCase();\n            var formulaRow = this.row;\n            var formulaCol = this.col;\n            var formulaSheet = this.sheet.toLowerCase();\n            var formulaMoves = false;\n            if (formulaSheet == affectedSheet) {\n                if (operation == 'row' && formulaRow >= start) {\n                    this.row += delta;\n                    formulaMoves = true;\n                }\n                if (operation == 'col' && formulaCol >= start) {\n                    this.col += delta;\n                    formulaMoves = true;\n                }\n            }\n            var newFormulaRow = this.row;\n            var newFormulaCol = this.col;\n            this.absrefs = null;\n            this.refs = this.refs.map(function (ref) {\n                if (ref === NULL) {\n                    return ref;\n                }\n                if (ref.sheet.toLowerCase() != affectedSheet) {\n                    if (formulaMoves) {\n                        if (operation == 'row' && formulaRow >= start) {\n                            ref = ref.relative(delta, 0);\n                        }\n                        if (operation == 'col' && formulaCol >= start) {\n                            ref = ref.relative(0, delta);\n                        }\n                    }\n                    return ref;\n                }\n                return ref.adjust(formulaRow, formulaCol, newFormulaRow, newFormulaCol, operation == 'row', start, delta);\n            }, this);\n        },\n        toString: function () {\n            return this.print(this.row, this.col);\n        }\n    });\n    var FUNCS = Object.create(null);\n    FUNCS['if'] = function (callback, args) {\n        var self = this;\n        var co = args[0], th = args[1], el = args[2];\n        this.resolveCells([co], function () {\n            var comatrix = self.asMatrix(co);\n            if (comatrix) {\n                th(function (th) {\n                    el(function (el) {\n                        var thmatrix = self.asMatrix(th);\n                        var elmatrix = self.asMatrix(el);\n                        callback(comatrix.map(function (val, row, col) {\n                            if (val instanceof CalcError) {\n                                return val;\n                            } else if (self.bool(val)) {\n                                return thmatrix ? thmatrix.get(row, col) : th;\n                            } else {\n                                return elmatrix ? elmatrix.get(row, col) : el;\n                            }\n                        }));\n                    });\n                });\n            } else {\n                co = this.force(co);\n                if (co instanceof CalcError) {\n                    callback(co);\n                } else if (self.bool(co)) {\n                    th(callback);\n                } else {\n                    el(callback);\n                }\n            }\n        });\n    };\n    FUNCS['φ'] = function (callback) {\n        callback((1 + Math.sqrt(5)) / 2);\n    };\n    function compileArgumentChecks(functionName, args) {\n        var arrayArgs = 'function arrayArgs(args) { var xargs = [], width = 0, height = 0, arrays = [], i = 0; ';\n        var resolve = 'function resolve(args, callback) { var toResolve = [], i = 0; ';\n        var name, forced, main = '\\'use strict\\'; function check(args) { var stack = [], tmp, xargs = [], i = 0, m, err = \\'VALUE\\'; ', haveForced = false;\n        var canBeArrayArg = false, hasArrayArgs = false;\n        main += args.map(comp).join('');\n        main += 'if (i < args.length) return new CalcError(\\'N/A\\'); ';\n        main += 'return xargs; } ';\n        arrayArgs += 'return { args: xargs, width: width, height: height, arrays: arrays }; } ';\n        var f;\n        if (haveForced) {\n            resolve += 'this.resolveCells(toResolve, callback); } ';\n            f = new Function('CalcError', main + resolve + arrayArgs + ' return { resolve: resolve, check: check, arrayArgs: arrayArgs };');\n        } else {\n            f = new Function('CalcError', main + ' return { check: check };');\n        }\n        f = f(CalcError);\n        if (!hasArrayArgs) {\n            delete f.arrayArgs;\n        }\n        return f;\n        function comp(x) {\n            name = x[0];\n            var code = '{ ';\n            if (Array.isArray(name)) {\n                arrayArgs += 'while (i < args.length) { ';\n                resolve += 'while (i < args.length) { ';\n                code += 'xargs.push(tmp = []); stack.push(xargs); xargs = tmp; ';\n                code += 'while (i < args.length) { ';\n                code += x.map(comp).join('');\n                code += '} ';\n                code += 'xargs = stack.pop(); ';\n                resolve += '} ';\n                arrayArgs += '} ';\n            } else if (name == '+') {\n                arrayArgs += 'while (i < args.length) { ';\n                resolve += 'while (i < args.length) { ';\n                code += 'xargs.push(tmp = []); stack.push(xargs); xargs = tmp; ';\n                code += 'do { ';\n                code += x.slice(1).map(comp).join('');\n                code += '} while (i < args.length); ';\n                code += 'xargs = stack.pop(); ';\n                resolve += '} ';\n                arrayArgs += '} ';\n            } else if (name == '?') {\n                code += 'if (!(' + cond(x[1]) + ')) return new CalcError(err); ';\n            } else {\n                var type = x[1];\n                if (Array.isArray(type) && /^#?collect/.test(type[0])) {\n                    var n = type[2];\n                    force();\n                    code += 'try {' + 'var $' + name + ' = this.cellValues(args.slice(i';\n                    if (n) {\n                        code += ', i + ' + n;\n                    }\n                    code += ')).filter(function($' + name + '){ ';\n                    if (type[0] == 'collect') {\n                        code += 'if ($' + name + ' instanceof CalcError) throw $' + name + '; ';\n                    }\n                    code += 'return ' + cond(type[1]) + '; }, this); ';\n                    if (n) {\n                        code += 'i += ' + n + '; ';\n                    } else {\n                        code += 'i = args.length; ';\n                    }\n                    code += 'xargs.push($' + name + ')' + '} catch(ex) { if (ex instanceof CalcError) return ex; throw ex; } ';\n                    resolve += 'toResolve.push(args.slice(i)); ';\n                } else if (type == 'rest') {\n                    code += 'xargs.push(args.slice(i)); i = args.length; ';\n                } else {\n                    if (canBeArrayArg = /^\\*/.test(name)) {\n                        hasArrayArgs = true;\n                        name = name.substr(1);\n                    }\n                    code += 'var $' + name + ' = args[i++]; ';\n                    var allowError = false;\n                    if (/!$/.test(type)) {\n                        type = type.substr(0, type.length - 1);\n                        allowError = true;\n                    } else {\n                        code += 'if ($' + name + ' instanceof CalcError) return $' + name + '; ';\n                    }\n                    code += typeCheck(type, allowError) + 'xargs.push($' + name + '); ';\n                }\n            }\n            code += '} ';\n            return code;\n        }\n        function force() {\n            if (forced) {\n                return '$' + name + '';\n            }\n            haveForced = true;\n            forced = true;\n            resolve += 'toResolve.push(args[i++]); ';\n            return '($' + name + ' = this.force($' + name + '))';\n        }\n        function typeCheck(type, allowError) {\n            forced = false;\n            var ret = 'if (!(' + cond(type) + ')) { ';\n            if (forced && !allowError) {\n                ret += ' if ($' + name + ' instanceof CalcError) return $' + name + '; ';\n            }\n            ret += 'return new CalcError(err); } ';\n            if (!forced) {\n                resolve += 'i++; ';\n            }\n            if (canBeArrayArg) {\n                arrayArgs += 'var $' + name + ' = this.asMatrix(args[i]); ' + 'if ($' + name + ') { ' + 'xargs.push($' + name + '); ' + 'width = Math.max(width, $' + name + '.width); ' + 'height = Math.max(height, $' + name + '.height); ' + 'arrays.push(true) } else { ' + 'xargs.push(args[i]); ' + 'arrays.push(false); } i++; ';\n            } else {\n                arrayArgs += 'xargs.push(args[i++]); arrays.push(false); ';\n            }\n            return ret;\n        }\n        function cond(type) {\n            if (Array.isArray(type)) {\n                if (type[0] == 'or') {\n                    return '(' + type.slice(1).map(cond).join(') || (') + ')';\n                }\n                if (type[0] == 'and') {\n                    return '(' + type.slice(1).map(cond).join(') && (') + ')';\n                }\n                if (type[0] == 'values') {\n                    return '(' + type.slice(1).map(function (val) {\n                        return force() + ' === ' + val;\n                    }).join(') || (') + ')';\n                }\n                if (type[0] == 'null') {\n                    return '(' + cond('null') + ' ? (($' + name + ' = ' + type[1] + '), true) : false)';\n                }\n                if (type[0] == 'between' || type[0] == '[between]') {\n                    return '(' + force() + ' >= ' + type[1] + ' && ' + '$' + name + ' <= ' + type[2] + ' ? true : ((err = \\'NUM\\'), false))';\n                }\n                if (type[0] == '(between)') {\n                    return '(' + force() + ' > ' + type[1] + ' && ' + '$' + name + ' < ' + type[2] + ' ? true : ((err = \\'NUM\\'), false))';\n                }\n                if (type[0] == '(between]') {\n                    return '(' + force() + ' > ' + type[1] + ' && ' + '$' + name + ' <= ' + type[2] + ' ? true : ((err = \\'NUM\\'), false))';\n                }\n                if (type[0] == '[between)') {\n                    return '(' + force() + ' >= ' + type[1] + ' && ' + '$' + name + ' < ' + type[2] + ' ? true : ((err = \\'NUM\\'), false))';\n                }\n                if (type[0] == 'assert') {\n                    var err = type[2] || 'N/A';\n                    return '((' + type[1] + ') ? true : (err = ' + JSON.stringify(err) + ', false))';\n                }\n                if (type[0] == 'not') {\n                    return '!(' + cond(type[1]) + ')';\n                }\n                throw new Error('Unknown array type condition: ' + type[0]);\n            }\n            if (type == 'number') {\n                return '(typeof ' + force() + ' == \\'number\\' || typeof $' + name + ' == \\'boolean\\')';\n            }\n            if (type == 'integer') {\n                return '((typeof ' + force() + ' == \\'number\\' || typeof $' + name + ' == \\'boolean\\') ? ($' + name + ' |= 0, true) : false)';\n            }\n            if (type == 'date') {\n                return '((typeof ' + force() + ' == \\'number\\') ? ($' + name + ' |= 0, true) : false)';\n            }\n            if (type == 'datetime') {\n                return '(typeof ' + force() + ' == \\'number\\')';\n            }\n            if (type == 'divisor') {\n                return '((typeof ' + force() + ' == \\'number\\' || typeof $' + name + ' == \\'boolean\\') && ' + '($' + name + ' == 0 ? ((err = \\'DIV/0\\'), false) : true))';\n            }\n            if (type == 'number+') {\n                return '((typeof ' + force() + ' == \\'number\\' || typeof $' + name + ' == \\'boolean\\') && ($' + name + ' >= 0 ? true : ((err = \\'NUM\\'), false)))';\n            }\n            if (type == 'integer+') {\n                return '((typeof ' + force() + ' == \\'number\\' || typeof $' + name + ' == \\'boolean\\') && (($' + name + ' |= 0) >= 0 ? true : ((err = \\'NUM\\'), false)))';\n            }\n            if (type == 'number++') {\n                return '((typeof ' + force() + ' == \\'number\\' || typeof $' + name + ' == \\'boolean\\') && ($' + name + ' > 0 ? true : ((err = \\'NUM\\'), false)))';\n            }\n            if (type == 'integer++') {\n                return '((typeof ' + force() + ' == \\'number\\' || typeof $' + name + ' == \\'boolean\\') && (($' + name + ' |= 0 ) > 0) ? true : ((err = \\'NUM\\'), false))';\n            }\n            if (type == 'string') {\n                return '((typeof ' + force() + ' == \\'string\\' || typeof $' + name + ' == \\'boolean\\' || typeof $' + name + ' == \\'number\\') ? ($' + name + ' += \\'\\', true) : ($' + name + ' === undefined ? ($' + name + ' = \\'\\', true) : false))';\n            }\n            if (type == 'boolean') {\n                return '(typeof ' + force() + ' == \\'boolean\\')';\n            }\n            if (type == 'logical') {\n                return '(typeof ' + force() + ' == \\'boolean\\' || (typeof $' + name + ' == \\'number\\' ? ($' + name + ' = !!$' + name + ', true) : false))';\n            }\n            if (type == 'matrix') {\n                force();\n                return '((m = this.asMatrix($' + name + ')) ? ($' + name + ' = m) : false)';\n            }\n            if (type == '#matrix') {\n                return '((m = this.asMatrix($' + name + ')) ? ($' + name + ' = m) : false)';\n            }\n            if (type == 'ref') {\n                return '($' + name + ' instanceof kendo.spreadsheet.Ref)';\n            }\n            if (type == 'area') {\n                return '($' + name + ' instanceof kendo.spreadsheet.CellRef || $' + name + ' instanceof kendo.spreadsheet.RangeRef)';\n            }\n            if (type == 'cell') {\n                return '($' + name + ' instanceof kendo.spreadsheet.CellRef)';\n            }\n            if (type == 'null') {\n                return '(' + force() + ' == null)';\n            }\n            if (type == 'anyvalue') {\n                return '(' + force() + ' != null && i <= args.length)';\n            }\n            if (type == 'forced') {\n                return '(' + force() + ', i <= args.length)';\n            }\n            if (type == 'anything') {\n                return '(i <= args.length)';\n            }\n            if (type == 'blank') {\n                return '(' + force() + ' == null || $' + name + ' === \\'\\')';\n            }\n            throw new Error('Can\\'t check for type: ' + type);\n        }\n    }\n    function withErrorHandling(obj, f, args) {\n        if (args instanceof CalcError) {\n            return args;\n        }\n        try {\n            return f.apply(obj, args);\n        } catch (ex) {\n            if (ex instanceof CalcError) {\n                return ex;\n            } else {\n                throw ex;\n            }\n        }\n    }\n    function makeSyncFunction(handler, resolve, check, arrayArgs) {\n        return function (callback, args) {\n            function doit() {\n                if (arrayArgs) {\n                    var x = arrayArgs.call(this, args);\n                    args = x.args;\n                    if (x.width > 0 && x.height > 0) {\n                        var result = new Matrix(this);\n                        for (var row = 0; row < x.height; ++row) {\n                            for (var col = 0; col < x.width; ++col) {\n                                var xargs = [];\n                                for (var i = 0; i < args.length; ++i) {\n                                    if (x.arrays[i]) {\n                                        var m = args[i];\n                                        xargs[i] = m.get(row % m.height, col % m.width);\n                                    } else {\n                                        xargs[i] = args[i];\n                                    }\n                                }\n                                xargs = check.call(this, xargs);\n                                result.set(row, col, withErrorHandling(this, handler, xargs));\n                            }\n                        }\n                        return callback(result);\n                    }\n                }\n                var xargs = check.call(this, args);\n                callback(withErrorHandling(this, handler, xargs));\n            }\n            if (resolve) {\n                resolve.call(this, args, doit);\n            } else {\n                doit.call(this);\n            }\n        };\n    }\n    function makeAsyncFunction(handler, resolve, check, arrayArgs) {\n        return function (callback, args) {\n            function doit() {\n                if (arrayArgs) {\n                    var x = arrayArgs.call(this, args);\n                    args = x.args;\n                    if (x.width > 0 && x.height > 0) {\n                        var result = new Matrix(this);\n                        var count = x.width * x.height;\n                        var makeCallback = function (row, col) {\n                            return function (value) {\n                                result.set(row, col, value);\n                                --count;\n                                if (count === 0) {\n                                    return callback(result);\n                                }\n                            };\n                        };\n                        for (var row = 0; row < x.height && count > 0; ++row) {\n                            for (var col = 0; col < x.width && count > 0; ++col) {\n                                var xargs = [];\n                                for (var i = 0; i < args.length; ++i) {\n                                    if (x.arrays[i]) {\n                                        var m = args[i];\n                                        xargs[i] = m.get(row % m.height, col % m.width);\n                                    } else {\n                                        xargs[i] = args[i];\n                                    }\n                                }\n                                xargs = check.call(this, xargs);\n                                if (xargs instanceof CalcError) {\n                                    result.set(row, col, xargs);\n                                    --count;\n                                    if (count === 0) {\n                                        return callback(result);\n                                    }\n                                } else {\n                                    xargs.unshift(makeCallback(row, col));\n                                    handler.apply(this, xargs);\n                                }\n                            }\n                        }\n                        return;\n                    }\n                }\n                var x = check.call(this, args);\n                if (x instanceof CalcError) {\n                    callback(x);\n                } else {\n                    x.unshift(callback);\n                    handler.apply(this, x);\n                }\n            }\n            if (resolve) {\n                resolve.call(this, args, doit);\n            } else {\n                doit.call(this);\n            }\n        };\n    }\n    function defineFunction(name, func) {\n        name = name.toLowerCase();\n        FUNCS[name] = func;\n        return {\n            args: function (args, log) {\n                var code = compileArgumentChecks(name, args);\n                if (log) {\n                    if (code.arrayArgs) {\n                        console.log(code.arrayArgs.toString());\n                    }\n                    if (code.resolve) {\n                        console.log(code.resolve.toString());\n                    }\n                    if (code.check) {\n                        console.log(code.check.toString());\n                    }\n                }\n                var f = FUNCS[name] = makeSyncFunction(func, code.resolve, code.check, code.arrayArgs);\n                f.kendoSpreadsheetArgs = args;\n                return this;\n            },\n            argsAsync: function (args, log) {\n                var code = compileArgumentChecks(name, args);\n                if (log) {\n                    if (code.arrayArgs) {\n                        console.log(code.arrayArgs.toString());\n                    }\n                    if (code.resolve) {\n                        console.log(code.resolve.toString());\n                    }\n                    if (code.check) {\n                        console.log(code.check.toString());\n                    }\n                }\n                var f = FUNCS[name] = makeAsyncFunction(func, code.resolve, code.check, code.arrayArgs);\n                f.kendoSpreadsheetArgs = args;\n                return this;\n            }\n        };\n    }\n    function dateToJulianDays(y, m, d) {\n        m++;\n        return (1461 * (y + 4800 + ((m - 14) / 12 | 0)) / 4 | 0) + (367 * (m - 2 - 12 * ((m - 14) / 12 | 0)) / 12 | 0) - (3 * ((y + 4900 + ((m - 14) / 12 | 0)) / 100 | 0) / 4 | 0) + d - 32075;\n    }\n    function julianDaysToDate(jd) {\n        var l, n, j, i, m, d, y;\n        l = jd + 68569;\n        n = 4 * l / 146097 | 0;\n        l = l - ((146097 * n + 3) / 4 | 0);\n        i = 4000 * (l + 1) / 1461001 | 0;\n        l = l - (1461 * i / 4 | 0) + 31;\n        j = 80 * l / 2447 | 0;\n        d = l - (2447 * j / 80 | 0);\n        l = j / 11 | 0;\n        m = j + 2 - 12 * l;\n        y = 100 * (n - 49) + i + l;\n        m--;\n        return {\n            year: y,\n            month: m,\n            date: d,\n            day: (jd + 1) % 7,\n            ord: ORDINAL_ADD_DAYS[isLeapYear(y)][m] + d\n        };\n    }\n    var BASE_DATE = dateToJulianDays(1900, 0, -1);\n    var DAYS_IN_MONTH = [\n        31,\n        28,\n        31,\n        30,\n        31,\n        30,\n        31,\n        31,\n        30,\n        31,\n        30,\n        31\n    ];\n    var ORDINAL_ADD_DAYS = [\n        [\n            0,\n            31,\n            59,\n            90,\n            120,\n            151,\n            181,\n            212,\n            243,\n            273,\n            304,\n            334\n        ],\n        [\n            0,\n            31,\n            60,\n            91,\n            121,\n            152,\n            182,\n            213,\n            244,\n            274,\n            305,\n            335\n        ]\n    ];\n    function isLeapYear(yr) {\n        if (yr % 4) {\n            return 0;\n        }\n        if (yr % 100) {\n            return 1;\n        }\n        if (yr % 400) {\n            return 0;\n        }\n        return 1;\n    }\n    function daysInYear(yr) {\n        return isLeapYear(yr) ? 366 : 365;\n    }\n    function daysInMonth(yr, mo) {\n        return isLeapYear(yr) && mo == 1 ? 29 : DAYS_IN_MONTH[mo];\n    }\n    function unpackDate(serial) {\n        return julianDaysToDate((serial | 0) + BASE_DATE);\n    }\n    function packDate(year, month, date) {\n        return dateToJulianDays(year, month, date) - BASE_DATE;\n    }\n    var MS_IN_MIN = 60 * 1000;\n    var MS_IN_HOUR = 60 * MS_IN_MIN;\n    var MS_IN_DAY = 24 * MS_IN_HOUR;\n    function unpackTime(serial) {\n        var frac = serial - (serial | 0);\n        if (frac < 0) {\n            frac++;\n        }\n        var ms = Math.round(MS_IN_DAY * frac);\n        var hours = Math.floor(ms / MS_IN_HOUR);\n        ms -= hours * MS_IN_HOUR;\n        var minutes = Math.floor(ms / MS_IN_MIN);\n        ms -= minutes * MS_IN_MIN;\n        var seconds = Math.floor(ms / 1000);\n        ms -= seconds * 1000;\n        return {\n            hours: hours,\n            minutes: minutes,\n            seconds: seconds,\n            milliseconds: ms\n        };\n    }\n    function serialToDate(serial) {\n        var d = unpackDate(serial), t = unpackTime(serial);\n        return new Date(d.year, d.month, d.date, t.hours, t.minutes, t.seconds, t.milliseconds);\n    }\n    function packTime(hh, mm, ss, ms) {\n        return (hh + (mm + (ss + ms / 1000) / 60) / 60) / 24;\n    }\n    function dateToSerial(date) {\n        var time = packTime(date.getHours(), date.getMinutes(), date.getSeconds(), date.getMilliseconds());\n        date = packDate(date.getFullYear(), date.getMonth(), date.getDate());\n        if (date < 0) {\n            return date - 1 + time;\n        } else {\n            return date + time;\n        }\n    }\n    function parseDate(str) {\n        return kendo.parseDate(str, [\n            'MM/dd/yyyy',\n            'MM-dd-yyyy',\n            'MM/dd/yy',\n            'MM-dd-yy',\n            'MMMM dd yyyy',\n            'MMMM dd yy',\n            'MMM dd yyyy',\n            'MMM dd yy',\n            'dd MMMM yyyy',\n            'dd MMMM yy',\n            'dd MMM yyyy',\n            'dd MMM yy',\n            'MMMM dd, yyyy',\n            'MMMM dd, yy',\n            'MMM dd, yyyy',\n            'MMM dd, yy',\n            'MMMM dd',\n            'MMM dd',\n            'MMMM yyyy',\n            'MMM yyyy',\n            'dd MMMM',\n            'dd MMM',\n            'MM-dd',\n            'MM/dd'\n        ]) || kendo.parseDate(str);\n    }\n    exports.CalcError = CalcError;\n    exports.Formula = Formula;\n    exports.Matrix = Matrix;\n    exports.packDate = packDate;\n    exports.unpackDate = unpackDate;\n    exports.packTime = packTime;\n    exports.unpackTime = unpackTime;\n    exports.serialToDate = serialToDate;\n    exports.dateToSerial = dateToSerial;\n    exports.daysInMonth = daysInMonth;\n    exports.isLeapYear = isLeapYear;\n    exports.daysInYear = daysInYear;\n    exports.parseDate = parseDate;\n    spreadsheet.dateToNumber = dateToSerial;\n    spreadsheet.numberToDate = serialToDate;\n    spreadsheet.defineFunction = defineFunction;\n    spreadsheet.CalcError = CalcError;\n    exports.defineFunction = defineFunction;\n    exports.defineAlias = function (alias, name) {\n        var orig = FUNCS[name];\n        if (!orig) {\n            throw new Error('Function ' + name + ' is not yet defined');\n        }\n        if (!orig.kendoSpreadsheetAliases) {\n            orig.kendoSpreadsheetAliases = [name];\n        }\n        orig.kendoSpreadsheetAliases.push(alias);\n        FUNCS[alias] = orig;\n    };\n    exports.FUNCS = FUNCS;\n    var NUMBER_OR_ZERO = [\n        'or',\n        'number',\n        [\n            'null',\n            0\n        ]\n    ];\n    var ARGS_NUMERIC = [\n        [\n            '*a',\n            NUMBER_OR_ZERO\n        ],\n        [\n            '*b',\n            NUMBER_OR_ZERO\n        ]\n    ];\n    var ARGS_ANYVALUE = [\n        [\n            '*a',\n            [\n                'or',\n                'anyvalue',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '*b',\n            [\n                'or',\n                'anyvalue',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ];\n    defineFunction('binary+', function (a, b) {\n        return a + b;\n    }).args(ARGS_NUMERIC);\n    defineFunction('binary-', function (a, b) {\n        return a - b;\n    }).args(ARGS_NUMERIC);\n    defineFunction('binary*', function (a, b) {\n        return a * b;\n    }).args(ARGS_NUMERIC);\n    defineFunction('binary/', function (a, b) {\n        return a / b;\n    }).args([\n        [\n            '*a',\n            NUMBER_OR_ZERO\n        ],\n        [\n            '*b',\n            'divisor'\n        ]\n    ]);\n    defineFunction('binary^', function (a, b) {\n        return Math.pow(a, b);\n    }).args(ARGS_NUMERIC);\n    defineFunction('binary&', function (a, b) {\n        if (a == null) {\n            a = '';\n        }\n        if (b == null) {\n            b = '';\n        }\n        return '' + a + b;\n    }).args([\n        [\n            '*a',\n            [\n                'or',\n                'number',\n                'string',\n                'boolean',\n                'null'\n            ]\n        ],\n        [\n            '*b',\n            [\n                'or',\n                'number',\n                'string',\n                'boolean',\n                'null'\n            ]\n        ]\n    ]);\n    defineFunction('binary=', function (a, b) {\n        return a === b;\n    }).args(ARGS_ANYVALUE);\n    defineFunction('binary<>', function (a, b) {\n        return a !== b;\n    }).args(ARGS_ANYVALUE);\n    defineFunction('binary<', binaryCompare(function (a, b) {\n        return a < b;\n    })).args(ARGS_ANYVALUE);\n    defineFunction('binary<=', binaryCompare(function (a, b) {\n        return a <= b;\n    })).args(ARGS_ANYVALUE);\n    defineFunction('binary>', binaryCompare(function (a, b) {\n        return a > b;\n    })).args(ARGS_ANYVALUE);\n    defineFunction('binary>=', binaryCompare(function (a, b) {\n        return a >= b;\n    })).args(ARGS_ANYVALUE);\n    defineFunction('unary+', function (a) {\n        return a;\n    }).args([[\n            '*a',\n            NUMBER_OR_ZERO\n        ]]);\n    defineFunction('unary-', function (a) {\n        return -a;\n    }).args([[\n            '*a',\n            NUMBER_OR_ZERO\n        ]]);\n    defineFunction('unary%', function (a) {\n        return a / 100;\n    }).args([[\n            '*a',\n            NUMBER_OR_ZERO\n        ]]);\n    defineFunction('binary:', function (a, b) {\n        return new RangeRef(a, b).setSheet(a.sheet || this.formula.sheet, a.hasSheet());\n    }).args([\n        [\n            'a',\n            'cell'\n        ],\n        [\n            'b',\n            'cell'\n        ]\n    ]);\n    defineFunction('binary,', function (a, b) {\n        return new UnionRef([\n            a,\n            b\n        ]);\n    }).args([\n        [\n            'a',\n            'ref'\n        ],\n        [\n            'b',\n            'ref'\n        ]\n    ]);\n    defineFunction('binary ', function (a, b) {\n        return a.intersect(b);\n    }).args([\n        [\n            'a',\n            'ref'\n        ],\n        [\n            'b',\n            'ref'\n        ]\n    ]);\n    defineFunction('not', function (a) {\n        return !this.bool(a);\n    }).args([[\n            '*a',\n            [\n                'or',\n                'anyvalue',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]]);\n    defineFunction('isblank', function (val) {\n        if (val instanceof CellRef) {\n            val = this.getRefData(val);\n            return val == null;\n        }\n        return false;\n    }).args([[\n            '*value',\n            'anything!'\n        ]]);\n    defineFunction('iserror', function (val) {\n        return val instanceof CalcError;\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('iserr', function (val) {\n        return val instanceof CalcError && val.code != 'N/A';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('isna', function (val) {\n        return val instanceof CalcError && val.code == 'N/A';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('islogical', function (val) {\n        return typeof val == 'boolean';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('isnontext', function (val) {\n        return typeof val != 'string';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('istext', function (val) {\n        return typeof val == 'string';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('isnumber', function (val) {\n        return typeof val == 'number';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('isref', function (val) {\n        return val instanceof CellRef || val instanceof RangeRef;\n    }).args([[\n            '*value',\n            'anything!'\n        ]]);\n    function binaryCompare(func) {\n        return function (left, right) {\n            if (typeof left == 'string' && typeof right != 'string') {\n                right = right == null ? '' : right + '';\n            }\n            if (typeof left != 'string' && typeof right == 'string') {\n                left = left == null ? '' : left + '';\n            }\n            if (typeof left == 'number' && right == null) {\n                right = 0;\n            }\n            if (typeof right == 'number' && left == null) {\n                left = 0;\n            }\n            if (typeof left == 'string' && typeof right == 'string') {\n                left = left.toLowerCase();\n                right = right.toLowerCase();\n            }\n            if (typeof right == typeof left) {\n                return func(left, right);\n            } else {\n                return new CalcError('VALUE');\n            }\n        };\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/validation', ['spreadsheet/runtime'], f);\n}(function () {\n    'use strict';\n    var $ = kendo.jQuery;\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var exports = {};\n    spreadsheet.validation = exports;\n    var calc = spreadsheet.calc;\n    var Class = kendo.Class;\n    var TRANSPOSE_FORMAT = '_matrix({0})';\n    var DATE_FORMAT = 'DATEVALUE(\"{0}\")';\n    calc.runtime.defineFunction('_matrix', function (m) {\n        return m;\n    }).args([[\n            'm',\n            'matrix'\n        ]]);\n    function compileValidation(sheet, row, col, validation) {\n        var validationHandler;\n        var comparer;\n        var parsedFromDate;\n        var parsedToDate;\n        if (typeof validation === 'string') {\n            validation = JSON.parse(validation);\n        }\n        if (validation.from) {\n            if (validation.dataType === 'list') {\n                validation.from = kendo.format(TRANSPOSE_FORMAT, validation.from);\n            }\n            if (validation.dataType === 'date') {\n                parsedFromDate = calc.runtime.parseDate(validation.from);\n                if (parsedFromDate) {\n                    validation.from = kendo.format(DATE_FORMAT, validation.from);\n                    validation.fromIsDateValue = true;\n                }\n            }\n            validation.from = calc.compile(calc.parseFormula(sheet, row, col, validation.from));\n        }\n        if (validation.to) {\n            if (validation.dataType === 'date') {\n                parsedToDate = calc.runtime.parseDate(validation.to);\n                if (parsedToDate) {\n                    validation.to = kendo.format(DATE_FORMAT, validation.to);\n                    validation.toIsDateValue = true;\n                }\n            }\n            validation.to = calc.compile(calc.parseFormula(sheet, row, col, validation.to));\n        }\n        if (validation.dataType == 'custom') {\n            comparer = exports.validationComparers.custom;\n        } else if (validation.dataType == 'list') {\n            comparer = exports.validationComparers.list;\n        } else {\n            comparer = exports.validationComparers[validation.comparerType];\n        }\n        if (!comparer) {\n            throw kendo.format('\\'{0}\\' comparer is not implemented.', validation.comparerType);\n        }\n        validationHandler = function (valueToCompare) {\n            var toValue = this.to && this.to.value ? this.to.value : undefined;\n            if (valueToCompare === null || valueToCompare === '') {\n                if (this.allowNulls) {\n                    this.value = true;\n                } else {\n                    this.value = false;\n                }\n            } else if (this.dataType == 'custom') {\n                this.value = comparer(valueToCompare, this.from.value, toValue);\n            } else if (this.dataType == 'list') {\n                var data = this._getListData();\n                this.value = comparer(valueToCompare, data, toValue);\n            } else {\n                this.value = comparer(valueToCompare, this.from.value, toValue);\n            }\n            return this.value;\n        };\n        return new kendo.spreadsheet.validation.Validation($.extend(validation, {\n            handler: validationHandler,\n            sheet: sheet,\n            row: row,\n            col: col\n        }));\n    }\n    var Validation = Class.extend({\n        init: function Validation(options) {\n            this.handler = options.handler;\n            this.from = options.from;\n            this.to = options.to;\n            this.dataType = options.dataType;\n            this.comparerType = options.comparerType;\n            this.type = options.type ? options.type : 'warning';\n            this.allowNulls = options.allowNulls ? true : false;\n            this.fromIsDateValue = options.fromIsDateValue ? true : false;\n            this.toIsDateValue = options.toIsDateValue ? true : false;\n            this.sheet = options.sheet;\n            this.row = options.row;\n            this.col = options.col;\n            if (options.tooltipMessageTemplate) {\n                this.tooltipMessageTemplate = options.tooltipMessageTemplate;\n            }\n            if (options.tooltipTitleTemplate) {\n                this.tooltipTitleTemplate = options.tooltipTitleTemplate;\n            }\n            if (options.messageTemplate) {\n                this.messageTemplate = options.messageTemplate;\n            }\n            if (options.titleTemplate) {\n                this.titleTemplate = options.titleTemplate;\n            }\n        },\n        _formatMessages: function (format) {\n            var from = this.from ? this.from.value : '';\n            var to = this.to ? this.to.value : '';\n            var fromFormula = this.from ? this.from.toString() : '';\n            var toFormula = this.to ? this.to.toString() : '';\n            var dataType = this.dataType;\n            var type = this.type;\n            var comparerType = this.comparerType;\n            return kendo.format(format, from, to, fromFormula, toFormula, dataType, type, comparerType);\n        },\n        _setMessages: function () {\n            this.title = '';\n            this.message = '';\n            if (this.tooltipTitleTemplate) {\n                this.tooltipTitle = this._formatMessages(this.tooltipTitleTemplate);\n            }\n            if (this.tooltipMessageTemplate) {\n                this.tooltipMessage = this._formatMessages(this.tooltipMessageTemplate);\n            }\n            if (this.titleTemplate) {\n                this.title = this._formatMessages(this.titleTemplate);\n            }\n            if (this.messageTemplate) {\n                this.message = this._formatMessages(this.messageTemplate);\n            }\n        },\n        _getListData: function () {\n            if (!this.from.value || !this.from.value.data) {\n                return [];\n            }\n            var cube = this.from.value.data;\n            var i;\n            var y;\n            var data = [];\n            for (i = 0; i < cube.length; i++) {\n                var array = cube[i];\n                if (array) {\n                    for (y = 0; y < array.length; y++) {\n                        data.push(array[y]);\n                    }\n                }\n            }\n            return data;\n        },\n        clone: function (sheet, row, col) {\n            var options = this._getOptions();\n            if (options.from) {\n                options.from = options.from.clone(sheet, row, col);\n            }\n            if (options.to) {\n                options.to = options.to.clone(sheet, row, col);\n            }\n            return new Validation($.extend(options, { handler: this.handler }, {\n                sheet: sheet,\n                row: row,\n                col: col\n            }));\n        },\n        exec: function (ss, compareValue, compareFormat, callback) {\n            var self = this;\n            var calculateFromCallBack = function () {\n                self.value = self.handler.call(self, compareValue, compareFormat);\n                self._setMessages();\n                if (callback) {\n                    callback(self.value);\n                }\n            };\n            if (self.to) {\n                self.to.exec(ss, function () {\n                    self.from.exec(ss, calculateFromCallBack);\n                });\n            } else {\n                self.from.exec(ss, calculateFromCallBack);\n            }\n        },\n        reset: function () {\n            if (this.from) {\n                this.from.reset();\n            }\n            if (this.to) {\n                this.to.reset();\n            }\n            delete this.value;\n        },\n        adjust: function (affectedSheet, operation, start, delta) {\n            if (this.from) {\n                this.from.adjust(affectedSheet, operation, start, delta);\n            }\n            if (this.to) {\n                this.to.adjust(affectedSheet, operation, start, delta);\n            }\n            if (this.sheet.toLowerCase() == affectedSheet.toLowerCase()) {\n                var formulaRow = this.row;\n                var formulaCol = this.col;\n                switch (operation) {\n                case 'row':\n                    if (formulaRow >= start) {\n                        this.row += delta;\n                    }\n                    break;\n                case 'col':\n                    if (formulaCol >= start) {\n                        this.col += delta;\n                    }\n                    break;\n                }\n            }\n        },\n        toJSON: function () {\n            var options = this._getOptions();\n            if (options.from) {\n                options.from = options.from.toString();\n                if (options.dataType === 'list') {\n                    options.from = options.from.replace(/^_matrix\\((.*)\\)$/i, '$1');\n                }\n                if (options.dataType === 'date') {\n                    if (this.fromIsDateValue) {\n                        options.from = options.from.replace(/^DATEVALUE\\(\"(.*)\"\\)$/i, '$1');\n                    }\n                }\n            }\n            if (options.to) {\n                options.to = options.to.toString();\n                if (options.dataType === 'date') {\n                    if (this.toIsDateValue) {\n                        options.to = options.to.replace(/^DATEVALUE\\(\"(.*)\"\\)$/i, '$1');\n                    }\n                }\n            }\n            return options;\n        },\n        _getOptions: function () {\n            return {\n                from: this.from,\n                to: this.to,\n                dataType: this.dataType,\n                type: this.type,\n                comparerType: this.comparerType,\n                row: this.row,\n                col: this.col,\n                sheet: this.sheet,\n                allowNulls: this.allowNulls,\n                tooltipMessageTemplate: this.tooltipMessageTemplate,\n                tooltipTitleTemplate: this.tooltipTitleTemplate,\n                messageTemplate: this.messageTemplate,\n                titleTemplate: this.titleTemplate\n            };\n        }\n    });\n    exports.compile = compileValidation;\n    exports.validationComparers = {\n        greaterThan: function (valueToCompare, from) {\n            return valueToCompare > from;\n        },\n        lessThan: function (valueToCompare, from) {\n            return valueToCompare < from;\n        },\n        between: function (valueToCompare, from, to) {\n            return valueToCompare > from && valueToCompare < to;\n        },\n        equalTo: function (valueToCompare, from) {\n            return valueToCompare == from;\n        },\n        notEqualTo: function (valueToCompare, from) {\n            return valueToCompare != from;\n        },\n        greaterThanOrEqualTo: function (valueToCompare, from) {\n            return valueToCompare >= from;\n        },\n        lessThanOrEqualTo: function (valueToCompare, from) {\n            return valueToCompare <= from;\n        },\n        notBetween: function (valueToCompare, from, to) {\n            return valueToCompare < from || valueToCompare > to;\n        },\n        custom: function (valueToCompare, from) {\n            return from;\n        },\n        list: function (valueToCompare, data) {\n            return data.indexOf(valueToCompare) > -1;\n        }\n    };\n    exports.Validation = Validation;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/sheet', [\n        'kendo.core',\n        'kendo.color',\n        'spreadsheet/runtime',\n        'spreadsheet/validation',\n        'spreadsheet/references'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var Range = kendo.spreadsheet.Range;\n        var Selection = kendo.Class.extend({\n            init: function (sheet) {\n                this._sheet = sheet;\n                this.selection = kendo.spreadsheet.FIRSTREF.toRangeRef();\n                this.originalSelection = kendo.spreadsheet.FIRSTREF.toRangeRef();\n                this._activeCell = kendo.spreadsheet.FIRSTREF.toRangeRef();\n                this.originalActiveCell = kendo.spreadsheet.FIRSTREF;\n            },\n            currentSelectionRange: function () {\n                return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef();\n            },\n            currentOriginalNavigationRange: function () {\n                return this.originalSelection.rangeAt(this.selectionRangeIndex).toRangeRef();\n            },\n            currentNavigationRange: function () {\n                if (this.singleCellSelection()) {\n                    return this._sheet._sheetRef;\n                } else {\n                    return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef();\n                }\n            },\n            nextNavigationRange: function () {\n                if (!this.singleCellSelection()) {\n                    this.selectionRangeIndex = this.selection.nextRangeIndex(this.selectionRangeIndex);\n                }\n                return this.currentNavigationRange();\n            },\n            previousNavigationRange: function () {\n                if (!this.singleCellSelection()) {\n                    this.selectionRangeIndex = this.selection.previousRangeIndex(this.selectionRangeIndex);\n                }\n                return this.currentNavigationRange();\n            },\n            activeCell: function (ref) {\n                if (ref) {\n                    this.originalActiveCell = ref;\n                    this._activeCell = this._sheet.unionWithMerged(ref.toRangeRef());\n                    this._sheet.focus(ref);\n                    this._sheet.triggerChange({\n                        activeCell: true,\n                        selection: true\n                    });\n                }\n                return this._activeCell;\n            },\n            select: function (ref, expanded, changeActiveCell) {\n                if (ref) {\n                    if (ref.eq(this.originalSelection)) {\n                        return;\n                    }\n                    this.originalSelection = ref;\n                    this.selection = expanded;\n                    if (changeActiveCell !== false) {\n                        if (ref.isCell()) {\n                            this.activeCell(ref);\n                        } else {\n                            this.activeCell(this.selection.lastRange().first());\n                        }\n                        this.selectionRangeIndex = this.selection.size() - 1;\n                    } else {\n                        this._sheet.triggerChange({ selection: true });\n                    }\n                }\n                return this.selection;\n            },\n            singleCellSelection: function () {\n                return this._activeCell.eq(this.selection);\n            }\n        });\n        var Sheet = kendo.Observable.extend({\n            init: function (rowCount, columnCount, rowHeight, columnWidth, headerHeight, headerWidth) {\n                kendo.Observable.prototype.init.call(this);\n                var cellCount = rowCount * columnCount - 1;\n                this._rows = new kendo.spreadsheet.Axis(rowCount, rowHeight);\n                this._columns = new kendo.spreadsheet.Axis(columnCount, columnWidth);\n                this._mergedCells = [];\n                this._frozenRows = 0;\n                this._frozenColumns = 0;\n                this._suspendChanges = false;\n                this._filter = null;\n                this._grid = new kendo.spreadsheet.Grid(this._rows, this._columns, rowCount, columnCount, headerHeight, headerWidth);\n                this._sheetRef = this._grid.normalize(kendo.spreadsheet.SHEETREF);\n                this._properties = new kendo.spreadsheet.PropertyBag(cellCount);\n                this._sorter = new kendo.spreadsheet.Sorter(this._grid, this._properties.sortable());\n                this._viewSelection = new Selection(this);\n                this._editSelection = new Selection(this);\n                this._formulaSelections = [];\n                this.options = { showGridLines: true };\n            },\n            _selectionState: function () {\n                return this._inEdit ? this._editSelection : this._viewSelection;\n            },\n            navigator: function () {\n                if (!this._navigator) {\n                    this._navigator = new kendo.spreadsheet.SheetNavigator(this);\n                }\n                return this._navigator;\n            },\n            axisManager: function () {\n                if (!this._axisManager) {\n                    this._axisManager = new kendo.spreadsheet.AxisManager(this);\n                }\n                return this._axisManager;\n            },\n            _name: function (value) {\n                if (!value) {\n                    return this._sheetName;\n                }\n                this._sheetName = value;\n                return this;\n            },\n            name: function () {\n                return this._name();\n            },\n            _property: function (accessor, value, reason) {\n                if (value === undefined) {\n                    return accessor();\n                } else {\n                    accessor(value);\n                    return this.triggerChange(reason);\n                }\n            },\n            _field: function (name, value, reason) {\n                if (value === undefined) {\n                    return this[name];\n                } else {\n                    this[name] = value;\n                    return this.triggerChange(reason);\n                }\n            },\n            suspendChanges: function (value) {\n                if (value === undefined) {\n                    return this._suspendChanges;\n                }\n                this._suspendChanges = value;\n                return this;\n            },\n            triggerChange: function (reason) {\n                if (!this._suspendChanges) {\n                    this.trigger('change', reason);\n                }\n                return this;\n            },\n            setDataSource: function (dataSource, columns) {\n                if (this.dataSourceBinder) {\n                    this.dataSourceBinder.destroy();\n                }\n                this.dataSourceBinder = new kendo.spreadsheet.SheetDataSourceBinder({\n                    dataSource: dataSource,\n                    sheet: this,\n                    columns: columns\n                });\n            },\n            hideColumn: function (columnIndex) {\n                return this._property(this._columns.hide.bind(this._columns), columnIndex, { layout: true });\n            },\n            unhideColumn: function (columnIndex) {\n                return this._property(this._columns.unhide.bind(this._columns), columnIndex, { layout: true });\n            },\n            isHiddenColumn: function (columnIndex) {\n                return this._grid._columns.hidden(columnIndex);\n            },\n            _copyRange: function (sourceRangeRef, targetRef) {\n                var grid = this._grid;\n                var rowCount = grid.rowCount;\n                var nextRefTopLeft = grid.normalize(sourceRangeRef.topLeft);\n                var nextRefBottomRight = grid.normalize(sourceRangeRef.bottomRight);\n                var nextIndex = nextRefTopLeft.col * rowCount + nextRefTopLeft.row;\n                var nextBottomIndex = nextRefBottomRight.col * rowCount + nextRefBottomRight.row;\n                var targetIndex = targetRef.col * rowCount + targetRef.row;\n                this._properties.copy(nextIndex, nextBottomIndex, targetIndex);\n            },\n            _adjustReferences: function (operation, start, delta, mergedCells) {\n                this._mergedCells = mergedCells.reduce(function (a, ref) {\n                    ref = ref.adjust(null, null, null, null, operation == 'row', start, delta);\n                    if (ref !== kendo.spreadsheet.NULLREF) {\n                        a.push(ref);\n                    }\n                    return a;\n                }, []);\n                if (this._workbook) {\n                    var affectedSheet = this._name();\n                    this._workbook._sheets.forEach(function (sheet) {\n                        sheet._forFormulas(function (formula) {\n                            formula.adjust(affectedSheet, operation, start, delta);\n                        });\n                        sheet._forValidations(function (validation) {\n                            validation.adjust(affectedSheet, operation, start, delta);\n                        });\n                    });\n                    this._workbook.adjustNames(affectedSheet, operation == 'row', start, delta);\n                }\n                var selection = this.select();\n                selection = selection.adjust(null, null, null, null, operation == 'row', start, delta);\n                if (selection !== kendo.spreadsheet.NULLREF) {\n                    this.select(selection);\n                }\n            },\n            _forFormulas: function (callback) {\n                var props = this._properties;\n                var formulas = props.get('formula').values();\n                var n = formulas.length;\n                formulas.forEach(function (f, i) {\n                    callback.call(this, f.value, i, n);\n                }, this);\n            },\n            _forValidations: function (callback) {\n                var props = this._properties;\n                props.get('validation').values().forEach(function (v) {\n                    callback.call(this, v.value);\n                }, this);\n            },\n            canInsertRow: function (rowIndex, count) {\n                count = count || 1;\n                var grid = this._grid;\n                var range = this.range(grid.rowCount - count, 0, count, grid.columnCount);\n                return !range.hasValue();\n            },\n            insertRow: function (rowIndex) {\n                if (!this.canInsertRow(rowIndex)) {\n                    throw new Error('Shifting nonblank cells off the worksheet is not supported!');\n                }\n                this.batch(function () {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var rowCount = grid.rowCount;\n                    var frozenRows = this.frozenRows();\n                    if (rowIndex < frozenRows) {\n                        this.frozenRows(frozenRows + 1);\n                    }\n                    var mergedCells = this._mergedCells.slice();\n                    for (var ci = 0; ci < columnCount; ci++) {\n                        var ref = new RangeRef(new CellRef(rowIndex, ci), new CellRef(rowIndex, ci));\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n                        var nextRef = new RangeRef(new CellRef(topLeft.row, topLeft.col), new CellRef(rowCount - 2, bottomRight.col));\n                        this._copyRange(nextRef, new CellRef(topLeft.row + 1, topLeft.col));\n                        new Range(ref, this).clear();\n                    }\n                    this._adjustReferences('row', rowIndex, 1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true\n                });\n                this.trigger('insertRow', { index: rowIndex });\n                return this;\n            },\n            isEnabledRow: function (rowIndex) {\n                var ref = new RangeRef(new CellRef(rowIndex, 0), new CellRef(rowIndex, this._grid.columnCount));\n                return new Range(ref, this).enable();\n            },\n            deleteRow: function (rowIndex) {\n                if (!this.isEnabledRow(rowIndex)) {\n                    return this;\n                }\n                this.batch(function () {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var frozenRows = this.frozenRows();\n                    if (rowIndex < frozenRows) {\n                        this.frozenRows(frozenRows - 1);\n                    }\n                    var mergedCells = this._mergedCells.slice();\n                    for (var ci = 0; ci < columnCount; ci++) {\n                        var ref = new RangeRef(new CellRef(rowIndex, ci), new CellRef(rowIndex, ci));\n                        new Range(ref, this).clear();\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n                        var nextRef = new RangeRef(new CellRef(topLeft.row + 1, topLeft.col), new CellRef(Infinity, bottomRight.col));\n                        this._copyRange(nextRef, topLeft);\n                        var nextRefBottomRight = grid.normalize(nextRef.bottomRight);\n                        new Range(new RangeRef(nextRefBottomRight, nextRefBottomRight), this).clear();\n                    }\n                    this._adjustReferences('row', rowIndex, -1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true\n                });\n                this.trigger('deleteRow', { index: rowIndex });\n                return this;\n            },\n            insertColumn: function (columnIndex) {\n                this.batch(function () {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var frozenColumns = this.frozenColumns();\n                    if (columnIndex < frozenColumns) {\n                        this.frozenColumns(frozenColumns + 1);\n                    }\n                    var mergedCells = this._mergedCells.slice();\n                    for (var ci = columnCount; ci >= columnIndex; ci--) {\n                        var ref = new RangeRef(new CellRef(0, ci), new CellRef(Infinity, ci));\n                        new Range(ref, this).clear();\n                        if (ci == columnIndex) {\n                            break;\n                        }\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n                        var nextRef = new RangeRef(new CellRef(topLeft.row, topLeft.col - 1), new CellRef(bottomRight.row, bottomRight.col - 1));\n                        this._copyRange(nextRef, topLeft);\n                    }\n                    this._adjustReferences('col', columnIndex, 1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true\n                });\n                return this;\n            },\n            isEnabledColumn: function (columnIndex) {\n                var ref = new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, columnIndex));\n                return new Range(ref, this).enable();\n            },\n            deleteColumn: function (columnIndex) {\n                if (!this.isEnabledColumn(columnIndex)) {\n                    return this;\n                }\n                this.batch(function () {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var frozenColumns = this.frozenColumns();\n                    if (columnIndex < frozenColumns) {\n                        this.frozenColumns(frozenColumns - 1);\n                    }\n                    var mergedCells = this._mergedCells.slice();\n                    for (var ci = columnIndex; ci < columnCount; ci++) {\n                        var ref = new RangeRef(new CellRef(0, ci), new CellRef(Infinity, ci));\n                        new Range(ref, this).clear();\n                        if (ci == columnCount - 1) {\n                            break;\n                        }\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n                        var nextRef = new RangeRef(new CellRef(topLeft.row, topLeft.col + 1), new CellRef(bottomRight.row, bottomRight.col + 1));\n                        this._copyRange(nextRef, topLeft);\n                    }\n                    this._adjustReferences('col', columnIndex, -1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true\n                });\n                return this;\n            },\n            hideRow: function (rowIndex) {\n                return this._property(this._rows.hide.bind(this._rows), rowIndex, { layout: true });\n            },\n            unhideRow: function (rowIndex) {\n                return this._property(this._rows.unhide.bind(this._rows), rowIndex, { layout: true });\n            },\n            isHiddenRow: function (rowIndex) {\n                return this._grid._rows.hidden(rowIndex);\n            },\n            columnWidth: function (columnIndex, width) {\n                return this._property(this._columns.value.bind(this._columns, columnIndex, columnIndex), width, { layout: true });\n            },\n            rowHeight: function (rowIndex, height) {\n                return this._property(this._rows.value.bind(this._rows, rowIndex, rowIndex), height, { layout: true });\n            },\n            frozenRows: function (value) {\n                return this._field('_frozenRows', value, { layout: true });\n            },\n            frozenColumns: function (value) {\n                return this._field('_frozenColumns', value, { layout: true });\n            },\n            _ref: function (row, column, numRows, numColumns) {\n                var ref = null;\n                if (row instanceof kendo.spreadsheet.Ref) {\n                    return row;\n                }\n                if (row instanceof kendo.spreadsheet.Range) {\n                    return row._ref.toRangeRef();\n                }\n                if (typeof row === 'string') {\n                    ref = kendo.spreadsheet.calc.parseReference(row);\n                } else {\n                    if (!numRows) {\n                        numRows = 1;\n                    }\n                    if (!numColumns) {\n                        numColumns = 1;\n                    }\n                    ref = new RangeRef(new CellRef(row, column), new CellRef(row + numRows - 1, column + numColumns - 1));\n                }\n                return ref;\n            },\n            range: function (row, column, numRows, numColumns) {\n                return new Range(this._ref(row, column, numRows, numColumns), this);\n            },\n            forEachMergedCell: function (ref, callback) {\n                var selectAll = false;\n                if (typeof callback === 'undefined') {\n                    callback = ref;\n                    selectAll = true;\n                }\n                this._mergedCells.forEach(function (merged) {\n                    if (selectAll || merged.intersects(ref)) {\n                        callback(merged);\n                    }\n                });\n            },\n            forEachFilterHeader: function (ref, callback) {\n                var selectAll = false;\n                if (typeof callback === 'undefined') {\n                    callback = ref;\n                    selectAll = true;\n                }\n                if (this._filter) {\n                    var refs = [];\n                    this._filter.ref.forEachColumn(function (columnRef) {\n                        if (selectAll || columnRef.intersects(ref)) {\n                            refs.push(columnRef.topLeft);\n                        }\n                    });\n                    this._mergedCells.forEach(function (merged) {\n                        refs = refs.map(function (ref) {\n                            if (merged.intersects(ref)) {\n                                return merged;\n                            }\n                            return ref;\n                        });\n                    });\n                    refs.reduce(function unique(result, element) {\n                        if (result.indexOf(element) < 0) {\n                            result.push(element);\n                        }\n                        return result;\n                    }, []).forEach(callback);\n                }\n            },\n            forEach: function (ref, callback) {\n                if (!(ref instanceof RangeRef)) {\n                    ref = this._ref(ref);\n                }\n                var topLeft = this._grid.normalize(ref.topLeft);\n                var bottomRight = this._grid.normalize(ref.bottomRight);\n                for (var ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    var ri = topLeft.row;\n                    var startCellIndex = this._grid.index(ri, ci);\n                    var endCellIndex = this._grid.index(bottomRight.row, ci);\n                    this._properties.forEach(startCellIndex, endCellIndex, function (value) {\n                        callback(ri++, ci, value);\n                    });\n                }\n            },\n            startResizing: function (initialPosition) {\n                this._initialPosition = initialPosition;\n                this._resizeInProgress = true;\n            },\n            startAutoFill: function () {\n                this._autoFillInProgress = true;\n                var selection = this.select();\n                this._autoFillOrigin = selection;\n                this._autoFillDest = selection;\n                this.triggerChange({ selection: true });\n            },\n            updateAutoFill: function (dest, punch, hint, direction) {\n                this._autoFillDest = dest;\n                this._autoFillPunch = punch;\n                this._autoFillHint = hint;\n                this._autoFillDirection = direction;\n                this.triggerChange({ selection: true });\n            },\n            autoFillRef: function () {\n                return this._autoFillDest;\n            },\n            autoFillPunch: function () {\n                return this._autoFillPunch;\n            },\n            autoFillInProgress: function () {\n                return this._autoFillInProgress;\n            },\n            resizingInProgress: function () {\n                return this._resizeInProgress;\n            },\n            completeResizing: function () {\n                if (this._resizeInProgress) {\n                    this._resizeInProgress = false;\n                    var hintPosition = this.resizeHintPosition();\n                    if (this._initialPosition && hintPosition) {\n                        var handlePosition = this.resizeHandlePosition();\n                        if (handlePosition.col !== -Infinity) {\n                            this.columnWidth(handlePosition.col, this.columnWidth(handlePosition.col) - (this._initialPosition.x - hintPosition.x));\n                        } else {\n                            this.rowHeight(handlePosition.row, this.rowHeight(handlePosition.row) - (this._initialPosition.y - hintPosition.y));\n                        }\n                    } else {\n                        this.trigger('change', { resize: true });\n                    }\n                }\n            },\n            resizeHandlePosition: function () {\n                return this._resizeHandlePosition;\n            },\n            resizeHintPosition: function (location) {\n                if (location !== undefined) {\n                    this._resizeHintPosition = location;\n                    this.trigger('change', { resize: true });\n                }\n                return this._resizeHintPosition;\n            },\n            removeResizeHandle: function () {\n                if (this._resizeHandlePosition) {\n                    this._resizeHintPosition = undefined;\n                    this._resizeHandlePosition = undefined;\n                    this._initialPosition = undefined;\n                    this.trigger('change', { resize: true });\n                }\n            },\n            positionResizeHandle: function (ref) {\n                this._resizeHandlePosition = ref;\n                this.trigger('change', { resize: true });\n            },\n            startSelection: function () {\n                this._selectionInProgress = true;\n            },\n            completeSelection: function () {\n                if (this._selectionInProgress) {\n                    this._selectionInProgress = false;\n                    this._resizeHintPosition = undefined;\n                    this.trigger('change', { selection: true });\n                }\n                if (this._autoFillInProgress) {\n                    this._autoFillInProgress = false;\n                    var dest = this._autoFillDest;\n                    var origin = this._autoFillOrigin;\n                    if (this._autoFillPunch) {\n                        this._workbook.execute({\n                            command: 'ClearContentCommand',\n                            options: { operatingRange: this.range(this._autoFillPunch) }\n                        });\n                    } else {\n                        if (!dest.eq(origin)) {\n                            this._workbook.execute({\n                                command: 'AutoFillCommand',\n                                options: {\n                                    operatingRange: this.range(dest),\n                                    origin: this.range(origin)\n                                }\n                            });\n                        } else {\n                            this.triggerChange({ selection: true });\n                        }\n                    }\n                    this._autoFillDest = null;\n                    this._autoFillPunch = null;\n                    this._autoFillOrigin = null;\n                    this.select(dest);\n                }\n            },\n            selectionInProgress: function () {\n                return this._selectionInProgress;\n            },\n            select: function (ref, changeActiveCell) {\n                var selectionState = this._selectionState();\n                var expandedRef;\n                if (ref) {\n                    ref = this._ref(ref);\n                    expandedRef = this._grid.isAxis(ref) ? ref : this.unionWithMerged(ref);\n                }\n                return selectionState.select(ref, expandedRef, changeActiveCell);\n            },\n            originalSelect: function () {\n                return this._selectionState().originalSelection;\n            },\n            currentSelectionRange: function () {\n                return this._selectionState().currentSelectionRange();\n            },\n            currentOriginalSelectionRange: function () {\n                return this._selectionState().currentOriginalNavigationRange();\n            },\n            currentNavigationRange: function () {\n                return this._selectionState().currentNavigationRange();\n            },\n            nextNavigationRange: function () {\n                return this._selectionState().nextNavigationRange();\n            },\n            previousNavigationRange: function () {\n                return this._selectionState().previousNavigationRange();\n            },\n            selectionRangeIndex: function () {\n                return this._selectionState().selectionRangeIndex;\n            },\n            activeCell: function (ref) {\n                return this._selectionState().activeCell(ref);\n            },\n            originalActiveCell: function () {\n                return this._selectionState().originalActiveCell;\n            },\n            singleCellSelection: function () {\n                return this._selectionState().singleCellSelection();\n            },\n            unionWithMerged: function (ref) {\n                var mergedCells = this._mergedCells;\n                return ref.map(function (ref) {\n                    return ref.toRangeRef().union(mergedCells);\n                });\n            },\n            trim: function (ref) {\n                var trims = [];\n                var grid = this._grid;\n                this._properties.forEachProperty(function (property) {\n                    trims.push(grid.trim(ref, property.list));\n                });\n                return this.unionWithMerged(ref.topLeft.toRangeRef().union(trims));\n            },\n            focus: function (ref) {\n                if (ref) {\n                    this._focus = ref.toRangeRef();\n                } else {\n                    var focus = this._focus;\n                    this._focus = null;\n                    return focus;\n                }\n            },\n            activeCellSelection: function () {\n                return new Range(this._grid.normalize(this.activeCell()), this);\n            },\n            selection: function () {\n                return new Range(this._grid.normalize(this._selectionState().selection), this);\n            },\n            selectedHeaders: function () {\n                var selection = this.select();\n                var rows = {};\n                var cols = {};\n                var allCols = false;\n                var allRows = false;\n                selection.forEach(function (ref) {\n                    var i;\n                    var rowState = 'partial';\n                    var colState = 'partial';\n                    ref = ref.toRangeRef();\n                    var bottomRight = ref.bottomRight;\n                    var rowSelection = bottomRight.col === Infinity;\n                    var colSelection = bottomRight.row === Infinity;\n                    if (colSelection) {\n                        allRows = true;\n                        colState = 'full';\n                    }\n                    if (rowSelection) {\n                        allCols = true;\n                        rowState = 'full';\n                    }\n                    if (!colSelection) {\n                        for (i = ref.topLeft.row; i <= bottomRight.row; i++) {\n                            if (rows[i] !== 'full') {\n                                rows[i] = rowState;\n                            }\n                        }\n                    }\n                    if (!rowSelection) {\n                        for (i = ref.topLeft.col; i <= bottomRight.col; i++) {\n                            if (cols[i] !== 'full') {\n                                cols[i] = colState;\n                            }\n                        }\n                    }\n                });\n                return {\n                    rows: rows,\n                    cols: cols,\n                    allRows: allRows,\n                    allCols: allCols,\n                    all: allRows && allCols\n                };\n            },\n            isInEditMode: function (isInEdit) {\n                if (isInEdit === undefined) {\n                    return this._inEdit;\n                }\n                this._inEdit = isInEdit;\n                if (isInEdit) {\n                    this._editSelection.selection = this._viewSelection.selection.clone();\n                    this._editSelection.originalSelection = this._viewSelection.originalSelection.clone();\n                    this._editSelection._activeCell = this._viewSelection._activeCell.clone();\n                    this._editSelection.originalActiveCell = this._viewSelection.originalActiveCell.clone();\n                }\n            },\n            _setFormulaSelections: function (selection) {\n                this._formulaSelections = (selection || []).slice();\n                this.triggerChange({ selection: true });\n            },\n            _viewActiveCell: function () {\n                return this._viewSelection._activeCell.toRangeRef();\n            },\n            toJSON: function () {\n                var positions = {};\n                var rows = this._rows.toJSON('height', positions);\n                var columns = this._columns.toJSON('width', {});\n                var viewSelection = this._viewSelection;\n                this.forEach(kendo.spreadsheet.SHEETREF, function (row, col, cell) {\n                    if (Object.keys(cell).length === 0) {\n                        return;\n                    }\n                    var position = positions[row];\n                    if (position === undefined) {\n                        position = rows.length;\n                        rows.push({ index: row });\n                        positions[row] = position;\n                    }\n                    row = rows[position];\n                    cell.index = col;\n                    if (row.cells === undefined) {\n                        row.cells = [];\n                    }\n                    if (cell.formula) {\n                        cell.formula = cell.formula.toString();\n                    }\n                    if (cell.validation) {\n                        cell.validation = cell.validation.toJSON();\n                    }\n                    if (cell.color) {\n                        cell.color = kendo.parseColor(cell.color).toCss();\n                    }\n                    if (cell.background) {\n                        cell.background = kendo.parseColor(cell.background).toCss();\n                    }\n                    if (cell.borderTop && cell.borderTop.color) {\n                        cell.borderTop.color = kendo.parseColor(cell.borderTop.color).toCss();\n                    }\n                    if (cell.borderBottom && cell.borderBottom.color) {\n                        cell.borderBottom.color = kendo.parseColor(cell.borderBottom.color).toCss();\n                    }\n                    if (cell.borderRight && cell.borderRight.color) {\n                        cell.borderRight.color = kendo.parseColor(cell.borderRight.color).toCss();\n                    }\n                    if (cell.borderLeft && cell.borderLeft.color) {\n                        cell.borderLeft.color = kendo.parseColor(cell.borderLeft.color).toCss();\n                    }\n                    row.cells.push(cell);\n                });\n                var json = {\n                    name: this._name(),\n                    rows: rows,\n                    columns: columns,\n                    selection: viewSelection.selection.toString(),\n                    activeCell: viewSelection.activeCell().toString(),\n                    frozenRows: this.frozenRows(),\n                    frozenColumns: this.frozenColumns(),\n                    mergedCells: this._mergedCells.map(function (ref) {\n                        return ref.toString();\n                    })\n                };\n                if (this._sort) {\n                    json.sort = {\n                        ref: this._sort.ref.toString(),\n                        columns: this._sort.columns.map(function (column) {\n                            return {\n                                index: column.index,\n                                ascending: column.ascending\n                            };\n                        })\n                    };\n                }\n                if (this._filter) {\n                    json.filter = {\n                        ref: this._filter.ref.toString(),\n                        columns: this._filter.columns.map(function (column) {\n                            var filter = column.filter.toJSON();\n                            filter.index = column.index;\n                            return filter;\n                        })\n                    };\n                }\n                return json;\n            },\n            fromJSON: function (json) {\n                this.batch(function () {\n                    if (json.name !== undefined) {\n                        this._name(json.name);\n                    }\n                    if (json.frozenColumns !== undefined) {\n                        this.frozenColumns(json.frozenColumns);\n                    }\n                    if (json.frozenRows !== undefined) {\n                        this.frozenRows(json.frozenRows);\n                    }\n                    if (json.columns !== undefined) {\n                        this._columns.fromJSON('width', json.columns);\n                    }\n                    if (json.rows !== undefined) {\n                        this._rows.fromJSON('height', json.rows);\n                        for (var ri = 0; ri < json.rows.length; ri++) {\n                            var row = json.rows[ri];\n                            var rowIndex = row.index;\n                            if (rowIndex === undefined) {\n                                rowIndex = ri;\n                            }\n                            if (row.cells) {\n                                for (var ci = 0; ci < row.cells.length; ci++) {\n                                    var cell = row.cells[ci];\n                                    var columnIndex = cell.index;\n                                    if (columnIndex === undefined) {\n                                        columnIndex = ci;\n                                    }\n                                    if (cell.formula) {\n                                        cell.formula = this._compileFormula(rowIndex, columnIndex, cell.formula);\n                                    }\n                                    if (cell.validation) {\n                                        cell.validation = this._compileValidation(rowIndex, columnIndex, cell.validation);\n                                    }\n                                    this._properties.fromJSON(this._grid.index(rowIndex, columnIndex), cell);\n                                }\n                            }\n                        }\n                    }\n                    if (json.selection) {\n                        this._viewSelection.selection = this._viewSelection.originalSelection = this._ref(json.selection);\n                    }\n                    if (json.activeCell) {\n                        var activeCellRef = this._ref(json.activeCell);\n                        this._viewSelection._activeCell = activeCellRef.toRangeRef();\n                        this._viewSelection.originalActiveCell = activeCellRef;\n                    }\n                    if (json.mergedCells) {\n                        json.mergedCells.forEach(function (ref) {\n                            this.range(ref).merge();\n                        }, this);\n                    }\n                    if (json.sort) {\n                        this._sort = {\n                            ref: this._ref(json.sort.ref),\n                            columns: json.sort.columns.slice(0)\n                        };\n                    }\n                    if (json.filter) {\n                        var ref = json.filter.ref;\n                        var columns = json.filter.columns === undefined ? [] : json.filter.columns;\n                        if (!ref) {\n                            kendo.logToConsole('Dropping filter for sheet \\'' + json.name + '\\' due to missing ref');\n                        } else {\n                            this._filter = {\n                                ref: this._ref(ref),\n                                columns: columns.map(function (column) {\n                                    return {\n                                        index: column.index,\n                                        filter: kendo.spreadsheet.Filter.create(column)\n                                    };\n                                })\n                            };\n                            this._refreshFilter();\n                        }\n                    }\n                });\n            },\n            formula: function (ref) {\n                return this._properties.get('formula', this._grid.cellRefIndex(ref));\n            },\n            validation: function (ref) {\n                return this._properties.get('validation', this._grid.cellRefIndex(ref));\n            },\n            resetFormulas: function () {\n                this._forFormulas(function (formula) {\n                    formula.reset();\n                });\n            },\n            resetValidations: function () {\n                this._forValidations(function (validation) {\n                    validation.reset();\n                });\n            },\n            recalc: function (context, callback) {\n                var formulas = this._properties.get('formula').values();\n                var count = formulas.length, pending = 0, i = 0;\n                if (!count && callback) {\n                    return callback();\n                }\n                function next() {\n                    pending--;\n                    if (i == count && !pending) {\n                        callback();\n                    }\n                }\n                while (i < count) {\n                    pending++;\n                    formulas[i++].value.exec(context, callback ? next : null);\n                }\n            },\n            revalidate: function (context) {\n                var self = this;\n                this._forValidations(function (validation) {\n                    var cellRef = new CellRef(validation.row, validation.col);\n                    var ref = new RangeRef(cellRef, cellRef);\n                    validation.exec(context, self._get(ref, 'value'), self._get(ref, 'format'));\n                });\n            },\n            _value: function (row, col, value) {\n                var index = this._grid.index(row, col);\n                if (value !== undefined) {\n                    this._properties.set('value', index, index, value);\n                } else {\n                    return this._properties.get('value', index);\n                }\n            },\n            _validation: function (row, col) {\n                var index = this._grid.index(row, col);\n                return this._properties.get('validation', index);\n            },\n            _compileValidation: function (row, col, validation) {\n                if (validation.from !== null || validation.from !== undefined) {\n                    validation.from = (validation.from + '').replace(/^=/, '');\n                }\n                if (validation.to !== null || validation.to !== undefined) {\n                    validation.to = (validation.to + '').replace(/^=/, '');\n                }\n                return kendo.spreadsheet.validation.compile(this._name(), row, col, validation);\n            },\n            _compileFormula: function (row, col, f) {\n                f = f.replace(/^=/, '');\n                f = kendo.spreadsheet.calc.parseFormula(this._name(), row, col, f);\n                return kendo.spreadsheet.calc.compile(f);\n            },\n            _copyValuesInRange: function (topLeft, bottomRight, value, property) {\n                var ci, start, end;\n                for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    start = this._grid.index(topLeft.row, ci);\n                    end = this._grid.index(bottomRight.row, ci);\n                    for (var index = start, row = topLeft.row; index <= end; ++index, ++row) {\n                        value = value.clone(this._name(), row, ci);\n                        this._properties.set(property, index, index, value);\n                    }\n                }\n                return value;\n            },\n            _set: function (ref, name, value) {\n                var topLeft = this._grid.normalize(ref.topLeft);\n                var bottomRight = this._grid.normalize(ref.bottomRight);\n                var ci, start, end;\n                if (value && name == 'formula') {\n                    if (typeof value == 'string') {\n                        value = this._compileFormula(topLeft.row, topLeft.col, value);\n                    }\n                    value = this._copyValuesInRange(topLeft, bottomRight, value, 'formula');\n                } else if (value && name == 'validation') {\n                    value = this._compileValidation(topLeft.row, topLeft.col, value);\n                    value = this._copyValuesInRange(topLeft, bottomRight, value, 'validation');\n                } else {\n                    for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                        start = this._grid.index(topLeft.row, ci);\n                        end = this._grid.index(bottomRight.row, ci);\n                        this._properties.set(name, start, end, value);\n                        if (name == 'formula') {\n                            this._properties.set('value', start, end, null);\n                        }\n                    }\n                }\n            },\n            _get: function (ref, name) {\n                var topLeft = this._grid.normalize(ref.topLeft);\n                var index = this._grid.index(topLeft.row, topLeft.col);\n                return this._properties.get(name, index);\n            },\n            batch: function (callback, reason) {\n                var suspended = this.suspendChanges();\n                this.suspendChanges(true);\n                callback.call(this);\n                return this.suspendChanges(suspended).triggerChange(reason);\n            },\n            _sortBy: function (ref, columns) {\n                var indices = null;\n                columns.forEach(function (column) {\n                    indices = this._sorter.sortBy(ref, column.index, this._properties.get('value'), column.ascending, indices);\n                }, this);\n                this._sort = {\n                    ref: ref,\n                    columns: columns\n                };\n                this._refreshFilter();\n                this.triggerChange({ recalc: true });\n            },\n            _refreshFilter: function () {\n                if (this._filter) {\n                    this._filterBy(this._filter.ref, this._filter.columns);\n                }\n            },\n            _filterBy: function (ref, columns) {\n                this.batch(function () {\n                    for (var ri = ref.topLeft.row; ri <= ref.bottomRight.row; ri++) {\n                        if (this._rows.hidden(ri)) {\n                            this._rows.unhide(ri);\n                        }\n                    }\n                    columns.forEach(function (column) {\n                        var columnRef = ref.resize({ top: 1 }).toColumn(column.index);\n                        var cells = [];\n                        if (columnRef === kendo.spreadsheet.NULLREF) {\n                            return;\n                        }\n                        this.forEach(columnRef, function (row, col, cell) {\n                            cell.row = row;\n                            cells.push(cell);\n                        });\n                        column.filter.prepare(cells);\n                        for (var ci = 0; ci < cells.length; ci++) {\n                            var cell = cells[ci];\n                            var value = column.filter.value(cell);\n                            if (column.filter.matches(value) === false) {\n                                this.hideRow(cell.row);\n                            }\n                        }\n                    }, this);\n                    this._filter = {\n                        ref: ref,\n                        columns: columns\n                    };\n                }, {\n                    layout: true,\n                    filter: true\n                });\n            },\n            filterColumn: function (ref) {\n                var filterRef = this.filter().ref;\n                return ref.toRangeRef().topLeft.col - filterRef.topLeft.col;\n            },\n            filter: function () {\n                return this._filter;\n            },\n            clearFilter: function (spec) {\n                this._clearFilter(spec instanceof Array ? spec : [spec]);\n            },\n            _clearFilter: function (indices) {\n                if (this._filter) {\n                    this.batch(function () {\n                        this._filter.columns = this._filter.columns.filter(function (column) {\n                            return indices.indexOf(column.index) < 0;\n                        });\n                        this._refreshFilter();\n                    }, {\n                        layout: true,\n                        filter: true\n                    });\n                }\n            },\n            getAxisState: function () {\n                return {\n                    rows: this._rows.getState(),\n                    columns: this._columns.getState()\n                };\n            },\n            setAxisState: function (state) {\n                this._rows.setState(state.rows);\n                this._columns.setState(state.columns);\n                this.triggerChange({ layout: true });\n            },\n            getState: function () {\n                return {\n                    rows: this._rows.getState(),\n                    columns: this._columns.getState(),\n                    mergedCells: this._mergedCells.map(function (cell) {\n                        return cell.clone();\n                    }),\n                    properties: this._properties.getState()\n                };\n            },\n            setState: function (state) {\n                this._rows.setState(state.rows);\n                this._columns.setState(state.columns);\n                this._mergedCells = state.mergedCells;\n                this._properties.setState(state.properties);\n                this.triggerChange(kendo.spreadsheet.ALL_REASONS);\n            },\n            _merge: function (ref) {\n                var mergedCells = this._mergedCells;\n                var sheet = this;\n                var mergedRef;\n                this.batch(function () {\n                    mergedRef = ref.map(function (ref) {\n                        if (ref instanceof kendo.spreadsheet.CellRef) {\n                            return ref;\n                        }\n                        var currentRef = ref.toRangeRef().union(mergedCells, function (ref) {\n                            mergedCells.splice(mergedCells.indexOf(ref), 1);\n                        });\n                        var range = new Range(currentRef, sheet);\n                        var formula = range._get('formula');\n                        var value = range.value();\n                        var format = range.format();\n                        var background = range.background();\n                        range.value(null);\n                        range.format(null);\n                        range.background(null);\n                        var topLeft = new Range(currentRef.collapse(), sheet);\n                        if (formula) {\n                            topLeft._set('formula', formula);\n                        } else {\n                            topLeft.value(value);\n                        }\n                        topLeft.format(format);\n                        topLeft.background(background);\n                        mergedCells.push(currentRef);\n                        return currentRef;\n                    });\n                    var viewSelection = sheet._viewSelection;\n                    viewSelection.selection = sheet.unionWithMerged(viewSelection.originalSelection);\n                    viewSelection._activeCell = sheet.unionWithMerged(viewSelection.originalActiveCell);\n                }, {\n                    activeCell: true,\n                    selection: true\n                });\n                return mergedRef;\n            }\n        });\n        kendo.spreadsheet.Sheet = Sheet;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/sheetsbar', [\n        'kendo.core',\n        'kendo.sortable'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var DOT = '.';\n        var EMPTYCHAR = ' ';\n        var sheetsBarClassNames = {\n            sheetsBarWrapper: 'k-widget k-header',\n            sheetsBarSheetsWrapper: 'k-tabstrip k-floatwrap k-tabstrip-bottom',\n            sheetsBarActive: 'k-spreadsheet-sheets-bar-active',\n            sheetsBarInactive: 'k-spreadsheet-sheets-bar-inactive',\n            sheetsBarAdd: 'k-spreadsheet-sheets-bar-add',\n            sheetsBarRemove: 'k-spreadsheet-sheets-remove',\n            sheetsBarItems: 'k-spreadsheet-sheets-items',\n            sheetsBarEditor: 'k-spreadsheet-sheets-editor',\n            sheetsBarScrollable: 'k-tabstrip-scrollable',\n            sheetsBarNext: 'k-tabstrip-next',\n            sheetsBarPrev: 'k-tabstrip-prev',\n            sheetsBarKItem: 'k-item k-state-default',\n            sheetsBarKActive: 'k-state-active k-state-tab-on-top',\n            sheetsBarKTextbox: 'k-textbox',\n            sheetsBarKLink: 'k-link',\n            sheetsBarKIcon: 'k-icon',\n            sheetsBarKFontIcon: 'k-font-icon',\n            sheetsBarKButton: 'k-button k-button-icon',\n            sheetsBarKButtonBare: 'k-button-bare',\n            sheetsBarKArrowW: 'k-i-arrow-w',\n            sheetsBarKArrowE: 'k-i-arrow-e',\n            sheetsBarKReset: 'k-reset k-tabstrip-items',\n            sheetsBarKIconX: 'k-i-x',\n            sheetsBarKSprite: 'k-sprite',\n            sheetsBarKIconPlus: 'k-i-plus',\n            sheetsBarHintWrapper: 'k-widget k-tabstrip k-tabstrip-bottom k-spreadsheet-sheets-items-hint',\n            sheetsBarKResetItems: 'k-reset k-tabstrip-items'\n        };\n        var SheetsBar = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                var classNames = SheetsBar.classNames;\n                kendo.ui.Widget.call(this, element, options);\n                element = this.element;\n                element.addClass(classNames.sheetsBarWrapper);\n                this._tree = new kendo.dom.Tree(element[0]);\n                this._tree.render([\n                    this._addButton(),\n                    this._createSheetsWrapper([])\n                ]);\n                this._toggleScrollEvents(true);\n                this._createSortable();\n                this._sortable.bind('start', this._onSheetReorderStart.bind(this));\n                this._sortable.bind('end', this._onSheetReorderEnd.bind(this));\n                element.on('click', DOT + classNames.sheetsBarRemove, this._onSheetRemove.bind(this));\n                element.on('click', 'li', this._onSheetSelect.bind(this));\n                element.on('dblclick', 'li' + DOT + classNames.sheetsBarActive, this._createEditor.bind(this));\n                element.on('click', DOT + classNames.sheetsBarAdd, this._onAddSelect.bind(this));\n            },\n            options: {\n                name: 'SheetsBar',\n                scrollable: { distance: 200 }\n            },\n            events: [\n                'select',\n                'reorder',\n                'rename'\n            ],\n            _createEditor: function () {\n                if (this._editor) {\n                    return;\n                }\n                this._renderSheets(this._sheets, this._selectedIndex, true);\n                this._editor = this.element.find(kendo.format('input{0}{1}', DOT, SheetsBar.classNames.sheetsBarEditor)).focus().on('keydown', this._onEditorKeydown.bind(this)).on('blur', this._onEditorBlur.bind(this));\n            },\n            _destroyEditor: function () {\n                this._editor.off();\n                this._editor = null;\n                this._renderSheets(this._sheets, this._selectedIndex, false);\n            },\n            renderSheets: function (sheets, selectedIndex) {\n                if (!sheets || selectedIndex < 0) {\n                    return;\n                }\n                this._renderSheets(sheets, selectedIndex, false);\n            },\n            _renderSheets: function (sheets, selectedIndex, isInEditMode) {\n                var that = this;\n                var wrapperOffsetWidth;\n                var sheetsGroupScrollWidth;\n                var classNames = SheetsBar.classNames;\n                that._isRtl = kendo.support.isRtl(that.element);\n                that._sheets = sheets;\n                that._selectedIndex = selectedIndex;\n                that._renderHtml(isInEditMode, true);\n                if (!that._scrollableAllowed()) {\n                    return;\n                }\n                var sheetsWrapper = that._sheetsWrapper();\n                var scrollPrevButton = sheetsWrapper.children(DOT + classNames.sheetsBarPrev);\n                var scrollNextButton = sheetsWrapper.children(DOT + classNames.sheetsBarNext);\n                var gapWidth = 2;\n                var addButton = that.element.find(DOT + classNames.sheetsBarAdd);\n                var addButtonWidth = addButton.outerWidth() + addButton.position().left + gapWidth;\n                var scrollPrevButtonWidth = scrollPrevButton.outerWidth() + gapWidth;\n                var sheetsGroup = that._sheetsGroup();\n                scrollPrevButton.css({ left: addButtonWidth });\n                sheetsWrapper.addClass(classNames.sheetsBarScrollable + EMPTYCHAR + classNames.sheetsBarSheetsWrapper);\n                sheetsGroup.css({ marginLeft: addButtonWidth });\n                wrapperOffsetWidth = sheetsWrapper[0].offsetWidth;\n                sheetsGroupScrollWidth = sheetsGroup[0].scrollWidth;\n                if (sheetsGroupScrollWidth + addButtonWidth > wrapperOffsetWidth) {\n                    var scrollNextButtonRight = Math.ceil(kendo.parseFloat(scrollNextButton.css('right')));\n                    if (!that._scrollableModeActive) {\n                        that._nowScrollingSheets = false;\n                        that._scrollableModeActive = true;\n                    }\n                    sheetsGroup.css({\n                        marginLeft: scrollPrevButtonWidth + addButtonWidth,\n                        marginRight: scrollNextButton.outerWidth() + scrollNextButtonRight + gapWidth\n                    });\n                } else {\n                    if (that._scrollableModeActive && sheetsGroupScrollWidth <= wrapperOffsetWidth) {\n                        that._scrollableModeActive = false;\n                        sheetsGroup.css({\n                            marginLeft: addButtonWidth,\n                            marginRight: ''\n                        });\n                    } else {\n                        sheetsGroup.css({ marginLeft: addButtonWidth });\n                    }\n                }\n                that._toggleScrollButtons();\n            },\n            _toggleScrollButtons: function (toggle) {\n                var that = this;\n                var ul = that._sheetsGroup();\n                var wrapper = that._sheetsWrapper();\n                var scrollLeft = ul.scrollLeft();\n                var prev = wrapper.find(DOT + SheetsBar.classNames.sheetsBarPrev);\n                var next = wrapper.find(DOT + SheetsBar.classNames.sheetsBarNext);\n                if (toggle === false) {\n                    prev.toggle(false);\n                    next.toggle(false);\n                } else {\n                    prev.toggle(that._isRtl ? scrollLeft < ul[0].scrollWidth - ul[0].offsetWidth - 1 : scrollLeft !== 0);\n                    next.toggle(that._isRtl ? scrollLeft !== 0 : scrollLeft < ul[0].scrollWidth - ul[0].offsetWidth - 1);\n                }\n            },\n            _toggleScrollEvents: function (toggle) {\n                var that = this;\n                var classNames = SheetsBar.classNames;\n                var options = that.options;\n                var scrollPrevButton;\n                var scrollNextButton;\n                var sheetsWrapper = that._sheetsWrapper();\n                scrollPrevButton = sheetsWrapper.children(DOT + classNames.sheetsBarPrev);\n                scrollNextButton = sheetsWrapper.children(DOT + classNames.sheetsBarNext);\n                if (toggle) {\n                    scrollPrevButton.on('mousedown', function () {\n                        that._nowScrollingSheets = true;\n                        that._scrollSheetsByDelta(options.scrollable.distance * (that._isRtl ? 1 : -1));\n                    });\n                    scrollNextButton.on('mousedown', function () {\n                        that._nowScrollingSheets = true;\n                        that._scrollSheetsByDelta(options.scrollable.distance * (that._isRtl ? -1 : 1));\n                    });\n                    scrollPrevButton.add(scrollNextButton).on('mouseup', function () {\n                        that._nowScrollingSheets = false;\n                    });\n                } else {\n                    scrollPrevButton.off();\n                    scrollNextButton.off();\n                }\n            },\n            _renderHtml: function (isInEditMode, renderScrollButtons) {\n                var idx;\n                var sheetElements = [];\n                var dom = kendo.dom;\n                var element = dom.element;\n                var sheets = this._sheets;\n                var selectedIndex = this._selectedIndex;\n                var classNames = SheetsBar.classNames;\n                for (idx = 0; idx < sheets.length; idx++) {\n                    var sheet = sheets[idx];\n                    var isSelectedSheet = idx === selectedIndex;\n                    var attr = { className: classNames.sheetsBarKItem + EMPTYCHAR };\n                    var elementContent = [];\n                    if (isSelectedSheet) {\n                        attr.className += classNames.sheetsBarKActive + EMPTYCHAR + classNames.sheetsBarActive;\n                    } else {\n                        attr.className += classNames.sheetsBarInactive;\n                    }\n                    if (isSelectedSheet && isInEditMode) {\n                        elementContent.push(element('input', {\n                            type: 'text',\n                            value: sheet.name(),\n                            className: classNames.sheetsBarKTextbox + EMPTYCHAR + classNames.sheetsBarEditor,\n                            maxlength: 50\n                        }, []));\n                    } else {\n                        elementContent.push(element('span', {\n                            className: classNames.sheetsBarKLink,\n                            title: sheet.name()\n                        }, [dom.text(sheet.name())]));\n                        var deleteIcon = element('span', { className: classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKFontIcon + EMPTYCHAR + classNames.sheetsBarKIconX }, []);\n                        elementContent.push(element('span', { className: classNames.sheetsBarKLink + EMPTYCHAR + classNames.sheetsBarRemove }, [deleteIcon]));\n                    }\n                    sheetElements.push(element('li', attr, elementContent));\n                }\n                this._tree.render([\n                    this._addButton(),\n                    this._createSheetsWrapper(sheetElements, renderScrollButtons)\n                ]);\n            },\n            _createSheetsWrapper: function (sheetElements, renderScrollButtons) {\n                var element = kendo.dom.element;\n                var classNames = SheetsBar.classNames;\n                var childrenElements = [element('ul', { className: classNames.sheetsBarKReset }, sheetElements)];\n                renderScrollButtons = true;\n                if (renderScrollButtons) {\n                    var baseButtonClass = classNames.sheetsBarKButton + EMPTYCHAR + classNames.sheetsBarKButtonBare + EMPTYCHAR;\n                    childrenElements.push(element('span', { className: baseButtonClass + classNames.sheetsBarPrev }, [element('span', { className: classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKArrowW }, [])]));\n                    childrenElements.push(element('span', { className: baseButtonClass + classNames.sheetsBarNext }, [element('span', { className: classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKArrowE }, [])]));\n                }\n                return element('div', { className: classNames.sheetsBarItems }, childrenElements);\n            },\n            _createSortable: function () {\n                var classNames = SheetsBar.classNames;\n                this._sortable = new kendo.ui.Sortable(this.element, {\n                    filter: kendo.format('ul li.{0},ul li.{1}', classNames.sheetsBarActive, classNames.sheetsBarInactive),\n                    container: DOT + classNames.sheetsBarItems,\n                    axis: 'x',\n                    animation: false,\n                    ignore: 'input',\n                    end: function () {\n                        if (this.draggable.hint) {\n                            this.draggable.hint.remove();\n                        }\n                    },\n                    hint: function (element) {\n                        var hint = $(element).clone();\n                        return hint.wrap('<div class=\\'' + classNames.sheetsBarHintWrapper + '\\'><ul class=\\'' + classNames.sheetsBarKResetItems + '\\'></ul></div>').closest('div');\n                    }\n                });\n            },\n            _onEditorKeydown: function (e) {\n                if (this._editor) {\n                    if (e.which === 13) {\n                        this._destroyEditor();\n                        this._onSheetRename($(e.target).val());\n                    }\n                    if (e.which === 27) {\n                        this._destroyEditor();\n                        this._onSheetRename();\n                    }\n                }\n            },\n            _onEditorBlur: function (e) {\n                if (this._editor) {\n                    this._destroyEditor();\n                    this._onSheetRename($(e.target).val());\n                }\n            },\n            _onSheetReorderEnd: function (e) {\n                e.preventDefault();\n                this.trigger('reorder', {\n                    oldIndex: e.oldIndex,\n                    newIndex: e.newIndex\n                });\n            },\n            _onSheetReorderStart: function (e) {\n                if (this._editor) {\n                    e.preventDefault();\n                }\n            },\n            _onSheetRemove: function (e) {\n                var removedSheetName = $(e.target).closest('li').text();\n                if (this._editor) {\n                    this._destroyEditor();\n                    this._onSheetRename(this._editor.val());\n                }\n                this.trigger('remove', { name: removedSheetName });\n            },\n            _onSheetSelect: function (e) {\n                var selectedSheetText = $(e.target).text();\n                if ($(e.target).is(DOT + SheetsBar.classNames.sheetsBarEditor) || !selectedSheetText) {\n                    e.preventDefault();\n                    return;\n                }\n                if (this._editor) {\n                    var editorValue = this._editor.val();\n                    this._destroyEditor();\n                    this._onSheetRename(editorValue);\n                }\n                this._scrollSheetsToItem($(e.target).closest('li'));\n                this.trigger('select', {\n                    name: selectedSheetText,\n                    isAddButton: false\n                });\n            },\n            _onSheetRename: function (newSheetName) {\n                this.trigger('rename', {\n                    name: newSheetName,\n                    sheetIndex: this._selectedIndex\n                });\n            },\n            _onAddSelect: function () {\n                this.trigger('select', { isAddButton: true });\n            },\n            _addButton: function () {\n                var element = kendo.dom.element;\n                var classNames = SheetsBar.classNames;\n                return element('a', { className: classNames.sheetsBarAdd + EMPTYCHAR + classNames.sheetsBarKButton }, [element('span', { className: classNames.sheetsBarKSprite + EMPTYCHAR + classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKFontIcon + EMPTYCHAR + classNames.sheetsBarKIconPlus }, [])]);\n            },\n            destroy: function () {\n                this._sortable.destroy();\n            },\n            _scrollableAllowed: function () {\n                var options = this.options;\n                return options.scrollable && !isNaN(options.scrollable.distance);\n            },\n            _scrollSheetsToItem: function (item) {\n                var that = this;\n                if (!that._scrollableModeActive) {\n                    return;\n                }\n                var sheetsGroup = that._sheetsGroup();\n                var currentScrollOffset = sheetsGroup.scrollLeft();\n                var itemWidth = item.outerWidth();\n                var itemOffset = that._isRtl ? item.position().left : item.position().left - sheetsGroup.children().first().position().left;\n                var sheetsGroupWidth = sheetsGroup[0].offsetWidth;\n                var sheetsGroupPadding = Math.ceil(parseFloat(sheetsGroup.css('padding-left')));\n                var itemPosition;\n                if (that._isRtl) {\n                    if (itemOffset < 0) {\n                        itemPosition = currentScrollOffset + itemOffset - (sheetsGroupWidth - currentScrollOffset) - sheetsGroupPadding;\n                    } else if (itemOffset + itemWidth > sheetsGroupWidth) {\n                        itemPosition = currentScrollOffset + itemOffset - itemWidth + sheetsGroupPadding * 2;\n                    }\n                } else {\n                    if (currentScrollOffset + sheetsGroupWidth < itemOffset + itemWidth) {\n                        itemPosition = itemOffset + itemWidth - sheetsGroupWidth + sheetsGroupPadding * 2;\n                    } else if (currentScrollOffset > itemOffset) {\n                        itemPosition = itemOffset - sheetsGroupPadding;\n                    }\n                }\n                sheetsGroup.finish().animate({ 'scrollLeft': itemPosition }, 'fast', 'linear', function () {\n                    that._toggleScrollButtons();\n                });\n            },\n            _sheetsGroup: function () {\n                return this._sheetsWrapper().children('ul');\n            },\n            _sheetsWrapper: function () {\n                return this.element.find(DOT + SheetsBar.classNames.sheetsBarItems);\n            },\n            _scrollSheetsByDelta: function (delta) {\n                var that = this;\n                var sheetsGroup = that._sheetsGroup();\n                var scrLeft = sheetsGroup.scrollLeft();\n                sheetsGroup.finish().animate({ 'scrollLeft': scrLeft + delta }, 'fast', 'linear', function () {\n                    if (that._nowScrollingSheets) {\n                        that._scrollSheetsByDelta(delta);\n                    } else {\n                        that._toggleScrollButtons();\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.SheetsBar = SheetsBar;\n        $.extend(true, SheetsBar, { classNames: sheetsBarClassNames });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/calc', ['spreadsheet/runtime'], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var RangeRef = spreadsheet.RangeRef;\n    var CellRef = spreadsheet.CellRef;\n    var NameRef = spreadsheet.NameRef;\n    var exports = spreadsheet.calc;\n    var runtime = exports.runtime;\n    var OPERATORS = Object.create(null);\n    var ParseError = kendo.Class.extend({\n        init: function ParseError(message, pos) {\n            this.message = message;\n            this.pos = pos;\n        },\n        toString: function () {\n            return this.message;\n        }\n    });\n    (function (ops) {\n        ops.forEach(function (cls, i) {\n            cls.forEach(function (op) {\n                OPERATORS[op] = ops.length - i;\n            });\n        });\n    }([\n        [':'],\n        [' '],\n        [','],\n        ['%'],\n        ['^'],\n        [\n            '*',\n            '/'\n        ],\n        [\n            '+',\n            '-'\n        ],\n        ['&'],\n        [\n            '=',\n            '<',\n            '>',\n            '<=',\n            '>=',\n            '<>'\n        ]\n    ]));\n    var TRUE = {\n        type: 'bool',\n        value: true\n    };\n    var FALSE = {\n        type: 'bool',\n        value: false\n    };\n    function getcol(str) {\n        str = str.toUpperCase();\n        for (var col = 0, i = 0; i < str.length; ++i) {\n            col = col * 26 + str.charCodeAt(i) - 64;\n        }\n        return col - 1;\n    }\n    function getrow(str) {\n        return parseInt(str, 10) - 1;\n    }\n    function parseReference(name, noThrow) {\n        if (name.toLowerCase() == '#sheet') {\n            return spreadsheet.SHEETREF;\n        }\n        OUT: {\n            var m;\n            if (m = /^(\\$)?([a-z]+)(\\$)?(\\d+)$/i.exec(name)) {\n                var row = getrow(m[4]), col = getcol(m[2]);\n                if (row <= 1048576 && col <= 16383) {\n                    return new CellRef(getrow(m[4]), getcol(m[2]));\n                }\n                break OUT;\n            }\n            var stream = TokenStream(name, {});\n            var a = [];\n            while (true) {\n                var ref = stream.next();\n                if (ref instanceof CellRef) {\n                    ref.rel = 0;\n                } else if (ref instanceof RangeRef) {\n                    ref.topLeft.rel = 0;\n                    ref.bottomRight.rel = 0;\n                } else {\n                    break OUT;\n                }\n                a.push(ref);\n                if (stream.eof()) {\n                    break;\n                }\n                if (!stream.is('op', ',')) {\n                    break OUT;\n                }\n                stream.next();\n            }\n            return a.length == 1 ? a[0] : new spreadsheet.UnionRef(a);\n        }\n        if (!noThrow) {\n            throw new Error('Cannot parse reference: ' + name);\n        }\n    }\n    function parseFormula(sheet, row, col, input) {\n        var refs = [];\n        input = TokenStream(input, {\n            row: row,\n            col: col\n        });\n        var is = input.is;\n        return {\n            type: 'exp',\n            ast: parseExpression(true),\n            refs: refs,\n            sheet: sheet,\n            row: row,\n            col: col\n        };\n        function addReference(ref) {\n            ref.index = refs.length;\n            refs.push(ref);\n            return ref;\n        }\n        function skip(type, value) {\n            if (is(type, value)) {\n                return input.next();\n            } else {\n                var tok = input.peek();\n                if (tok) {\n                    input.croak('Expected ' + type + ' \\xAB' + value + '\\xBB but found ' + tok.type + ' \\xAB' + tok.value + '\\xBB');\n                } else {\n                    input.croak('Expected ' + type + ' \\xAB' + value + '\\xBB');\n                }\n            }\n        }\n        function parseExpression(commas) {\n            return maybeBinary(maybeIntersect(parseAtom(commas)), 0, commas);\n        }\n        function parseSymbol(tok) {\n            if (tok.upper == 'TRUE' || tok.upper == 'FALSE') {\n                return tok.upper == 'TRUE' ? TRUE : FALSE;\n            }\n            return addReference(new NameRef(tok.value));\n        }\n        function parseFuncall() {\n            var fname = input.next();\n            fname = fname.value;\n            skip('punc', '(');\n            var args = [];\n            if (!is('punc', ')')) {\n                while (1) {\n                    if (is('op', ',')) {\n                        args.push({ type: 'null' });\n                        input.next();\n                        continue;\n                    }\n                    args.push(parseExpression(false));\n                    if (input.eof() || is('punc', ')')) {\n                        break;\n                    }\n                    skip('op', ',');\n                }\n            }\n            skip('punc', ')');\n            return {\n                type: 'func',\n                func: fname,\n                args: args\n            };\n        }\n        function fixReference(ref) {\n            if (!ref.hasSheet()) {\n                ref.setSheet(sheet);\n            }\n            return addReference(ref);\n        }\n        function parseAtom(commas) {\n            var exp;\n            if (is('ref')) {\n                exp = fixReference(input.next());\n            } else if (is('func')) {\n                exp = parseFuncall();\n            } else if (is('punc', '(')) {\n                input.next();\n                exp = parseExpression(true);\n                skip('punc', ')');\n            } else if (is('punc', '{')) {\n                input.next();\n                exp = parseArray();\n                skip('punc', '}');\n            } else if (is('num') || is('str')) {\n                exp = input.next();\n            } else if (is('sym')) {\n                exp = parseSymbol(input.next());\n            } else if (is('op', '+') || is('op', '-')) {\n                exp = {\n                    type: 'prefix',\n                    op: input.next().value,\n                    exp: parseExpression(commas)\n                };\n            } else if (!input.peek()) {\n                input.croak('Incomplete expression');\n            } else {\n                input.croak('Parse error');\n            }\n            return maybePercent(exp);\n        }\n        function parseArray() {\n            var row = [], value = [row], first = true;\n            while (!input.eof() && !is('punc', '}')) {\n                if (first) {\n                    first = false;\n                } else if (is('punc', ';')) {\n                    value.push(row = []);\n                    input.next();\n                } else {\n                    skip('op', ',');\n                }\n                row.push(parseExpression(false));\n            }\n            return {\n                type: 'matrix',\n                value: value\n            };\n        }\n        function maybeIntersect(exp) {\n            if (is('punc', '(') || is('ref') || is('num') || is('func')) {\n                return {\n                    type: 'binary',\n                    op: ' ',\n                    left: exp,\n                    right: parseExpression(false)\n                };\n            } else {\n                return exp;\n            }\n        }\n        function maybePercent(exp) {\n            if (is('op', '%')) {\n                input.next();\n                return maybePercent({\n                    type: 'postfix',\n                    op: '%',\n                    exp: exp\n                });\n            } else {\n                return exp;\n            }\n        }\n        function maybeBinary(left, my_prec, commas) {\n            var tok = is('op');\n            if (tok && (commas || tok.value != ',')) {\n                var his_prec = OPERATORS[tok.value];\n                if (his_prec > my_prec) {\n                    input.next();\n                    var right = maybeBinary(parseAtom(commas), his_prec, commas);\n                    return maybeBinary({\n                        type: 'binary',\n                        op: tok.value,\n                        left: left,\n                        right: right\n                    }, my_prec, commas);\n                }\n            }\n            return left;\n        }\n    }\n    function makePrinter(exp) {\n        return makeClosure('function(row, col){return(' + print(exp.ast, exp, 0) + ')}');\n        function print(node, parent, prec) {\n            switch (node.type) {\n            case 'num':\n            case 'bool':\n                return JSON.stringify(node.value);\n            case 'str':\n                return JSON.stringify(JSON.stringify(node.value));\n            case 'ref':\n                return 'this.refs[' + node.index + '].print(row, col)';\n            case 'prefix':\n                return withParens(function () {\n                    return JSON.stringify(node.op) + ' + ' + print(node.exp, node, OPERATORS[node.op]);\n                });\n            case 'postfix':\n                return withParens(function () {\n                    return print(node.exp, node, OPERATORS[node.op]) + ' + ' + JSON.stringify(node.op);\n                });\n            case 'binary':\n                return withParens(function () {\n                    var left = parenthesize(print(node.left, node, OPERATORS[node.op]), node.left instanceof NameRef && node.op == ':');\n                    var right = parenthesize(print(node.right, node, OPERATORS[node.op]), node.right instanceof NameRef && node.op == ':');\n                    return left + ' + ' + JSON.stringify(node.op) + ' + ' + right;\n                });\n            case 'func':\n                return JSON.stringify(node.func + '(') + ' + ' + (node.args.length > 0 ? node.args.map(function (arg) {\n                    return print(arg, node, 0);\n                }).join(' + \\', \\' + ') : '\\'\\'') + ' + \\')\\'';\n            case 'matrix':\n                return '\\'{ \\' + ' + node.value.map(function (el) {\n                    return el.map(function (el) {\n                        return print(el, node, 0);\n                    }).join(' + \\', \\' + ');\n                }).join(' + \\'; \\' + ') + '+ \\' }\\'';\n            case 'null':\n                return '\\'\\'';\n            }\n            throw new Error('Cannot make printer for node ' + node.type);\n            function withParens(f) {\n                var op = node.op;\n                var needParens = OPERATORS[op] < prec || !prec && op == ',' || parent.type == 'binary' && prec == OPERATORS[op] && node === parent.right;\n                return parenthesize(f(), needParens);\n            }\n        }\n        function parenthesize(code, cond) {\n            return cond ? '\\'(\\' + ' + code + ' + \\')\\'' : code;\n        }\n    }\n    function toCPS(ast, k) {\n        var GENSYM = 0;\n        return cps(ast, k);\n        function cps(node, k) {\n            switch (node.type) {\n            case 'ref':\n            case 'num':\n            case 'str':\n            case 'null':\n            case 'bool':\n                return cpsAtom(node, k);\n            case 'prefix':\n            case 'postfix':\n                return cpsUnary(node, k);\n            case 'binary':\n                return cpsBinary(node, k);\n            case 'func':\n                return cpsFunc(node, k);\n            case 'lambda':\n                return cpsLambda(node, k);\n            case 'matrix':\n                return cpsMatrix(node.value, k, true);\n            }\n            throw new Error('Cannot CPS ' + node.type);\n        }\n        function cpsAtom(node, k) {\n            return k(node);\n        }\n        function cpsUnary(node, k) {\n            return cps({\n                type: 'func',\n                func: 'unary' + node.op,\n                args: [node.exp]\n            }, k);\n        }\n        function cpsBinary(node, k) {\n            return cps({\n                type: 'func',\n                func: 'binary' + node.op,\n                args: [\n                    node.left,\n                    node.right\n                ]\n            }, k);\n        }\n        function cpsIf(co, th, el, k) {\n            return cps(co, function (co) {\n                var rest = makeContinuation(k);\n                var thenK = gensym('T');\n                var elseK = gensym('E');\n                return {\n                    type: 'func',\n                    func: 'if',\n                    args: [\n                        rest,\n                        co,\n                        {\n                            type: 'lambda',\n                            vars: [thenK],\n                            body: cps(th || TRUE, function (th) {\n                                return {\n                                    type: 'call',\n                                    func: {\n                                        type: 'var',\n                                        name: thenK\n                                    },\n                                    args: [th]\n                                };\n                            })\n                        },\n                        {\n                            type: 'lambda',\n                            vars: [elseK],\n                            body: cps(el || FALSE, function (el) {\n                                return {\n                                    type: 'call',\n                                    func: {\n                                        type: 'var',\n                                        name: elseK\n                                    },\n                                    args: [el]\n                                };\n                            })\n                        }\n                    ]\n                };\n            });\n        }\n        function cpsAnd(args, k) {\n            if (args.length === 0) {\n                return cpsAtom(TRUE, k);\n            }\n            return cps({\n                type: 'func',\n                func: 'IF',\n                args: [\n                    args[0],\n                    {\n                        type: 'func',\n                        func: 'AND',\n                        args: args.slice(1)\n                    },\n                    FALSE\n                ]\n            }, k);\n        }\n        function cpsOr(args, k) {\n            if (args.length === 0) {\n                return cpsAtom(FALSE, k);\n            }\n            return cps({\n                type: 'func',\n                func: 'IF',\n                args: [\n                    args[0],\n                    TRUE,\n                    {\n                        type: 'func',\n                        func: 'OR',\n                        args: args.slice(1)\n                    }\n                ]\n            }, k);\n        }\n        function cpsFunc(node, k) {\n            switch (node.func.toLowerCase()) {\n            case 'if':\n                return cpsIf(node.args[0], node.args[1], node.args[2], k);\n            case 'and':\n                return cpsAnd(node.args, k);\n            case 'or':\n                return cpsOr(node.args, k);\n            case 'true':\n                return k(TRUE);\n            case 'false':\n                return k(FALSE);\n            }\n            return function loop(args, i) {\n                if (i == node.args.length) {\n                    return {\n                        type: 'func',\n                        func: node.func,\n                        args: args\n                    };\n                } else {\n                    return cps(node.args[i], function (value) {\n                        return loop(args.concat([value]), i + 1);\n                    });\n                }\n            }([makeContinuation(k)], 0);\n        }\n        function cpsLambda(node, k) {\n            var cont = gensym('K');\n            var body = cps(node.body, function (body) {\n                return {\n                    type: 'call',\n                    func: {\n                        type: 'var',\n                        value: cont\n                    },\n                    args: [body]\n                };\n            });\n            return k({\n                type: 'lambda',\n                vars: [cont].concat(node.vars),\n                body: body\n            });\n        }\n        function cpsMatrix(elements, k, isMatrix) {\n            var a = [];\n            return function loop(i) {\n                if (i == elements.length) {\n                    return k({\n                        type: 'matrix',\n                        value: a\n                    });\n                } else {\n                    return (isMatrix ? cpsMatrix : cps)(elements[i], function (val) {\n                        a[i] = val;\n                        return loop(i + 1);\n                    });\n                }\n            }(0);\n        }\n        function makeContinuation(k) {\n            var cont = gensym('R');\n            return {\n                type: 'lambda',\n                vars: [cont],\n                body: k({\n                    type: 'var',\n                    name: cont\n                })\n            };\n        }\n        function gensym(name) {\n            if (!name) {\n                name = '';\n            }\n            name = '_' + name;\n            return name + ++GENSYM;\n        }\n    }\n    var makeClosure = function (cache) {\n        return function (code) {\n            var f = cache[code];\n            if (!f) {\n                f = cache[code] = new Function('\\'use strict\\';return(' + code + ')')();\n            }\n            return f;\n        };\n    }(Object.create(null));\n    var FORMULA_CACHE = Object.create(null);\n    function makeFormula(exp) {\n        var printer = makePrinter(exp);\n        var hash = printer.call(exp);\n        var formula = FORMULA_CACHE[hash];\n        if (formula) {\n            return formula.clone(exp.sheet, exp.row, exp.col);\n        }\n        var code = js(toCPS(exp.ast, function (ret) {\n            return {\n                type: 'return',\n                value: ret\n            };\n        }));\n        code = [\n            'function(){',\n            'var context = this, refs = context.formula.absrefs',\n            code,\n            '}'\n        ].join(';\\n');\n        formula = new runtime.Formula(exp.refs, makeClosure(code), printer, exp.sheet, exp.row, exp.col);\n        FORMULA_CACHE[hash] = formula;\n        return formula;\n        function js(node) {\n            var type = node.type;\n            if (type == 'num') {\n                return node.value + '';\n            } else if (type == 'str') {\n                return JSON.stringify(node.value);\n            } else if (type == 'return') {\n                return 'context.resolve(' + js(node.value) + ')';\n            } else if (type == 'func') {\n                return 'context.func(' + JSON.stringify(node.func) + ', ' + js(node.args[0]) + ', ' + jsArray(node.args.slice(1)) + ')';\n            } else if (type == 'call') {\n                return js(node.func) + '(' + node.args.map(js).join(', ') + ')';\n            } else if (type == 'ref') {\n                return 'refs[' + node.index + ']';\n            } else if (type == 'bool') {\n                return '' + node.value;\n            } else if (type == 'if') {\n                return '(context.bool(' + js(node.co) + ') ? ' + js(node.th) + ' : ' + js(node.el) + ')';\n            } else if (type == 'lambda') {\n                return '(function(' + node.vars.join(', ') + '){ return(' + js(node.body) + ') })';\n            } else if (type == 'var') {\n                return node.name;\n            } else if (type == 'matrix') {\n                return jsArray(node.value);\n            } else if (type == 'null') {\n                return 'null';\n            } else {\n                throw new Error('Cannot compile expression ' + type);\n            }\n        }\n        function jsArray(a) {\n            return '[ ' + a.map(js).join(', ') + ' ]';\n        }\n    }\n    function identity(x) {\n        return x;\n    }\n    function TokenStream(input, options) {\n        input = RawTokenStream(InputStream(input), options);\n        var ahead = input.ahead;\n        var skip = input.skip;\n        var token = null;\n        var fixCell = options.row != null && options.col != null ? function (cell) {\n            if (cell.rel & 1) {\n                cell.col -= options.col;\n            }\n            if (cell.rel & 2) {\n                cell.row -= options.row;\n            }\n            return cell;\n        } : identity;\n        var addPos = options.forEditor ? function (thing, startToken, endToken) {\n            thing.begin = startToken.begin;\n            thing.end = endToken.end;\n            return thing;\n        } : identity;\n        return {\n            peek: peek,\n            next: next,\n            croak: input.croak,\n            eof: input.eof,\n            is: is\n        };\n        function is(type, value) {\n            var tok = peek();\n            return tok != null && (type == null || tok.type === type) && (value == null || tok.value === value) ? tok : null;\n        }\n        function peek() {\n            if (token == null) {\n                token = readNext();\n            }\n            return token;\n        }\n        function next() {\n            if (token != null) {\n                var tmp = token;\n                token = null;\n                return tmp;\n            }\n            return readNext();\n        }\n        function readNext() {\n            var ret;\n            var t = input.peek();\n            if (t) {\n                if (t.type == 'sym' || t.type == 'rc' || t.type == 'num') {\n                    ret = ahead(8, refRange3D) || ahead(6, refCell3D) || ahead(6, refSheetRange) || ahead(4, refSheetCell) || ahead(4, refRange) || ahead(2, refCell) || ahead(2, funcall);\n                }\n                if (!ret) {\n                    ret = input.next();\n                }\n            }\n            return ret;\n        }\n        function toCell(tok, isFirst) {\n            if (tok.type == 'rc') {\n                if (tok.rel && !options.forEditor && (options.row == null || options.col == null)) {\n                    input.croak('Cannot read relative cell in RC notation');\n                }\n                return new CellRef(tok.row, tok.col, tok.rel);\n            }\n            if (tok.type == 'num') {\n                if (tok.value <= 1048577) {\n                    return fixCell(new CellRef(getrow(tok.value), isFirst ? -Infinity : +Infinity, 2));\n                } else {\n                    return null;\n                }\n            }\n            var name = tok.value;\n            var m = /^(\\$)?([a-z]+)(\\$)?(\\d+)$/i.exec(name);\n            if (m) {\n                var row = getrow(m[4]), col = getcol(m[2]);\n                if (row <= 1048576 && col <= 16383) {\n                    return fixCell(new CellRef(getrow(m[4]), getcol(m[2]), (m[1] ? 0 : 1) | (m[3] ? 0 : 2)));\n                } else {\n                    return null;\n                }\n            }\n            var abs = name.charAt(0) == '$';\n            if (abs) {\n                name = name.substr(1);\n            }\n            if (/^\\d+$/.test(name)) {\n                var row = getrow(name);\n                if (row <= 1048576) {\n                    return fixCell(new CellRef(getrow(name), isFirst ? -Infinity : +Infinity, abs ? 0 : 2));\n                }\n            } else {\n                var col = getcol(name);\n                if (col <= 16383) {\n                    return fixCell(new CellRef(isFirst ? -Infinity : +Infinity, getcol(name), abs ? 0 : 1));\n                }\n            }\n        }\n        function refRange3D(a, b, c, d, e, f, g, h) {\n            if (a.type == 'sym' && b.type == 'op' && b.value == ':' && c.type == 'sym' && d.type == 'punc' && d.value == '!' && (e.type == 'sym' || e.type == 'rc' || e.type == 'num' && e.value == e.value | 0) && f.type == 'op' && f.value == ':' && (g.type == 'sym' || g.type == 'rc' || g.type == 'num' && g.value == g.value | 0) && g.type == e.type && !(h.type == 'punc' && h.value == '(' && !g.space)) {\n                var tl = toCell(e, true), br = toCell(g, false);\n                if (tl && br) {\n                    skip(7);\n                    return addPos(new RangeRef(tl.setSheet(a.value, true), br.setSheet(c.value, true)).setSheet(a.value, true), a, g);\n                }\n            }\n        }\n        function refCell3D(a, b, c, d, e, f) {\n            if (a.type == 'sym' && b.type == 'op' && b.value == ':' && c.type == 'sym' && d.type == 'punc' && d.value == '!' && (e.type == 'sym' || e.type == 'rc' || e.type == 'num' && e.value == e.value | 0) && !(f.type == 'punc' && f.value == '(' && !e.space)) {\n                var tl = toCell(e);\n                if (tl) {\n                    skip(5);\n                    var br = tl.clone();\n                    return addPos(new RangeRef(tl.setSheet(a.value, true), br.setSheet(c.value, true)).setSheet(a.value, true), a, e);\n                }\n            }\n        }\n        function refSheetRange(a, b, c, d, e, f) {\n            if (a.type == 'sym' && b.type == 'punc' && b.value == '!' && (c.type == 'sym' || c.type == 'rc' || c.type == 'num' && c.value == c.value | 0) && d.type == 'op' && d.value == ':' && (e.type == 'sym' || e.type == 'rc' || e.type == 'num' && e.value == e.value | 0) && !(f.type == 'punc' && f.value == '(' && !e.space)) {\n                var tl = toCell(c, true), br = toCell(e, false);\n                if (tl && br) {\n                    skip(5);\n                    return addPos(new RangeRef(tl, br).setSheet(a.value, true), a, e);\n                }\n            }\n        }\n        function refSheetCell(a, b, c, d) {\n            if (a.type == 'sym' && b.type == 'punc' && b.value == '!' && (c.type == 'sym' || c.type == 'rc' || c.type == 'num' && c.value == c.value | 0) && !(d.type == 'punc' && d.value == '(' && !c.space)) {\n                skip(3);\n                var x = toCell(c);\n                if (!x) {\n                    x = new NameRef(c.value);\n                }\n                return addPos(x.setSheet(a.value, true), a, c);\n            }\n        }\n        function refRange(a, b, c, d) {\n            if ((a.type == 'sym' || a.type == 'rc' || a.type == 'num' && a.value == a.value | 0) && (b.type == 'op' && b.value == ':') && (c.type == 'sym' || c.type == 'rc' || c.type == 'num' && c.value == c.value | 0) && !(d.type == 'punc' && d.value == '(' && !c.space)) {\n                var tl = toCell(a, true), br = toCell(c, false);\n                if (tl && br) {\n                    skip(3);\n                    return addPos(new RangeRef(tl, br), a, c);\n                }\n            }\n        }\n        function refCell(a, b) {\n            if ((a.type == 'sym' || a.type == 'rc') && !(b.type == 'punc' && b.value == '(' && !a.space)) {\n                var x = toCell(a);\n                if (x && isFinite(x.row) && isFinite(x.col)) {\n                    skip(1);\n                    return addPos(x, a, a);\n                }\n            }\n        }\n        function funcall(a, b) {\n            if (a.type == 'sym' && b.type == 'punc' && b.value == '(' && !a.space) {\n                a.type = 'func';\n                skip(1);\n                return a;\n            }\n        }\n    }\n    function RawTokenStream(input, options) {\n        var tokens = [], index = 0;\n        var readWhile = input.readWhile;\n        return {\n            next: next,\n            peek: peek,\n            eof: eof,\n            croak: input.croak,\n            ahead: ahead,\n            skip: skip\n        };\n        function isDigit(ch) {\n            return /[0-9]/i.test(ch);\n        }\n        function isIdStart(ch) {\n            return /[a-z$_]/i.test(ch) || ch.toLowerCase() != ch.toUpperCase();\n        }\n        function isId(ch) {\n            return isIdStart(ch) || isDigit(ch) || ch == '.';\n        }\n        function isOpChar(ch) {\n            return ch in OPERATORS;\n        }\n        function isPunc(ch) {\n            return '!;(){}[]'.indexOf(ch) >= 0;\n        }\n        function isWhitespace(ch) {\n            return ' \\t\\n\\xA0'.indexOf(ch) >= 0;\n        }\n        function readNumber() {\n            var has_dot = false;\n            var number = readWhile(function (ch) {\n                if (ch == '.') {\n                    if (has_dot) {\n                        return false;\n                    }\n                    has_dot = true;\n                    return true;\n                }\n                return isDigit(ch);\n            });\n            return {\n                type: 'num',\n                value: parseFloat(number)\n            };\n        }\n        function symbol(id, quote) {\n            return {\n                type: 'sym',\n                value: id,\n                upper: id.toUpperCase(),\n                space: isWhitespace(input.peek()),\n                quote: quote\n            };\n        }\n        function getRC(a, b, c) {\n            if (!a && !c || a && c) {\n                var negative = a && /-$/.test(a);\n                var num = parseInt(b, 10);\n                if (negative) {\n                    num = -num;\n                }\n                if (!a) {\n                    num--;\n                }\n                return num;\n            }\n        }\n        function readSymbol() {\n            var m = input.lookingAt(/^R(\\[-?)?([0-9]+)(\\])?C(\\[-?)?([0-9]+)(\\])?/i);\n            if (m) {\n                var row = getRC(m[1], m[2], m[3]);\n                var col = getRC(m[4], m[5], m[6]);\n                if (row != null && col != null) {\n                    input.skip(m);\n                    return {\n                        type: 'rc',\n                        row: row,\n                        col: col,\n                        rel: (m[4] ? 1 : 0) | (m[1] ? 2 : 0)\n                    };\n                }\n            }\n            return symbol(readWhile(isId));\n        }\n        function readString() {\n            input.next();\n            return {\n                type: 'str',\n                value: input.readEscaped('\"')\n            };\n        }\n        function readSheetName() {\n            input.next();\n            return symbol(input.readEscaped('\\''), true);\n        }\n        function readOperator() {\n            return {\n                type: 'op',\n                value: readWhile(function (ch, op) {\n                    return op + ch in OPERATORS;\n                })\n            };\n        }\n        function readPunc() {\n            return {\n                type: 'punc',\n                value: input.next()\n            };\n        }\n        function readNext() {\n            if (input.eof()) {\n                return null;\n            }\n            var ch = input.peek(), m;\n            if (ch == '\"') {\n                return readString();\n            }\n            if (ch == '\\'') {\n                return readSheetName();\n            }\n            if (isDigit(ch)) {\n                return readNumber();\n            }\n            if (isIdStart(ch)) {\n                return readSymbol();\n            }\n            if (isOpChar(ch)) {\n                return readOperator();\n            }\n            if (isPunc(ch)) {\n                return readPunc();\n            }\n            if (m = input.lookingAt(/^#([a-z\\/]+)[?!]/i)) {\n                input.skip(m);\n                return {\n                    type: 'error',\n                    value: m[1]\n                };\n            }\n            if (!options.forEditor) {\n                input.croak('Can\\'t handle character: ' + ch);\n            }\n            return {\n                type: 'error',\n                value: input.next()\n            };\n        }\n        function peek() {\n            while (tokens.length <= index) {\n                readWhile(isWhitespace);\n                var begin = input.pos();\n                var tok = readNext();\n                if (options.forEditor && tok) {\n                    tok.begin = begin;\n                    tok.end = input.pos();\n                }\n                tokens.push(tok);\n            }\n            return tokens[index];\n        }\n        function next() {\n            var tok = peek();\n            if (tok) {\n                index++;\n            }\n            return tok;\n        }\n        function ahead(n, f) {\n            var pos = index, a = [];\n            while (n-- > 0) {\n                a.push(next() || EOF);\n            }\n            index = pos;\n            return f.apply(a, a);\n        }\n        function skip(n) {\n            index += n;\n        }\n        function eof() {\n            return peek() == null;\n        }\n    }\n    var EOF = { type: 'eof' };\n    function InputStream(input) {\n        var pos = 0, line = 1, col = 0;\n        return {\n            next: next,\n            peek: peek,\n            eof: eof,\n            croak: croak,\n            readWhile: readWhile,\n            readEscaped: readEscaped,\n            lookingAt: lookingAt,\n            skip: skip,\n            forward: forward,\n            pos: location\n        };\n        function location() {\n            return pos;\n        }\n        function next() {\n            var ch = input.charAt(pos++);\n            if (ch == '\\n') {\n                line++;\n                col = 0;\n            } else {\n                col++;\n            }\n            return ch;\n        }\n        function peek() {\n            return input.charAt(pos);\n        }\n        function eof() {\n            return peek() === '';\n        }\n        function croak(msg) {\n            throw new ParseError(msg, pos);\n        }\n        function skip(ch) {\n            if (typeof ch == 'string') {\n                if (input.substr(pos, ch.length) != ch) {\n                    croak('Expected ' + ch);\n                }\n                forward(ch.length);\n            } else if (ch instanceof RegExp) {\n                var m = ch.exec(input.substr(pos));\n                if (m) {\n                    forward(m[0].length);\n                    return m;\n                }\n            } else {\n                forward(ch[0].length);\n            }\n        }\n        function forward(n) {\n            while (n-- > 0) {\n                next();\n            }\n        }\n        function readEscaped(end) {\n            var escaped = false, str = '';\n            while (!eof()) {\n                var ch = next();\n                if (escaped) {\n                    str += ch;\n                    escaped = false;\n                } else if (ch == '\\\\') {\n                    escaped = true;\n                } else if (ch == end) {\n                    break;\n                } else {\n                    str += ch;\n                }\n            }\n            return str;\n        }\n        function readWhile(predicate) {\n            var str = '';\n            while (!eof() && predicate(peek(), str)) {\n                str += next();\n            }\n            return str;\n        }\n        function lookingAt(rx) {\n            return rx.exec(input.substr(pos));\n        }\n    }\n    var FORMAT_PARSERS = [];\n    var registerFormatParser = exports.registerFormatParser = function (p) {\n        FORMAT_PARSERS.push(p);\n    };\n    exports.parse = function (sheet, row, col, input) {\n        if (input instanceof Date) {\n            return {\n                type: 'date',\n                value: runtime.dateToSerial(input)\n            };\n        }\n        if (typeof input == 'number') {\n            return {\n                type: 'number',\n                value: input\n            };\n        }\n        if (typeof input == 'boolean') {\n            return {\n                type: 'boolean',\n                value: input\n            };\n        }\n        input += '';\n        if (/^'/.test(input)) {\n            return {\n                type: 'string',\n                value: input.substr(1)\n            };\n        }\n        if (/^[0-9.]+%$/.test(input)) {\n            var str = input.substr(0, input.length - 1);\n            var num = parseFloat(str);\n            if (!isNaN(num) && num == str) {\n                return {\n                    type: 'percent',\n                    value: num / 100\n                };\n            }\n        }\n        if (/^=/.test(input)) {\n            input = input.substr(1);\n            if (/\\S/.test(input)) {\n                return parseFormula(sheet, row, col, input);\n            } else {\n                return {\n                    type: 'string',\n                    value: '=' + input\n                };\n            }\n        }\n        for (var i = 0; i < FORMAT_PARSERS.length; ++i) {\n            var result = FORMAT_PARSERS[i](input);\n            if (result) {\n                return result;\n            }\n        }\n        if (input.toLowerCase() == 'true') {\n            return {\n                type: 'boolean',\n                value: true\n            };\n        }\n        if (input.toLowerCase() == 'false') {\n            return {\n                type: 'boolean',\n                value: false\n            };\n        }\n        var date = runtime.parseDate(input);\n        if (date) {\n            return {\n                type: 'date',\n                value: runtime.dateToSerial(date)\n            };\n        }\n        var num = parseFloat(input);\n        if (!isNaN(num) && input.length > 0 && num == input) {\n            return {\n                type: 'number',\n                value: num\n            };\n        }\n        return {\n            type: 'string',\n            value: input\n        };\n    };\n    function tokenize(input, row, col) {\n        var tokens = [];\n        input = TokenStream(input, {\n            forEditor: true,\n            row: row,\n            col: col\n        });\n        while (!input.eof()) {\n            tokens.push(next());\n        }\n        var tok = tokens[0];\n        if (tok.type == 'op' && tok.value == '=') {\n            tok.type = 'startexp';\n        }\n        return tokens;\n        function next() {\n            var tok = input.next();\n            if (tok.type == 'sym') {\n                if (tok.upper == 'TRUE') {\n                    tok.type = 'bool';\n                    tok.value = true;\n                } else if (tok.upper == 'FALSE') {\n                    tok.type = 'bool';\n                    tok.value = false;\n                }\n            } else if (tok.type == 'ref') {\n                tok = {\n                    type: 'ref',\n                    ref: row != null && col != null ? tok.absolute(row, col) : tok,\n                    begin: tok.begin,\n                    end: tok.end\n                };\n            }\n            return tok;\n        }\n    }\n    exports.parseFormula = parseFormula;\n    exports.parseReference = parseReference;\n    exports.compile = makeFormula;\n    exports.InputStream = InputStream;\n    exports.ParseError = ParseError;\n    exports.tokenize = tokenize;\n    registerFormatParser(function (input) {\n        var m;\n        if (m = /^(\\d+):(\\d+)$/.exec(input)) {\n            var hh = parseInt(m[1], 10);\n            var mm = parseInt(m[2], 10);\n            return {\n                type: 'date',\n                format: 'hh:mm',\n                value: runtime.packTime(hh, mm, 0, 0)\n            };\n        }\n        if (m = /^(\\d+):(\\d+)(\\.\\d+)$/.exec(input)) {\n            var mm = parseInt(m[1], 10);\n            var ss = parseInt(m[2], 10);\n            var ms = parseFloat(m[3]) * 1000;\n            return {\n                type: 'date',\n                format: 'mm:ss.00',\n                value: runtime.packTime(0, mm, ss, ms)\n            };\n        }\n        if (m = /^(\\d+):(\\d+):(\\d+)$/.exec(input)) {\n            var hh = parseInt(m[1], 10);\n            var mm = parseInt(m[2], 10);\n            var ss = parseInt(m[3], 10);\n            return {\n                type: 'date',\n                format: 'hh:mm:ss',\n                value: runtime.packTime(hh, mm, ss, 0)\n            };\n        }\n        if (m = /^(\\d+):(\\d+):(\\d+)(\\.\\d+)$/.exec(input)) {\n            var hh = parseInt(m[1], 10);\n            var mm = parseInt(m[2], 10);\n            var ss = parseInt(m[3], 10);\n            var ms = parseFloat(m[4]) * 1000;\n            return {\n                type: 'date',\n                format: 'hh:mm:ss.00',\n                value: runtime.packTime(hh, mm, ss, ms)\n            };\n        }\n    });\n    registerFormatParser(function (input) {\n        var m;\n        var culture = kendo.culture();\n        var comma = culture.numberFormat[','];\n        var dot = culture.numberFormat['.'];\n        var currency = culture.numberFormat.currency.symbol;\n        var rx = new RegExp('^(\\\\' + currency + '\\\\s*)?(\\\\d+(\\\\' + comma + '\\\\d{3})*(\\\\' + dot + '\\\\d+)?)(\\\\s*\\\\' + currency + ')?$');\n        if (m = rx.exec(input)) {\n            var value = m[2].replace(new RegExp('\\\\' + comma, 'g'), '').replace(dot, '.');\n            var format = '#';\n            if (m[1] || m[3] || m[5]) {\n                format += ',#';\n            }\n            if (m[4]) {\n                format += '.' + repeat('0', m[1] || m[5] ? 2 : m[4].length - 1);\n            }\n            if (m[1]) {\n                format = '\"' + m[1] + '\"' + format;\n            }\n            if (m[5]) {\n                format = format + '\"' + m[5] + '\"';\n            }\n            return {\n                type: 'number',\n                format: format == '#' ? null : format,\n                value: parseFloat(value)\n            };\n        }\n    });\n    function repeat(str, len) {\n        var out = '';\n        while (len-- > 0) {\n            out += str;\n        }\n        return out;\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/excel-reader', [\n        'kendo.core',\n        'kendo.color',\n        'util/parse-xml',\n        'spreadsheet/calc'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var $ = kendo.jQuery;\n    var parseXML = kendo.util.parseXML;\n    var parseReference = kendo.spreadsheet.calc.parseReference;\n    function readExcel(file, workbook, deferred) {\n        var reader = new FileReader();\n        reader.onload = function (e) {\n            var zip = new JSZip(e.target.result);\n            readWorkbook(zip, workbook, deferred);\n        };\n        reader.readAsArrayBuffer(file);\n    }\n    var SEL_CELL = [\n        'sheetData',\n        'row',\n        'c'\n    ];\n    var SEL_COL = [\n        'cols',\n        'col'\n    ];\n    var SEL_DEFINED_NAME = [\n        'definedNames',\n        'definedName'\n    ];\n    var SEL_FORMULA = [\n        'sheetData',\n        'row',\n        'c',\n        'f'\n    ];\n    var SEL_MERGE = [\n        'mergeCells',\n        'mergeCell'\n    ];\n    var SEL_PANE = [\n        'sheetViews',\n        'sheetView',\n        'pane'\n    ];\n    var SEL_ROW = [\n        'sheetData',\n        'row'\n    ];\n    var SEL_SELECTION = [\n        'sheetViews',\n        'sheetView',\n        'selection'\n    ];\n    var SEL_SHEET = [\n        'sheets',\n        'sheet'\n    ];\n    var SEL_STRING = [\n        'sheetData',\n        'row',\n        'c',\n        'is'\n    ];\n    var SEL_TEXT = ['t'];\n    var SEL_SHARED_STRING = ['si'];\n    var SEL_VALUE = [\n        'sheetData',\n        'row',\n        'c',\n        'v'\n    ];\n    var SEL_VIEW = [\n        'bookViews',\n        'workbookView'\n    ];\n    var SEL_SHEET_VIEW = [\n        'sheetViews',\n        'sheetView'\n    ];\n    function readWorkbook(zip, workbook, deferred) {\n        var strings = readStrings(zip);\n        var relationships = readRelationships(zip, 'workbook.xml');\n        var theme = readTheme(zip, relationships.byType.theme[0]);\n        var styles = readStyles(zip, theme);\n        var items = [];\n        var activeSheet = 0;\n        parse(zip, 'xl/workbook.xml', {\n            enter: function (tag, attrs) {\n                if (this.is(SEL_SHEET)) {\n                    var relId = attrs['r:id'];\n                    var file = relationships.byId[relId];\n                    var name = attrs.name;\n                    var dim = sheetDimensions(zip, file);\n                    items.push({\n                        workbook: workbook,\n                        zip: zip,\n                        strings: strings,\n                        styles: styles,\n                        file: file,\n                        options: {\n                            name: name,\n                            rows: Math.max(workbook.options.rows || 0, dim.rows),\n                            columns: Math.max(workbook.options.columns || 0, dim.cols),\n                            columnWidth: dim.columnWidth,\n                            rowHeight: dim.rowHeight\n                        }\n                    });\n                } else if (this.is(SEL_VIEW)) {\n                    if (attrs.activeTab) {\n                        activeSheet = integer(attrs.activeTab);\n                    }\n                }\n            },\n            text: function (text) {\n                var attrs = this.is(SEL_DEFINED_NAME);\n                if (attrs && !(bool(attrs['function']) || bool(attrs.vbProcedure))) {\n                    var ref = parseReference(text, true);\n                    workbook.defineName(attrs.name, ref, bool(attrs.hidden));\n                }\n            }\n        });\n        loadSheets(items, workbook, deferred).then(function () {\n            var sheets = workbook.sheets();\n            recalcSheets(sheets);\n            workbook.activeSheet(sheets[activeSheet]);\n        });\n    }\n    function loadSheets(items, workbook, deferred) {\n        var ready = new $.Deferred().resolve();\n        for (var i = 0; i < items.length; i++) {\n            (function (entry, i) {\n                ready = ready.then(function () {\n                    var sheet = workbook.insertSheet(entry.options);\n                    sheet.suspendChanges(true);\n                    var promise = queueSheet(sheet, entry);\n                    if (deferred) {\n                        var args = {\n                            sheet: sheet,\n                            progress: i / (items.length - 1)\n                        };\n                        promise.then(function () {\n                            deferred.notify(args);\n                        });\n                    }\n                    return promise;\n                });\n            }(items[i], i));\n        }\n        if (deferred) {\n            ready.then(function () {\n                deferred.resolve();\n            });\n        }\n        return ready;\n    }\n    function queueSheet(sheet, ctx) {\n        var deferred = new $.Deferred();\n        setTimeout(function () {\n            readSheet(ctx.zip, ctx.file, sheet, ctx.strings, ctx.styles);\n            deferred.resolve();\n        }, 0);\n        return deferred;\n    }\n    function recalcSheets(sheets) {\n        for (var i = 0; i < sheets.length; i++) {\n            sheets[i].suspendChanges(false).triggerChange({ recalc: true });\n        }\n    }\n    function sheetDimensions(zip, file) {\n        var dim = {\n            rows: 0,\n            cols: 0\n        };\n        parse(zip, 'xl/' + file, {\n            enter: function (tag, attrs) {\n                if (tag == 'dimension') {\n                    var ref = parseReference(attrs.ref);\n                    if (ref.bottomRight) {\n                        dim.cols = ref.bottomRight.col + 1;\n                        dim.rows = ref.bottomRight.row + 1;\n                    }\n                } else if (tag === 'sheetFormatPr') {\n                    if (attrs.defaultColWidth) {\n                        dim.columnWidth = toColWidth(parseFloat(attrs.defaultColWidth));\n                    }\n                    if (attrs.defaultRowHeight) {\n                        dim.rowHeight = toRowHeight(parseFloat(attrs.defaultRowHeight));\n                    }\n                } else if (this.is(SEL_ROW)) {\n                    this.exit();\n                }\n            }\n        });\n        return dim;\n    }\n    function toColWidth(size) {\n        var maximumDigitWidth = 7;\n        var fraction = (256 * size + Math.floor(128 / maximumDigitWidth)) / 256;\n        return Math.floor(fraction) * maximumDigitWidth;\n    }\n    function toRowHeight(pts) {\n        return pts * 1.5625;\n    }\n    function readSheet(zip, file, sheet, strings, styles) {\n        var ref, type, value, formula, formulaRange;\n        var nCols = sheet._columns._count;\n        var prevCellRef = null;\n        parse(zip, 'xl/' + file, {\n            enter: function (tag, attrs) {\n                if (this.is(SEL_CELL)) {\n                    value = null;\n                    formula = null;\n                    formulaRange = null;\n                    ref = attrs.r;\n                    if (ref == null) {\n                        ref = parseReference(prevCellRef);\n                        ref.col++;\n                        ref = ref.toString();\n                    }\n                    prevCellRef = ref;\n                    type = attrs.t;\n                    var styleIndex = attrs.s;\n                    if (styleIndex != null) {\n                        applyStyle(sheet, ref, styles, styleIndex);\n                    }\n                } else if (this.is(SEL_MERGE)) {\n                    sheet.range(attrs.ref).merge();\n                } else if (this.is(SEL_COL)) {\n                    var start = integer(attrs.min) - 1;\n                    var stop = Math.min(nCols, integer(attrs.max)) - 1;\n                    if (attrs.width) {\n                        var width = toColWidth(parseFloat(attrs.width));\n                        sheet._columns.values.value(start, stop, width);\n                    }\n                    if (attrs.hidden === '1') {\n                        for (var ci = start; ci <= stop; ci++) {\n                            sheet.hideColumn(ci);\n                        }\n                    }\n                } else if (this.is(SEL_ROW)) {\n                    var row = integer(attrs.r) - 1;\n                    if (attrs.ht) {\n                        var height = toRowHeight(parseFloat(attrs.ht));\n                        sheet._rows.values.value(row, row, height);\n                    }\n                    if (attrs.hidden === '1') {\n                        sheet.hideRow(row);\n                    }\n                } else if (this.is(SEL_SELECTION)) {\n                    if (attrs.activeCell) {\n                        var acRef = parseReference(attrs.activeCell);\n                        sheet.select(acRef, true);\n                    }\n                } else if (this.is(SEL_PANE)) {\n                    if (attrs.state == 'frozen') {\n                        if (attrs.xSplit) {\n                            sheet.frozenColumns(integer(attrs.xSplit));\n                        }\n                        if (attrs.ySplit) {\n                            sheet.frozenRows(integer(attrs.ySplit));\n                        }\n                    }\n                } else if (this.is(SEL_SHEET_VIEW)) {\n                    sheet.options.showGridLines = bool(attrs.showGridLines, true);\n                }\n            },\n            leave: function (tag) {\n                if (this.is(SEL_CELL)) {\n                    if (formula != null) {\n                        try {\n                            sheet.range(formulaRange || ref).formula(formula);\n                        } catch (ex) {\n                            sheet.range(formulaRange || ref).value(formula).background('#ffaaaa');\n                        }\n                    } else if (value != null) {\n                        var range = sheet.range(ref);\n                        if (!range._get('formula')) {\n                            if (!type || type == 'n') {\n                                value = parseFloat(value);\n                            } else if (type == 's') {\n                                value = strings[integer(value)];\n                            } else if (type == 'b') {\n                                value = value === '1';\n                            } else if (type == 'd') {\n                                value = kendo.parseDate(value);\n                            }\n                            range.value(value);\n                        }\n                    }\n                } else if (tag == 'cols') {\n                    sheet._columns._refresh();\n                } else if (tag == 'sheetData') {\n                    sheet._rows._refresh();\n                }\n            },\n            text: function (text) {\n                var attrs;\n                if (this.is(SEL_VALUE) || this.is(SEL_STRING)) {\n                    value = text;\n                } else if (attrs = this.is(SEL_FORMULA)) {\n                    formula = text;\n                    if (attrs.t == 'shared') {\n                        formulaRange = attrs.ref;\n                    }\n                }\n            }\n        });\n    }\n    var BORDER_WIDTHS = {\n        'none': 0,\n        'thin': 1,\n        'medium': 2,\n        'dashed': 1,\n        'dotted': 1,\n        'thick': 3,\n        'double': 3,\n        'hair': 1,\n        'mediumDashed': 2,\n        'dashDot': 1,\n        'mediumDashDot': 2,\n        'dashDotDot': 1,\n        'mediumDashDotDot': 2,\n        'slantDashDot': 1\n    };\n    var DEFAULT_FORMATS = {\n        0: 'General',\n        1: '0',\n        2: '0.00',\n        3: '#,##0',\n        4: '#,##0.00',\n        9: '0%',\n        10: '0.00%',\n        11: '0.00E+00',\n        12: '# ?/?',\n        13: '# ??/??',\n        14: 'mm-dd-yy',\n        15: 'd-mmm-yy',\n        16: 'd-mmm',\n        17: 'mmm-yy',\n        18: 'h:mm AM/PM',\n        19: 'h:mm:ss AM/PM',\n        20: 'h:mm',\n        21: 'h:mm:ss',\n        22: 'm/d/yy h:mm',\n        37: '#,##0 ;(#,##0)',\n        38: '#,##0 ;[Red](#,##0)',\n        39: '#,##0.00;(#,##0.00)',\n        40: '#,##0.00;[Red](#,##0.00)',\n        45: 'mm:ss',\n        46: '[h]:mm:ss',\n        47: 'mmss.0',\n        48: '##0.0E+0',\n        49: '@'\n    };\n    function applyStyle(sheet, ref, styles, styleIndex) {\n        var range = sheet.range(ref);\n        var xf = styles.inlineStyles[styleIndex], base, value;\n        if (xf.xfId) {\n            base = styles.namedStyles[xf.xfId];\n        }\n        if (shouldSet('applyBorder', 'borderId')) {\n            setBorder(styles.borders[value]);\n        }\n        if (shouldSet('applyFont', 'fontId')) {\n            setFont(styles.fonts[value]);\n        }\n        if (shouldSet('applyAlignment', 'textAlign')) {\n            range.textAlign(value);\n        }\n        if (shouldSet('applyAlignment', 'verticalAlign')) {\n            range.verticalAlign(value);\n        }\n        if (shouldSet('applyAlignment', 'wrapText')) {\n            range._property('wrap', value);\n        }\n        if (shouldSet('applyFill', 'fillId')) {\n            setFill(styles.fills[value]);\n        }\n        if (shouldSet('applyNumberFormat', 'numFmtId')) {\n            setFormat(styles.numFmts[value] || DEFAULT_FORMATS[value]);\n        }\n        function setFormat(f) {\n            var format = typeof f == 'string' ? f : f.formatCode;\n            if (format != null && !/^general$/i.test(format)) {\n                format = format.replace(/^\\[\\$-[0-9]+\\]/, '');\n                range.format(format);\n            }\n        }\n        function setFill(f) {\n            if (f.type == 'solid') {\n                range.background(f.color);\n            }\n        }\n        function setFont(f) {\n            range.fontFamily(f.name);\n            range._property('fontSize', f.size);\n            if (f.bold) {\n                range.bold(true);\n            }\n            if (f.italic) {\n                range.italic(true);\n            }\n        }\n        function setBorder(b) {\n            function set(side, prop) {\n                var border = b[side];\n                if (!border) {\n                    return;\n                }\n                var width = BORDER_WIDTHS[border.style];\n                if (width === 0) {\n                    return;\n                }\n                var color = border.color;\n                if (color == null) {\n                    color = '#000';\n                }\n                range._property(prop, {\n                    size: width,\n                    color: color\n                });\n            }\n            set('left', 'borderLeft');\n            set('top', 'borderTop');\n            set('right', 'borderRight');\n            set('bottom', 'borderBottom');\n        }\n        function shouldSet(applyName, propName) {\n            var t = xf[applyName];\n            if (t != null && !t) {\n                return false;\n            }\n            value = xf[propName];\n            if (base && value == null) {\n                t = base[applyName];\n                if (t != null && !t) {\n                    return false;\n                }\n                value = base[propName];\n            }\n            return value != null;\n        }\n    }\n    function parse(zip, file, callbacks) {\n        var part = zip.files[file];\n        if (part) {\n            parseXML(part.asUint8Array(), callbacks);\n        }\n    }\n    function readStrings(zip) {\n        var strings = [];\n        var current;\n        parse(zip, 'xl/sharedStrings.xml', {\n            enter: function () {\n                if (this.is(SEL_SHARED_STRING)) {\n                    current = '';\n                }\n            },\n            leave: function () {\n                if (this.is(SEL_SHARED_STRING)) {\n                    strings.push(current);\n                }\n            },\n            text: function (text) {\n                if (this.is(SEL_TEXT)) {\n                    current += text;\n                }\n            }\n        });\n        return strings;\n    }\n    function readRelationships(zip, file) {\n        var map = {\n            byId: {},\n            byType: { theme: [] }\n        };\n        parse(zip, 'xl/_rels/' + file + '.rels', {\n            enter: function (tag, attrs) {\n                if (tag == 'Relationship') {\n                    map.byId[attrs.Id] = attrs.Target;\n                    var type = attrs.Type.match(/\\w+$/)[0];\n                    var entries = map.byType[type] || [];\n                    entries.push(attrs.Target);\n                    map.byType[type] = entries;\n                }\n            }\n        });\n        return map;\n    }\n    var SEL_BORDER = [\n        'borders',\n        'border'\n    ];\n    var SEL_FILL = [\n        'fills',\n        'fill'\n    ];\n    var SEL_FONT = [\n        'fonts',\n        'font'\n    ];\n    var SEL_INLINE_STYLE = [\n        'cellXfs',\n        'xf'\n    ];\n    var SEL_NAMED_STYLE = [\n        'cellStyleXfs',\n        'xf'\n    ];\n    var SEL_NUM_FMT = [\n        'numFmts',\n        'numFmt'\n    ];\n    var INDEXED_COLORS = [\n        toCSSColor('FF000000'),\n        toCSSColor('FFFFFFFF'),\n        toCSSColor('FFFF0000'),\n        toCSSColor('FF00FF00'),\n        toCSSColor('FF0000FF'),\n        toCSSColor('FFFFFF00'),\n        toCSSColor('FFFF00FF'),\n        toCSSColor('FF00FFFF'),\n        toCSSColor('FF000000'),\n        toCSSColor('FFFFFFFF'),\n        toCSSColor('FFFF0000'),\n        toCSSColor('FF00FF00'),\n        toCSSColor('FF0000FF'),\n        toCSSColor('FFFFFF00'),\n        toCSSColor('FFFF00FF'),\n        toCSSColor('FF00FFFF'),\n        toCSSColor('FF800000'),\n        toCSSColor('FF008000'),\n        toCSSColor('FF000080'),\n        toCSSColor('FF808000'),\n        toCSSColor('FF800080'),\n        toCSSColor('FF008080'),\n        toCSSColor('FFC0C0C0'),\n        toCSSColor('FF808080'),\n        toCSSColor('FF9999FF'),\n        toCSSColor('FF993366'),\n        toCSSColor('FFFFFFCC'),\n        toCSSColor('FFCCFFFF'),\n        toCSSColor('FF660066'),\n        toCSSColor('FFFF8080'),\n        toCSSColor('FF0066CC'),\n        toCSSColor('FFCCCCFF'),\n        toCSSColor('FF000080'),\n        toCSSColor('FFFF00FF'),\n        toCSSColor('FFFFFF00'),\n        toCSSColor('FF00FFFF'),\n        toCSSColor('FF800080'),\n        toCSSColor('FF800000'),\n        toCSSColor('FF008080'),\n        toCSSColor('FF0000FF'),\n        toCSSColor('FF00CCFF'),\n        toCSSColor('FFCCFFFF'),\n        toCSSColor('FFCCFFCC'),\n        toCSSColor('FFFFFF99'),\n        toCSSColor('FF99CCFF'),\n        toCSSColor('FFFF99CC'),\n        toCSSColor('FFCC99FF'),\n        toCSSColor('FFFFCC99'),\n        toCSSColor('FF3366FF'),\n        toCSSColor('FF33CCCC'),\n        toCSSColor('FF99CC00'),\n        toCSSColor('FFFFCC00'),\n        toCSSColor('FFFF9900'),\n        toCSSColor('FFFF6600'),\n        toCSSColor('FF666699'),\n        toCSSColor('FF969696'),\n        toCSSColor('FF003366'),\n        toCSSColor('FF339966'),\n        toCSSColor('FF003300'),\n        toCSSColor('FF333300'),\n        toCSSColor('FF993300'),\n        toCSSColor('FF993366'),\n        toCSSColor('FF333399'),\n        toCSSColor('FF333333'),\n        toCSSColor('FF000000'),\n        toCSSColor('FFFFFFFF')\n    ];\n    function readStyles(zip, theme) {\n        var styles = {\n            fonts: [],\n            numFmts: {},\n            fills: [],\n            borders: [],\n            namedStyles: [],\n            inlineStyles: []\n        };\n        var font = null;\n        var fill = null;\n        var border = null;\n        var xf = null;\n        parse(zip, 'xl/styles.xml', {\n            enter: function (tag, attrs, closed) {\n                if (this.is(SEL_NUM_FMT)) {\n                    styles.numFmts[attrs.numFmtId] = attrs;\n                } else if (this.is(SEL_FONT)) {\n                    styles.fonts.push(font = {});\n                } else if (font) {\n                    if (tag == 'sz') {\n                        font.size = parseFloat(attrs.val);\n                    } else if (tag == 'name') {\n                        font.name = attrs.val;\n                    } else if (tag == 'b') {\n                        font.bold = bool(attrs.val, true);\n                    } else if (tag == 'i') {\n                        font.italic = bool(attrs.val, true);\n                    }\n                } else if (this.is(SEL_FILL)) {\n                    styles.fills.push(fill = {});\n                } else if (fill) {\n                    if (tag == 'patternFill') {\n                        fill.type = attrs.patternType;\n                    } else if (tag == 'fgColor' && fill.type === 'solid') {\n                        fill.color = getColor(attrs);\n                    } else if (tag == 'bgColor' && fill.type !== 'solid') {\n                        fill.color = getColor(attrs);\n                    }\n                } else if (this.is(SEL_BORDER)) {\n                    styles.borders.push(border = {});\n                } else if (border) {\n                    if (/^(?:left|top|right|bottom)$/.test(tag) && attrs.style) {\n                        border[tag] = { style: attrs.style };\n                    }\n                    if (tag == 'color') {\n                        var side = this.stack[this.stack.length - 2].$tag;\n                        border[side].color = getColor(attrs);\n                    }\n                } else if (this.is(SEL_NAMED_STYLE)) {\n                    xf = getXf(attrs);\n                    styles.namedStyles.push(xf);\n                    if (closed) {\n                        xf = null;\n                    }\n                } else if (this.is(SEL_INLINE_STYLE)) {\n                    xf = getXf(attrs);\n                    styles.inlineStyles.push(xf);\n                    if (closed) {\n                        xf = null;\n                    }\n                } else if (xf) {\n                    if (tag == 'alignment') {\n                        if (/^(?:left|center|right|justify)$/.test(attrs.horizontal)) {\n                            xf.textAlign = attrs.horizontal;\n                        }\n                        if (/^(?:top|center|bottom)$/.test(attrs.vertical)) {\n                            xf.verticalAlign = attrs.vertical;\n                        }\n                        if (attrs.wrapText != null) {\n                            xf.wrapText = bool(attrs.wrapText);\n                        }\n                    }\n                }\n            },\n            leave: function (tag) {\n                if (this.is(SEL_FONT)) {\n                    font = null;\n                } else if (this.is(SEL_FILL)) {\n                    fill = null;\n                } else if (this.is(SEL_BORDER)) {\n                    border = null;\n                } else if (tag == 'xf') {\n                    xf = null;\n                }\n            }\n        });\n        function getXf(attrs) {\n            var xf = {\n                borderId: integer(attrs.borderId),\n                fillId: integer(attrs.fillId),\n                fontId: integer(attrs.fontId),\n                numFmtId: integer(attrs.numFmtId),\n                pivotButton: bool(attrs.pivotButton),\n                quotePrefix: bool(attrs.quotePrefix),\n                xfId: integer(attrs.xfId)\n            };\n            addBool('applyAlignment');\n            addBool('applyBorder');\n            addBool('applyFill');\n            addBool('applyFont');\n            addBool('applyNumberFormat');\n            addBool('applyProtection');\n            function addBool(name) {\n                if (attrs[name] != null) {\n                    xf[name] = bool(attrs[name]);\n                }\n            }\n            return xf;\n        }\n        function getColor(attrs) {\n            if (attrs.rgb) {\n                return toCSSColor(attrs.rgb);\n            } else if (attrs.indexed) {\n                return INDEXED_COLORS[integer(attrs.indexed)];\n            } else if (attrs.theme) {\n                var themeColor = theme.colorScheme[integer(attrs.theme)];\n                var color = kendo.parseColor(themeColor);\n                if (attrs.tint) {\n                    color = color.toHSL();\n                    var tint = parseFloat(attrs.tint);\n                    if (tint < 0) {\n                        color.l = color.l * (1 + tint);\n                    } else {\n                        color.l = color.l * (1 - tint) + (100 - 100 * (1 - tint));\n                    }\n                }\n                return color.toCssRgba();\n            }\n        }\n        return styles;\n    }\n    var SEL_SCHEME_RGBCLR = [\n        'a:clrScheme',\n        '*',\n        'a:srgbClr'\n    ];\n    var SEL_SCHEME_SYSCLR = [\n        'a:clrScheme',\n        '*',\n        'a:sysClr'\n    ];\n    function readTheme(zip, rel) {\n        var scheme = [];\n        var theme = { colorScheme: scheme };\n        var file = 'xl/' + rel;\n        if (zip.files[file]) {\n            parse(zip, file, {\n                enter: function (tag, attrs) {\n                    if (this.is(SEL_SCHEME_SYSCLR)) {\n                        scheme.push(toCSSColor(attrs.val == 'window' ? 'FFFFFFFF' : 'FF000000'));\n                    } else if (this.is(SEL_SCHEME_RGBCLR)) {\n                        scheme.push(toCSSColor('FF' + attrs.val));\n                    }\n                }\n            });\n            if (scheme.length > 3) {\n                swap(scheme, 0, 1);\n                swap(scheme, 2, 3);\n            }\n        }\n        function swap(arr, a, b) {\n            var tmp = arr[a];\n            arr[a] = arr[b];\n            arr[b] = tmp;\n        }\n        return theme;\n    }\n    function integer(val) {\n        return val == null ? null : parseInt(val, 10);\n    }\n    function bool(val, def) {\n        if (val == null) {\n            return def;\n        }\n        return val == 'true' || val === true || val == 1;\n    }\n    function toCSSColor(rgb) {\n        var m = /^([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(rgb);\n        return 'rgba(' + parseInt(m[2], 16) + ', ' + parseInt(m[3], 16) + ', ' + parseInt(m[4], 16) + ', ' + parseInt(m[1], 16) / 255 + ')';\n    }\n    kendo.spreadsheet.readExcel = readExcel;\n    kendo.spreadsheet._readSheet = readSheet;\n    kendo.spreadsheet._readStrings = readStrings;\n    kendo.spreadsheet._readStyles = readStyles;\n    kendo.spreadsheet._readTheme = readTheme;\n    kendo.spreadsheet._readWorkbook = readWorkbook;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/workbook', [\n        'kendo.core',\n        'spreadsheet/runtime',\n        'spreadsheet/references',\n        'spreadsheet/excel-reader'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Workbook = kendo.Observable.extend({\n            init: function (options, view) {\n                kendo.Observable.fn.init.call(this);\n                this.options = options;\n                this._view = view;\n                this._sheets = [];\n                this._sheetsSearchCache = {};\n                this._sheet = this.insertSheet({\n                    rows: this.options.rows,\n                    columns: this.options.columns,\n                    rowHeight: this.options.rowHeight,\n                    columnWidth: this.options.columnWidth,\n                    headerHeight: this.options.headerHeight,\n                    headerWidth: this.options.headerWidth,\n                    dataSource: this.options.dataSource\n                });\n                this.undoRedoStack = new kendo.util.UndoRedoStack();\n                this.undoRedoStack.bind([\n                    'undo',\n                    'redo'\n                ], this._onUndoRedo.bind(this));\n                this._context = new kendo.spreadsheet.FormulaContext(this);\n                this._validationContext = new kendo.spreadsheet.ValidationFormulaContext(this);\n                this._names = Object.create(null);\n                this.fromJSON(this.options);\n            },\n            clipboard: function () {\n                if (!this._clipboard) {\n                    this._clipboard = new kendo.spreadsheet.Clipboard(this);\n                }\n                return this._clipboard;\n            },\n            destroy: function () {\n                this.unbind();\n                if (this._clipboard) {\n                    this._clipboard.destroy();\n                }\n            },\n            events: [\n                'change',\n                'excelImport',\n                'excelExport'\n            ],\n            _sheetChange: function (e) {\n                this.trigger('change', e);\n            },\n            _inputForRef: function (ref) {\n                return new kendo.spreadsheet.Range(ref, this._sheet).input();\n            },\n            _onUndoRedo: function (e) {\n                e.command.range().select();\n            },\n            execute: function (options) {\n                var commandOptions = $.extend({ workbook: this }, options.options);\n                var command = new kendo.spreadsheet[options.command](commandOptions);\n                var sheet = this.activeSheet();\n                if (commandOptions.origin) {\n                    command.origin(commandOptions.origin);\n                }\n                if (commandOptions.operatingRange) {\n                    command.range(commandOptions.operatingRange);\n                } else if (commandOptions.editActiveCell) {\n                    command.range(sheet.activeCellSelection());\n                } else {\n                    command.range(sheet.selection());\n                }\n                var result = command.exec();\n                if (!result || result.reason !== 'error') {\n                    this.undoRedoStack.push(command);\n                }\n                return result;\n            },\n            resetFormulas: function () {\n                this._sheets.forEach(function (sheet) {\n                    sheet.resetFormulas();\n                });\n            },\n            resetValidations: function () {\n                this._sheets.forEach(function (sheet) {\n                    sheet.resetValidations();\n                });\n            },\n            refresh: function (reason) {\n                if (reason.recalc) {\n                    this.resetFormulas();\n                    this.resetValidations();\n                    this._sheet.recalc(this._context);\n                    this._sheet.revalidate(this._validationContext);\n                }\n            },\n            activeSheet: function (sheet) {\n                if (sheet === undefined) {\n                    return this._sheet;\n                }\n                if (!this.sheetByName(sheet.name())) {\n                    return;\n                }\n                this._sheet = sheet;\n                sheet.triggerChange(kendo.spreadsheet.ALL_REASONS);\n            },\n            moveSheetToIndex: function (sheet, toIndex) {\n                var fromIndex = this.sheetIndex(sheet);\n                var sheets = this._sheets;\n                if (fromIndex === -1) {\n                    return;\n                }\n                this._sheetsSearchCache = {};\n                sheets.splice(toIndex, 0, sheets.splice(fromIndex, 1)[0]);\n                this.trigger('change', { sheetSelection: true });\n            },\n            insertSheet: function (options) {\n                options = options || {};\n                var that = this;\n                var insertIndex = typeof options.index === 'number' ? options.index : that._sheets.length;\n                var sheetName;\n                var sheets = that._sheets;\n                var getUniqueSheetName = function (sheetNameSuffix) {\n                    sheetNameSuffix = sheetNameSuffix ? sheetNameSuffix : 1;\n                    var name = 'Sheet' + sheetNameSuffix;\n                    if (!that.sheetByName(name)) {\n                        return name;\n                    }\n                    return getUniqueSheetName(sheetNameSuffix + 1);\n                };\n                if (options.name && that.sheetByName(options.name)) {\n                    return;\n                }\n                this._sheetsSearchCache = {};\n                sheetName = options.name || getUniqueSheetName();\n                var sheet = new kendo.spreadsheet.Sheet(options.rows || this.options.rows, options.columns || this.options.columns, options.rowHeight || this.options.rowHeight, options.columnWidth || this.options.columnWidth, options.headerHeight || this.options.headerHeight, options.headerWidth || this.options.headerWidth);\n                sheet._workbook = this;\n                sheet._name(sheetName);\n                sheet.bind('change', this._sheetChange.bind(this));\n                sheets.splice(insertIndex, 0, sheet);\n                if (options.data) {\n                    sheet.fromJSON(options.data);\n                }\n                if (options.dataSource) {\n                    sheet.setDataSource(options.dataSource);\n                }\n                this.trigger('change', { sheetSelection: true });\n                return sheet;\n            },\n            sheets: function () {\n                return this._sheets.slice();\n            },\n            sheetByName: function (sheetName) {\n                return this._sheets[this.sheetIndex(sheetName)];\n            },\n            sheetByIndex: function (index) {\n                return this._sheets[index];\n            },\n            sheetIndex: function (sheet) {\n                var sheets = this._sheets;\n                var sheetName = (typeof sheet == 'string' ? sheet : sheet.name()).toLowerCase();\n                var idx = this._sheetsSearchCache[sheetName];\n                if (idx >= 0) {\n                    return idx;\n                }\n                for (idx = 0; idx < sheets.length; idx++) {\n                    var name = sheets[idx].name().toLowerCase();\n                    this._sheetsSearchCache[name] = idx;\n                    if (name === sheetName) {\n                        return idx;\n                    }\n                }\n                return -1;\n            },\n            renameSheet: function (sheet, newSheetName) {\n                var oldSheetName = sheet.name();\n                if (!newSheetName || oldSheetName === newSheetName) {\n                    return;\n                }\n                sheet = this.sheetByName(oldSheetName);\n                if (!sheet) {\n                    return;\n                }\n                this._sheetsSearchCache = {};\n                this._sheets.forEach(function (sheet) {\n                    sheet._forFormulas(function (formula) {\n                        formula.renameSheet(oldSheetName, newSheetName);\n                    });\n                });\n                sheet._name(newSheetName);\n                this.trigger('change', { sheetSelection: true });\n                return sheet;\n            },\n            removeSheet: function (sheet) {\n                var that = this;\n                var sheets = that._sheets;\n                var name = sheet.name();\n                var index = that.sheetIndex(sheet);\n                if (sheets.length === 1) {\n                    return;\n                }\n                this._sheetsSearchCache = {};\n                if (index > -1) {\n                    sheet.unbind();\n                    sheets.splice(index, 1);\n                    if (that.activeSheet().name() === name) {\n                        var newSheet = sheets[index === sheets.length ? index - 1 : index];\n                        that.activeSheet(newSheet);\n                    } else {\n                        this.trigger('change', {\n                            recalc: true,\n                            sheetSelection: true\n                        });\n                    }\n                }\n            },\n            fromJSON: function (json) {\n                if (json.sheets) {\n                    for (var idx = 0; idx < json.sheets.length; idx++) {\n                        var sheet = this.sheetByIndex(idx);\n                        if (!sheet) {\n                            sheet = this.insertSheet();\n                        }\n                        sheet.fromJSON(json.sheets[idx]);\n                        var dataSource = json.sheets[idx].dataSource;\n                        if (dataSource) {\n                            sheet.setDataSource(dataSource);\n                        }\n                    }\n                }\n                if (json.activeSheet) {\n                    this.activeSheet(this.sheetByName(json.activeSheet));\n                }\n            },\n            toJSON: function () {\n                this.resetFormulas();\n                this.resetValidations();\n                return {\n                    activeSheet: this.activeSheet().name(),\n                    sheets: this._sheets.map(function (sheet) {\n                        sheet.recalc(this._context);\n                        return sheet.toJSON();\n                    }, this)\n                };\n            },\n            fromFile: function (file) {\n                var deferred = new $.Deferred();\n                var promise = deferred.promise();\n                var args = {\n                    file: file,\n                    promise: promise\n                };\n                if (file && !this.trigger('excelImport', args)) {\n                    for (var i = 0; i < this._sheets.length; i++) {\n                        this._sheets[i].unbind();\n                    }\n                    this._sheets = [];\n                    this._sheetsSearchCache = {};\n                    kendo.spreadsheet.readExcel(file, this, deferred);\n                } else {\n                    deferred.reject();\n                }\n                return promise;\n            },\n            saveAsExcel: function (options) {\n                options = $.extend({}, this.options.excel, options);\n                var data = this.toJSON();\n                if (!this.trigger('excelExport', { workbook: data })) {\n                    var workbook = new kendo.ooxml.Workbook(data);\n                    kendo.saveAs({\n                        dataURI: workbook.toDataURL(),\n                        fileName: data.fileName || options.fileName,\n                        proxyURL: options.proxyURL,\n                        forceProxy: options.forceProxy\n                    });\n                }\n            },\n            draw: function (options, callback) {\n                if (typeof options == 'function' && !callback) {\n                    callback = options;\n                    options = {};\n                }\n                var parts = [], sheets = this._sheets;\n                (function loop(i) {\n                    if (i < sheets.length) {\n                        sheets[i].draw(kendo.spreadsheet.SHEETREF, options, function (group) {\n                            parts.push(group);\n                            loop(i + 1);\n                        });\n                    } else {\n                        var group = parts[0];\n                        for (i = 1; i < parts.length; ++i) {\n                            group.children = group.children.concat(parts[i].children);\n                        }\n                        callback(group);\n                    }\n                }(0));\n            },\n            defineName: function (name, value, hidden) {\n                this._names[name] = {\n                    value: value,\n                    hidden: hidden\n                };\n            },\n            undefineName: function (name) {\n                delete this._names[name];\n            },\n            nameValue: function (name) {\n                if (name in this._names) {\n                    return this._names[name].value;\n                }\n                return null;\n            },\n            adjustNames: function (affectedSheet, forRow, start, delta) {\n                affectedSheet = affectedSheet.toLowerCase();\n                Object.keys(this._names).forEach(function (name) {\n                    var ref = this.nameValue(name);\n                    if (ref instanceof kendo.spreadsheet.Ref && ref.sheet.toLowerCase() == affectedSheet) {\n                        ref = ref.adjust(null, null, null, null, forRow, start, delta);\n                        this.defineName(name, ref);\n                    }\n                }, this);\n            },\n            options: {}\n        });\n        kendo.spreadsheet.Workbook = Workbook;\n        if (kendo.PDFMixin) {\n            kendo.PDFMixin.extend(Workbook.prototype);\n            Workbook.prototype.saveAsPDF = function (options) {\n                var progress = new $.Deferred();\n                var promise = progress.promise();\n                var args = { promise: promise };\n                if (this.trigger('pdfExport', args)) {\n                    return;\n                }\n                this._drawPDF(options, progress).then(function (root) {\n                    return kendo.drawing.exportPDF(root);\n                }).done(function (dataURI) {\n                    kendo.saveAs({\n                        dataURI: dataURI,\n                        fileName: options.fileName,\n                        proxyURL: options.proxyURL,\n                        forceProxy: options.forceProxy,\n                        proxyTarget: options.proxyTarget\n                    });\n                    progress.resolve();\n                }).fail(function (err) {\n                    progress.reject(err);\n                });\n                return promise;\n            };\n            Workbook.prototype._drawPDF = function (options) {\n                var result = new $.Deferred();\n                var callback = function (group) {\n                    result.resolve(group);\n                };\n                switch (options.area) {\n                case 'workbook':\n                    options.workbook.draw(options, callback);\n                    break;\n                case 'sheet':\n                    options.workbook.activeSheet().draw(options, callback);\n                    break;\n                case 'selection':\n                    options.workbook.activeSheet().selection().draw(options, callback);\n                    break;\n                }\n                return result.promise();\n            };\n        }\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/formulacontext', ['kendo.core'], f);\n}(function () {\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var CellRef = spreadsheet.CellRef;\n    var RangeRef = spreadsheet.RangeRef;\n    var UnionRef = spreadsheet.UnionRef;\n    var NameRef = spreadsheet.NameRef;\n    var Ref = spreadsheet.Ref;\n    var FormulaContext = kendo.Class.extend({\n        init: function (workbook) {\n            this.workbook = workbook;\n        },\n        getRefCells: function (ref, hiddenInfo) {\n            var sheet, formula, value, i;\n            if (ref instanceof CellRef) {\n                sheet = this.workbook.sheetByName(ref.sheet);\n                if (!sheet || !ref.valid()) {\n                    return [{ value: new kendo.spreadsheet.calc.runtime.CalcError('REF') }];\n                }\n                formula = sheet.formula(ref);\n                value = sheet.range(ref.row, ref.col).value();\n                if (formula != null || value != null) {\n                    return [{\n                            formula: formula,\n                            value: value,\n                            row: ref.row,\n                            col: ref.col,\n                            sheet: ref.sheet,\n                            hidden: hiddenInfo ? sheet.columnWidth(ref.col) === 0 || sheet.rowHeight(ref.row) === 0 : false\n                        }];\n                } else {\n                    return [];\n                }\n            }\n            if (ref instanceof RangeRef) {\n                i = this.workbook.sheetIndex(ref.sheet);\n                var states = [], n = i;\n                if (ref.endSheet) {\n                    n = this.workbook.sheetIndex(ref.endSheet);\n                    if (i > n) {\n                        var tmp = i;\n                        i = n;\n                        n = tmp;\n                    }\n                }\n                if (i < 0 || n < 0 || !ref.valid()) {\n                    return [{ value: new kendo.spreadsheet.calc.runtime.CalcError('REF') }];\n                }\n                while (i <= n) {\n                    sheet = this.workbook.sheetByIndex(i++);\n                    var tl = sheet._grid.normalize(ref.topLeft);\n                    var br = sheet._grid.normalize(ref.bottomRight);\n                    var startCellIndex = sheet._grid.cellRefIndex(tl);\n                    var endCellIndex = sheet._grid.cellRefIndex(br);\n                    var values = sheet._properties.iterator('value', startCellIndex, endCellIndex);\n                    for (var col = tl.col; col <= br.col; ++col) {\n                        for (var row = tl.row; row <= br.row; ++row) {\n                            var index = sheet._grid.index(row, col);\n                            formula = sheet._properties.get('formula', index);\n                            value = values.at(index);\n                            if (formula != null || value != null) {\n                                states.push({\n                                    formula: formula,\n                                    value: value,\n                                    row: row,\n                                    col: col,\n                                    sheet: sheet.name(),\n                                    hidden: hiddenInfo ? sheet.columnWidth(col) === 0 || sheet.rowHeight(row) === 0 : false\n                                });\n                            }\n                        }\n                    }\n                }\n                return states;\n            }\n            if (ref instanceof UnionRef) {\n                var a = [];\n                for (i = 0; i < ref.refs.length; ++i) {\n                    a = a.concat(this.getRefCells(ref.refs[i], hiddenInfo));\n                }\n                return a;\n            }\n            if (ref instanceof NameRef) {\n                var val = this.workbook.nameValue(ref.name);\n                if (val instanceof Ref) {\n                    return this.getRefCells(val, hiddenInfo);\n                }\n                return [{ value: new kendo.spreadsheet.calc.runtime.CalcError('NAME') }];\n            }\n            return [];\n        },\n        getData: function (ref) {\n            var single = ref instanceof CellRef;\n            if (ref instanceof NameRef) {\n                single = this.workbook.nameValue(ref) instanceof CellRef;\n            }\n            var data = this.getRefCells(ref).map(function (cell) {\n                return cell.value;\n            });\n            return single ? data[0] : data;\n        },\n        onFormula: function (f) {\n            var sheet = this.workbook.sheetByName(f.sheet);\n            var row = f.row, col = f.col, value = f.value;\n            var currentFormula = sheet.formula({\n                row: row,\n                col: col\n            });\n            if (currentFormula !== f) {\n                return false;\n            }\n            if (value instanceof kendo.spreadsheet.calc.runtime.Matrix) {\n                value.each(function (value, r, c) {\n                    sheet._value(row + r, col + c, value);\n                });\n            } else {\n                sheet._value(row, col, value);\n            }\n            clearTimeout(sheet._formulaContextRefresh);\n            sheet._formulaContextRefresh = setTimeout(function () {\n                sheet.batch(function () {\n                }, { layout: true });\n            }, 50);\n            return true;\n        }\n    });\n    var ValidationFormulaContext = FormulaContext.extend({\n        onFormula: function () {\n            return true;\n        }\n    });\n    spreadsheet.FormulaContext = FormulaContext;\n    spreadsheet.ValidationFormulaContext = ValidationFormulaContext;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/controller', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        'use strict';\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var alphaNumRegExp = /:alphanum$/;\n        var ACTIONS = {\n            'up': 'up',\n            'down': 'down',\n            'left': 'left',\n            'right': 'right',\n            'home': 'first-col',\n            'ctrl+left': 'first-col',\n            'end': 'last-col',\n            'ctrl+right': 'last-col',\n            'ctrl+up': 'first-row',\n            'ctrl+down': 'last-row',\n            'ctrl+home': 'first',\n            'ctrl+end': 'last',\n            'pageup': 'prev-page',\n            'pagedown': 'next-page'\n        };\n        var ENTRY_ACTIONS = {\n            'tab': 'next',\n            'shift+tab': 'previous',\n            'enter': 'lower',\n            'shift+enter': 'upper',\n            'delete': 'clearContents',\n            'backspace': 'clearContents',\n            'shift+:alphanum': 'edit',\n            ':alphanum': 'edit',\n            'ctrl+:alphanum': 'ctrl',\n            ':edit': 'edit'\n        };\n        var CONTAINER_EVENTS = {\n            'wheel': 'onWheel',\n            '*+mousedown': 'onMouseDown',\n            'contextmenu': 'onContextMenu',\n            '*+mousedrag': 'onMouseDrag',\n            '*+mouseup': 'onMouseUp',\n            '*+dblclick': 'onDblClick',\n            'mousemove': 'onMouseMove'\n        };\n        var CLIPBOARD_EVENTS = {\n            '*+pageup': 'onPageUp',\n            '*+pagedown': 'onPageDown',\n            'mouseup': 'onMouseUp',\n            '*+cut': 'onCut',\n            '*+paste': 'onPaste',\n            '*+copy': 'onCopy'\n        };\n        var EDITOR_EVENTS = {\n            'esc': 'onEditorEsc',\n            'enter': 'onEditorBlur',\n            'shift+enter': 'onEditorBlur',\n            'tab': 'onEditorBlur',\n            'shift+tab': 'onEditorBlur'\n        };\n        var FORMULABAR_EVENTS = $.extend({ focus: 'onEditorBarFocus' }, EDITOR_EVENTS);\n        var FORMULAINPUT_EVENTS = $.extend({ focus: 'onEditorCellFocus' }, EDITOR_EVENTS);\n        var SELECTION_MODES = {\n            cell: 'range',\n            rowheader: 'row',\n            columnheader: 'column',\n            topcorner: 'sheet',\n            autofill: 'autofill'\n        };\n        function toActionSelector(selectors) {\n            return selectors.map(function (action) {\n                return '[data-action=\"' + action + '\"]';\n            }).join(',');\n        }\n        var COMPOSITE_UNAVAILABLE_ACTION_SELECTORS = toActionSelector([\n            'cut',\n            'copy',\n            'paste',\n            'insert-left',\n            'insert-right',\n            'insert-above',\n            'insert-below'\n        ]);\n        var UNHIDE_ACTION_SELECTORS = toActionSelector([\n            'unhide-row',\n            'unhide-column'\n        ]);\n        var ACTION_KEYS = [];\n        var SHIFT_ACTION_KEYS = [];\n        var ENTRY_ACTION_KEYS = [];\n        for (var key in ACTIONS) {\n            ACTION_KEYS.push(key);\n            SHIFT_ACTION_KEYS.push('shift+' + key);\n        }\n        for (key in ENTRY_ACTIONS) {\n            ENTRY_ACTION_KEYS.push(key);\n        }\n        CLIPBOARD_EVENTS[ACTION_KEYS] = 'onAction';\n        CLIPBOARD_EVENTS[SHIFT_ACTION_KEYS] = 'onShiftAction';\n        CLIPBOARD_EVENTS[ENTRY_ACTION_KEYS] = 'onEntryAction';\n        FORMULAINPUT_EVENTS[ACTION_KEYS] = 'onEditorAction';\n        FORMULAINPUT_EVENTS[SHIFT_ACTION_KEYS] = 'onEditorShiftAction';\n        var Controller = kendo.Class.extend({\n            init: function (view, workbook) {\n                this.view = view;\n                this.workbook(workbook);\n                this.container = $(view.container);\n                this.clipboardElement = $(view.clipboard);\n                this.cellContextMenu = view.cellContextMenu;\n                this.rowHeaderContextMenu = view.rowHeaderContextMenu;\n                this.colHeaderContextMenu = view.colHeaderContextMenu;\n                this.scroller = view.scroller;\n                this.tabstrip = view.tabstrip;\n                this.sheetsbar = view.sheetsbar;\n                this.editor = view.editor;\n                this.editor.bind('change', this.onEditorChange.bind(this));\n                this.editor.bind('activate', this.onEditorActivate.bind(this));\n                this.editor.bind('deactivate', this.onEditorDeactivate.bind(this));\n                this.editor.bind('update', this.onEditorUpdate.bind(this));\n                $(view.scroller).on('scroll', this.onScroll.bind(this));\n                this.listener = new kendo.spreadsheet.EventListener(this.container, this, CONTAINER_EVENTS);\n                this.keyListener = new kendo.spreadsheet.EventListener(this.clipboardElement, this, CLIPBOARD_EVENTS);\n                this.barKeyListener = new kendo.spreadsheet.EventListener(this.editor.barElement(), this, FORMULABAR_EVENTS);\n                this.inputKeyListener = new kendo.spreadsheet.EventListener(this.editor.cellElement(), this, FORMULAINPUT_EVENTS);\n                if (this.sheetsbar) {\n                    this.sheetsbar.bind('select', this.onSheetBarSelect.bind(this));\n                    this.sheetsbar.bind('reorder', this.onSheetBarReorder.bind(this));\n                    this.sheetsbar.bind('rename', this.onSheetBarRename.bind(this));\n                    this.sheetsbar.bind('remove', this.onSheetBarRemove.bind(this));\n                }\n                this.cellContextMenu.bind('select', this.onContextMenuSelect.bind(this));\n                this.rowHeaderContextMenu.bind('select', this.onContextMenuSelect.bind(this));\n                this.colHeaderContextMenu.bind('select', this.onContextMenuSelect.bind(this));\n                this.cellContextMenu.element.add(this.rowHeaderContextMenu.element).add(this.colHeaderContextMenu.element).on('contextmenu', false);\n                if (this.tabstrip) {\n                    this.tabstrip.bind('action', this.onCommandRequest.bind(this));\n                    this.tabstrip.bind('dialog', this.onDialogRequest.bind(this));\n                }\n            },\n            _execute: function (options) {\n                var result = this._workbook.execute(options);\n                if (options.command === 'EditCommand' && !result) {\n                    this._workbook.trigger('change', { editorClose: true });\n                }\n                if (result) {\n                    if (result.reason === 'error') {\n                        this.view.showError(result);\n                    } else {\n                        this.view.openDialog(result.reason);\n                    }\n                }\n                return result;\n            },\n            _activeTooltip: function () {\n                return this._workbook.activeSheet().activeCell().simplify().toString();\n            },\n            onContextMenuSelect: function (e) {\n                var action = $(e.item).data('action');\n                var command;\n                switch (action) {\n                case 'cut':\n                    command = {\n                        command: 'ToolbarCutCommand',\n                        options: { workbook: this._workbook }\n                    };\n                    break;\n                case 'copy':\n                    command = {\n                        command: 'ToolbarCopyCommand',\n                        options: { workbook: this._workbook }\n                    };\n                    break;\n                case 'paste':\n                    command = {\n                        command: 'ToolbarPasteCommand',\n                        options: { workbook: this._workbook }\n                    };\n                    break;\n                case 'unmerge':\n                    command = {\n                        command: 'MergeCellCommand',\n                        options: { value: 'unmerge' }\n                    };\n                    break;\n                case 'merge':\n                    this.view.openDialog('merge');\n                    break;\n                case 'hide-row':\n                    command = {\n                        command: 'HideLineCommand',\n                        options: { axis: 'row' }\n                    };\n                    break;\n                case 'hide-column':\n                    command = {\n                        command: 'HideLineCommand',\n                        options: { axis: 'column' }\n                    };\n                    break;\n                case 'unhide-row':\n                    command = {\n                        command: 'UnHideLineCommand',\n                        options: { axis: 'row' }\n                    };\n                    break;\n                case 'unhide-column':\n                    command = {\n                        command: 'UnHideLineCommand',\n                        options: { axis: 'column' }\n                    };\n                    break;\n                case 'delete-row':\n                    command = { command: 'DeleteRowCommand' };\n                    break;\n                case 'delete-column':\n                    command = { command: 'DeleteColumnCommand' };\n                    break;\n                }\n                if (command) {\n                    this._execute(command);\n                }\n            },\n            onSheetBarRemove: function (e) {\n                var sheet = this._workbook.sheetByName(e.name);\n                if (!sheet) {\n                    return;\n                }\n                this._workbook.removeSheet(sheet);\n            },\n            destroy: function () {\n                this.listener.destroy();\n                this.keyListener.destroy();\n                this.inputKeyListener.destroy();\n            },\n            onSheetBarSelect: function (e) {\n                var sheet;\n                var workbook = this._workbook;\n                if (e.isAddButton) {\n                    sheet = workbook.insertSheet();\n                } else {\n                    sheet = workbook.sheetByName(e.name);\n                }\n                if (workbook.activeSheet().name() !== sheet.name()) {\n                    workbook.activeSheet(sheet);\n                }\n            },\n            onSheetBarReorder: function (e) {\n                var sheet = this._workbook.sheetByIndex(e.oldIndex);\n                this._workbook.moveSheetToIndex(sheet, e.newIndex);\n                this._workbook.activeSheet(sheet);\n            },\n            onSheetBarRename: function (e) {\n                var sheet = this._workbook.sheetByIndex(e.sheetIndex);\n                this._workbook.renameSheet(sheet, e.name);\n                this.clipboardElement.focus();\n            },\n            sheet: function (sheet) {\n                this.navigator = sheet.navigator();\n                this.axisManager = sheet.axisManager();\n            },\n            workbook: function (workbook) {\n                this._workbook = workbook;\n                this.clipboard = workbook.clipboard();\n            },\n            refresh: function () {\n                var editor = this.editor;\n                var workbook = this._workbook;\n                var sheet = workbook.activeSheet();\n                this._viewPortHeight = this.view.scroller.clientHeight;\n                this.navigator.height(this._viewPortHeight);\n                if (!editor.isActive()) {\n                    editor.enable(sheet.selection().enable() !== false);\n                    editor.value(workbook._inputForRef(sheet.activeCell()));\n                }\n            },\n            onScroll: function () {\n                this.view.render();\n            },\n            onWheel: function (event) {\n                var deltaX = event.originalEvent.deltaX;\n                var deltaY = event.originalEvent.deltaY;\n                if (event.originalEvent.deltaMode === 1) {\n                    deltaX *= 10;\n                    deltaY *= 10;\n                }\n                this.scrollWith(deltaX, deltaY);\n                event.preventDefault();\n            },\n            onAction: function (event, action) {\n                this.navigator.moveActiveCell(ACTIONS[action]);\n                event.preventDefault();\n            },\n            onPageUp: function () {\n                this.scrollDown(-this._viewPortHeight);\n            },\n            onPageDown: function () {\n                this.scrollDown(this._viewPortHeight);\n            },\n            onEntryAction: function (event, action) {\n                if (event.mod) {\n                    var shouldPrevent = true;\n                    var key = String.fromCharCode(event.keyCode);\n                    switch (key) {\n                    case 'A':\n                        this.navigator.selectAll();\n                        break;\n                    case 'Y':\n                        this._workbook.undoRedoStack.redo();\n                        break;\n                    case 'Z':\n                        this._workbook.undoRedoStack.undo();\n                        break;\n                    default:\n                        shouldPrevent = false;\n                        break;\n                    }\n                    if (shouldPrevent) {\n                        event.preventDefault();\n                    }\n                } else {\n                    var disabled = this._workbook.activeSheet().selection().enable() === false;\n                    if (action == 'delete' || action == 'backspace') {\n                        if (disabled) {\n                            return;\n                        }\n                        this._execute({ command: 'ClearContentCommand' });\n                        event.preventDefault();\n                    } else if (alphaNumRegExp.test(action) || action === ':edit') {\n                        if (disabled) {\n                            return;\n                        }\n                        if (action !== ':edit') {\n                            this.editor.value('');\n                        }\n                        this.editor.activate({\n                            range: this._workbook.activeSheet()._viewActiveCell(),\n                            rect: this.view.activeCellRectangle(),\n                            tooltip: this._activeTooltip()\n                        }).focus();\n                    } else {\n                        this.navigator.navigateInSelection(ENTRY_ACTIONS[action]);\n                        event.preventDefault();\n                    }\n                }\n            },\n            onShiftAction: function (event, action) {\n                this.navigator.modifySelection(ACTIONS[action.replace('shift+', '')], this.appendSelection);\n                event.preventDefault();\n            },\n            onMouseMove: function (event) {\n                var sheet = this._workbook.activeSheet();\n                if (sheet.resizingInProgress() || sheet.selectionInProgress()) {\n                    return;\n                }\n                var object = this.objectAt(event);\n                if (object.type === 'columnresizehandle' || object.type === 'rowresizehandle') {\n                    sheet.positionResizeHandle(object.ref);\n                } else {\n                    sheet.removeResizeHandle();\n                }\n            },\n            onMouseDown: function (event) {\n                var object = this.objectAt(event);\n                if (object.pane) {\n                    this.originFrame = object.pane;\n                }\n                if (this.editor.canInsertRef(false) && object.ref) {\n                    this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs());\n                    this.navigator.startSelection(object.ref, this._selectionMode, this.appendSelection);\n                    event.preventDefault();\n                    return;\n                } else {\n                    this.editor.deactivate();\n                    if (this.editor.isActive()) {\n                        event.preventDefault();\n                        return;\n                    }\n                }\n                var sheet = this._workbook.activeSheet();\n                if (object.type === 'columnresizehandle' || object.type === 'rowresizehandle') {\n                    sheet.startResizing({\n                        x: object.x,\n                        y: object.y\n                    });\n                    event.preventDefault();\n                    return;\n                }\n                if (object.type === 'filtericon') {\n                    this.openFilterMenu(event);\n                    event.preventDefault();\n                    return;\n                }\n                this._selectionMode = SELECTION_MODES[object.type];\n                this.appendSelection = event.mod;\n                this.navigator.startSelection(object.ref, this._selectionMode, this.appendSelection);\n            },\n            onContextMenu: function (event) {\n                var sheet = this._workbook.activeSheet();\n                if (sheet.resizingInProgress()) {\n                    return;\n                }\n                event.preventDefault();\n                this.cellContextMenu.close();\n                this.colHeaderContextMenu.close();\n                this.rowHeaderContextMenu.close();\n                var menu;\n                var location = {\n                    pageX: event.pageX,\n                    pageY: event.pageY\n                };\n                var object = this.objectAt(location);\n                if (object.type === 'columnresizehandle' || object.type === 'rowresizehandle') {\n                    return;\n                }\n                this.navigator.selectForContextMenu(object.ref, SELECTION_MODES[object.type]);\n                var isComposite = this.navigator._sheet.select() instanceof kendo.spreadsheet.UnionRef;\n                var showUnhide = false;\n                var showUnmerge = false;\n                if (object.type == 'columnheader') {\n                    menu = this.colHeaderContextMenu;\n                    showUnhide = !isComposite && this.axisManager.selectionIncludesHiddenColumns();\n                } else if (object.type == 'rowheader') {\n                    menu = this.rowHeaderContextMenu;\n                    showUnhide = !isComposite && this.axisManager.selectionIncludesHiddenRows();\n                } else {\n                    menu = this.cellContextMenu;\n                    showUnmerge = this.navigator.selectionIncludesMergedCells();\n                }\n                menu.element.find(COMPOSITE_UNAVAILABLE_ACTION_SELECTORS).toggle(!isComposite);\n                menu.element.find(UNHIDE_ACTION_SELECTORS).toggle(showUnhide);\n                menu.element.find('[data-action=unmerge]').toggle(showUnmerge);\n                setTimeout(function () {\n                    menu.open(event.pageX, event.pageY);\n                });\n            },\n            prevent: function (event) {\n                event.preventDefault();\n            },\n            constrainResize: function (type, ref) {\n                var sheet = this._workbook.activeSheet();\n                var resizeHandle = sheet.resizeHandlePosition();\n                return !resizeHandle || type === 'outside' || type === 'topcorner' || ref.col < resizeHandle.col || ref.row < resizeHandle.row;\n            },\n            onMouseDrag: function (event) {\n                if (this._selectionMode === 'sheet') {\n                    return;\n                }\n                var location = {\n                    pageX: event.pageX,\n                    pageY: event.pageY\n                };\n                var object = this.objectAt(location);\n                var sheet = this._workbook.activeSheet();\n                if (sheet.resizingInProgress()) {\n                    if (!this.constrainResize(object.type, object.ref)) {\n                        sheet.resizeHintPosition({\n                            x: object.x,\n                            y: object.y\n                        });\n                    }\n                    return;\n                }\n                if (object.type === 'outside') {\n                    this.startAutoScroll(object);\n                    return;\n                }\n                if (this.originFrame === object.pane) {\n                    this.selectToLocation(location);\n                } else {\n                    var frame = this.originFrame._grid;\n                    if (object.x > frame.right) {\n                        this.scrollLeft();\n                    }\n                    if (object.y > frame.bottom) {\n                        this.scrollTop();\n                    }\n                    if (object.y < frame.top || object.x < frame.left) {\n                        this.startAutoScroll(object, location);\n                    } else {\n                        this.selectToLocation(location);\n                    }\n                }\n                event.preventDefault();\n            },\n            onMouseUp: function (event) {\n                var sheet = this._workbook.activeSheet();\n                sheet.completeResizing();\n                this.navigator.completeSelection();\n                this.stopAutoScroll();\n                var editor = this.editor.activeEditor();\n                if (!editor) {\n                    return;\n                }\n                var el = event.target;\n                while (el) {\n                    if (el === editor.element[0]) {\n                        return;\n                    }\n                    el = el.parentNode;\n                }\n                var object = this.objectAt(event);\n                if (object && object.ref && editor.canInsertRef(false)) {\n                    editor.refAtPoint(sheet.selection()._ref);\n                    sheet._setFormulaSelections(editor.highlightedRefs());\n                }\n            },\n            onDblClick: function (event) {\n                var object = this.objectAt(event);\n                var disabled = this._workbook.activeSheet().selection().enable() === false;\n                if (object.type !== 'cell' || disabled) {\n                    return;\n                }\n                this.editor.activate({\n                    range: this._workbook.activeSheet()._viewActiveCell(),\n                    rect: this.view.activeCellRectangle(),\n                    tooltip: this._activeTooltip()\n                }).focus();\n                this.onEditorUpdate();\n            },\n            onCut: function (e) {\n                if (e) {\n                    var table = this.clipboardElement.find('table.kendo-clipboard-' + this.clipboard._uid).detach();\n                    this.clipboardElement.append(table.clone(false));\n                    setTimeout(function () {\n                        this.clipboardElement.empty().append(table);\n                    }.bind(this));\n                }\n                this._execute({\n                    command: 'CutCommand',\n                    options: { workbook: this.view._workbook }\n                });\n            },\n            clipBoardValue: function () {\n                return this.clipboardElement.html();\n            },\n            onPaste: function (e) {\n                var html = '';\n                var plain = '';\n                this.clipboard.menuInvoked = e === undefined;\n                if (e) {\n                    if (e.originalEvent.clipboardData && e.originalEvent.clipboardData.getData) {\n                        e.preventDefault();\n                        var hasHTML = false;\n                        var hasPlainText = false;\n                        if (window.DOMStringList && e.originalEvent.clipboardData.types instanceof window.DOMStringList) {\n                            hasHTML = e.originalEvent.clipboardData.types.contains('text/html');\n                            hasPlainText = e.originalEvent.clipboardData.types.contains('text/plain');\n                        } else {\n                            hasHTML = /text\\/html/.test(e.originalEvent.clipboardData.types);\n                            hasPlainText = /text\\/plain/.test(e.originalEvent.clipboardData.types);\n                        }\n                        if (hasHTML) {\n                            html = e.originalEvent.clipboardData.getData('text/html');\n                        }\n                        if (hasPlainText) {\n                            plain = e.originalEvent.clipboardData.getData('text/plain').trim();\n                        }\n                    } else {\n                        var table = this.clipboardElement.find('table.kendo-clipboard-' + this.clipboard._uid).detach();\n                        this.clipboardElement.empty();\n                        setTimeout(function () {\n                            var html = this.clipboardElement.html();\n                            var plain = window.clipboardData.getData('Text').trim();\n                            if (!html && !plain) {\n                                return;\n                            }\n                            this.clipboard.external({\n                                html: html,\n                                plain: plain\n                            });\n                            this.clipboardElement.empty().append(table);\n                            this._execute({\n                                command: 'PasteCommand',\n                                options: { workbook: this.view._workbook }\n                            });\n                            this.clipboard.menuInvoked = true;\n                        }.bind(this));\n                        return;\n                    }\n                } else {\n                    if (kendo.support.browser.msie) {\n                        this.clipboardElement.focus().select();\n                        document.execCommand('paste');\n                        return;\n                    } else {\n                        this.clipboard.menuInvoked = true;\n                    }\n                }\n                if (!html && !plain) {\n                    return;\n                }\n                this.clipboard.external({\n                    html: html,\n                    plain: plain\n                });\n                this._execute({\n                    command: 'PasteCommand',\n                    options: { workbook: this.view._workbook }\n                });\n            },\n            onCopy: function (e) {\n                this.clipboard.menuInvoked = e === undefined;\n                this._execute({\n                    command: 'CopyCommand',\n                    options: { workbook: this.view._workbook }\n                });\n            },\n            scrollTop: function () {\n                this.scroller.scrollTop = 0;\n            },\n            scrollLeft: function () {\n                this.scroller.scrollLeft = 0;\n            },\n            scrollDown: function (value) {\n                this.scroller.scrollTop += value;\n            },\n            scrollRight: function (value) {\n                this.scroller.scrollLeft += value;\n            },\n            scrollWith: function (right, down) {\n                this.scroller.scrollTop += down;\n                this.scroller.scrollLeft += right;\n            },\n            objectAt: function (location) {\n                var offset = this.container.offset();\n                var coordinates = {\n                    left: location.pageX - offset.left,\n                    top: location.pageY - offset.top\n                };\n                return this.view.objectAt(coordinates.left, coordinates.top);\n            },\n            selectToLocation: function (cellLocation) {\n                var object = this.objectAt(cellLocation);\n                if (object.pane) {\n                    this.extendSelection(object);\n                    this.lastKnownCellLocation = cellLocation;\n                    this.originFrame = object.pane;\n                }\n                this.stopAutoScroll();\n            },\n            extendSelection: function (object) {\n                this.navigator.extendSelection(object.ref, this._selectionMode, this.appendSelection);\n            },\n            autoScroll: function () {\n                var x = this._autoScrollTarget.x;\n                var y = this._autoScrollTarget.y;\n                var boundaries = this.originFrame._grid;\n                var scroller = this.view.scroller;\n                var scrollStep = 8;\n                var scrollLeft = scroller.scrollLeft;\n                var scrollTop = scroller.scrollTop;\n                if (x < boundaries.left) {\n                    this.scrollRight(-scrollStep);\n                }\n                if (x > boundaries.right) {\n                    this.scrollRight(scrollStep);\n                }\n                if (y < boundaries.top) {\n                    this.scrollDown(-scrollStep);\n                }\n                if (y > boundaries.bottom) {\n                    this.scrollDown(scrollStep);\n                }\n                if (scrollTop === scroller.scrollTop && scrollLeft === scroller.scrollLeft) {\n                    this.selectToLocation(this.finalLocation);\n                } else {\n                    this.extendSelection(this.objectAt(this.lastKnownCellLocation));\n                }\n            },\n            startAutoScroll: function (viewObject, location) {\n                if (!this._scrollInterval) {\n                    this._scrollInterval = setInterval(this.autoScroll.bind(this), 50);\n                }\n                this.finalLocation = location || this.lastKnownCellLocation;\n                this._autoScrollTarget = viewObject;\n            },\n            stopAutoScroll: function () {\n                clearInterval(this._scrollInterval);\n                this._scrollInterval = null;\n            },\n            openFilterMenu: function (event) {\n                var object = this.objectAt(event);\n                var sheet = this._workbook.activeSheet();\n                var column = sheet.filterColumn(object.ref);\n                var filterMenu = this.view.createFilterMenu(column);\n                filterMenu.bind('action', this.onCommandRequest.bind(this));\n                filterMenu.bind('action', filterMenu.close.bind(filterMenu));\n                filterMenu.openFor(event.target);\n            },\n            onEditorChange: function (e) {\n                this._workbook.activeSheet().isInEditMode(false);\n                var result = this._execute({\n                    command: 'EditCommand',\n                    options: {\n                        editActiveCell: true,\n                        value: e.value\n                    }\n                });\n                if (result && result.reason === 'error') {\n                    e.preventDefault();\n                }\n            },\n            onEditorActivate: function () {\n                var workbook = this._workbook;\n                var sheet = workbook.activeSheet();\n                sheet._setFormulaSelections(this.editor.highlightedRefs());\n                sheet.isInEditMode(true);\n            },\n            onEditorDeactivate: function () {\n                var sheet = this._workbook.activeSheet();\n                sheet.isInEditMode(false);\n                sheet._setFormulaSelections([]);\n            },\n            onEditorUpdate: function () {\n                this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs());\n            },\n            onEditorBarFocus: function () {\n                var disabled = this._workbook.activeSheet().selection().enable() === false;\n                if (disabled) {\n                    return;\n                }\n                this.editor.activate({\n                    range: this._workbook.activeSheet()._viewActiveCell(),\n                    rect: this.view.activeCellRectangle(),\n                    tooltip: this._activeTooltip()\n                });\n            },\n            onEditorCellFocus: function () {\n                this.editor.scale();\n            },\n            onEditorEsc: function () {\n                this.editor.value(this._workbook._inputForRef(this._workbook.activeSheet()._viewActiveCell()));\n                this.editor.deactivate();\n                this.clipboardElement.focus();\n            },\n            onEditorBlur: function (_, action) {\n                if (this.editor.isFiltered()) {\n                    return;\n                }\n                this.editor.deactivate();\n                if (!this.editor.isActive()) {\n                    this.clipboardElement.focus();\n                    this.navigator.navigateInSelection(ENTRY_ACTIONS[action]);\n                }\n            },\n            onEditorAction: function (event, action) {\n                var editor = this.editor;\n                var sheet = this._workbook.activeSheet();\n                if (editor.canInsertRef(true)) {\n                    this.navigator.moveActiveCell(ACTIONS[action]);\n                    editor.activeEditor().refAtPoint(sheet.selection()._ref);\n                    sheet._setFormulaSelections(editor.highlightedRefs());\n                    event.preventDefault();\n                }\n            },\n            onEditorShiftAction: function (event, action) {\n                var editor = this.editor;\n                var sheet = this._workbook.activeSheet();\n                if (editor.canInsertRef(true)) {\n                    this.navigator.modifySelection(ACTIONS[action.replace('shift+', '')], this.appendSelection);\n                    editor.activeEditor().refAtPoint(sheet.selection()._ref);\n                    sheet._setFormulaSelections(editor.highlightedRefs());\n                    event.preventDefault();\n                }\n            },\n            onCommandRequest: function (e) {\n                if (e.command) {\n                    this._execute(e);\n                } else {\n                    this._workbook.undoRedoStack[e.action]();\n                }\n            },\n            onDialogRequest: function (e) {\n                var exportOptions = {\n                    pdfExport: this._workbook.options.pdf,\n                    excelExport: this._workbook.options.excel\n                };\n                if (e.options) {\n                    $.extend(true, e.options, exportOptions);\n                } else {\n                    e.options = exportOptions;\n                }\n                this.view.openDialog(e.name, e.options);\n            }\n        });\n        kendo.spreadsheet.Controller = Controller;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/view', [\n        'kendo.core',\n        'kendo.menu',\n        'spreadsheet/sheetsbar'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var DOT = '.';\n        var RESIZE_HANDLE_WIDTH = 7;\n        var viewClassNames = {\n            view: 'k-spreadsheet-view',\n            fixedContainer: 'k-spreadsheet-fixed-container',\n            scroller: 'k-spreadsheet-scroller',\n            viewSize: 'k-spreadsheet-view-size',\n            clipboard: 'k-spreadsheet-clipboard',\n            cellEditor: 'k-spreadsheet-cell-editor',\n            barEditor: 'k-spreadsheet-editor',\n            topCorner: 'k-spreadsheet-top-corner',\n            filterHeadersWrapper: 'k-filter-wrapper',\n            filterRange: 'k-filter-range',\n            filterButton: 'k-spreadsheet-filter',\n            filterButtonActive: 'k-state-active',\n            icon: 'k-icon k-font-icon',\n            iconFilterDefault: 'k-i-arrow-s',\n            sheetsBar: 'k-spreadsheet-sheets-bar',\n            sheetsBarActive: 'k-spreadsheet-sheets-bar-active',\n            sheetsBarInactive: 'k-spreadsheet-sheets-bar-inactive',\n            cellContextMenu: 'k-spreadsheet-cell-context-menu',\n            rowHeaderContextMenu: 'k-spreadsheet-row-header-context-menu',\n            colHeaderContextMenu: 'k-spreadsheet-col-header-context-menu'\n        };\n        var VIEW_MESAGES = kendo.spreadsheet.messages.view = {\n            errors: {\n                openUnsupported: 'Unsupported format. Please select an .xlsx file.',\n                shiftingNonblankCells: 'Cannot insert cells due to data loss possibility. Select another insert location or delete the data from the end of your worksheet.',\n                filterRangeContainingMerges: 'Cannot create a filter within a range containing merges',\n                sortRangeContainingMerges: 'Cannot sort a range containing merges',\n                validationError: 'The value that you entered violates the validation rules set on the cell.'\n            },\n            tabs: {\n                home: 'Home',\n                insert: 'Insert',\n                data: 'Data'\n            }\n        };\n        function selectElementContents(el) {\n            var sel = window.getSelection();\n            sel.removeAllRanges();\n            var range = document.createRange();\n            range.selectNodeContents(el);\n            sel.addRange(range);\n        }\n        function cellBefore(table, row) {\n            var cells = table.trs[row].children;\n            return cells[cells.length - 2];\n        }\n        function cellAbove(table, row) {\n            var prevRow = table.trs[row - 1];\n            var index = table.trs[row].children.length - 1;\n            if (prevRow && index >= 0) {\n                return prevRow.children[index];\n            }\n        }\n        function cellBorder(value) {\n            return [\n                'solid',\n                (value.size || 1) + 'px',\n                value.color || '#000'\n            ].join(' ');\n        }\n        function drawCell(collection, cell, cls, hBorders, vBorders, showGrid) {\n            if (!cls && !kendo.spreadsheet.draw.shouldDrawCell(cell)) {\n                return;\n            }\n            var left = cell.left;\n            var top = cell.top;\n            var width = cell.width + 1;\n            var height = cell.height + 1;\n            var style = {};\n            var background = cell.background;\n            var defaultBorder = null;\n            if (background) {\n                defaultBorder = background;\n                if (showGrid) {\n                    defaultBorder = kendo.parseColor(defaultBorder).toHSV();\n                    defaultBorder.v *= 0.9;\n                    defaultBorder = defaultBorder.toCssRgba();\n                }\n                defaultBorder = cellBorder({ color: defaultBorder });\n            }\n            if (background) {\n                style.backgroundColor = background;\n            }\n            if (cell.color) {\n                style.color = cell.color;\n            }\n            if (cell.fontFamily) {\n                style.fontFamily = cell.fontFamily;\n            }\n            if (cell.underline) {\n                style.textDecoration = 'underline';\n            }\n            if (cell.italic) {\n                style.fontStyle = 'italic';\n            }\n            if (cell.textAlign) {\n                style.textAlign = cell.textAlign;\n            }\n            if (cell.bold) {\n                style.fontWeight = 'bold';\n            }\n            if (cell.fontSize) {\n                style.fontSize = cell.fontSize + 'px';\n            }\n            if (cell.wrap === true) {\n                style.whiteSpace = 'pre-wrap';\n                style.wordBreak = 'break-all';\n            }\n            if (cell.borderLeft) {\n                style.borderLeft = cellBorder(cell.borderLeft);\n                if (vBorders) {\n                    vBorders[cell.left] = true;\n                }\n            } else if (defaultBorder && vBorders && !vBorders[cell.left]) {\n                style.borderLeft = defaultBorder;\n            } else {\n                left++;\n                width--;\n            }\n            if (cell.borderTop) {\n                style.borderTop = cellBorder(cell.borderTop);\n                if (hBorders) {\n                    hBorders[cell.top] = true;\n                }\n            } else if (defaultBorder && hBorders && !hBorders[cell.top]) {\n                style.borderTop = defaultBorder;\n            } else {\n                top++;\n                height--;\n            }\n            if (cell.borderRight) {\n                style.borderRight = cellBorder(cell.borderRight);\n                if (vBorders) {\n                    vBorders[cell.right] = true;\n                }\n            } else if (defaultBorder && vBorders && !vBorders[cell.right]) {\n                style.borderRight = defaultBorder;\n            } else {\n                width--;\n            }\n            if (cell.borderBottom) {\n                style.borderBottom = cellBorder(cell.borderBottom);\n                if (hBorders) {\n                    hBorders[cell.bottom] = true;\n                }\n            } else if (defaultBorder && hBorders && !hBorders[cell.bottom]) {\n                style.borderBottom = defaultBorder;\n            } else {\n                height--;\n            }\n            style.left = left + 'px';\n            style.top = top + 'px';\n            style.width = width + 'px';\n            style.height = height + 'px';\n            var data = cell.value, type = typeof data;\n            if (cell.format && data !== null) {\n                data = kendo.spreadsheet.formatting.format(data, cell.format);\n                if (data.__dataType) {\n                    type = data.__dataType;\n                }\n            } else if (data !== null && data !== undefined) {\n                data = kendo.dom.text(data);\n            }\n            if (!style.textAlign) {\n                switch (type) {\n                case 'number':\n                case 'date':\n                case 'percent':\n                    style.textAlign = 'right';\n                    break;\n                case 'boolean':\n                    style.textAlign = 'center';\n                    break;\n                }\n            }\n            var classNames = [paneClassNames.cell];\n            if (cls) {\n                classNames.push(cls);\n            }\n            if (cell.enable === false) {\n                classNames.push('k-state-disabled');\n            }\n            if (cell.merged) {\n                classNames.push('k-spreadsheet-merged-cell');\n            }\n            var verticalAlign = cell.verticalAlign || 'bottom';\n            if (verticalAlign && data) {\n                data = kendo.dom.element('div', { className: 'k-vertical-align-' + verticalAlign }, [data]);\n            }\n            var children = data ? [data] : [];\n            var properties = { style: style };\n            var validation = cell.validation;\n            if (validation && !validation.value) {\n                children.push(kendo.dom.element('span', { className: 'k-dirty' }));\n                classNames.push('k-dirty-cell');\n                properties.title = validation._getOptions().messageTemplate;\n            }\n            properties.className = classNames.join(' ');\n            var div = kendo.dom.element('div', properties, children);\n            collection.push(div);\n            return div;\n        }\n        function addCell(table, row, cell) {\n            var style = {};\n            if (cell.background) {\n                style.backgroundColor = cell.background;\n            }\n            if (cell.color) {\n                style.color = cell.color;\n            }\n            if (cell.fontFamily) {\n                style.fontFamily = cell.fontFamily;\n            }\n            if (cell.underline) {\n                style.textDecoration = 'underline';\n            }\n            if (cell.italic) {\n                style.fontStyle = 'italic';\n            }\n            if (cell.textAlign) {\n                style.textAlign = cell.textAlign;\n            }\n            if (cell.verticalAlign) {\n                style.verticalAlign = cell.verticalAlign === 'center' ? 'middle' : cell.verticalAlign;\n            }\n            if (cell.bold) {\n                style.fontWeight = 'bold';\n            }\n            if (cell.fontSize) {\n                style.fontSize = cell.fontSize + 'px';\n            }\n            if (cell.wrap === true) {\n                style.whiteSpace = 'pre-wrap';\n                style.wordBreak = 'break-all';\n            }\n            if (cell.borderRight) {\n                style.borderRight = cellBorder(cell.borderRight);\n            } else if (cell.background) {\n                style.borderRightColor = cell.background;\n            }\n            if (cell.borderBottom) {\n                style.borderBottom = cellBorder(cell.borderBottom);\n            } else if (cell.background) {\n                style.borderBottomColor = cell.background;\n            }\n            var data = cell.value, type = typeof data;\n            if (cell.format && data !== null) {\n                data = kendo.spreadsheet.formatting.format(data, cell.format);\n                if (data.__dataType) {\n                    type = data.__dataType;\n                }\n            }\n            if (!style.textAlign) {\n                switch (type) {\n                case 'number':\n                case 'date':\n                case 'percent':\n                    style.textAlign = 'right';\n                    break;\n                case 'boolean':\n                    style.textAlign = 'center';\n                    break;\n                }\n            }\n            var className = null;\n            if (cell.enable === false) {\n                className = 'k-state-disabled';\n            }\n            var td = table.addCell(row, data, style, className, cell.validation);\n            var border, sibling;\n            if (cell.borderLeft) {\n                sibling = cellBefore(table, row);\n                border = cellBorder(cell.borderLeft);\n                if (sibling && border) {\n                    sibling.attr.style.borderRight = border;\n                }\n            } else if (cell.background) {\n                style.borderLeftColor = cell.background;\n            }\n            if (cell.borderTop) {\n                sibling = cellAbove(table, row);\n                border = cellBorder(cell.borderTop);\n                if (sibling && border) {\n                    sibling.attr.style.borderBottom = border;\n                }\n            } else if (cell.background) {\n                style.borderTopColor = cell.background;\n            }\n            return td;\n        }\n        var HtmlTable = kendo.Class.extend({\n            init: function () {\n                this.cols = [];\n                this.trs = [];\n                this._height = 0;\n                this._width = 0;\n            },\n            addColumn: function (width) {\n                this._width += width;\n                var col = kendo.dom.element('col', { style: { width: width + 'px' } });\n                col.visible = width > 0;\n                this.cols.push(col);\n            },\n            addRow: function (height) {\n                var attr = null;\n                attr = { style: { height: height + 'px' } };\n                this._height += height;\n                var tr = kendo.dom.element('tr', attr);\n                tr.visible = height > 0;\n                this.trs.push(tr);\n            },\n            addCell: function (rowIndex, text, style, className, validation) {\n                if (text === null || text === undefined) {\n                    text = '';\n                }\n                if (!(text instanceof kendo.dom.Node)) {\n                    text = kendo.dom.text(text);\n                }\n                var children = [text];\n                var properties = { style: style };\n                if (validation && !validation.value) {\n                    children.push(kendo.dom.element('span', { className: 'k-dirty' }));\n                    className = (className || '') + (className ? ' ' : '') + 'k-dirty-cell';\n                    properties.title = validation._getOptions().messageTemplate;\n                }\n                if (className) {\n                    properties.className = className;\n                }\n                var td = kendo.dom.element('td', properties, children);\n                this.trs[rowIndex].children.push(td);\n                return td;\n            },\n            toDomTree: function (x, y, className) {\n                this.trs = this.trs.filter(function (tr) {\n                    return tr.visible;\n                });\n                var offset = 0;\n                this.cols = this.cols.filter(function (col, ci) {\n                    if (!col.visible) {\n                        this.trs.forEach(function (tr) {\n                            tr.children.splice(ci - offset, 1);\n                        });\n                        offset++;\n                    }\n                    return col.visible;\n                }, this);\n                return kendo.dom.element('table', {\n                    style: {\n                        left: x + 'px',\n                        top: y + 'px',\n                        height: this._height + 'px',\n                        width: this._width + 'px'\n                    },\n                    className: className\n                }, [\n                    kendo.dom.element('colgroup', null, this.cols),\n                    kendo.dom.element('tbody', null, this.trs)\n                ]);\n            }\n        });\n        var CELL_CONTEXT_MENU = '<ul class=\"#=classNames.cellContextMenu#\">' + '<li data-action=cut>Cut</li>' + '<li data-action=copy>Copy</li>' + '<li data-action=paste>Paste</li>' + '<li class=\"k-separator\"></li>' + '<li data-action=merge>Merge</li>' + '<li data-action=unmerge>Unmerge</li>' + '</ul>';\n        var ROW_HEADER_CONTEXT_MENU = '<ul class=\"#=classNames.rowHeaderContextMenu#\">' + '<li data-action=cut>Cut</li>' + '<li data-action=copy>Copy</li>' + '<li data-action=paste>Paste</li>' + '<li class=\"k-separator\"></li>' + '<li data-action=\"delete-row\">Delete</li>' + '<li data-action=\"hide-row\">Hide</li>' + '<li data-action=\"unhide-row\">Unhide</li>' + '</ul>';\n        var COL_HEADER_CONTEXT_MENU = '<ul class=\"#=classNames.colHeaderContextMenu#\">' + '<li data-action=cut>Cut</li>' + '<li data-action=copy>Copy</li>' + '<li data-action=paste>Paste</li>' + '<li class=\"k-separator\"></li>' + '<li data-action=\"delete-column\">Delete</li>' + '<li data-action=\"hide-column\">Hide</li>' + '<li data-action=\"unhide-column\">Unhide</li>' + '</ul>';\n        kendo.spreadsheet.ContextMenu = kendo.ui.ContextMenu;\n        var VIEW_CONTENTS = kendo.template('<div class=\"#=classNames.view#\"><div class=\"#=classNames.fixedContainer#\"></div><div class=\"#=classNames.scroller#\"><div class=\"#=classNames.viewSize#\"></div></div>' + '<div tabindex=\"0\" class=\"#=classNames.clipboard#\" contenteditable=true></div><div class=\"#=classNames.cellEditor#\"></div></div><div class=\"#=classNames.sheetsBar#\"></div>' + CELL_CONTEXT_MENU + ROW_HEADER_CONTEXT_MENU + COL_HEADER_CONTEXT_MENU);\n        function within(value, min, max) {\n            return value >= min && value <= max;\n        }\n        var View = kendo.Class.extend({\n            init: function (element, options) {\n                var classNames = View.classNames;\n                this.element = element;\n                this.options = $.extend(true, {}, this.options, options);\n                this._chrome();\n                this._dialogs = [];\n                element.append(VIEW_CONTENTS({ classNames: classNames }));\n                this._formulaInput();\n                this.wrapper = element.find(DOT + classNames.view);\n                this.container = element.find(DOT + classNames.fixedContainer)[0];\n                this.scroller = element.find(DOT + classNames.scroller)[0];\n                this.clipboard = element.find(DOT + classNames.clipboard);\n                this.viewSize = $(this.scroller.firstChild);\n                this.tree = new kendo.dom.Tree(this.container);\n                this.clipboardContents = new kendo.dom.Tree(this.clipboard[0]);\n                this.editor = new kendo.spreadsheet.SheetEditor(this);\n                this._sheetsbar();\n                var contextMenuConfig = {\n                    target: element,\n                    animation: false,\n                    showOn: 'never'\n                };\n                this.cellContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.cellContextMenu), contextMenuConfig);\n                this.colHeaderContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.colHeaderContextMenu), contextMenuConfig);\n                this.rowHeaderContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.rowHeaderContextMenu), contextMenuConfig);\n                var scrollbar = kendo.support.scrollbar();\n                $(this.container).css({\n                    width: this.wrapper[0].clientWidth - scrollbar,\n                    height: this.wrapper[0].clientHeight - scrollbar\n                });\n            },\n            _resize: function () {\n                var tabstripHeight = this.tabstrip ? this.tabstrip.element.outerHeight() : 0;\n                var formulaBarHeight = this.formulaBar ? this.formulaBar.element.outerHeight() : 0;\n                var sheetsBarHeight = this.sheetsbar ? this.sheetsbar.element.outerHeight() : 0;\n                this.wrapper.height(this.element.height() - (tabstripHeight + formulaBarHeight + sheetsBarHeight));\n                if (this.tabstrip) {\n                    this.tabstrip.quickAccessAdjust();\n                }\n            },\n            _chrome: function () {\n                var formulaBar = $('<div />').prependTo(this.element);\n                this.formulaBar = new kendo.spreadsheet.FormulaBar(formulaBar);\n                if (this.options.toolbar) {\n                    this._tabstrip();\n                }\n            },\n            _formulaInput: function () {\n                var editor = this.element.find(DOT + View.classNames.cellEditor);\n                this.formulaInput = new kendo.spreadsheet.FormulaInput(editor, { autoScale: true });\n            },\n            _sheetsbar: function () {\n                if (this.options.sheetsbar) {\n                    this.sheetsbar = new kendo.spreadsheet.SheetsBar(this.element.find(DOT + View.classNames.sheetsBar), $.extend(true, {}, this.options.sheetsbar));\n                }\n            },\n            _tabstrip: function () {\n                var messages = VIEW_MESAGES.tabs;\n                var options = $.extend(true, {\n                    home: true,\n                    insert: true,\n                    data: true\n                }, this.options.toolbar);\n                var tabs = [];\n                if (this.tabstrip) {\n                    this.tabstrip.destroy();\n                    this.element.children('.k-tabstrip').remove();\n                }\n                for (var name in options) {\n                    if (options[name] === true || options[name] instanceof Array) {\n                        tabs.push({\n                            id: name,\n                            text: messages[name],\n                            content: ''\n                        });\n                    }\n                }\n                this.tabstrip = new kendo.spreadsheet.TabStrip($('<div />').prependTo(this.element), {\n                    animation: false,\n                    dataTextField: 'text',\n                    dataContentField: 'content',\n                    dataSource: tabs,\n                    toolbarOptions: options,\n                    view: this\n                });\n                this.tabstrip.select(0);\n            },\n            _executeCommand: function (e) {\n                this._workbook.execute(e);\n            },\n            workbook: function (workbook) {\n                this._workbook = workbook;\n            },\n            sheet: function (sheet) {\n                this._sheet = sheet;\n            },\n            activeCellRectangle: function () {\n                return this.cellRectangle(this._sheet._viewActiveCell());\n            },\n            _rectangle: function (pane, ref) {\n                return pane._grid.boundingRectangle(ref.toRangeRef());\n            },\n            isColumnResizer: function (x, pane, ref) {\n                var rectangle = this._rectangle(pane, ref);\n                x -= this._sheet._grid._headerWidth;\n                var handleWidth = RESIZE_HANDLE_WIDTH / 2;\n                var right = rectangle.right - this.scroller.scrollLeft;\n                return right - handleWidth <= x && x <= right + handleWidth;\n            },\n            isRowResizer: function (y, pane, ref) {\n                var rectangle = this._rectangle(pane, ref);\n                y -= this._sheet._grid._headerHeight;\n                var handleWidth = RESIZE_HANDLE_WIDTH / 2;\n                var bottom = rectangle.bottom - this.scroller.scrollTop;\n                return bottom - handleWidth <= y && y <= bottom + handleWidth;\n            },\n            isFilterIcon: function (x, y, pane, ref) {\n                var result = false;\n                x -= this._sheet._grid._headerWidth - this.scroller.scrollLeft;\n                y -= this._sheet._grid._headerHeight - this.scroller.scrollTop;\n                this._sheet.forEachFilterHeader(ref, function (ref) {\n                    var rect = this._rectangle(pane, ref);\n                    result = result || pane.filterIconRect(rect).intersects(x, y);\n                }.bind(this));\n                return result;\n            },\n            isAutoFill: function (x, y, pane) {\n                var selection = this._sheet.select();\n                if (selection.size > 1) {\n                    return false;\n                }\n                x -= this._sheet._grid._headerWidth;\n                y -= this._sheet._grid._headerHeight;\n                if (!pane._grid.columns.frozen) {\n                    x += this.scroller.scrollLeft;\n                }\n                if (!pane._grid.rows.frozen) {\n                    y += this.scroller.scrollTop;\n                }\n                var rectangle = this._rectangle(pane, selection);\n                return Math.abs(rectangle.right - x) < 8 && Math.abs(rectangle.bottom - y) < 8;\n            },\n            objectAt: function (x, y) {\n                var grid = this._sheet._grid;\n                var object, pane;\n                if (x < 0 || y < 0 || x > this.scroller.clientWidth || y > this.scroller.clientHeight) {\n                    object = { type: 'outside' };\n                } else if (x < grid._headerWidth && y < grid._headerHeight) {\n                    object = { type: 'topcorner' };\n                } else {\n                    pane = this.paneAt(x, y);\n                    var row = pane._grid.rows.index(y, this.scroller.scrollTop);\n                    var column = pane._grid.columns.index(x, this.scroller.scrollLeft);\n                    var type = 'cell';\n                    var ref = new CellRef(row, column);\n                    if (this.isAutoFill(x, y, pane)) {\n                        type = 'autofill';\n                    } else if (this.isFilterIcon(x, y, pane, ref)) {\n                        type = 'filtericon';\n                    } else if (x < grid._headerWidth) {\n                        ref = new CellRef(row, -Infinity);\n                        type = this.isRowResizer(y, pane, ref) ? 'rowresizehandle' : 'rowheader';\n                    } else if (y < grid._headerHeight) {\n                        ref = new CellRef(-Infinity, column);\n                        type = this.isColumnResizer(x, pane, ref) ? 'columnresizehandle' : 'columnheader';\n                    }\n                    object = {\n                        type: type,\n                        ref: ref\n                    };\n                }\n                object.pane = pane;\n                object.x = x;\n                object.y = y;\n                return object;\n            },\n            paneAt: function (x, y) {\n                return this.panes.filter(function paneLocationWithin(pane) {\n                    var grid = pane._grid;\n                    return within(y, grid.top, grid.bottom) && within(x, grid.left, grid.right);\n                })[0];\n            },\n            containingPane: function (cell) {\n                return this.panes.filter(function (pane) {\n                    if (pane._grid.contains(cell)) {\n                        return true;\n                    }\n                    return false;\n                })[0];\n            },\n            cellRectangle: function (cell) {\n                var theGrid = this.containingPane(cell)._grid;\n                var rectangle = this._sheet._grid.rectangle(cell);\n                return rectangle.offset(theGrid.headerWidth - this.scroller.scrollLeft, theGrid.headerHeight - this.scroller.scrollTop);\n            },\n            refresh: function (reason) {\n                var sheet = this._sheet;\n                if (this.tabstrip) {\n                    this.tabstrip.refreshTools(sheet.range(sheet.activeCell()));\n                }\n                if (reason.sheetSelection && this.sheetsbar) {\n                    this.sheetsbar.renderSheets(this._workbook.sheets(), this._workbook.sheetIndex(this._sheet));\n                }\n                this._resize();\n                this.viewSize[0].style.height = sheet._grid.totalHeight() + 'px';\n                this.viewSize[0].style.width = sheet._grid.totalWidth() + 'px';\n                if (reason.layout) {\n                    var frozenColumns = sheet.frozenColumns();\n                    var frozenRows = sheet.frozenRows();\n                    this.panes = [this._pane(frozenRows, frozenColumns)];\n                    if (frozenColumns > 0) {\n                        this.panes.push(this._pane(frozenRows, 0, null, frozenColumns));\n                    }\n                    if (frozenRows > 0) {\n                        this.panes.push(this._pane(0, frozenColumns, frozenRows, null));\n                    }\n                    if (frozenRows > 0 && frozenColumns > 0) {\n                        this.panes.push(this._pane(0, 0, frozenRows, frozenColumns));\n                    }\n                }\n                if (reason.filter) {\n                    this._destroyFilterMenu();\n                }\n                if (reason.activeCell) {\n                    this._focus = sheet.activeCell().toRangeRef();\n                }\n            },\n            createFilterMenu: function (column) {\n                if (this._filterMenu && this._filterMenu.options.column == column) {\n                    return this._filterMenu;\n                }\n                this._destroyFilterMenu();\n                var sheet = this._sheet;\n                var ref = sheet.filter().ref;\n                var range = new kendo.spreadsheet.Range(ref, sheet);\n                var element = $('<div />').appendTo(this.element);\n                var options = {\n                    column: column,\n                    range: range\n                };\n                var filterMenu = new kendo.spreadsheet.FilterMenu(element, options);\n                this._filterMenu = filterMenu;\n                return filterMenu;\n            },\n            selectClipBoardContents: function () {\n                this.clipboard.focus();\n                selectElementContents(this.clipboard[0]);\n            },\n            scrollIntoView: function (cell) {\n                var willScroll = false;\n                var theGrid = this.containingPane(cell)._grid;\n                var boundaries = theGrid.scrollBoundaries(cell);\n                var scroller = this.scroller;\n                var scrollTop = theGrid.rows.frozen ? 0 : scroller.scrollTop;\n                var scrollLeft = theGrid.columns.frozen ? 0 : scroller.scrollLeft;\n                if (boundaries.top < scrollTop) {\n                    willScroll = true;\n                    scroller.scrollTop = boundaries.scrollTop;\n                }\n                if (boundaries.bottom > scrollTop) {\n                    willScroll = true;\n                    scroller.scrollTop = boundaries.scrollBottom;\n                }\n                if (boundaries.left < scrollLeft) {\n                    willScroll = true;\n                    scroller.scrollLeft = boundaries.scrollLeft;\n                }\n                if (boundaries.right > scrollLeft) {\n                    willScroll = true;\n                    scroller.scrollLeft = boundaries.scrollRight;\n                }\n                return willScroll;\n            },\n            _destroyDialog: function () {\n                this._dialogs.pop();\n            },\n            openDialog: function (name, options) {\n                var sheet = this._sheet;\n                var ref = sheet.activeCell();\n                var range = new kendo.spreadsheet.Range(ref, sheet);\n                var dialog = kendo.spreadsheet.dialogs.create(name, options);\n                if (dialog) {\n                    dialog.bind('action', this._executeCommand.bind(this));\n                    dialog.bind('deactivate', this._destroyDialog.bind(this));\n                    this._dialogs.push(dialog);\n                    dialog.open(range);\n                    return dialog;\n                }\n            },\n            showError: function (options) {\n                var errorMessages = VIEW_MESAGES.errors;\n                this.openDialog('message', {\n                    title: options.title || 'Error',\n                    text: options.body ? options.body : errorMessages[options.type],\n                    activate: function () {\n                        this.dialog().element.find('.k-button').focus();\n                    },\n                    close: function () {\n                        this.editor.focusLastActive();\n                    }.bind(this)\n                });\n            },\n            destroy: function () {\n                this._dialogs.forEach(function (dialog) {\n                    dialog.destroy();\n                });\n                this.cellContextMenu.destroy();\n                this.rowHeaderContextMenu.destroy();\n                this.colHeaderContextMenu.destroy();\n                if (this.tabstrip) {\n                    this.tabstrip.destroy();\n                }\n                this._destroyFilterMenu();\n            },\n            _destroyFilterMenu: function () {\n                if (this._filterMenu) {\n                    this._filterMenu.destroy();\n                    this._filterMenu = undefined;\n                    this._filterMenuColumn = undefined;\n                }\n            },\n            render: function () {\n                if (!this.element.is(':visible')) {\n                    return;\n                }\n                var sheet = this._sheet;\n                var focus = sheet.focus();\n                if (focus && this.scrollIntoView(focus)) {\n                    return;\n                }\n                var grid = sheet._grid;\n                var scrollTop = this.scroller.scrollTop;\n                var scrollLeft = this.scroller.scrollLeft;\n                if (scrollTop < 0) {\n                    scrollTop = 0;\n                }\n                if (scrollLeft < 0) {\n                    scrollLeft = 0;\n                }\n                var result = this.panes.map(function (pane) {\n                    return pane.render(scrollLeft, scrollTop);\n                }, this);\n                var merged = [];\n                merged = Array.prototype.concat.apply(merged, result);\n                var topCorner = kendo.dom.element('div', {\n                    style: {\n                        width: grid._headerWidth + 'px',\n                        height: grid._headerHeight + 'px'\n                    },\n                    className: View.classNames.topCorner\n                });\n                merged.push(topCorner);\n                if (sheet.resizeHandlePosition() && sheet.resizeHintPosition()) {\n                    merged.push(this.renderResizeHint());\n                }\n                this.tree.render(merged);\n                if (this.editor.isActive()) {\n                    this.editor.toggleTooltip(this.activeCellRectangle());\n                } else if (!sheet.selectionInProgress() && !sheet.resizingInProgress() && !sheet.isInEditMode()) {\n                    this.renderClipboardContents();\n                }\n            },\n            renderResizeHint: function () {\n                var sheet = this._sheet;\n                var ref = sheet.resizeHandlePosition();\n                var horizontal = ref.col !== -Infinity;\n                var style;\n                if (horizontal) {\n                    style = {\n                        height: this.scroller.clientHeight + 'px',\n                        width: RESIZE_HANDLE_WIDTH + 'px',\n                        left: sheet.resizeHintPosition().x + 'px',\n                        top: '0px'\n                    };\n                } else {\n                    style = {\n                        height: RESIZE_HANDLE_WIDTH + 'px',\n                        width: this.scroller.clientWidth + 'px',\n                        top: sheet.resizeHintPosition().y + 'px',\n                        left: '0px'\n                    };\n                }\n                var classNames = Pane.classNames;\n                return kendo.dom.element('div', {\n                    className: classNames.resizeHint + (!horizontal ? ' ' + classNames.resizeHintVertical : ''),\n                    style: style\n                }, [\n                    kendo.dom.element('div', { className: classNames.resizeHintHandle }),\n                    kendo.dom.element('div', { className: classNames.resizeHintMarker })\n                ]);\n            },\n            renderClipboardContents: function () {\n                var sheet = this._sheet;\n                var grid = sheet._grid;\n                var selection = sheet.select().toRangeRef();\n                var status = this._workbook.clipboard().canCopy();\n                if (status.canCopy === false && status.multiSelection) {\n                    this.clipboardContents.render([]);\n                    this.selectClipBoardContents();\n                    return;\n                }\n                selection = sheet.trim(selection);\n                var table = new HtmlTable();\n                var selectionView = grid.rangeDimensions(selection);\n                selectionView.rows.forEach(function (height) {\n                    table.addRow(height);\n                });\n                selectionView.columns.forEach(function (width) {\n                    table.addColumn(width);\n                });\n                var primaryMergedCells = {};\n                var secondaryMergedCells = {};\n                sheet.forEachMergedCell(selection, function (ref) {\n                    var topLeft = ref.topLeft;\n                    grid.forEach(ref, function (cellRef) {\n                        if (topLeft.eq(cellRef)) {\n                            primaryMergedCells[cellRef.print()] = ref;\n                        } else {\n                            secondaryMergedCells[cellRef.print()] = true;\n                        }\n                    });\n                });\n                sheet.forEach(selection, function (row, col, cell) {\n                    var location = new CellRef(row, col).print();\n                    if (!secondaryMergedCells[location]) {\n                        var td = addCell(table, row - selection.topLeft.row, cell);\n                        var mergedCell = primaryMergedCells[location];\n                        if (mergedCell) {\n                            td.attr.colspan = mergedCell.width();\n                            td.attr.rowspan = mergedCell.height();\n                        }\n                    }\n                });\n                this.clipboardContents.render([table.toDomTree(0, 0, 'kendo-clipboard-' + this._workbook.clipboard()._uid)]);\n                this.selectClipBoardContents();\n            },\n            _pane: function (row, column, rowCount, columnCount) {\n                var pane = new Pane(this._sheet, this._sheet._grid.pane({\n                    row: row,\n                    column: column,\n                    rowCount: rowCount,\n                    columnCount: columnCount\n                }));\n                pane.refresh(this.scroller.clientWidth, this.scroller.clientHeight);\n                return pane;\n            }\n        });\n        var paneClassNames = {\n            cell: 'k-spreadsheet-cell',\n            vaxis: 'k-spreadsheet-vaxis',\n            haxis: 'k-spreadsheet-haxis',\n            rowHeader: 'k-spreadsheet-row-header',\n            columnHeader: 'k-spreadsheet-column-header',\n            pane: 'k-spreadsheet-pane',\n            data: 'k-spreadsheet-data',\n            mergedCell: 'k-spreadsheet-merged-cell',\n            mergedCellsWrapper: 'k-merged-cells-wrapper',\n            activeCell: 'k-spreadsheet-active-cell',\n            selection: 'k-spreadsheet-selection',\n            selectionWrapper: 'k-selection-wrapper',\n            autoFillWrapper: 'k-auto-fill-wrapper',\n            single: 'k-single',\n            top: 'k-top',\n            right: 'k-right',\n            bottom: 'k-bottom',\n            left: 'k-left',\n            resizeHandle: 'k-resize-handle',\n            resizeHint: 'k-resize-hint',\n            resizeHintHandle: 'k-resize-hint-handle',\n            resizeHintMarker: 'k-resize-hint-marker',\n            resizeHintVertical: 'k-resize-hint-vertical',\n            selectionHighlight: 'k-spreadsheet-selection-highlight',\n            series: [\n                'k-series-a',\n                'k-series-b',\n                'k-series-c',\n                'k-series-d',\n                'k-series-e',\n                'k-series-f'\n            ]\n        };\n        var Pane = kendo.Class.extend({\n            init: function (sheet, grid) {\n                this._sheet = sheet;\n                this._grid = grid;\n            },\n            refresh: function (width, height) {\n                this._grid.refresh(width, height);\n            },\n            isVisible: function (scrollLeft, scrollTop, ref) {\n                return this._grid.view(scrollLeft, scrollTop).ref.intersects(ref);\n            },\n            render: function (scrollLeft, scrollTop) {\n                var classNames = Pane.classNames;\n                var sheet = this._sheet;\n                var grid = this._grid;\n                var view = grid.view(scrollLeft, scrollTop);\n                this._currentView = view;\n                this._currentRect = this._rectangle(view.ref);\n                this._selectedHeaders = sheet.selectedHeaders();\n                var children = [];\n                children.push(this.renderData());\n                children.push(this.renderSelection());\n                children.push(this.renderAutoFill());\n                children.push(this.renderEditorSelection());\n                children.push(this.renderFilterHeaders());\n                if (grid.hasRowHeader) {\n                    var rowHeader = kendo.dom.element('div', {\n                        className: classNames.rowHeader,\n                        style: {\n                            width: grid.headerWidth + 'px',\n                            top: view.rowOffset + 'px'\n                        }\n                    });\n                    children.push(rowHeader);\n                    sheet.forEach(view.ref.leftColumn(), function (row) {\n                        if (!sheet.isHiddenRow(row)) {\n                            var text = row + 1, height = sheet.rowHeight(row);\n                            rowHeader.children.push(kendo.dom.element('div', {\n                                className: this.headerClassName(row, 'row'),\n                                style: {\n                                    width: grid.headerWidth + 'px',\n                                    height: height + 'px'\n                                }\n                            }, [kendo.dom.element('div', { className: 'k-vertical-align-center' }, [kendo.dom.text(text + '')])]));\n                        }\n                    }.bind(this));\n                }\n                if (grid.hasColumnHeader) {\n                    var columnHeader = kendo.dom.element('div', {\n                        className: classNames.columnHeader,\n                        style: {\n                            top: '0px',\n                            left: view.columnOffset + 'px',\n                            width: this._currentRect.width + 'px',\n                            height: grid.headerHeight + 'px'\n                        }\n                    });\n                    children.push(columnHeader);\n                    var left = 0;\n                    sheet.forEach(view.ref.topRow(), function (row, col) {\n                        if (!sheet.isHiddenColumn(col)) {\n                            var text = kendo.spreadsheet.Ref.display(null, Infinity, col), width = sheet.columnWidth(col);\n                            columnHeader.children.push(kendo.dom.element('div', {\n                                className: this.headerClassName(col, 'col'),\n                                style: {\n                                    position: 'absolute',\n                                    left: left + 'px',\n                                    width: width + 'px',\n                                    height: grid.headerHeight + 'px'\n                                }\n                            }, [kendo.dom.element('div', { className: 'k-vertical-align-center' }, [kendo.dom.text(text + '')])]));\n                            left += width;\n                        }\n                    }.bind(this));\n                }\n                if (sheet.resizeHandlePosition() && (grid.hasColumnHeader || grid.hasRowHeader)) {\n                    var ref = sheet._grid.normalize(sheet.resizeHandlePosition());\n                    if (view.ref.intersects(ref)) {\n                        if (!sheet.resizeHintPosition()) {\n                            children.push(this.renderResizeHandler());\n                        }\n                    }\n                }\n                var paneClasses = [classNames.pane];\n                if (grid.hasColumnHeader) {\n                    paneClasses.push(classNames.top);\n                }\n                if (grid.hasRowHeader) {\n                    paneClasses.push(classNames.left);\n                }\n                return kendo.dom.element('div', {\n                    style: grid.style,\n                    className: paneClasses.join(' ')\n                }, children);\n            },\n            headerClassName: function (index, type) {\n                var selectedHeaders = this._selectedHeaders;\n                var itemSelection;\n                var allHeaders;\n                if (type === 'row') {\n                    itemSelection = selectedHeaders.rows[index];\n                    allHeaders = selectedHeaders.allRows;\n                } else {\n                    itemSelection = selectedHeaders.cols[index];\n                    allHeaders = selectedHeaders.allCols;\n                }\n                var className = itemSelection || (selectedHeaders.all ? 'full' : allHeaders ? 'partial' : 'none');\n                if (className) {\n                    className = 'k-selection-' + className;\n                }\n                return className;\n            },\n            renderData: function () {\n                var view = this._currentView;\n                var cont = kendo.dom.element('div', {\n                    className: Pane.classNames.data,\n                    style: {\n                        position: 'relative',\n                        left: view.columnOffset + 'px',\n                        top: view.rowOffset + 'px'\n                    }\n                });\n                var rect = this._currentRect;\n                var layout = kendo.spreadsheet.draw.doLayout(this._sheet, view.ref, { forScreen: true }), prev;\n                var showGridLines = this._sheet.options.showGridLines;\n                if (showGridLines) {\n                    prev = null;\n                    layout.xCoords.forEach(function (x) {\n                        if (x !== prev) {\n                            prev = x;\n                            cont.children.push(kendo.dom.element('div', {\n                                className: paneClassNames.vaxis,\n                                style: {\n                                    left: x + 'px',\n                                    height: rect.height + 'px'\n                                }\n                            }));\n                        }\n                    });\n                    prev = null;\n                    layout.yCoords.forEach(function (y) {\n                        if (y !== prev) {\n                            prev = y;\n                            cont.children.push(kendo.dom.element('div', {\n                                className: paneClassNames.haxis,\n                                style: {\n                                    top: y + 'px',\n                                    width: rect.width + 'px'\n                                }\n                            }));\n                        }\n                    });\n                }\n                var vBorders = {}, hBorders = {};\n                layout.cells.forEach(function (cell) {\n                    var hb = hBorders[cell.col] || (hBorders[cell.col] = {});\n                    var vb = vBorders[cell.row] || (vBorders[cell.row] = {});\n                    drawCell(cont.children, cell, null, hb, vb, showGridLines);\n                });\n                return cont;\n            },\n            renderResizeHandler: function () {\n                var sheet = this._sheet;\n                var ref = sheet.resizeHandlePosition();\n                var rectangle = this._rectangle(ref);\n                var style;\n                if (ref.col !== -Infinity) {\n                    style = {\n                        height: this._grid.headerHeight + 'px',\n                        width: RESIZE_HANDLE_WIDTH + 'px',\n                        left: rectangle.right - RESIZE_HANDLE_WIDTH / 2 + 'px',\n                        top: '0px'\n                    };\n                } else {\n                    style = {\n                        height: RESIZE_HANDLE_WIDTH + 'px',\n                        width: this._grid.headerWidth + 'px',\n                        top: rectangle.bottom - RESIZE_HANDLE_WIDTH / 2 + 'px',\n                        left: '0px'\n                    };\n                }\n                return kendo.dom.element('div', {\n                    className: Pane.classNames.resizeHandle,\n                    style: style\n                });\n            },\n            filterIconRect: function (rect) {\n                var BUTTON_SIZE = 16;\n                var BUTTON_OFFSET = 3;\n                return new kendo.spreadsheet.Rectangle(rect.right - BUTTON_SIZE - BUTTON_OFFSET, rect.top + BUTTON_OFFSET, BUTTON_SIZE, BUTTON_SIZE);\n            },\n            renderFilterHeaders: function () {\n                var sheet = this._sheet;\n                var children = [];\n                var classNames = View.classNames;\n                var filter = sheet.filter();\n                function icon(className) {\n                    return kendo.dom.element('span', { className: classNames.icon + ' ' + className });\n                }\n                function filterButton(classNames, position, index) {\n                    var style = {\n                        left: position.left + 'px',\n                        top: position.top + 'px'\n                    };\n                    var filtered = filter && filter.columns.some(function (c) {\n                        return c.index === index;\n                    });\n                    var classes = classNames.filterButton;\n                    if (filtered) {\n                        classes += ' ' + classNames.filterButtonActive;\n                    }\n                    var button = kendo.dom.element('span', {\n                        className: classes,\n                        style: style\n                    }, [icon(classNames.iconFilterDefault)]);\n                    return button;\n                }\n                if (filter) {\n                    this._addDiv(children, filter.ref, classNames.filterRange);\n                }\n                sheet.forEachFilterHeader(this._currentView.ref, function (ref) {\n                    var rect = this._rectangle(ref);\n                    var position = this.filterIconRect(rect);\n                    var column = this._sheet.filterColumn(ref);\n                    var button = filterButton(classNames, position, column);\n                    children.push(button);\n                }.bind(this));\n                return kendo.dom.element('div', { className: classNames.filterHeadersWrapper }, children);\n            },\n            renderEditorSelection: function () {\n                var classNames = Pane.classNames;\n                var sheet = this._sheet;\n                var selections = [];\n                sheet._formulaSelections.forEach(function (range) {\n                    var ref = range.ref;\n                    if (ref === kendo.spreadsheet.NULLREF) {\n                        return;\n                    }\n                    this._addDiv(selections, ref, classNames.selectionHighlight + ' ' + range.colorClass);\n                }.bind(this));\n                return kendo.dom.element('div', { className: classNames.selectionWrapper }, selections);\n            },\n            renderSelection: function () {\n                var classNames = Pane.classNames;\n                var selections = [];\n                var activeCellClasses = [classNames.activeCell];\n                var selectionClasses = [classNames.selection];\n                var sheet = this._sheet;\n                var activeCell = sheet.activeCell().toRangeRef();\n                var activeFormulaColor = this._activeFormulaColor();\n                var selection = sheet.select();\n                activeCellClasses = activeCellClasses.concat(activeFormulaColor, this._directionClasses(activeCell));\n                selectionClasses = selectionClasses.concat(activeFormulaColor);\n                if (sheet.singleCellSelection()) {\n                    activeCellClasses.push(classNames.single);\n                }\n                if (selection.size() === 1) {\n                    selectionClasses.push('k-single-selection');\n                }\n                if (this._sheet.autoFillPunch()) {\n                    selectionClasses.push('k-dim-auto-fill-handle');\n                }\n                selection.forEach(function (ref) {\n                    if (ref !== kendo.spreadsheet.NULLREF) {\n                        this._addDiv(selections, ref, selectionClasses.join(' '));\n                    }\n                }.bind(this));\n                this._addTable(selections, activeCell, activeCellClasses.join(' '));\n                return kendo.dom.element('div', { className: classNames.selectionWrapper }, selections);\n            },\n            renderAutoFill: function () {\n                var autoFillRectangle = [];\n                if (this._sheet.autoFillInProgress()) {\n                    var autoFillRef = this._sheet.autoFillRef();\n                    var punch = this._sheet.autoFillPunch();\n                    var direction = this._sheet._autoFillDirection;\n                    this._addDiv(autoFillRectangle, autoFillRef, 'k-auto-fill');\n                    if (punch) {\n                        this._addDiv(autoFillRectangle, punch, 'k-auto-fill-punch');\n                    } else if (direction !== undefined) {\n                        var ref, cssClass;\n                        switch (direction) {\n                        case 0:\n                            ref = autoFillRef.bottomRight;\n                            cssClass = 'k-auto-fill-br-hint';\n                            break;\n                        case 1:\n                            ref = autoFillRef.bottomRight;\n                            cssClass = 'k-auto-fill-br-hint';\n                            break;\n                        case 2:\n                            ref = new CellRef(autoFillRef.topLeft.row, autoFillRef.bottomRight.col);\n                            cssClass = 'k-auto-fill-tr-hint';\n                            break;\n                        case 3:\n                            ref = new CellRef(autoFillRef.bottomRight.row, autoFillRef.topLeft.col);\n                            cssClass = 'k-auto-fill-bl-hint';\n                            break;\n                        }\n                        var hint = kendo.dom.element('span', { className: 'k-tooltip' }, [kendo.dom.text(this._sheet._autoFillHint)]);\n                        var rectangle = this._addDiv(autoFillRectangle, ref, cssClass);\n                        if (rectangle) {\n                            rectangle.children.push(hint);\n                        }\n                    }\n                }\n                return kendo.dom.element('div', { className: Pane.classNames.autoFillWrapper }, autoFillRectangle);\n            },\n            _addDiv: function (collection, ref, className) {\n                var view = this._currentView, div;\n                if (view.ref.intersects(ref)) {\n                    div = this._rectangle(ref).resize(1, 1).toDiv(className);\n                    collection.push(div);\n                }\n                return div;\n            },\n            _addTable: function (collection, ref, className) {\n                var sheet = this._sheet;\n                var view = this._currentView;\n                if (view.ref.intersects(ref)) {\n                    sheet.forEach(ref.collapse(), function (row, col, cell) {\n                        var rectangle = this._rectangle(ref);\n                        cell.left = rectangle.left;\n                        cell.top = rectangle.top;\n                        cell.width = rectangle.width;\n                        cell.height = rectangle.height;\n                        drawCell(collection, cell, className, null, null, true);\n                    }.bind(this));\n                }\n            },\n            _activeFormulaColor: function () {\n                var activeFormulaSelection;\n                var colorClasses = [];\n                if (this._sheet.isInEditMode()) {\n                    activeFormulaSelection = this._sheet._formulaSelections.filter(function (sel) {\n                        return sel.active && sel.type == 'ref';\n                    })[0];\n                    if (activeFormulaSelection) {\n                        colorClasses.push(activeFormulaSelection.colorClass);\n                    }\n                }\n                return colorClasses;\n            },\n            _directionClasses: function (cell) {\n                var cellClasses = [];\n                var classNames = Pane.classNames;\n                var view = this._currentView.ref;\n                if (!cell.move(0, -1).intersects(view)) {\n                    cellClasses.push(classNames.left);\n                }\n                if (!cell.move(-1, 0).intersects(view)) {\n                    cellClasses.push(classNames.top);\n                }\n                if (!cell.move(0, 1).intersects(view)) {\n                    cellClasses.push(classNames.right);\n                }\n                if (!cell.move(1, 0).intersects(view)) {\n                    cellClasses.push(classNames.bottom);\n                }\n                return cellClasses;\n            },\n            _rectangle: function (ref) {\n                return this._grid.boundingRectangle(ref.toRangeRef()).offset(-this._currentView.mergedCellLeft, -this._currentView.mergedCellTop);\n            }\n        });\n        kendo.spreadsheet.View = View;\n        kendo.spreadsheet.Pane = Pane;\n        kendo.spreadsheet.drawCell = drawCell;\n        $.extend(true, View, { classNames: viewClassNames });\n        $.extend(true, Pane, { classNames: paneClassNames });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/grid', [\n        'kendo.core',\n        'spreadsheet/references'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var CellRef = kendo.spreadsheet.CellRef;\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var UnionRef = kendo.spreadsheet.UnionRef;\n        var Rectangle = kendo.Class.extend({\n            init: function (left, top, width, height) {\n                this.left = left;\n                this.width = width;\n                this.right = left + width;\n                this.top = top;\n                this.height = height;\n                this.bottom = top + height;\n            },\n            offset: function (left, top) {\n                return new Rectangle(this.left + left, this.top + top, this.width, this.height);\n            },\n            resize: function (width, height) {\n                return new Rectangle(this.left, this.top, this.width + width, this.height + height);\n            },\n            intersects: function (x, y) {\n                return this.left < x && x < this.left + this.width && this.top < y && y < this.top + this.height;\n            },\n            toDiv: function (className) {\n                return kendo.dom.element('div', {\n                    className: className,\n                    style: {\n                        width: this.width + 'px',\n                        height: this.height + 'px',\n                        top: this.top + 'px',\n                        left: this.left + 'px'\n                    }\n                });\n            }\n        });\n        var Grid = kendo.Class.extend({\n            init: function (rows, columns, rowCount, columnCount, headerHeight, headerWidth) {\n                this.rowCount = rowCount;\n                this.columnCount = columnCount;\n                this._columns = columns;\n                this._rows = rows;\n                this._headerHeight = headerHeight;\n                this._headerWidth = headerWidth;\n            },\n            isAxis: function (ref) {\n                ref = ref.toRangeRef();\n                var topLeft = ref.topLeft;\n                var bottomRight = ref.bottomRight;\n                return topLeft.row === 0 && bottomRight.row === this.rowCount - 1 || topLeft.col === 0 && bottomRight.col === this.columnCount - 1;\n            },\n            width: function (start, end) {\n                return this._columns.sum(start, end);\n            },\n            height: function (start, end) {\n                return this._rows.sum(start, end);\n            },\n            totalHeight: function () {\n                return this._rows.total + this._headerHeight;\n            },\n            totalWidth: function () {\n                return this._columns.total + this._headerWidth;\n            },\n            index: function (row, column) {\n                return column * this.rowCount + row;\n            },\n            cellRef: function (index) {\n                return new CellRef(index % this.rowCount, index / this.rowCount >> 0);\n            },\n            rowRef: function (row) {\n                return new RangeRef(new CellRef(row, 0), new CellRef(row, this.columnCount - 1));\n            },\n            colRef: function (col) {\n                return new RangeRef(new CellRef(0, col), new CellRef(this.rowCount - 1, col));\n            },\n            cellRefIndex: function (ref) {\n                return this.index(ref.row, ref.col);\n            },\n            normalize: function (ref) {\n                if (ref instanceof RangeRef) {\n                    return new RangeRef(this.normalize(ref.topLeft), this.normalize(ref.bottomRight)).setSheet(ref.sheet, ref.hasSheet());\n                }\n                if (ref instanceof UnionRef) {\n                    return ref.map(function (ref) {\n                        return this.normalize(ref);\n                    }, this);\n                }\n                var clone = ref.clone();\n                clone.col = Math.max(0, Math.min(this.columnCount - 1, ref.col));\n                clone.row = Math.max(0, Math.min(this.rowCount - 1, ref.row));\n                return clone;\n            },\n            rectangle: function (ref) {\n                var topLeft = this.normalize(ref.topLeft);\n                var bottomRight = this.normalize(ref.bottomRight);\n                return new Rectangle(this.width(0, topLeft.col - 1), this.height(0, topLeft.row - 1), this.width(topLeft.col, bottomRight.col), this.height(topLeft.row, bottomRight.row));\n            },\n            pane: function (options) {\n                return new PaneGrid(new kendo.spreadsheet.PaneAxis(this._rows, options.row, options.rowCount, this._headerHeight), new kendo.spreadsheet.PaneAxis(this._columns, options.column, options.columnCount, this._headerWidth), this);\n            },\n            rangeDimensions: function (rangeRef) {\n                return {\n                    rows: this._rows.values.iterator(rangeRef.topLeft.row, rangeRef.bottomRight.row),\n                    columns: this._columns.values.iterator(rangeRef.topLeft.col, rangeRef.bottomRight.col)\n                };\n            },\n            forEach: function (ref, callback) {\n                var topLeft = this.normalize(ref.topLeft);\n                var bottomRight = this.normalize(ref.bottomRight);\n                for (var ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    for (var ri = topLeft.row; ri <= bottomRight.row; ri++) {\n                        callback(new CellRef(ri, ci));\n                    }\n                }\n            },\n            trim: function (ref, property) {\n                var topLeft = ref.topLeft;\n                var bottomRight = ref.bottomRight;\n                var bottomRightRow = topLeft.row;\n                var bottomRightCol = topLeft.col;\n                for (var ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    var start = this.index(topLeft.row, ci);\n                    var end = this.index(bottomRight.row, ci);\n                    var values = property.tree.intersecting(start, end);\n                    if (values.length) {\n                        var cell = this.cellRef(values[values.length - 1].end);\n                        bottomRightRow = Math.max(bottomRightRow, cell.row);\n                        bottomRightCol = ci;\n                    }\n                }\n                return new RangeRef(ref.topLeft, new CellRef(Math.min(bottomRightRow, ref.bottomRight.row), bottomRightCol));\n            }\n        });\n        var PaneGrid = kendo.Class.extend({\n            init: function (rows, columns, grid) {\n                this.rows = rows;\n                this.columns = columns;\n                this._grid = grid;\n                this.headerHeight = rows.headerSize;\n                this.headerWidth = columns.headerSize;\n                this.hasRowHeader = columns.hasHeader;\n                this.hasColumnHeader = rows.hasHeader;\n            },\n            refresh: function (width, height) {\n                this.columns.viewSize(width);\n                this.rows.viewSize(height);\n                var x = this.columns.paneSegment();\n                var y = this.rows.paneSegment();\n                this.left = x.offset;\n                this.top = y.offset;\n                this.right = x.offset + x.length;\n                this.bottom = y.offset + y.length;\n                this.style = {\n                    top: y.offset + 'px',\n                    left: x.offset + 'px',\n                    height: y.length + 'px',\n                    width: x.length + 'px'\n                };\n            },\n            view: function (left, top) {\n                var rows = this.rows.visible(top);\n                var columns = this.columns.visible(left);\n                return {\n                    rows: rows,\n                    columns: columns,\n                    rowOffset: rows.offset,\n                    columnOffset: columns.offset,\n                    mergedCellLeft: columns.start,\n                    mergedCellTop: rows.start,\n                    ref: new RangeRef(new CellRef(rows.values.start, columns.values.start), new CellRef(rows.values.end, columns.values.end))\n                };\n            },\n            contains: function (ref) {\n                return this.rows.contains(ref.topLeft.row, ref.bottomRight.row) && this.columns.contains(ref.topLeft.col, ref.bottomRight.col);\n            },\n            index: function (row, column) {\n                return this._grid.index(row, column);\n            },\n            boundingRectangle: function (ref) {\n                return this._grid.rectangle(ref);\n            },\n            cellRefIndex: function (ref) {\n                return this._grid.cellRefIndex(ref);\n            },\n            scrollBoundaries: function (cell) {\n                var position = this.boundingRectangle(cell);\n                var boundaries = {\n                    top: Math.max(0, position.top - this.top + (this.hasColumnHeader ? 0 : this.headerHeight)),\n                    left: Math.max(0, position.left - this.left + (this.hasRowHeader ? 0 : this.headerWidth)),\n                    right: position.right - this.columns._viewSize + this.headerWidth,\n                    bottom: position.bottom - this.rows._viewSize + this.headerHeight\n                };\n                var widthCompensation = this.columns.defaultValue / 2;\n                var heightCompensation = this.rows.defaultValue / 2;\n                boundaries.scrollTop = boundaries.top - heightCompensation;\n                boundaries.scrollBottom = boundaries.bottom + heightCompensation;\n                boundaries.scrollLeft = boundaries.left - widthCompensation;\n                boundaries.scrollRight = boundaries.right + widthCompensation;\n                return boundaries;\n            }\n        });\n        kendo.spreadsheet.Grid = Grid;\n        kendo.spreadsheet.PaneGrid = PaneGrid;\n        kendo.spreadsheet.Rectangle = Rectangle;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/axis', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var Axis = kendo.Class.extend({\n            init: function (count, value) {\n                this._value = value;\n                this._count = count;\n                this.values = new kendo.spreadsheet.RangeList(0, count - 1, value);\n                this._hidden = new kendo.spreadsheet.RangeList(0, count - 1, 0);\n                this.scrollBarSize = kendo.support.scrollbar();\n                this._refresh();\n            },\n            toJSON: function (field, positions) {\n                var values = [];\n                var iterator = this.values.iterator(0, this._count - 1);\n                for (var idx = 0; idx < this._count; idx++) {\n                    var value = iterator.at(idx);\n                    if (value === this._value) {\n                        continue;\n                    }\n                    var position = positions[idx];\n                    if (position === undefined) {\n                        position = values.length;\n                        var item = { index: idx };\n                        item[field] = value;\n                        values.push(item);\n                        positions[idx] = position;\n                    }\n                }\n                return values;\n            },\n            fromJSON: function (field, values) {\n                for (var idx = 0; idx < values.length; idx++) {\n                    var value = values[idx][field];\n                    var index = values[idx].index;\n                    if (index === undefined) {\n                        index = idx;\n                    }\n                    this.value(index, index, value);\n                }\n            },\n            hide: function (index) {\n                if (!this.hidden(index)) {\n                    var value = this.value(index, index);\n                    this._hidden.value(index, index, value);\n                    this.value(index, index, 0);\n                }\n            },\n            hidden: function (index) {\n                return this._hidden.value(index, index) !== 0;\n            },\n            includesHidden: function (start, end) {\n                return this._hidden.intersecting(start, end).length > 1;\n            },\n            nextVisible: function (index, overflow) {\n                var end = this._count - 1;\n                if (index === end) {\n                    return overflow ? index + 1 : index;\n                }\n                index += 1;\n                var range = this._hidden.intersecting(index, index)[0];\n                if (range.value !== 0) {\n                    if (range.end === end) {\n                        return index - 1;\n                    } else {\n                        return range.end + 1;\n                    }\n                } else {\n                    return index;\n                }\n            },\n            nextPage: function (index, pageSize) {\n                return this.index(this.sum(0, index - 1) + pageSize);\n            },\n            prevPage: function (index, pageSize) {\n                return this.index(this.sum(0, index) - pageSize);\n            },\n            firstVisible: function () {\n                var firstHidden = this._hidden.first();\n                if (firstHidden.value === 0) {\n                    return 0;\n                } else {\n                    return firstHidden.end + 1;\n                }\n            },\n            lastVisible: function () {\n                var lastHidden = this._hidden.last();\n                if (lastHidden.value === 0) {\n                    return this._count - 1;\n                } else {\n                    return lastHidden.start - 1;\n                }\n            },\n            prevVisible: function (index, overflow) {\n                if (index === 0) {\n                    return overflow ? -1 : 0;\n                }\n                index -= 1;\n                var range = this._hidden.intersecting(index, index)[0];\n                if (range.value !== 0) {\n                    if (range.start === 0) {\n                        return index + 1;\n                    } else {\n                        return range.start - 1;\n                    }\n                } else {\n                    return index;\n                }\n            },\n            unhide: function (index) {\n                if (this.hidden(index)) {\n                    var value = this._hidden.value(index, index);\n                    this._hidden.value(index, index, 0);\n                    this.value(index, index, value);\n                }\n            },\n            value: function (start, end, value) {\n                if (value !== undefined) {\n                    this.values.value(start, end, value);\n                    this._refresh();\n                } else {\n                    return this.values.iterator(start, end).at(0);\n                }\n            },\n            sum: function (start, end) {\n                var values = this.values.iterator(start, end);\n                var sum = 0;\n                for (var idx = start; idx <= end; idx++) {\n                    sum += values.at(idx);\n                }\n                return sum;\n            },\n            visible: function (start, end) {\n                var startSegment = null;\n                var endSegment = null;\n                var lastPage = false;\n                if (end >= this.total + this.scrollBarSize) {\n                    lastPage = true;\n                }\n                var ranges = this._pixelValues.intersecting(start, end);\n                startSegment = ranges[0];\n                endSegment = ranges[ranges.length - 1];\n                if (!startSegment) {\n                    return {\n                        values: this.values.iterator(0, 0),\n                        offset: 0\n                    };\n                }\n                var startOffset = start - startSegment.start;\n                var startIndex = (startOffset / startSegment.value.value >> 0) + startSegment.value.start;\n                var offset = startOffset - (startIndex - startSegment.value.start) * startSegment.value.value;\n                var endOffset = end - endSegment.start;\n                var endIndex = (endOffset / endSegment.value.value >> 0) + endSegment.value.start;\n                if (endIndex > endSegment.value.end) {\n                    endIndex = endSegment.value.end;\n                }\n                if (lastPage) {\n                    offset += endSegment.value.value - (endOffset - (endIndex - endSegment.value.start) * endSegment.value.value);\n                }\n                offset = Math.min(-offset, 0);\n                return {\n                    values: this.values.iterator(startIndex, endIndex),\n                    offset: offset\n                };\n            },\n            index: function (value) {\n                var index = 0;\n                var iterator = this.values.iterator(0, this._count - 1);\n                var current = iterator.at(0);\n                while (current < value && index < this._count - 1) {\n                    current += iterator.at(++index);\n                }\n                return index;\n            },\n            _refresh: function () {\n                var current = 0;\n                this._pixelValues = this.values.map(function (range) {\n                    var start = current;\n                    current += (range.end - range.start + 1) * range.value;\n                    var end = current - 1;\n                    return new kendo.spreadsheet.ValueRange(start, end, range);\n                });\n                this.total = current;\n            },\n            getState: function () {\n                return {\n                    values: this.values.getState(),\n                    hidden: this._hidden.getState()\n                };\n            },\n            setState: function (state) {\n                this.values.setState(state.values);\n                this._hidden.setState(state.hidden);\n                this._refresh();\n            }\n        });\n        var PaneAxis = kendo.Class.extend({\n            init: function (axis, start, count, headerSize) {\n                this._axis = axis;\n                this._start = start;\n                this._count = count;\n                this.hasHeader = start === 0;\n                this.headerSize = headerSize;\n                this.defaultValue = axis._value;\n                this.frozen = count > 0;\n            },\n            viewSize: function (viewSize) {\n                this._viewSize = viewSize;\n            },\n            sum: function (start, end) {\n                return this._axis.sum(start, end - 1);\n            },\n            start: function () {\n                return this.sum(0, this._start);\n            },\n            size: function () {\n                return this.sum(this._start, this._start + this._count);\n            },\n            index: function (value, offset) {\n                return this._axis.index(value + (this.frozen ? 0 : offset) - this.headerSize);\n            },\n            paneSegment: function () {\n                var offset = this.start();\n                var length;\n                if (!this.hasHeader) {\n                    offset += this.headerSize;\n                }\n                if (this.frozen) {\n                    length = this.size();\n                    if (this.hasHeader) {\n                        length += this.headerSize;\n                    } else {\n                        length -= this.headerSize;\n                    }\n                } else {\n                    length = this._viewSize - offset;\n                }\n                return {\n                    offset: offset,\n                    length: length\n                };\n            },\n            visible: function (offset) {\n                var start = this.start();\n                var size;\n                if (this.frozen) {\n                    size = this.size();\n                    if (!this.hasHeader) {\n                        size -= this.headerSize;\n                    }\n                } else {\n                    size = this._viewSize - start - this.headerSize;\n                    start += offset;\n                }\n                var result = this._axis.visible(start, start + size - 1);\n                if (this.frozen) {\n                    result.offset = 0;\n                }\n                result.start = start;\n                if (this.hasHeader) {\n                    result.offset += this.headerSize;\n                    result.start -= this.headerSize;\n                }\n                return result;\n            },\n            contains: function (start, end) {\n                if (this.frozen) {\n                    if (start > this._start + this._count) {\n                        return false;\n                    }\n                    if (end < this._start) {\n                        return false;\n                    }\n                    return true;\n                } else {\n                    return end >= this._start;\n                }\n            }\n        });\n        kendo.spreadsheet.Axis = Axis;\n        kendo.spreadsheet.PaneAxis = PaneAxis;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/filter', [\n        'kendo.core',\n        'kendo.data'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var Filter = kendo.spreadsheet.Filter = kendo.Class.extend({\n            prepare: function () {\n            },\n            value: function (cell) {\n                return cell.value;\n            },\n            matches: function () {\n                throw new Error('The \\'matches\\' method is not implemented.');\n            },\n            toJSON: function () {\n                throw new Error('The \\'toJSON\\' method is not implemented.');\n            }\n        });\n        Filter.create = function (options) {\n            var filter = options.filter;\n            if (!filter) {\n                throw new Error('Filter type not specified.');\n            }\n            var constructor = kendo.spreadsheet[filter.charAt(0).toUpperCase() + filter.substring(1) + 'Filter'];\n            if (!constructor) {\n                throw new Error('Filter type not recognized.');\n            }\n            return new constructor(options);\n        };\n        kendo.spreadsheet.ValueFilter = Filter.extend({\n            _values: [],\n            _dates: [],\n            _blanks: false,\n            init: function (options) {\n                if (options.values !== undefined) {\n                    this._values = options.values;\n                }\n                if (options.blanks !== undefined) {\n                    this._blanks = options.blanks;\n                }\n                if (options.dates !== undefined) {\n                    this._dates = options.dates;\n                }\n            },\n            value: function (cell) {\n                var value = cell.value;\n                if (this._dates.length > 0 && cell.format && typeof value === 'number') {\n                    var type = kendo.spreadsheet.formatting.type(value, cell.format);\n                    if (type === 'date') {\n                        value = kendo.spreadsheet.numberToDate(value);\n                    }\n                }\n                return value;\n            },\n            matches: function (value) {\n                if (value === null || value === undefined) {\n                    return this._blanks;\n                }\n                if (value instanceof Date) {\n                    return this._dates.some(function (date) {\n                        return date.year === value.getFullYear() && (date.month === undefined || date.month === value.getMonth()) && (date.day === undefined || date.day === value.getDate()) && (date.hours === undefined || date.hours === value.getHours()) && (date.minutes === undefined || date.minutes === value.getMinutes()) && (date.seconds === undefined || date.seconds === value.getSeconds());\n                    });\n                }\n                return this._values.indexOf(value) >= 0;\n            },\n            toJSON: function () {\n                return {\n                    filter: 'value',\n                    values: this._values.slice(0)\n                };\n            }\n        });\n        kendo.spreadsheet.CustomFilter = Filter.extend({\n            _logic: 'and',\n            init: function (options) {\n                if (options.logic !== undefined) {\n                    this._logic = options.logic;\n                }\n                if (options.criteria === undefined) {\n                    throw new Error('Must specify criteria.');\n                }\n                this._criteria = options.criteria;\n                var expression = kendo.data.Query.filterExpr({\n                    logic: this._logic,\n                    filters: this._criteria\n                }).expression;\n                this._matches = new Function('d', 'return ' + expression);\n            },\n            matches: function (value) {\n                if (value === null) {\n                    return false;\n                }\n                return this._matches(value);\n            },\n            value: function (cell) {\n                var value = cell.value;\n                var criterionValue = this._criteria[0].value;\n                var criterionType = criterionValue instanceof Date ? 'date' : typeof criterionValue;\n                var valueType = typeof value;\n                if (cell.format) {\n                    valueType = kendo.spreadsheet.formatting.type(value, cell.format);\n                }\n                if (valueType != criterionType) {\n                    if (criterionType == 'string') {\n                        if (cell.format) {\n                            value = kendo.spreadsheet.formatting.text(value, cell.format);\n                        }\n                        value = value + '';\n                    }\n                } else if (valueType == 'date') {\n                    value = kendo.spreadsheet.numberToDate(value);\n                }\n                return value;\n            },\n            toJSON: function () {\n                return {\n                    filter: 'custom',\n                    logic: this._logic,\n                    criteria: this._criteria\n                };\n            }\n        });\n        kendo.spreadsheet.TopFilter = Filter.extend({\n            init: function (options) {\n                this._type = options.type;\n                this._value = options.value;\n                this._values = [];\n            },\n            prepare: function (cells) {\n                var values = cells.map(this.value).sort().filter(function (value, index, array) {\n                    return index === 0 || value !== array[index - 1];\n                });\n                if (this._type === 'topNumber' || this._type == 'topPercent') {\n                    values.sort(function (x, y) {\n                        return y - x;\n                    });\n                } else {\n                    values.sort(function (x, y) {\n                        return x - y;\n                    });\n                }\n                var count = this._value;\n                if (this._type === 'topPercent' || this._type === 'bottomPercent') {\n                    count = values.length * count / 100 >> 0;\n                }\n                this._values = values.slice(0, count);\n            },\n            matches: function (value) {\n                return this._values.indexOf(value) >= 0;\n            },\n            toJSON: function () {\n                return {\n                    filter: 'top',\n                    type: this._type,\n                    value: this._value\n                };\n            }\n        });\n        kendo.spreadsheet.DynamicFilter = Filter.extend({\n            init: function (options) {\n                this._type = options.type;\n                this._predicate = this[options.type];\n                if (typeof this._predicate !== 'function') {\n                    throw new Error('DynamicFilter type \\'' + options.type + '\\' not recognized.');\n                }\n            },\n            value: function (cell) {\n                var value = cell.value;\n                if (cell.format) {\n                    var type = kendo.spreadsheet.formatting.type(value, cell.format);\n                    if (type === 'date') {\n                        value = kendo.spreadsheet.numberToDate(value);\n                    }\n                }\n                return value;\n            },\n            prepare: function (cells) {\n                var sum = 0;\n                var count = 0;\n                for (var ci = 0; ci < cells.length; ci++) {\n                    var value = this.value(cells[ci]);\n                    if (typeof value === 'number') {\n                        sum += value;\n                        count++;\n                    }\n                }\n                if (count > 0) {\n                    this._average = sum / count;\n                } else {\n                    this._average = 0;\n                }\n            },\n            matches: function (value) {\n                return this._predicate(value);\n            },\n            aboveAverage: function (value) {\n                if (value instanceof Date) {\n                    value = kendo.spreadsheet.dateToNumber(value);\n                }\n                if (typeof value !== 'number') {\n                    return false;\n                }\n                return value > this._average;\n            },\n            belowAverage: function (value) {\n                if (value instanceof Date) {\n                    value = kendo.spreadsheet.dateToNumber(value);\n                }\n                if (typeof value !== 'number') {\n                    return false;\n                }\n                return value < this._average;\n            },\n            tomorrow: function (value) {\n                if (value instanceof Date) {\n                    var tomorrow = kendo.date.addDays(kendo.date.today(), 1);\n                    return kendo.date.getDate(value).getTime() === tomorrow.getTime();\n                }\n                return false;\n            },\n            today: function (value) {\n                if (value instanceof Date) {\n                    return kendo.date.isToday(value);\n                }\n                return false;\n            },\n            yesterday: function (value) {\n                if (value instanceof Date) {\n                    var yesterday = kendo.date.addDays(kendo.date.today(), -1);\n                    return kendo.date.getDate(value).getTime() === yesterday.getTime();\n                }\n                return false;\n            },\n            nextWeek: function (value) {\n                return sameWeek(kendo.date.addDays(kendo.date.today(), 7), value);\n            },\n            thisWeek: function (value) {\n                return sameWeek(kendo.date.today(), value);\n            },\n            lastWeek: function (value) {\n                return sameWeek(kendo.date.addDays(kendo.date.today(), -7), value);\n            },\n            nextMonth: function (value) {\n                return sameMonth(value, 1);\n            },\n            thisMonth: function (value) {\n                return sameMonth(value, 0);\n            },\n            lastMonth: function (value) {\n                return sameMonth(value, -1);\n            },\n            nextQuarter: function (value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n                    var diff = quarter(value) - quarter(today);\n                    return diff === 1 && today.getFullYear() === value.getFullYear() || diff == -3 && today.getFullYear() + 1 === value.getFullYear();\n                }\n                return false;\n            },\n            thisQuarter: function (value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n                    var diff = quarter(value) - quarter(today);\n                    return diff === 0 && today.getFullYear() === value.getFullYear();\n                }\n                return false;\n            },\n            lastQuarter: function (value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n                    var diff = quarter(today) - quarter(value);\n                    return diff === 1 && today.getFullYear() === value.getFullYear() || diff == -3 && today.getFullYear() - 1 === value.getFullYear();\n                }\n                return false;\n            },\n            nextYear: function (value) {\n                return sameYear(value, 1);\n            },\n            thisYear: function (value) {\n                return sameYear(value, 0);\n            },\n            lastYear: function (value) {\n                return sameYear(value, -1);\n            },\n            yearToDate: function (value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n                    return value.getFullYear() === today.getFullYear() && value <= today;\n                }\n                return false;\n            },\n            toJSON: function () {\n                return {\n                    filter: 'dynamic',\n                    type: this._type\n                };\n            }\n        });\n        [\n            1,\n            2,\n            3,\n            4\n        ].forEach(function (target) {\n            kendo.spreadsheet.DynamicFilter.prototype['quarter' + target] = function (value) {\n                if (value instanceof Date) {\n                    return quarter(value) === target;\n                }\n                return false;\n            };\n        });\n        kendo.cultures['en-US'].calendar.months.names.forEach(function (month, index) {\n            kendo.spreadsheet.DynamicFilter.prototype[month.toLowerCase()] = function (value) {\n                if (value instanceof Date) {\n                    return value.getMonth() === index;\n                }\n                return false;\n            };\n        });\n        function quarter(value) {\n            var month = value.getMonth() + 1;\n            if (month >= 1 && month <= 3) {\n                return 1;\n            } else if (month >= 4 && month <= 6) {\n                return 2;\n            } else if (month >= 7 && month <= 9) {\n                return 3;\n            } else {\n                return 4;\n            }\n        }\n        function sameYear(value, offset) {\n            if (value instanceof Date) {\n                var today = kendo.date.today();\n                today.setFullYear(today.getFullYear() + offset);\n                return today.getFullYear() === value.getFullYear();\n            }\n            return false;\n        }\n        function sameMonth(value, offset) {\n            if (value instanceof Date) {\n                var today = kendo.date.firstDayOfMonth(kendo.date.today());\n                today.setMonth(today.getMonth() + offset, 1);\n                return today.getTime() === kendo.date.firstDayOfMonth(value).getTime();\n            }\n            return false;\n        }\n        function sameWeek(a, b) {\n            if (b instanceof Date) {\n                var firstWeek = kendo.date.dayOfWeek(kendo.date.getDate(a), 1);\n                var secondWeek = kendo.date.dayOfWeek(kendo.date.getDate(b), 1);\n                return firstWeek.getTime() === secondWeek.getTime();\n            }\n            return false;\n        }\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/sorter', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var Sorter = kendo.Class.extend({\n            init: function (grid, lists) {\n                this._grid = grid;\n                this._lists = lists;\n            },\n            indices: function (rangeRef, list, ascending, indices) {\n                var comparer = Sorter.ascendingComparer;\n                if (ascending === false) {\n                    comparer = Sorter.descendingComparer;\n                }\n                return list.sortedIndices(this._grid.cellRefIndex(rangeRef.topLeft), this._grid.cellRefIndex(rangeRef.bottomRight), comparer, indices);\n            },\n            sortBy: function (ref, column, list, ascending, indices) {\n                var sortedIndices = this.indices(ref.toColumn(column), list, ascending, indices);\n                for (var ci = ref.topLeft.col; ci <= ref.bottomRight.col; ci++) {\n                    var start = this._grid.index(ref.topLeft.row, ci);\n                    var end = this._grid.index(ref.bottomRight.row, ci);\n                    for (var li = 0; li < this._lists.length; li++) {\n                        if (start < this._lists[li].lastRangeStart()) {\n                            this._lists[li].sort(start, end, sortedIndices);\n                        }\n                    }\n                }\n                return sortedIndices;\n            }\n        });\n        Sorter.ascendingComparer = function (a, b) {\n            if (a === null && b === null) {\n                return 0;\n            }\n            if (a === null) {\n                return 1;\n            }\n            if (b === null) {\n                return -1;\n            }\n            var typeA = typeof a;\n            var typeB = typeof b;\n            if (typeA === 'number') {\n                if (typeB === 'number') {\n                    return a - b;\n                } else {\n                    return -1;\n                }\n            }\n            if (typeA === 'string') {\n                switch (typeB) {\n                case 'number':\n                    return 1;\n                case 'string':\n                    return a.localeCompare(b);\n                default:\n                    return -1;\n                }\n            }\n            if (typeA === 'boolean') {\n                switch (typeB) {\n                case 'number':\n                    return 1;\n                case 'string':\n                    return 1;\n                case 'boolean':\n                    return a - b;\n                default:\n                    return -1;\n                }\n            }\n            if (a instanceof kendo.spreadsheet.calc.runtime.CalcError) {\n                if (b instanceof kendo.spreadsheet.calc.runtime.CalcError) {\n                    return 0;\n                } else {\n                    return 1;\n                }\n            }\n            throw new Error('Cannot compare ' + a + ' and ' + b);\n        };\n        Sorter.descendingComparer = function (a, b) {\n            if (a === null && b === null) {\n                return 0;\n            }\n            if (a === null) {\n                return 1;\n            }\n            if (b === null) {\n                return -1;\n            }\n            return Sorter.ascendingComparer(b, a);\n        };\n        kendo.spreadsheet.Sorter = Sorter;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/numformat', [\n        'spreadsheet/calc',\n        'kendo.dom'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var calc = kendo.spreadsheet.calc;\n    var dom = kendo.dom;\n    var RX_COLORS = /^\\[(black|green|white|blue|magenta|yellow|cyan|red)\\]/i;\n    var RX_CONDITION = /^\\[(<=|>=|<>|<|>|=)(-?[0-9.]+)\\]/;\n    function parse(input) {\n        input = calc.InputStream(input);\n        var sections = [], haveConditional = false, decimalPart;\n        while (!input.eof()) {\n            var sec = readSection();\n            sections.push(sec);\n            if (sec.cond) {\n                haveConditional = true;\n            }\n        }\n        function addPlainText() {\n            sections.push({\n                cond: 'text',\n                body: [{ type: 'text' }]\n            });\n        }\n        if (haveConditional) {\n            addPlainText();\n        } else if (sections.length == 1) {\n            sections[0].cond = 'num';\n            addPlainText();\n        } else if (sections.length == 2) {\n            sections[0].cond = {\n                op: '>=',\n                value: 0\n            };\n            sections[1].cond = {\n                op: '<',\n                value: 0\n            };\n            addPlainText();\n        } else if (sections.length >= 3) {\n            sections[0].cond = {\n                op: '>',\n                value: 0\n            };\n            sections[1].cond = {\n                op: '<',\n                value: 0\n            };\n            sections[2].cond = {\n                op: '=',\n                value: 0\n            };\n            addPlainText();\n            if (sections.length > 3) {\n                sections[3].cond = 'text';\n                sections = sections.slice(0, 4);\n            }\n        }\n        return sections;\n        function maybeColor() {\n            var m = input.skip(RX_COLORS);\n            if (m) {\n                return m[1].toLowerCase();\n            }\n        }\n        function maybeCondition() {\n            var m = input.skip(RX_CONDITION);\n            if (m) {\n                var val = parseFloat(m[2]);\n                if (!isNaN(val)) {\n                    return {\n                        op: m[1],\n                        value: val\n                    };\n                }\n            }\n        }\n        function readFormat() {\n            var format = [], tok, prev = null;\n            while (!input.eof() && (tok = readNext())) {\n                if (tok.type == 'date') {\n                    if (prev && /^(el)?time$/.test(prev.type) && prev.part == 'h' && tok.part == 'm' && tok.format < 3) {\n                        tok.type = 'time';\n                    }\n                } else if (/^(el)?time$/.test(tok.type) && tok.part == 's') {\n                    if (prev && prev.type == 'date' && prev.part == 'm' && prev.format < 3) {\n                        prev.type = 'time';\n                    }\n                }\n                if (!/^(?:str|space|fill)$/.test(tok.type)) {\n                    prev = tok;\n                }\n                format.push(tok);\n            }\n            return format;\n        }\n        function maybeFraction(tok) {\n            if (tok.type != 'date' || tok.part == 'm' && tok.format < 3) {\n                var m = input.skip(/^\\.(0+)/);\n                if (m) {\n                    tok.fraction = m[1].length;\n                    if (tok.type == 'date') {\n                        tok.type = 'time';\n                    }\n                }\n            }\n            return tok;\n        }\n        function readNext() {\n            var ch, m;\n            if (m = input.skip(/^([#0?]+),([#0?]+)/)) {\n                return {\n                    type: 'digit',\n                    sep: true,\n                    format: m[1] + m[2],\n                    decimal: decimalPart\n                };\n            }\n            if (m = input.skip(/^[#0?]+/)) {\n                return {\n                    type: 'digit',\n                    sep: false,\n                    format: m[0],\n                    decimal: decimalPart\n                };\n            }\n            if (m = input.skip(/^(e)([+-])/i)) {\n                return {\n                    type: 'exp',\n                    ch: m[1],\n                    sign: m[2]\n                };\n            }\n            if (m = input.skip(/^(d{1,4}|m{1,5}|yyyy|yy)/i)) {\n                m = m[1].toLowerCase();\n                return maybeFraction({\n                    type: 'date',\n                    part: m.charAt(0),\n                    format: m.length\n                });\n            }\n            if (m = input.skip(/^(hh?|ss?)/i)) {\n                m = m[1].toLowerCase();\n                return maybeFraction({\n                    type: 'time',\n                    part: m.charAt(0),\n                    format: m.length\n                });\n            }\n            if (m = input.skip(/^\\[(hh?|mm?|ss?)\\]/i)) {\n                m = m[1].toLowerCase();\n                return maybeFraction({\n                    type: 'eltime',\n                    part: m.charAt(0),\n                    format: m.length\n                });\n            }\n            if (m = input.skip(/^(am\\/pm|a\\/p)/i)) {\n                m = m[1].split('/');\n                return {\n                    type: 'ampm',\n                    am: m[0],\n                    pm: m[1]\n                };\n            }\n            switch (ch = input.next()) {\n            case ';':\n                return null;\n            case '\\\\':\n                return {\n                    type: 'str',\n                    value: input.next()\n                };\n            case '\"':\n                return {\n                    type: 'str',\n                    value: input.readEscaped(ch)\n                };\n            case '@':\n                return { type: 'text' };\n            case '_':\n                return {\n                    type: 'space',\n                    value: input.next()\n                };\n            case '*':\n                return {\n                    type: 'fill',\n                    value: input.next()\n                };\n            case '.':\n                if (input.lookingAt(/^\\s*[#0?]/)) {\n                    decimalPart = true;\n                    return { type: 'dec' };\n                }\n                return {\n                    type: 'str',\n                    value: '.'\n                };\n            case '%':\n                return { type: 'percent' };\n            case ',':\n                return { type: 'comma' };\n            }\n            return {\n                type: 'str',\n                value: ch\n            };\n        }\n        function readSection() {\n            decimalPart = false;\n            var color = maybeColor(), cond = maybeCondition();\n            if (!color && cond) {\n                color = maybeColor();\n            }\n            return {\n                color: color,\n                cond: cond,\n                body: readFormat()\n            };\n        }\n    }\n    function print(sections) {\n        return sections.map(printSection).join(';');\n        function printSection(sec) {\n            var out = '';\n            if (sec.color) {\n                out += '[' + sec.color + ']';\n            }\n            if (sec.cond) {\n                if (!(sec.cond == 'text' || sec.cond == 'num')) {\n                    out += '[' + sec.cond.op + sec.cond.value + ']';\n                }\n            }\n            out += sec.body.map(printToken).join('');\n            return out;\n        }\n        function maybeFraction(fmt, tok) {\n            if (tok.fraction) {\n                fmt += '.' + padLeft('', tok.fraction, '0');\n            }\n            return fmt;\n        }\n        function printToken(tok) {\n            if (tok.type == 'digit') {\n                if (tok.sep) {\n                    return tok.format.charAt(0) + ',' + tok.format.substr(1);\n                } else {\n                    return tok.format;\n                }\n            } else if (tok.type == 'exp') {\n                return tok.ch + tok.sign;\n            } else if (tok.type == 'date' || tok.type == 'time') {\n                return maybeFraction(padLeft('', tok.format, tok.part), tok);\n            } else if (tok.type == 'eltime') {\n                return maybeFraction('[' + padLeft('', tok.format, tok.part) + ']', tok);\n            } else if (tok.type == 'ampm') {\n                return tok.am + '/' + tok.pm;\n            } else if (tok.type == 'str') {\n                return JSON.stringify(tok.value);\n            } else if (tok.type == 'text') {\n                return '@';\n            } else if (tok.type == 'space') {\n                return '_' + tok.value;\n            } else if (tok.type == 'fill') {\n                return '*' + tok.value;\n            } else if (tok.type == 'dec') {\n                return '.';\n            } else if (tok.type == 'percent') {\n                return '%';\n            } else if (tok.type == 'comma') {\n                return ',';\n            }\n        }\n    }\n    function adjustDecimals(sections, x) {\n        sections.forEach(function (sec) {\n            var diff = x;\n            if (sec.cond == 'text') {\n                return;\n            }\n            var body = sec.body, adjusted = false, i = body.length;\n            while (diff !== 0 && --i >= 0) {\n                var tok = body[i];\n                if (tok.type == 'digit') {\n                    if (tok.decimal) {\n                        adjusted = true;\n                        if (diff > 0) {\n                            tok.format += padLeft('', diff, '0');\n                        } else if (diff < 0) {\n                            var tmp = tok.format.length;\n                            tok.format = tok.format.substr(0, tmp + diff);\n                            diff += tmp - tok.format.length;\n                        }\n                        if (tok.format.length === 0) {\n                            body.splice(i, 1);\n                            while (--i >= 0) {\n                                tok = body[i];\n                                if (tok.type == 'digit' && tok.decimal) {\n                                    ++i;\n                                    break;\n                                }\n                                if (tok.type == 'dec') {\n                                    body.splice(i, 1);\n                                    break;\n                                }\n                            }\n                        }\n                    }\n                    if (diff > 0) {\n                        break;\n                    }\n                }\n            }\n            if (!adjusted && diff > 0) {\n                body.splice(i + 1, 0, { type: 'dec' }, {\n                    type: 'digit',\n                    sep: false,\n                    decimal: true,\n                    format: padLeft('', diff, '0')\n                });\n            }\n        });\n    }\n    function TokenStream(parts) {\n        var index = 0;\n        return {\n            next: function () {\n                return parts[index++];\n            },\n            eof: function () {\n                return index >= parts.length;\n            },\n            ahead: function (n, f) {\n                if (index + n <= parts.length) {\n                    var val = f.apply(null, parts.slice(index, index + n));\n                    if (val) {\n                        index += n;\n                    }\n                    return val;\n                }\n            },\n            restart: function () {\n                index = 0;\n            }\n        };\n    }\n    function compileFormatPart(format) {\n        var input = TokenStream(format.body);\n        var hasDate = false;\n        var hasTime = false;\n        var hasAmpm = false;\n        var percentCount = 0;\n        var scaleCount = 0;\n        var code = '';\n        var separeThousands = false;\n        var declen = 0;\n        var intFormat = [], decFormat = [];\n        var condition = format.cond;\n        var preamble = '';\n        if (condition == 'text') {\n            preamble = 'if (typeof value == \\'string\\' || value instanceof kendo.spreadsheet.CalcError) { ';\n        } else if (condition == 'num') {\n            preamble = 'if (typeof value == \\'number\\') { ';\n        } else if (condition) {\n            var op = condition.op == '=' ? '==' : condition.op;\n            preamble = 'if (typeof value == \\'number\\' && value ' + op + ' ' + condition.value + ') { ';\n            code += 'value = Math.abs(value); ';\n        }\n        if (format.color) {\n            code += 'result.color = ' + JSON.stringify(format.color) + '; ';\n        }\n        function checkComma(a, b) {\n            if (a.type == 'digit' && b.type == 'comma' || a.type == 'comma' && a.hidden && b.type == 'comma') {\n                b.hidden = true;\n                scaleCount++;\n            }\n        }\n        while (!input.eof()) {\n            input.ahead(2, checkComma);\n            var tok = input.next();\n            if (tok.type == 'percent') {\n                percentCount++;\n            } else if (tok.type == 'digit') {\n                if (tok.decimal) {\n                    declen += tok.format.length;\n                    decFormat.push(tok.format);\n                } else {\n                    intFormat.push(tok.format);\n                    if (tok.sep) {\n                        separeThousands = true;\n                    }\n                }\n            } else if (tok.type == 'time') {\n                hasTime = true;\n            } else if (tok.type == 'date') {\n                hasDate = true;\n            } else if (tok.type == 'ampm') {\n                hasAmpm = hasTime = true;\n            }\n        }\n        if (percentCount > 0) {\n            code += 'value *= ' + Math.pow(100, percentCount) + '; ';\n        }\n        if (scaleCount > 0) {\n            code += 'value /= ' + Math.pow(1000, scaleCount) + '; ';\n        }\n        if (intFormat.length) {\n            code += 'var intPart = runtime.formatInt(culture, value, ' + JSON.stringify(intFormat) + ', ' + declen + ', ' + separeThousands + '); ';\n        }\n        if (decFormat.length) {\n            code += 'var decPart = runtime.formatDec(value, ' + JSON.stringify(decFormat) + ', ' + declen + '); ';\n        }\n        if (intFormat.length || decFormat.length) {\n            code += 'type = \\'number\\'; ';\n        }\n        if (hasDate) {\n            code += 'var date = runtime.unpackDate(value); ';\n        }\n        if (hasTime) {\n            code += 'var time = runtime.unpackTime(value); ';\n        }\n        if (hasDate || hasTime) {\n            code += 'type = \\'date\\'; ';\n        }\n        if (percentCount > 0 || scaleCount > 0 || intFormat.length || decFormat.length || hasDate || hasTime) {\n            if (!preamble) {\n                preamble = 'if (typeof value == \\'number\\') { ';\n            }\n        }\n        input.restart();\n        while (!input.eof()) {\n            var tok = input.next();\n            if (tok.type == 'dec') {\n                code += 'output += culture.numberFormat[\\'.\\']; ';\n            } else if (tok.type == 'comma' && !tok.hidden) {\n                code += 'output += \\',\\'; ';\n            } else if (tok.type == 'percent') {\n                code += 'type = \\'percent\\'; ';\n                code += 'output += culture.numberFormat.percent.symbol; ';\n            } else if (tok.type == 'str') {\n                code += 'output += ' + JSON.stringify(tok.value) + '; ';\n            } else if (tok.type == 'text') {\n                code += 'type = \\'text\\'; ';\n                code += 'output += value; ';\n            } else if (tok.type == 'space') {\n                code += 'if (output) result.body.push(output); ';\n                code += 'output = \\'\\'; ';\n                code += 'result.body.push({ type: \\'space\\', value: ' + JSON.stringify(tok.value) + ' }); ';\n            } else if (tok.type == 'fill') {\n                code += 'output += runtime.fill(' + JSON.stringify(tok.value) + '); ';\n            } else if (tok.type == 'digit') {\n                code += 'output += ' + (tok.decimal ? 'decPart' : 'intPart') + '.shift(); ';\n            } else if (tok.type == 'date') {\n                code += 'output += runtime.date(culture, date, ' + JSON.stringify(tok.part) + ', ' + tok.format + '); ';\n            } else if (tok.type == 'time') {\n                code += 'output += runtime.time(time, ' + JSON.stringify(tok.part) + ', ' + tok.format + ', ' + hasAmpm + ', ' + tok.fraction + '); ';\n            } else if (tok.type == 'eltime') {\n                code += 'output += runtime.eltime(value, ' + JSON.stringify(tok.part) + ', ' + tok.format + ', ' + tok.fraction + '); ';\n            } else if (tok.type == 'ampm') {\n                code += 'output += time.hours < 12 ? ' + JSON.stringify(tok.am) + ' : ' + JSON.stringify(tok.pm) + '; ';\n            }\n        }\n        code += 'if (output) result.body.push(output); ';\n        code += 'result.type = type; ';\n        code += 'return result; ';\n        if (preamble) {\n            code = preamble + code + '}';\n        }\n        return code;\n    }\n    var CACHE = Object.create(null);\n    function compile(format) {\n        var f = CACHE[format];\n        if (!f) {\n            var tree = parse(format);\n            var code = tree.map(compileFormatPart).join('\\n');\n            code = '\\'use strict\\'; return function(value, culture){ ' + 'if (!culture) culture = kendo.culture(); ' + 'var output = \\'\\', type = null, result = { body: [] }; ' + code + '; return result; };';\n            f = CACHE[format] = new Function('runtime', code)(runtime);\n        }\n        return f;\n    }\n    var runtime = {\n        unpackDate: calc.runtime.unpackDate,\n        unpackTime: calc.runtime.unpackTime,\n        date: function (culture, d, part, length) {\n            switch (part) {\n            case 'd':\n                switch (length) {\n                case 1:\n                    return d.date;\n                case 2:\n                    return padLeft(d.date, 2, '0');\n                case 3:\n                    return culture.calendars.standard.days.namesAbbr[d.day];\n                case 4:\n                    return culture.calendars.standard.days.names[d.day];\n                }\n                break;\n            case 'm':\n                switch (length) {\n                case 1:\n                    return d.month + 1;\n                case 2:\n                    return padLeft(d.month + 1, 2, '0');\n                case 3:\n                    return culture.calendars.standard.months.namesAbbr[d.month];\n                case 4:\n                    return culture.calendars.standard.months.names[d.month];\n                case 5:\n                    return culture.calendars.standard.months.names[d.month].charAt(0);\n                }\n                break;\n            case 'y':\n                switch (length) {\n                case 2:\n                    return d.year % 100;\n                case 4:\n                    return d.year;\n                }\n                break;\n            }\n            return '##';\n        },\n        time: function (t, part, length, ampm, fraclen) {\n            var ret, fraction;\n            switch (part) {\n            case 'h':\n                ret = padLeft(ampm ? t.hours % 12 || 12 : t.hours, length, '0');\n                if (fraclen) {\n                    fraction = (t.minutes + (t.seconds + t.milliseconds / 1000) / 60) / 60;\n                }\n                break;\n            case 'm':\n                ret = padLeft(t.minutes, length, '0');\n                if (fraclen) {\n                    fraction = (t.seconds + t.milliseconds / 1000) / 60;\n                }\n                break;\n            case 's':\n                ret = padLeft(t.seconds, length, '0');\n                if (fraclen) {\n                    fraction = t.milliseconds / 1000;\n                }\n                break;\n            }\n            if (fraction) {\n                ret += fraction.toFixed(fraclen).replace(/^0+/, '');\n            }\n            return ret;\n        },\n        eltime: function (value, part, length, fraclen) {\n            var ret, fraction;\n            switch (part) {\n            case 'h':\n                ret = value * 24;\n                break;\n            case 'm':\n                ret = value * 24 * 60;\n                break;\n            case 's':\n                ret = value * 24 * 60 * 60;\n                break;\n            }\n            if (fraclen) {\n                fraction = ret - (ret | 0);\n            }\n            ret = padLeft(ret | 0, length, '0');\n            if (fraction) {\n                ret += fraction.toFixed(fraclen).replace(/^0+/, '');\n            }\n            return ret;\n        },\n        fill: function (ch) {\n            return ch;\n        },\n        formatInt: function (culture, value, parts, declen, sep) {\n            value = value.toFixed(declen).replace(/\\..*$/, '');\n            if (declen > 0) {\n                if (value === '0') {\n                    value = '';\n                } else if (value === '-0') {\n                    value = '-';\n                }\n            }\n            var iv = value.length - 1;\n            var result = [];\n            var len = 0, str;\n            function add(ch) {\n                if (sep && len && len % 3 === 0 && ch != ' ') {\n                    str = culture.numberFormat[','] + str;\n                }\n                str = ch + str;\n                len++;\n            }\n            for (var j = parts.length; --j >= 0;) {\n                var format = parts[j];\n                str = '';\n                for (var k = format.length; --k >= 0;) {\n                    var chf = format.charAt(k);\n                    if (iv < 0) {\n                        if (chf == '0') {\n                            add('0');\n                        } else if (chf == '?') {\n                            add(' ');\n                        }\n                    } else {\n                        add(value.charAt(iv--));\n                    }\n                }\n                if (j === 0) {\n                    while (iv >= 0) {\n                        add(value.charAt(iv--));\n                    }\n                }\n                result.unshift(str);\n            }\n            return result;\n        },\n        formatDec: function (value, parts, declen) {\n            value = value.toFixed(declen);\n            var pos = value.indexOf('.');\n            if (pos >= 0) {\n                value = value.substr(pos + 1).replace(/0+$/, '');\n            } else {\n                value = '';\n            }\n            var iv = 0;\n            var result = [];\n            for (var j = 0; j < parts.length; ++j) {\n                var format = parts[j];\n                var str = '';\n                for (var k = 0; k < format.length; ++k) {\n                    var chf = format.charAt(k);\n                    if (iv < value.length) {\n                        str += value.charAt(iv++);\n                    } else if (chf == '0') {\n                        str += '0';\n                    } else if (chf == '?') {\n                        str += ' ';\n                    }\n                }\n                result.push(str);\n            }\n            return result;\n        }\n    };\n    function padLeft(val, width, ch) {\n        val += '';\n        while (val.length < width) {\n            val = ch + val;\n        }\n        return val;\n    }\n    function text(f) {\n        var a = f.body;\n        var text = '';\n        for (var i = 0; i < a.length; ++i) {\n            var el = a[i];\n            if (typeof el == 'string') {\n                text += el;\n            } else if (el.type == 'space') {\n                text += ' ';\n            }\n        }\n        return text;\n    }\n    kendo.spreadsheet.formatting = {\n        compile: compile,\n        parse: parse,\n        format: function (value, format, culture) {\n            var f = compile(format)(value, culture);\n            var span = dom.element('span');\n            span.__dataType = f.type;\n            var a = f.body;\n            if (f.color) {\n                span.attr.style = { color: f.color };\n            }\n            for (var i = 0; i < a.length; ++i) {\n                var el = a[i];\n                if (typeof el == 'string') {\n                    span.children.push(dom.text(el));\n                } else if (el.type == 'space') {\n                    span.children.push(dom.element('span', { style: { visibility: 'hidden' } }, [dom.text(el.value)]));\n                }\n            }\n            return span;\n        },\n        text: function (value, format, culture) {\n            var f = compile(format)(value, culture);\n            return text(f);\n        },\n        textAndColor: function (value, format, culture) {\n            var f = compile(format)(value, culture);\n            return {\n                text: text(f),\n                color: f.color,\n                type: f.type\n            };\n        },\n        type: function (value, format) {\n            return compile(format)(value).type;\n        },\n        adjustDecimals: function (format, diff) {\n            var ast = parse(format);\n            adjustDecimals(ast, diff);\n            return print(ast);\n        }\n    };\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/runtime.functions', [\n        'spreadsheet/runtime',\n        'util/main'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var util = kendo.util;\n    var spreadsheet = kendo.spreadsheet;\n    var calc = spreadsheet.calc;\n    var runtime = calc.runtime;\n    var defineFunction = runtime.defineFunction;\n    var defineAlias = runtime.defineAlias;\n    var CalcError = runtime.CalcError;\n    var RangeRef = spreadsheet.RangeRef;\n    var CellRef = spreadsheet.CellRef;\n    var UnionRef = spreadsheet.UnionRef;\n    var Matrix = runtime.Matrix;\n    var Ref = spreadsheet.Ref;\n    var daysInMonth = runtime.daysInMonth;\n    var packDate = runtime.packDate;\n    var unpackDate = runtime.unpackDate;\n    var daysInYear = runtime.daysInYear;\n    [\n        'abs',\n        'cos',\n        'sin',\n        'acos',\n        'asin',\n        'tan',\n        'atan',\n        'exp',\n        'sqrt'\n    ].forEach(function (name) {\n        defineFunction(name, Math[name]).args([[\n                '*n',\n                'number'\n            ]]);\n    });\n    defineFunction('ln', Math.log).args([[\n            '*n',\n            'number'\n        ]]);\n    defineFunction('log', function (num, base) {\n        return Math.log(num) / Math.log(base);\n    }).args([\n        [\n            '*num',\n            'number++'\n        ],\n        [\n            '*base',\n            [\n                'or',\n                'number++',\n                [\n                    'null',\n                    10\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$base != 1',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('log10', function (num) {\n        return Math.log(num) / Math.log(10);\n    }).args([[\n            '*num',\n            'number++'\n        ]]);\n    defineFunction('pi', function () {\n        return Math.PI;\n    }).args([]);\n    defineFunction('sqrtpi', function (n) {\n        return Math.sqrt(n * Math.PI);\n    }).args([[\n            '*num',\n            'number+'\n        ]]);\n    defineFunction('degrees', function (rad) {\n        return 180 * rad / Math.PI % 360;\n    }).args([[\n            '*radians',\n            'number'\n        ]]);\n    defineFunction('radians', function (deg) {\n        return Math.PI * deg / 180;\n    }).args([[\n            '*degrees',\n            'number'\n        ]]);\n    function _cosh(n) {\n        return (Math.exp(n) + Math.exp(-n)) / 2;\n    }\n    defineFunction('cosh', _cosh).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('acosh', function (n) {\n        return Math.log(n + Math.sqrt(n - 1) * Math.sqrt(n + 1));\n    }).args([\n        [\n            '*num',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$num >= 1'\n            ]\n        ]\n    ]);\n    function _sinh(n) {\n        return (Math.exp(n) - Math.exp(-n)) / 2;\n    }\n    defineFunction('sinh', _sinh).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('asinh', function (n) {\n        return Math.log(n + Math.sqrt(n * n + 1));\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('sec', function (n) {\n        return 1 / Math.cos(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('sech', function (n) {\n        return 1 / _cosh(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('csc', function (n) {\n        return 1 / Math.sin(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('csch', function (n) {\n        return 1 / _sinh(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('atan2', function (x, y) {\n        return Math.atan(y / x);\n    }).args([\n        [\n            '*x',\n            'divisor'\n        ],\n        [\n            '*y',\n            'number'\n        ]\n    ]);\n    function _tanh(n) {\n        return _sinh(n) / _cosh(n);\n    }\n    defineFunction('tanh', _tanh).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('atanh', function (n) {\n        return Math.log(Math.sqrt(1 - n * n) / (1 - n));\n    }).args([[\n            '*num',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    -1,\n                    1\n                ]\n            ]\n        ]]);\n    defineFunction('cot', function (n) {\n        return 1 / Math.tan(n);\n    }).args([[\n            '*num',\n            'divisor'\n        ]]);\n    defineFunction('coth', function (n) {\n        return 1 / _tanh(n);\n    }).args([[\n            '*num',\n            'divisor'\n        ]]);\n    defineFunction('acot', function (n) {\n        return Math.PI / 2 - Math.atan(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('acoth', function (n) {\n        return Math.log((n + 1) / (n - 1)) / 2;\n    }).args([\n        [\n            '*num',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'or',\n                [\n                    'assert',\n                    '$num < -1'\n                ],\n                [\n                    'assert',\n                    '$num > 1'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('power', function (a, b) {\n        return Math.pow(a, b);\n    }).args([\n        [\n            '*a',\n            'number'\n        ],\n        [\n            '*b',\n            'number'\n        ]\n    ]);\n    defineFunction('mod', function (a, b) {\n        return a % b;\n    }).args([\n        [\n            '*a',\n            'number'\n        ],\n        [\n            '*b',\n            'divisor'\n        ]\n    ]);\n    defineFunction('quotient', function (a, b) {\n        return Math.floor(a / b);\n    }).args([\n        [\n            '*a',\n            'number'\n        ],\n        [\n            '*b',\n            'divisor'\n        ]\n    ]);\n    defineFunction('ceiling', function (num, s) {\n        return s ? s * Math.ceil(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$significance >= 0 || $number < 0'\n            ]\n        ]\n    ]);\n    defineFunction('ceiling.precise', function (num, s) {\n        s = Math.abs(s);\n        return s ? s * Math.ceil(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineAlias('iso.ceiling', 'ceiling.precise');\n    defineFunction('ceiling.math', function (num, s, mode) {\n        if (!s || !num) {\n            return 0;\n        }\n        if (num < 0 && (!mode && s < 0 || mode && s > 0)) {\n            s = -s;\n        }\n        return s ? s * Math.ceil(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    '$number < 0 ? -1 : 1'\n                ]\n            ]\n        ],\n        [\n            '*mode',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('floor', function (num, s) {\n        return s ? s * Math.floor(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$significance >= 0 || $number < 0'\n            ]\n        ]\n    ]);\n    defineFunction('floor.precise', function (num, s) {\n        s = Math.abs(s);\n        return s ? s * Math.floor(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('floor.math', function (num, s, mode) {\n        if (!s || !num) {\n            return 0;\n        }\n        if (num < 0 && (!mode && s < 0 || mode && s > 0)) {\n            s = -s;\n        }\n        return s ? s * Math.floor(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    '$number < 0 ? -1 : 1'\n                ]\n            ]\n        ],\n        [\n            '*mode',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('int', Math.floor).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('mround', function (num, mult) {\n        return mult ? mult * Math.round(num / mult) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*multiple',\n            'number'\n        ]\n    ]);\n    defineFunction('round', function (num, digits) {\n        var sign = num < 0 ? -1 : 1;\n        if (sign < 0) {\n            num = -num;\n        }\n        digits = Math.pow(10, digits);\n        num *= digits;\n        num = Math.round(num);\n        return sign * num / digits;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*digits',\n            'number'\n        ]\n    ]);\n    defineFunction('roundup', function (num, digits) {\n        digits = Math.pow(10, digits);\n        num *= digits;\n        num = num < 0 ? Math.floor(num) : Math.ceil(num);\n        return num / digits;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*digits',\n            'number'\n        ]\n    ]);\n    defineFunction('rounddown', function (num, digits) {\n        digits = Math.pow(10, digits);\n        num *= digits;\n        num = num < 0 ? Math.ceil(num) : Math.floor(num);\n        return num / digits;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*digits',\n            'number'\n        ]\n    ]);\n    defineFunction('even', function (num) {\n        var n = num < 0 ? Math.floor(num) : Math.ceil(num);\n        return n % 2 ? n + (n < 0 ? -1 : 1) : n;\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('odd', function (num) {\n        var n = num < 0 ? Math.floor(num) : Math.ceil(num);\n        return n % 2 ? n : n + (n < 0 ? -1 : 1);\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('sign', function (num) {\n        return num < 0 ? -1 : num > 0 ? 1 : 0;\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    function _gcd(a, b) {\n        while (b) {\n            var r = a % b;\n            a = b;\n            b = r;\n        }\n        return a;\n    }\n    function _lcm(a, b) {\n        return Math.abs(a * b) / _gcd(a, b);\n    }\n    defineFunction('gcd', function (args) {\n        var a = args[0];\n        for (var i = 1; i < args.length; ++i) {\n            a = _gcd(a, args[i]);\n        }\n        return a;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('lcm', function (args) {\n        var a = args[0];\n        for (var i = 1; i < args.length; ++i) {\n            a = _lcm(a, args[i]);\n        }\n        return a;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('sum', function (numbers) {\n        return numbers.reduce(function (sum, num) {\n            return sum + num;\n        }, 0);\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('product', function (numbers) {\n        return numbers.reduce(function (prod, num) {\n            return prod * num;\n        }, 1);\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('sumproduct', function (first, rest) {\n        var sum = 0;\n        first.each(function (p, row, col) {\n            if (typeof p == 'number') {\n                for (var i = 0; i < rest.length; ++i) {\n                    var v = rest[i].get(row, col);\n                    if (typeof v != 'number') {\n                        return;\n                    }\n                    p *= v;\n                }\n                sum += p;\n            }\n        });\n        return sum;\n    }).args([\n        [\n            'a1',\n            'matrix'\n        ],\n        [\n            '+',\n            [\n                'a2',\n                [\n                    'and',\n                    'matrix',\n                    [\n                        'assert',\n                        '$a2.width == $a1.width'\n                    ],\n                    [\n                        'assert',\n                        '$a2.height == $a1.height'\n                    ]\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('sumsq', function (numbers) {\n        return numbers.reduce(function (sum, num) {\n            return sum + num * num;\n        }, 0);\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('sumx2my2', function (a, b) {\n        var sum = 0;\n        a.each(function (x, row, col) {\n            var y = b.get(row, col);\n            if (typeof x == 'number' && typeof y == 'number') {\n                sum += x * x - y * y;\n            }\n        });\n        return sum;\n    }).args([\n        [\n            'a',\n            'matrix'\n        ],\n        [\n            'b',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$b.width == $a.width'\n                ],\n                [\n                    'assert',\n                    '$b.height == $a.height'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('sumx2py2', function (a, b) {\n        var sum = 0;\n        a.each(function (x, row, col) {\n            var y = b.get(row, col);\n            if (typeof x == 'number' && typeof y == 'number') {\n                sum += x * x + y * y;\n            }\n        });\n        return sum;\n    }).args([\n        [\n            'a',\n            'matrix'\n        ],\n        [\n            'b',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$b.width == $a.width'\n                ],\n                [\n                    'assert',\n                    '$b.height == $a.height'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('sumxmy2', function (a, b) {\n        var sum = 0;\n        a.each(function (x, row, col) {\n            var y = b.get(row, col);\n            if (typeof x == 'number' && typeof y == 'number') {\n                sum += (x - y) * (x - y);\n            }\n        });\n        return sum;\n    }).args([\n        [\n            'a',\n            'matrix'\n        ],\n        [\n            'b',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$b.width == $a.width'\n                ],\n                [\n                    'assert',\n                    '$b.height == $a.height'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('seriessum', function (x, n, m, a) {\n        var sum = 0;\n        a.each(function (coef) {\n            if (typeof coef != 'number') {\n                throw new CalcError('VALUE');\n            }\n            sum += coef * Math.pow(x, n);\n            n += m;\n        });\n        return sum;\n    }).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'y',\n            'number'\n        ],\n        [\n            'm',\n            'number'\n        ],\n        [\n            'a',\n            'matrix'\n        ]\n    ]);\n    defineFunction('min', function (numbers) {\n        return Math.min.apply(Math, numbers);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('max', function (numbers) {\n        return Math.max.apply(Math, numbers);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('counta', function (values) {\n        return values.length;\n    }).args([[\n            'values',\n            [\n                '#collect',\n                'anyvalue'\n            ]\n        ]]);\n    defineFunction('count', function (numbers) {\n        return numbers.length;\n    }).args([[\n            'numbers',\n            [\n                '#collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('countunique', function (values) {\n        var count = 0, seen = [];\n        values.forEach(function (val) {\n            if (seen.indexOf(val) < 0) {\n                count++;\n                seen.push(val);\n            }\n        });\n        return count;\n    }).args([[\n            'values',\n            [\n                '#collect',\n                'anyvalue'\n            ]\n        ]]);\n    defineFunction('countblank', function (a) {\n        var count = 0;\n        function add(val) {\n            if (val == null || val === '') {\n                count++;\n            }\n        }\n        function loop(args) {\n            for (var i = 0; i < args.length; ++i) {\n                var x = args[i];\n                if (x instanceof Matrix) {\n                    x.each(add, true);\n                } else {\n                    add(x);\n                }\n            }\n        }\n        loop(a);\n        return count;\n    }).args([[\n            '+',\n            [\n                'args',\n                [\n                    'or',\n                    'matrix',\n                    'anyvalue'\n                ]\n            ]\n        ]]);\n    defineFunction('iseven', function (num) {\n        return num % 2 === 0;\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('isodd', function (num) {\n        return num % 2 !== 0;\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('n', function (val) {\n        if (typeof val == 'boolean') {\n            return val ? 1 : 0;\n        }\n        if (typeof val == 'number') {\n            return val;\n        }\n        return 0;\n    }).args([[\n            '*value',\n            'anyvalue'\n        ]]);\n    defineFunction('na', function () {\n        return new CalcError('N/A');\n    }).args([]);\n    function forIFS(args, f) {\n        var chunks = [], i = 0, matrix = args[0];\n        while (i < args.length) {\n            chunks.push({\n                matrix: args[i++],\n                pred: parseCriteria(args[i++])\n            });\n        }\n        ROW:\n            for (var row = 0; row < matrix.height; ++row) {\n                COL:\n                    for (var col = 0; col < matrix.width; ++col) {\n                        for (i = 0; i < chunks.length; ++i) {\n                            var val = chunks[i].matrix.get(row, col);\n                            if (!chunks[i].pred(val == null || val === '' ? 0 : val)) {\n                                continue COL;\n                            }\n                        }\n                        f(row, col);\n                    }\n            }\n    }\n    var ARGS_COUNTIFS = [\n        [\n            'm1',\n            'matrix'\n        ],\n        [\n            'c1',\n            'anyvalue'\n        ],\n        [\n            [\n                'm2',\n                [\n                    'and',\n                    'matrix',\n                    [\n                        'assert',\n                        '$m1.width == $m2.width'\n                    ],\n                    [\n                        'assert',\n                        '$m1.height == $m2.height'\n                    ]\n                ]\n            ],\n            [\n                'c2',\n                'anyvalue'\n            ]\n        ]\n    ];\n    defineFunction('countifs', function (m1, c1, rest) {\n        var count = 0;\n        rest.unshift(m1, c1);\n        forIFS(rest, function () {\n            count++;\n        });\n        return count;\n    }).args(ARGS_COUNTIFS);\n    var ARGS_SUMIFS = [[\n            'range',\n            'matrix'\n        ]].concat(ARGS_COUNTIFS);\n    defineFunction('sumifs', function (range, m1, c1, args) {\n        args.unshift(range, numericPredicate, m1, c1);\n        var sum = 0;\n        forIFS(args, function (row, col) {\n            var val = range.get(row, col);\n            if (val) {\n                sum += val;\n            }\n        });\n        return sum;\n    }).args(ARGS_SUMIFS);\n    defineFunction('averageifs', function (range, m1, c1, args) {\n        args.unshift(range, numericPredicate, m1, c1);\n        var sum = 0, count = 0;\n        forIFS(args, function (row, col) {\n            var val = range.get(row, col);\n            if (val == null || val === '') {\n                val = 0;\n            }\n            sum += val;\n            count++;\n        });\n        return count ? sum / count : new CalcError('DIV/0');\n    }).args(ARGS_SUMIFS);\n    defineFunction('countif', function (matrix, criteria) {\n        criteria = parseCriteria(criteria);\n        var count = 0;\n        matrix.each(function (val) {\n            if (criteria(val)) {\n                count++;\n            }\n        });\n        return count;\n    }).args([\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            '*criteria',\n            'anyvalue'\n        ]\n    ]);\n    var ARGS_SUMIF = [\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            '*criteria',\n            'anyvalue'\n        ],\n        [\n            'sumRange',\n            [\n                'or',\n                [\n                    'and',\n                    'matrix',\n                    [\n                        'assert',\n                        '$sumRange.width == $range.width'\n                    ],\n                    [\n                        'assert',\n                        '$sumRange.height == $range.height'\n                    ]\n                ],\n                [\n                    'null',\n                    '$range'\n                ]\n            ]\n        ]\n    ];\n    defineFunction('sumif', function (range, criteria, sumRange) {\n        var sum = 0;\n        criteria = parseCriteria(criteria);\n        range.each(function (val, row, col) {\n            if (criteria(val)) {\n                var v = sumRange.get(row, col);\n                if (numericPredicate(v)) {\n                    sum += v || 0;\n                }\n            }\n        });\n        return sum;\n    }).args(ARGS_SUMIF);\n    defineFunction('averageif', function (range, criteria, sumRange) {\n        var sum = 0, count = 0;\n        criteria = parseCriteria(criteria);\n        range.each(function (val, row, col) {\n            if (criteria(val)) {\n                var v = sumRange.get(row, col);\n                if (numericPredicate(v)) {\n                    sum += v || 0;\n                    count++;\n                }\n            }\n        });\n        return count ? sum / count : new CalcError('DIV/0');\n    }).args(ARGS_SUMIF);\n    (function (def) {\n        def('large', function (numbers, nth) {\n            return numbers.sort(descending)[nth];\n        });\n        def('small', function (numbers, nth) {\n            return numbers.sort(ascending)[nth];\n        });\n    }(function (name, handler) {\n        defineFunction(name, function (matrix, nth) {\n            var numbers = [];\n            var error = matrix.each(function (val) {\n                if (val instanceof CalcError) {\n                    return val;\n                }\n                if (typeof val == 'number') {\n                    numbers.push(val);\n                }\n            });\n            if (error) {\n                return error;\n            }\n            if (nth > numbers.length) {\n                return new CalcError('NUM');\n            }\n            return handler(numbers, nth - 1);\n        }).args([\n            [\n                'array',\n                'matrix'\n            ],\n            [\n                '*nth',\n                'number++'\n            ]\n        ]);\n    }));\n    function _avg(numbers) {\n        return numbers.reduce(function (sum, num) {\n            return sum + num;\n        }, 0) / numbers.length;\n    }\n    function _var_sp(numbers, divisor, avg) {\n        if (avg == null) {\n            avg = _avg(numbers);\n        }\n        return numbers.reduce(function (sum, num) {\n            return sum + Math.pow(num - avg, 2);\n        }, 0) / divisor;\n    }\n    function _stdev_sp(numbers, divisor) {\n        return Math.sqrt(_var_sp(numbers, divisor));\n    }\n    defineFunction('stdev.s', function (numbers) {\n        return _stdev_sp(numbers, numbers.length - 1);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('stdev.p', function (numbers) {\n        return _stdev_sp(numbers, numbers.length);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('var.s', function (numbers) {\n        return _var_sp(numbers, numbers.length - 1);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('var.p', function (numbers) {\n        return _var_sp(numbers, numbers.length);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('median', function (numbers) {\n        var n = numbers.length;\n        numbers.sort(ascending);\n        if (n % 2) {\n            return numbers[n >> 1];\n        }\n        return (numbers[n >> 1] + numbers[n >> 1 + 1]) / 2;\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('mode.sngl', function (numbers) {\n        numbers.sort(ascending);\n        var prev = null, count = 0, max = 1, mode = null;\n        for (var i = 0; i < numbers.length; ++i) {\n            var n = numbers[i];\n            if (n != prev) {\n                count = 1;\n                prev = n;\n            } else {\n                count++;\n            }\n            if (count > max) {\n                max = count;\n                mode = n;\n            }\n        }\n        return mode == null ? new CalcError('N/A') : mode;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('mode.mult', function (numbers) {\n        var seen = Object.create(null), max = 2, res = [];\n        numbers.forEach(function (num) {\n            var s = seen[num] || 0;\n            seen[num] = ++s;\n            if (s == max) {\n                res.push(num);\n            } else if (s > max) {\n                max = s;\n                res = [num];\n            }\n        });\n        var m = new Matrix(this);\n        res.forEach(function (num, i) {\n            m.set(i, 0, num);\n        });\n        return m;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('geomean', function (numbers) {\n        var n = numbers.length;\n        var p = numbers.reduce(function (p, num) {\n            if (num < 0) {\n                throw new CalcError('NUM');\n            }\n            return p * num;\n        }, 1);\n        return Math.pow(p, 1 / n);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('harmean', function (numbers) {\n        var n = numbers.length;\n        var s = numbers.reduce(function (s, num) {\n            if (!num) {\n                throw new CalcError('DIV/0');\n            }\n            return s + 1 / num;\n        }, 0);\n        return n / s;\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('trimmean', function (numbers, p) {\n        var n = numbers.length;\n        numbers.sort(ascending);\n        var discard = Math.floor(n * p);\n        if (discard % 2) {\n            --discard;\n        }\n        discard /= 2;\n        var sum = 0;\n        for (var i = discard; i < n - discard; ++i) {\n            sum += numbers[i];\n        }\n        return sum / (n - discard * 2);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'percent',\n            [\n                'and',\n                'number',\n                [\n                    '[between)',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('frequency', function (data, bins) {\n        data.sort(ascending);\n        bins.sort(ascending);\n        var prev = -Infinity;\n        var i = 0;\n        function count(max) {\n            var n = 0;\n            while (i < data.length && data[i] > prev && data[i] <= max) {\n                ++n;\n                ++i;\n            }\n            return n;\n        }\n        var m = new Matrix(this);\n        bins.forEach(function (val, i) {\n            var n = count(val);\n            prev = val;\n            m.set(i, 0, n);\n        });\n        m.set(m.height, 0, data.length - i);\n        return m;\n    }).args([\n        [\n            'data',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'bins',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ]\n    ]);\n    defineFunction('rank.eq', function (val, numbers, asc) {\n        numbers.sort(asc ? ascending : descending);\n        var pos = numbers.indexOf(val);\n        return pos < 0 ? new CalcError('N/A') : pos + 1;\n    }).args([\n        [\n            'value',\n            'number'\n        ],\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            'order',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineAlias('rank', 'rank.eq');\n    defineFunction('rank.avg', function (val, numbers, asc) {\n        numbers.sort(asc ? ascending : descending);\n        var pos = numbers.indexOf(val);\n        if (pos < 0) {\n            return new CalcError('N/A');\n        }\n        for (var i = pos; numbers[i] == val; ++i) {\n        }\n        return (pos + i + 1) / 2;\n    }).args([\n        [\n            'value',\n            'number'\n        ],\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            'order',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('kurt', function (numbers) {\n        var n = numbers.length;\n        var avg = _avg(numbers);\n        var variance = _var_sp(numbers, n - 1, avg);\n        var stddev = Math.sqrt(variance);\n        var sum = numbers.reduce(function (sum, num) {\n            return sum + Math.pow((num - avg) / stddev, 4);\n        }, 0);\n        return n * (n + 1) / ((n - 1) * (n - 2) * (n - 3)) * sum - 3 * Math.pow(n - 1, 2) / ((n - 2) * (n - 3));\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 4',\n                'NUM'\n            ]\n        ]\n    ]);\n    function _percentrank(numbers, x, exc) {\n        var nlt = 0, ngt = 0, left = null, right = null, found = false;\n        numbers.forEach(function (num) {\n            if (num < x) {\n                nlt++;\n                left = left == null ? num : Math.max(left, num);\n            } else if (num > x) {\n                ngt++;\n                right = right == null ? num : Math.min(right, num);\n            } else {\n                found = true;\n            }\n        });\n        if (!nlt && !ngt) {\n            return new CalcError('N/A');\n        }\n        if (found) {\n            if (exc) {\n                return (nlt + 1) / (numbers.length + 1);\n            }\n            return nlt / (nlt + ngt);\n        }\n        return ((right - x) * _percentrank(numbers, left, exc) + (x - left) * _percentrank(numbers, right, exc)) / (right - left);\n    }\n    var ARGS_PERCENTRANK = [\n        [\n            'array',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'x',\n            'number'\n        ],\n        [\n            'significance',\n            [\n                'or',\n                [\n                    'null',\n                    3\n                ],\n                'integer++'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array.length > 0',\n                'NUM'\n            ]\n        ]\n    ];\n    defineFunction('percentrank.inc', function (numbers, x, significance) {\n        var p = _percentrank(numbers, x, 0);\n        p = p.toFixed(significance + 1);\n        return parseFloat(p.substr(0, p.length - 1));\n    }).args(ARGS_PERCENTRANK);\n    defineFunction('percentrank.exc', function (numbers, x, significance) {\n        var p = _percentrank(numbers, x, 1);\n        p = p.toFixed(significance + 1);\n        return parseFloat(p.substr(0, p.length - 1));\n    }).args(ARGS_PERCENTRANK);\n    defineAlias('percentrank', 'percentrank.inc');\n    function _covariance(x, y, divisor) {\n        var sum = 0;\n        var ax = _avg(x);\n        var ay = _avg(y);\n        var n = x.length;\n        for (var i = 0; i < n; ++i) {\n            sum += (x[i] - ax) * (y[i] - ay);\n        }\n        return sum / divisor;\n    }\n    defineFunction('covariance.p', function (x, y) {\n        return _covariance(x, y, x.length);\n    }).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length == $array2.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length > 0',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('covariance.s', function (x, y) {\n        return _covariance(x, y, x.length - 1);\n    }).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length == $array2.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length > 1',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineAlias('covar', 'covariance.p');\n    var _fact = util.memoize(function (n) {\n        for (var i = 2, fact = 1; i <= n; ++i) {\n            fact *= i;\n        }\n        return fact;\n    });\n    defineFunction('fact', _fact).args([[\n            '*n',\n            'integer+'\n        ]]);\n    defineFunction('factdouble', function (n) {\n        for (var i = 2 + (n & 1), fact = 1; i <= n; i += 2) {\n            fact *= i;\n        }\n        return fact;\n    }).args([[\n            '*n',\n            'integer+'\n        ]]);\n    defineFunction('multinomial', function (numbers) {\n        var div = 1, sum = 0;\n        numbers.forEach(function (n) {\n            if (n < 0) {\n                throw new CalcError('NUM');\n            }\n            sum += n;\n            div *= _fact(n);\n        });\n        return _fact(sum) / div;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    var _combinations = util.memoize(function (n, k) {\n        for (var f1 = k + 1, f2 = 1, p1 = 1, p2 = 1; f2 <= n - k; ++f1, ++f2) {\n            p1 *= f1;\n            p2 *= f2;\n        }\n        return p1 / p2;\n    });\n    defineFunction('combin', _combinations).args([\n        [\n            '*n',\n            'integer++'\n        ],\n        [\n            '*k',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    0,\n                    '$n'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('combina', function (n, k) {\n        return _combinations(n + k - 1, n - 1);\n    }).args([\n        [\n            '*n',\n            'integer++'\n        ],\n        [\n            '*k',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    1,\n                    '$n'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('average', function (numbers) {\n        var sum = numbers.reduce(function (sum, num) {\n            return sum + num;\n        }, 0);\n        return sum / numbers.length;\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                [\n                    'and',\n                    'number',\n                    [\n                        'not',\n                        'boolean'\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('averagea', function (values) {\n        var sum = 0, count = 0;\n        values.forEach(function (num) {\n            if (typeof num != 'string') {\n                sum += num;\n            }\n            ++count;\n        });\n        return count ? sum / count : new CalcError('DIV/0');\n    }).args([[\n            'values',\n            [\n                'collect',\n                'anyvalue'\n            ]\n        ]]);\n    function _percentile(numbers, rank) {\n        numbers.sort(ascending);\n        var n = numbers.length;\n        var k = rank | 0, d = rank - k;\n        if (k === 0) {\n            return numbers[0];\n        }\n        if (k >= n) {\n            return numbers[n - 1];\n        }\n        --k;\n        return numbers[k] + d * (numbers[k + 1] - numbers[k]);\n    }\n    function _percentile_inc(numbers, p) {\n        var rank = p * (numbers.length - 1) + 1;\n        return _percentile(numbers, rank);\n    }\n    function _percentile_exc(numbers, p) {\n        var rank = p * (numbers.length + 1);\n        return _percentile(numbers, rank);\n    }\n    defineFunction('percentile.inc', _percentile_inc).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('percentile.exc', _percentile_exc).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    0,\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('quartile.inc', function (numbers, quarter) {\n        return _percentile_inc(numbers, quarter / 4);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'quarter',\n            [\n                'values',\n                0,\n                1,\n                2,\n                3,\n                4\n            ]\n        ]\n    ]);\n    defineFunction('quartile.exc', function (numbers, quarter) {\n        return _percentile_exc(numbers, quarter / 4);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'quarter',\n            [\n                'values',\n                0,\n                1,\n                2,\n                3,\n                4\n            ]\n        ]\n    ]);\n    defineAlias('quartile', 'quartile.inc');\n    defineAlias('percentile', 'percentile.inc');\n    var AGGREGATE_FUNCS = [\n        'AVERAGE',\n        'COUNT',\n        'COUNTA',\n        'MAX',\n        'MIN',\n        'PRODUCT',\n        'STDEV.S',\n        'STDEV.P',\n        'SUM',\n        'VAR.S',\n        'VAR.P',\n        'MEDIAN',\n        'MODE.SNGL',\n        'LARGE',\n        'SMALL',\n        'PERCENTILE.INC',\n        'QUARTILE.INC',\n        'PERCENTILE.EXC',\n        'QUARTILE.EXC'\n    ];\n    function fetchValuesForAggregate(self, args, options) {\n        var values = [];\n        var opt_ignore_hidden_rows = 1;\n        var opt_ignore_errors = 2;\n        var opt_use_aggregates = 4;\n        (function fetchValues(args) {\n            if (args instanceof Ref) {\n                self.getRefCells(args, true).forEach(function (cell) {\n                    var value = cell.value;\n                    if (options & opt_ignore_hidden_rows && cell.hidden) {\n                        return;\n                    }\n                    if (cell.formula) {\n                        var str = cell.formula.print(cell.row, cell.col);\n                        if (/^\\s*(?:aggregate|subtotal)\\s*\\(/i.test(str)) {\n                            if (!(options & opt_use_aggregates)) {\n                                return;\n                            }\n                        }\n                        if ('value' in cell.formula) {\n                            value = cell.formula.value;\n                        }\n                    }\n                    if (options & opt_ignore_errors && value instanceof CalcError) {\n                        return;\n                    }\n                    if (typeof value == 'number' || value instanceof CalcError) {\n                        values.push(value);\n                    }\n                });\n            } else if (Array.isArray(args)) {\n                for (var i = 0; i < args.length; ++i) {\n                    fetchValues(args[i]);\n                }\n            } else if (args instanceof Matrix) {\n                args.each(fetchValues);\n            } else if (typeof args == 'number') {\n                values.push(args);\n            } else if (args instanceof CalcError && !(options & opt_ignore_errors)) {\n                values.push(args);\n            }\n        }(args));\n        return values;\n    }\n    defineFunction('aggregate', function (callback, funcId, options, args) {\n        var self = this;\n        self.resolveCells(args, function () {\n            var values;\n            if (funcId > 12) {\n                values = fetchValuesForAggregate(self, args[0], options);\n                var k = args[1];\n                if (k instanceof CellRef) {\n                    k = self.getRefData(k);\n                }\n                if (typeof k != 'number') {\n                    return callback(new CalcError('VALUE'));\n                }\n            } else {\n                values = fetchValuesForAggregate(self, args, options);\n            }\n            self.func(AGGREGATE_FUNCS[funcId - 1], callback, values);\n        });\n    }).argsAsync([\n        [\n            'funcId',\n            [\n                'values',\n                1,\n                2,\n                3,\n                4,\n                5,\n                6,\n                7,\n                8,\n                9,\n                10,\n                11,\n                12,\n                13,\n                14,\n                15,\n                16,\n                17,\n                18,\n                19\n            ]\n        ],\n        [\n            'options',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'values',\n                    0,\n                    1,\n                    2,\n                    3,\n                    4,\n                    5,\n                    6,\n                    7\n                ]\n            ]\n        ],\n        [\n            'args',\n            'rest'\n        ]\n    ]);\n    defineFunction('subtotal', function (callback, funcId) {\n        var self = this;\n        var ignoreHidden = funcId > 100;\n        if (ignoreHidden) {\n            funcId -= 100;\n        }\n        var args = [];\n        for (var i = 2; i < arguments.length; ++i) {\n            args.push(arguments[i]);\n        }\n        self.resolveCells(args, function () {\n            var values = fetchValuesForAggregate(self, args, ignoreHidden ? 1 : 0);\n            self.func(AGGREGATE_FUNCS[funcId - 1], callback, values);\n        });\n    }).argsAsync([\n        [\n            'funcId',\n            [\n                'values',\n                1,\n                2,\n                3,\n                4,\n                5,\n                6,\n                7,\n                8,\n                9,\n                10,\n                11,\n                101,\n                102,\n                103,\n                104,\n                105,\n                106,\n                107,\n                108,\n                109,\n                110,\n                111\n            ]\n        ],\n        [\n            '+',\n            [\n                'ref',\n                [\n                    'or',\n                    'ref',\n                    '#matrix'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('avedev', function (numbers) {\n        var avg = numbers.reduce(function (sum, num) {\n            return sum + num;\n        }, 0) / numbers.length;\n        return numbers.reduce(function (sum, num) {\n            return sum + Math.abs(num - avg);\n        }, 0) / numbers.length;\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    function _binom_dist(x, n, p, cumulative) {\n        if (!cumulative) {\n            return _combinations(n, x) * Math.pow(p, x) * Math.pow(1 - p, n - x);\n        } else {\n            var sum = 0;\n            for (var j = 0; j <= x; ++j) {\n                sum += _combinations(n, j) * Math.pow(p, j) * Math.pow(1 - p, n - j);\n            }\n            return sum;\n        }\n    }\n    defineFunction('binom.dist', _binom_dist).args([\n        [\n            'successes',\n            'integer+'\n        ],\n        [\n            'trials',\n            [\n                'and',\n                'integer',\n                [\n                    'assert',\n                    '$trials >= $successes'\n                ]\n            ]\n        ],\n        [\n            'probability',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineAlias('binomdist', 'binom.dist');\n    defineFunction('binom.inv', function (n, p, alpha) {\n        for (var x = 0; x <= n; ++x) {\n            if (_binom_dist(x, n, p, true) >= alpha) {\n                return x;\n            }\n        }\n        return new CalcError('N/A');\n    }).args([\n        [\n            'trials',\n            'integer+'\n        ],\n        [\n            'probability',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'alpha',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineAlias('critbinom', 'binom.inv');\n    defineFunction('binom.dist.range', function (n, p, s, s2) {\n        var sum = 0;\n        for (var k = s; k <= s2; ++k) {\n            sum += _combinations(n, k) * Math.pow(p, k) * Math.pow(1 - p, n - k);\n        }\n        return sum;\n    }).args([\n        [\n            'trials',\n            'integer+'\n        ],\n        [\n            'probability',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'successes_min',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    0,\n                    '$trials'\n                ]\n            ]\n        ],\n        [\n            'successes_max',\n            [\n                'or',\n                [\n                    'and',\n                    'integer',\n                    [\n                        '[between]',\n                        '$successes_min',\n                        '$trials'\n                    ]\n                ],\n                [\n                    'null',\n                    '$successes_min'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('negbinom.dist', function (x, k, p, cumulative) {\n        if (cumulative) {\n            var sum = 0;\n            while (x >= 0) {\n                sum += _combinations(x + k - 1, x) * Math.pow(p, k) * Math.pow(1 - p, x);\n                x--;\n            }\n            return sum;\n        }\n        return _combinations(x + k - 1, x) * Math.pow(p, k) * Math.pow(1 - p, x);\n    }).args([\n        [\n            'number_f',\n            'integer+'\n        ],\n        [\n            'number_s',\n            'integer+'\n        ],\n        [\n            'probability_s',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineAlias('negbinomdist', 'negbinom.dist');\n    defineFunction('address', function (row, col, abs, a1, sheet) {\n        var cell = new CellRef(row - 1, col - 1, abs - 1);\n        if (sheet) {\n            cell.setSheet(sheet, true);\n        }\n        return a1 ? cell.print(0, 0) : cell.print();\n    }).args([\n        [\n            'row',\n            'integer++'\n        ],\n        [\n            'col',\n            'integer++'\n        ],\n        [\n            'abs',\n            [\n                'or',\n                [\n                    'null',\n                    1\n                ],\n                [\n                    'values',\n                    1,\n                    2,\n                    3,\n                    4\n                ]\n            ]\n        ],\n        [\n            'a1',\n            [\n                'or',\n                [\n                    'null',\n                    true\n                ],\n                'logical'\n            ]\n        ],\n        [\n            'sheet',\n            [\n                'or',\n                'null',\n                'string'\n            ]\n        ]\n    ]);\n    defineFunction('areas', function (ref) {\n        var count = 0;\n        (function loop(x) {\n            if (x instanceof CellRef || x instanceof RangeRef) {\n                count++;\n            } else if (x instanceof UnionRef) {\n                x.refs.forEach(loop);\n            }\n        }(ref));\n        return count;\n    }).args([[\n            'ref',\n            'ref'\n        ]]);\n    defineFunction('choose', function (index, args) {\n        if (index > args.length) {\n            return new CalcError('N/A');\n        } else {\n            return args[index - 1];\n        }\n    }).args([\n        [\n            '*index',\n            'integer'\n        ],\n        [\n            '+',\n            [\n                'value',\n                'anything'\n            ]\n        ]\n    ]);\n    defineFunction('column', function (ref) {\n        if (!ref) {\n            return this.formula.col + 1;\n        }\n        if (ref instanceof CellRef) {\n            return ref.col + 1;\n        }\n        return this.asMatrix(ref).mapCol(function (col) {\n            return col + ref.topLeft.col + 1;\n        });\n    }).args([[\n            'ref',\n            [\n                'or',\n                'area',\n                'null'\n            ]\n        ]]);\n    defineFunction('columns', function (m) {\n        return m instanceof Ref ? m.width() : m.width;\n    }).args([[\n            'ref',\n            [\n                'or',\n                'area',\n                '#matrix'\n            ]\n        ]]);\n    defineFunction('formulatext', function (ref) {\n        var cell = this.getRefCells(ref)[0];\n        if (!cell.formula) {\n            return new CalcError('N/A');\n        }\n        return cell.formula.print(cell.row, cell.col);\n    }).args([[\n            'ref',\n            'ref'\n        ]]);\n    defineFunction('hlookup', function (value, m, row, approx) {\n        var resultCol = null;\n        m.eachCol(function (col) {\n            var data = m.get(0, col);\n            if (approx) {\n                if (data > value) {\n                    return true;\n                }\n                resultCol = col;\n            } else if (data === value) {\n                resultCol = col;\n                return true;\n            }\n        });\n        if (resultCol == null) {\n            return new CalcError('N/A');\n        }\n        return m.get(row - 1, resultCol);\n    }).args([\n        [\n            'value',\n            'anyvalue'\n        ],\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            'row',\n            'integer++'\n        ],\n        [\n            'approx',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('index', function (ref, row, col, areanum) {\n        var m = ref instanceof UnionRef ? ref.refs[areanum - 1] : ref;\n        if (!row && !col || !m) {\n            return new CalcError('N/A');\n        }\n        m = this.asMatrix(m);\n        if (m.width > 1 && m.height > 1) {\n            if (row && col) {\n                return m.get(row - 1, col - 1);\n            }\n            if (!row) {\n                return m.mapRow(function (row) {\n                    return m.get(row, col - 1);\n                });\n            }\n            if (!col) {\n                return m.mapCol(function (col) {\n                    return m.get(row - 1, col);\n                });\n            }\n        }\n        if (m.width == 1) {\n            return m.get(row - 1, 0);\n        }\n        if (m.height == 1) {\n            return m.get(0, col - 1);\n        }\n        return new CalcError('REF');\n    }).args([\n        [\n            'range',\n            [\n                'or',\n                'matrix',\n                'ref'\n            ]\n        ],\n        [\n            'row',\n            [\n                'or',\n                'integer+',\n                'null'\n            ]\n        ],\n        [\n            'col',\n            [\n                'or',\n                'integer+',\n                'null'\n            ]\n        ],\n        [\n            'areanum',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('indirect', function (thing) {\n        try {\n            var f = this.formula;\n            var exp = calc.parseFormula(f.sheet, f.row, f.col, thing);\n            if (!(exp.ast instanceof Ref)) {\n                throw 1;\n            }\n            return exp.ast.absolute(f.row, f.col);\n        } catch (ex) {\n            return new CalcError('REF');\n        }\n    }).args([[\n            'thing',\n            'string'\n        ]]);\n    defineFunction('match', function (val, m, type) {\n        var index = 1, cmp;\n        if (type === 0) {\n            cmp = parseCriteria(val);\n        } else if (type === -1) {\n            cmp = parseCriteria('<=' + val);\n        } else if (type === 1) {\n            cmp = parseCriteria('>=' + val);\n        }\n        if (m.each(function (el) {\n                if (el != null && cmp(el)) {\n                    if (type !== 0 && val != el) {\n                        --index;\n                    }\n                    return true;\n                }\n                index++;\n            }, true) && index > 0) {\n            return index;\n        } else {\n            return new CalcError('N/A');\n        }\n    }).args([\n        [\n            'value',\n            'anyvalue'\n        ],\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    -1,\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('offset', function (ref, rows, cols, height, width) {\n        var topLeft = (ref instanceof CellRef ? ref : ref.topLeft).clone();\n        topLeft.row += rows;\n        topLeft.col += cols;\n        if (topLeft.row < 0 || topLeft.col < 0) {\n            return new CalcError('VALUE');\n        }\n        if (height > 1 || width > 1) {\n            return new RangeRef(topLeft, new CellRef(topLeft.row + height - 1, topLeft.col + width - 1)).setSheet(ref.sheet, ref.hasSheet());\n        }\n        return topLeft;\n    }).args([\n        [\n            'ref',\n            'area'\n        ],\n        [\n            '*rows',\n            'integer'\n        ],\n        [\n            '*cols',\n            'integer'\n        ],\n        [\n            '*height',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    '$ref.height()'\n                ]\n            ]\n        ],\n        [\n            '*width',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    '$ref.width()'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('row', function (ref) {\n        if (!ref) {\n            return this.formula.row + 1;\n        }\n        if (ref instanceof CellRef) {\n            return ref.row + 1;\n        }\n        return this.asMatrix(ref).mapRow(function (row) {\n            return row + ref.topLeft.row + 1;\n        });\n    }).args([[\n            'ref',\n            [\n                'or',\n                'area',\n                'null'\n            ]\n        ]]);\n    defineFunction('rows', function (m) {\n        return m instanceof Ref ? m.height() : m.height;\n    }).args([[\n            'ref',\n            [\n                'or',\n                'area',\n                '#matrix'\n            ]\n        ]]);\n    defineFunction('vlookup', function (value, m, col, approx) {\n        var resultRow = null;\n        m.eachRow(function (row) {\n            var data = m.get(row, 0);\n            if (approx) {\n                if (data > value) {\n                    return true;\n                }\n                resultRow = row;\n            } else if (data === value) {\n                resultRow = row;\n                return true;\n            }\n        });\n        if (resultRow == null) {\n            return new CalcError('N/A');\n        }\n        return m.get(resultRow, col - 1);\n    }).args([\n        [\n            'value',\n            'anyvalue'\n        ],\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            'col',\n            'integer++'\n        ],\n        [\n            'approx',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('date', function (year, month, date) {\n        return packDate(year, month - 1, date);\n    }).args([\n        [\n            '*year',\n            'integer'\n        ],\n        [\n            '*month',\n            'integer'\n        ],\n        [\n            '*date',\n            'integer'\n        ]\n    ]);\n    defineFunction('day', function (date) {\n        return unpackDate(date).date;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('month', function (date) {\n        return unpackDate(date).month + 1;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('year', function (date) {\n        return unpackDate(date).year;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('weekday', function (date) {\n        return unpackDate(date).day + 1;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('weeknum', function (date, type) {\n        var fw = packDate(unpackDate(date).year, 0, 1);\n        var sy = unpackDate(fw);\n        var diff;\n        if (type == 21) {\n            diff = 3 - (sy.day + 6) % 7;\n            if (diff < 0) {\n                diff += 7;\n            }\n            fw += diff;\n            sy.date += diff;\n            sy.day = 4;\n            type = 1;\n        } else {\n            if (type == 1) {\n                type = 0;\n            } else if (type == 2) {\n                type = 1;\n            } else {\n                type = (type - 10) % 7;\n            }\n        }\n        diff = sy.day - type;\n        if (diff < 0) {\n            diff += 7;\n        }\n        fw -= diff;\n        return Math.ceil((date + 1 - fw) / 7);\n    }).args([\n        [\n            '*date',\n            'date'\n        ],\n        [\n            '*type',\n            [\n                'or',\n                [\n                    'null',\n                    1\n                ],\n                [\n                    'values',\n                    1,\n                    2,\n                    11,\n                    12,\n                    13,\n                    14,\n                    15,\n                    16,\n                    17,\n                    21\n                ]\n            ]\n        ]\n    ]);\n    function weeksInYear(year) {\n        var d = unpackDate(packDate(year, 0, 1));\n        if (d.day == 4 || d.day == 3 && runtime.isLeapYear(year)) {\n            return 53;\n        }\n        return 52;\n    }\n    defineFunction('isoweeknum', function isoweeknum(date) {\n        var d = unpackDate(date);\n        var dow = d.day || 7;\n        var wk = Math.floor((d.ord - dow + 10) / 7);\n        if (wk < 1) {\n            return weeksInYear(d.year - 1);\n        } else if (wk == 53 && wk > weeksInYear(d.year)) {\n            return 1;\n        }\n        return wk;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('now', function () {\n        return runtime.dateToSerial(new Date());\n    }).args([]);\n    defineFunction('today', function () {\n        return runtime.dateToSerial(new Date()) | 0;\n    }).args([]);\n    defineFunction('time', function (hh, mm, ss) {\n        return runtime.packTime(hh, mm, ss, 0);\n    }).args([\n        [\n            '*hours',\n            'integer'\n        ],\n        [\n            '*minutes',\n            'integer'\n        ],\n        [\n            '*seconds',\n            'integer'\n        ]\n    ]);\n    defineFunction('hour', function (time) {\n        return runtime.unpackTime(time).hours;\n    }).args([[\n            '*time',\n            'datetime'\n        ]]);\n    defineFunction('minute', function (time) {\n        return runtime.unpackTime(time).minutes;\n    }).args([[\n            '*time',\n            'datetime'\n        ]]);\n    defineFunction('second', function (time) {\n        return runtime.unpackTime(time).seconds;\n    }).args([[\n            '*time',\n            'datetime'\n        ]]);\n    defineFunction('edate', function (base, months) {\n        var d = unpackDate(base);\n        var m = d.month + months;\n        var y = d.year + Math.floor(m / 12);\n        m %= 12;\n        if (m < 0) {\n            m += 12;\n        }\n        d = Math.min(d.date, daysInMonth(y, m));\n        return packDate(y, m, d);\n    }).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*months',\n            'integer'\n        ]\n    ]);\n    defineFunction('eomonth', function (base, months) {\n        var d = unpackDate(base);\n        var m = d.month + months;\n        var y = d.year + Math.floor(m / 12);\n        m %= 12;\n        if (m < 0) {\n            m += 12;\n        }\n        d = daysInMonth(y, m);\n        return packDate(y, m, d);\n    }).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*months',\n            'integer'\n        ]\n    ]);\n    defineFunction('workday', function (date, n, holidays) {\n        var inc = n > 0 ? 1 : -1;\n        n = Math.abs(n);\n        var dow = unpackDate(date).day;\n        while (n > 0) {\n            date += inc;\n            dow = (dow + inc) % 7;\n            if (dow > 0 && dow < 6 && holidays.indexOf(date) < 0) {\n                --n;\n            }\n        }\n        return date;\n    }).args([\n        [\n            'start_date',\n            'date'\n        ],\n        [\n            'days',\n            'integer'\n        ],\n        [\n            'holidays',\n            [\n                'collect',\n                'date'\n            ]\n        ]\n    ]);\n    defineFunction('networkdays', function (date, end, holidays) {\n        if (date > end) {\n            var tmp = date;\n            date = end;\n            end = tmp;\n        }\n        var count = 0;\n        var dow = unpackDate(date).day;\n        while (date <= end) {\n            if (dow > 0 && dow < 6 && holidays.indexOf(date) < 0) {\n                count++;\n            }\n            date++;\n            dow = (dow + 1) % 7;\n        }\n        return count;\n    }).args([\n        [\n            'start_date',\n            'date'\n        ],\n        [\n            'end_date',\n            'date'\n        ],\n        [\n            'holidays',\n            [\n                'collect',\n                'date'\n            ]\n        ]\n    ]);\n    defineFunction('days', function (start, end) {\n        return end - start;\n    }).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*end_date',\n            'date'\n        ]\n    ]);\n    function _days_360(start, end, method) {\n        var d1 = unpackDate(start);\n        var d2 = unpackDate(end);\n        if (method) {\n            if (d1.date == 31) {\n                d1.date = 30;\n            }\n            if (d2.date == 31) {\n                d2.date = 30;\n            }\n        } else {\n            if (d1.month == 1 && d2.month == 1 && d1.date == daysInMonth(d1.year, 1) && d2.date == daysInMonth(d2.year, 1)) {\n                d2.date = 30;\n            }\n            if (d1.date == daysInMonth(d1.year, d1.month)) {\n                d1.date = 30;\n                if (d2.date == 31) {\n                    d2.date = 30;\n                }\n            } else {\n                if (d1.date == 30 && d2.date == 31) {\n                    d2.date = 30;\n                }\n            }\n        }\n        return 360 * (d2.year - d1.year) + 30 * (d2.month - d1.month) + (d2.date - d1.date);\n    }\n    runtime._days_360 = _days_360;\n    defineFunction('days360', _days_360).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*end_date',\n            'date'\n        ],\n        [\n            '*method',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    'false'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('yearfrac', function (start, end, method) {\n        switch (method) {\n        case 0:\n            return _days_360(start, end, false) / 360;\n        case 1:\n            return (end - start) / daysInYear(unpackDate(start).year);\n        case 2:\n            return (end - start) / 360;\n        case 3:\n            return (end - start) / 365;\n        case 4:\n            return _days_360(start, end, true) / 360;\n        }\n    }).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*end_date',\n            'date'\n        ],\n        [\n            '*method',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'values',\n                    0,\n                    1,\n                    2,\n                    3,\n                    4\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('datevalue', function (text) {\n        var date = runtime.parseDate(text);\n        if (date) {\n            return runtime.dateToSerial(date);\n        }\n        return new CalcError('VALUE');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('timevalue', function (text) {\n        var m = text.toLowerCase().match(/(\\d+):(\\d+)(:(\\d+)(\\.(\\d+))?)?\\s*(am?|pm?)?/);\n        if (m) {\n            var hh = parseFloat(m[1]);\n            var mm = parseFloat(m[2]);\n            var ss = m[3] ? parseFloat(m[4]) : 0;\n            var ampm = m[7];\n            if (ampm && (hh > 12 || hh < 1)) {\n                return new CalcError('VALUE');\n            }\n            if (/^p/.test(ampm)) {\n                hh += 12;\n            }\n            return runtime.packTime(hh, mm, ss, 0);\n        }\n        return new CalcError('VALUE');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('mdeterm', function (m) {\n        var error = m.each(function (val) {\n            if (typeof val != 'number') {\n                return new CalcError('VALUE');\n            }\n        }, true);\n        return error || m.determinant();\n    }).args([[\n            'm',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$m.width == $m.height'\n                ]\n            ]\n        ]]);\n    defineFunction('transpose', function (m) {\n        return m.transpose();\n    }).args([[\n            'range',\n            'matrix'\n        ]]);\n    defineFunction('mmult', function (a, b) {\n        return a.multiply(b);\n    }).args([\n        [\n            'a',\n            'matrix'\n        ],\n        [\n            'b',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$b.height == $a.width'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('munit', function (n) {\n        return new Matrix(this).unit(n);\n    }).args([[\n            'n',\n            'integer+'\n        ]]);\n    defineFunction('minverse', function (m) {\n        var error = m.each(function (val) {\n            if (typeof val != 'number') {\n                return new CalcError('VALUE');\n            }\n        }, true);\n        return error || m.inverse() || new CalcError('VALUE');\n    }).args([[\n            'm',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$m.width == $m.height'\n                ]\n            ]\n        ]]);\n    defineFunction('rand', function () {\n        return Math.random();\n    }).args([]);\n    defineFunction('randbetween', function (min, max) {\n        return min + Math.floor((max - min + 1) * Math.random());\n    }).args([\n        [\n            'min',\n            'integer'\n        ],\n        [\n            'max',\n            [\n                'and',\n                'integer',\n                [\n                    'assert',\n                    '$max >= $min'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('true', function () {\n        return true;\n    }).args([]);\n    defineFunction('false', function () {\n        return true;\n    }).args([]);\n    defineFunction('roman', function (num) {\n        return util.arabicToRoman(num).toUpperCase();\n    }).args([[\n            '*number',\n            'integer'\n        ]]);\n    defineFunction('arabic', function (rom) {\n        var num = util.romanToArabic(rom);\n        return num == null ? new CalcError('VALUE') : num;\n    }).args([[\n            '*roman',\n            'string'\n        ]]);\n    defineFunction('base', function (number, radix, minLen) {\n        var str = number.toString(radix).toUpperCase();\n        while (str.length < minLen) {\n            str = '0' + str;\n        }\n        return str;\n    }).args([\n        [\n            '*number',\n            'integer'\n        ],\n        [\n            '*radix',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    2,\n                    36\n                ]\n            ]\n        ],\n        [\n            '*minLen',\n            [\n                'or',\n                'integer+',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('decimal', function (text, radix) {\n        text = text.toUpperCase();\n        var val = 0;\n        for (var i = 0; i < text.length; ++i) {\n            var d = text.charCodeAt(i);\n            if (d >= 48 && d <= 57) {\n                d -= 48;\n            } else if (d >= 65 && d < 55 + radix) {\n                d -= 55;\n            } else {\n                return new CalcError('VALUE');\n            }\n            val = val * radix + d;\n        }\n        return val;\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*radix',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    2,\n                    36\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('char', function (code) {\n        return String.fromCharCode(code);\n    }).args([[\n            '*code',\n            'integer+'\n        ]]);\n    var RX_NON_PRINTABLE = /[\\0-\\x1F\\x7F-\\x9F\\xAD\\u0378\\u0379\\u037F-\\u0383\\u038B\\u038D\\u03A2\\u0528-\\u0530\\u0557\\u0558\\u0560\\u0588\\u058B-\\u058E\\u0590\\u05C8-\\u05CF\\u05EB-\\u05EF\\u05F5-\\u0605\\u061C\\u061D\\u06DD\\u070E\\u070F\\u074B\\u074C\\u07B2-\\u07BF\\u07FB-\\u07FF\\u082E\\u082F\\u083F\\u085C\\u085D\\u085F-\\u089F\\u08A1\\u08AD-\\u08E3\\u08FF\\u0978\\u0980\\u0984\\u098D\\u098E\\u0991\\u0992\\u09A9\\u09B1\\u09B3-\\u09B5\\u09BA\\u09BB\\u09C5\\u09C6\\u09C9\\u09CA\\u09CF-\\u09D6\\u09D8-\\u09DB\\u09DE\\u09E4\\u09E5\\u09FC-\\u0A00\\u0A04\\u0A0B-\\u0A0E\\u0A11\\u0A12\\u0A29\\u0A31\\u0A34\\u0A37\\u0A3A\\u0A3B\\u0A3D\\u0A43-\\u0A46\\u0A49\\u0A4A\\u0A4E-\\u0A50\\u0A52-\\u0A58\\u0A5D\\u0A5F-\\u0A65\\u0A76-\\u0A80\\u0A84\\u0A8E\\u0A92\\u0AA9\\u0AB1\\u0AB4\\u0ABA\\u0ABB\\u0AC6\\u0ACA\\u0ACE\\u0ACF\\u0AD1-\\u0ADF\\u0AE4\\u0AE5\\u0AF2-\\u0B00\\u0B04\\u0B0D\\u0B0E\\u0B11\\u0B12\\u0B29\\u0B31\\u0B34\\u0B3A\\u0B3B\\u0B45\\u0B46\\u0B49\\u0B4A\\u0B4E-\\u0B55\\u0B58-\\u0B5B\\u0B5E\\u0B64\\u0B65\\u0B78-\\u0B81\\u0B84\\u0B8B-\\u0B8D\\u0B91\\u0B96-\\u0B98\\u0B9B\\u0B9D\\u0BA0-\\u0BA2\\u0BA5-\\u0BA7\\u0BAB-\\u0BAD\\u0BBA-\\u0BBD\\u0BC3-\\u0BC5\\u0BC9\\u0BCE\\u0BCF\\u0BD1-\\u0BD6\\u0BD8-\\u0BE5\\u0BFB-\\u0C00\\u0C04\\u0C0D\\u0C11\\u0C29\\u0C34\\u0C3A-\\u0C3C\\u0C45\\u0C49\\u0C4E-\\u0C54\\u0C57\\u0C5A-\\u0C5F\\u0C64\\u0C65\\u0C70-\\u0C77\\u0C80\\u0C81\\u0C84\\u0C8D\\u0C91\\u0CA9\\u0CB4\\u0CBA\\u0CBB\\u0CC5\\u0CC9\\u0CCE-\\u0CD4\\u0CD7-\\u0CDD\\u0CDF\\u0CE4\\u0CE5\\u0CF0\\u0CF3-\\u0D01\\u0D04\\u0D0D\\u0D11\\u0D3B\\u0D3C\\u0D45\\u0D49\\u0D4F-\\u0D56\\u0D58-\\u0D5F\\u0D64\\u0D65\\u0D76-\\u0D78\\u0D80\\u0D81\\u0D84\\u0D97-\\u0D99\\u0DB2\\u0DBC\\u0DBE\\u0DBF\\u0DC7-\\u0DC9\\u0DCB-\\u0DCE\\u0DD5\\u0DD7\\u0DE0-\\u0DF1\\u0DF5-\\u0E00\\u0E3B-\\u0E3E\\u0E5C-\\u0E80\\u0E83\\u0E85\\u0E86\\u0E89\\u0E8B\\u0E8C\\u0E8E-\\u0E93\\u0E98\\u0EA0\\u0EA4\\u0EA6\\u0EA8\\u0EA9\\u0EAC\\u0EBA\\u0EBE\\u0EBF\\u0EC5\\u0EC7\\u0ECE\\u0ECF\\u0EDA\\u0EDB\\u0EE0-\\u0EFF\\u0F48\\u0F6D-\\u0F70\\u0F98\\u0FBD\\u0FCD\\u0FDB-\\u0FFF\\u10C6\\u10C8-\\u10CC\\u10CE\\u10CF\\u1249\\u124E\\u124F\\u1257\\u1259\\u125E\\u125F\\u1289\\u128E\\u128F\\u12B1\\u12B6\\u12B7\\u12BF\\u12C1\\u12C6\\u12C7\\u12D7\\u1311\\u1316\\u1317\\u135B\\u135C\\u137D-\\u137F\\u139A-\\u139F\\u13F5-\\u13FF\\u169D-\\u169F\\u16F1-\\u16FF\\u170D\\u1715-\\u171F\\u1737-\\u173F\\u1754-\\u175F\\u176D\\u1771\\u1774-\\u177F\\u17DE\\u17DF\\u17EA-\\u17EF\\u17FA-\\u17FF\\u180F\\u181A-\\u181F\\u1878-\\u187F\\u18AB-\\u18AF\\u18F6-\\u18FF\\u191D-\\u191F\\u192C-\\u192F\\u193C-\\u193F\\u1941-\\u1943\\u196E\\u196F\\u1975-\\u197F\\u19AC-\\u19AF\\u19CA-\\u19CF\\u19DB-\\u19DD\\u1A1C\\u1A1D\\u1A5F\\u1A7D\\u1A7E\\u1A8A-\\u1A8F\\u1A9A-\\u1A9F\\u1AAE-\\u1AFF\\u1B4C-\\u1B4F\\u1B7D-\\u1B7F\\u1BF4-\\u1BFB\\u1C38-\\u1C3A\\u1C4A-\\u1C4C\\u1C80-\\u1CBF\\u1CC8-\\u1CCF\\u1CF7-\\u1CFF\\u1DE7-\\u1DFB\\u1F16\\u1F17\\u1F1E\\u1F1F\\u1F46\\u1F47\\u1F4E\\u1F4F\\u1F58\\u1F5A\\u1F5C\\u1F5E\\u1F7E\\u1F7F\\u1FB5\\u1FC5\\u1FD4\\u1FD5\\u1FDC\\u1FF0\\u1FF1\\u1FF5\\u1FFF\\u200B-\\u200F\\u202A-\\u202E\\u2060-\\u206F\\u2072\\u2073\\u208F\\u209D-\\u209F\\u20BB-\\u20CF\\u20F1-\\u20FF\\u218A-\\u218F\\u23F4-\\u23FF\\u2427-\\u243F\\u244B-\\u245F\\u2700\\u2B4D-\\u2B4F\\u2B5A-\\u2BFF\\u2C2F\\u2C5F\\u2CF4-\\u2CF8\\u2D26\\u2D28-\\u2D2C\\u2D2E\\u2D2F\\u2D68-\\u2D6E\\u2D71-\\u2D7E\\u2D97-\\u2D9F\\u2DA7\\u2DAF\\u2DB7\\u2DBF\\u2DC7\\u2DCF\\u2DD7\\u2DDF\\u2E3C-\\u2E7F\\u2E9A\\u2EF4-\\u2EFF\\u2FD6-\\u2FEF\\u2FFC-\\u2FFF\\u3040\\u3097\\u3098\\u3100-\\u3104\\u312E-\\u3130\\u318F\\u31BB-\\u31BF\\u31E4-\\u31EF\\u321F\\u32FF\\u4DB6-\\u4DBF\\u9FCD-\\u9FFF\\uA48D-\\uA48F\\uA4C7-\\uA4CF\\uA62C-\\uA63F\\uA698-\\uA69E\\uA6F8-\\uA6FF\\uA78F\\uA794-\\uA79F\\uA7AB-\\uA7F7\\uA82C-\\uA82F\\uA83A-\\uA83F\\uA878-\\uA87F\\uA8C5-\\uA8CD\\uA8DA-\\uA8DF\\uA8FC-\\uA8FF\\uA954-\\uA95E\\uA97D-\\uA97F\\uA9CE\\uA9DA-\\uA9DD\\uA9E0-\\uA9FF\\uAA37-\\uAA3F\\uAA4E\\uAA4F\\uAA5A\\uAA5B\\uAA7C-\\uAA7F\\uAAC3-\\uAADA\\uAAF7-\\uAB00\\uAB07\\uAB08\\uAB0F\\uAB10\\uAB17-\\uAB1F\\uAB27\\uAB2F-\\uABBF\\uABEE\\uABEF\\uABFA-\\uABFF\\uD7A4-\\uD7AF\\uD7C7-\\uD7CA\\uD7FC-\\uF8FF\\uFA6E\\uFA6F\\uFADA-\\uFAFF\\uFB07-\\uFB12\\uFB18-\\uFB1C\\uFB37\\uFB3D\\uFB3F\\uFB42\\uFB45\\uFBC2-\\uFBD2\\uFD40-\\uFD4F\\uFD90\\uFD91\\uFDC8-\\uFDEF\\uFDFE\\uFDFF\\uFE1A-\\uFE1F\\uFE27-\\uFE2F\\uFE53\\uFE67\\uFE6C-\\uFE6F\\uFE75\\uFEFD-\\uFF00\\uFFBF-\\uFFC1\\uFFC8\\uFFC9\\uFFD0\\uFFD1\\uFFD8\\uFFD9\\uFFDD-\\uFFDF\\uFFE7\\uFFEF-\\uFFFB\\uFFFE\\uFFFF]/g;\n    defineFunction('clean', function (text) {\n        return text.replace(RX_NON_PRINTABLE, '');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('code', function (text) {\n        return text.charAt(0);\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineAlias('unichar', 'char');\n    defineAlias('unicode', 'code');\n    defineFunction('concatenate', function () {\n        var out = '';\n        for (var i = 0; i < arguments.length; ++i) {\n            out += arguments[i];\n        }\n        return out;\n    }).args([[\n            '+',\n            [\n                '*text',\n                'string'\n            ]\n        ]]);\n    defineFunction('dollar', function (number, decimals) {\n        var format = '$#,##0.DECIMALS;($#,##0.DECIMALS)';\n        var dec = '';\n        while (decimals-- > 0) {\n            dec += '0';\n        }\n        format = format.replace(/DECIMALS/g, dec);\n        return spreadsheet.formatting.text(number, format);\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*decimals',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    2\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('exact', function (a, b) {\n        return a === b;\n    }).args([\n        [\n            '*text1',\n            'string'\n        ],\n        [\n            '*text2',\n            'string'\n        ]\n    ]);\n    defineFunction('find', function (substring, string, start) {\n        var pos = string.indexOf(substring, start - 1);\n        return pos < 0 ? new CalcError('VALUE') : pos + 1;\n    }).args([\n        [\n            '*substring',\n            'string'\n        ],\n        [\n            '*string',\n            'string'\n        ],\n        [\n            '*start',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('fixed', function (number, decimals, noCommas) {\n        var format = noCommas ? '0.DECIMALS' : '#,##0.DECIMALS';\n        var dec = '';\n        while (decimals-- > 0) {\n            dec += '0';\n        }\n        format = format.replace(/DECIMALS/g, dec);\n        return spreadsheet.formatting.text(number, format);\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*decimals',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    2\n                ]\n            ]\n        ],\n        [\n            '*noCommas',\n            [\n                'or',\n                'boolean',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('left', function (text, length) {\n        return text.substr(0, length);\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*length',\n            [\n                'or',\n                'integer+',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('right', function (text, length) {\n        return text.substr(-length);\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*length',\n            [\n                'or',\n                'integer+',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('len', function (text) {\n        return text.length;\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('lower', function (text) {\n        return text.toLowerCase();\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('upper', function (text) {\n        return text.toUpperCase();\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('ltrim', function (text) {\n        return text.replace(/^\\s+/, '');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('rtrim', function (text) {\n        return text.replace(/\\s+$/, '');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('trim', function (text) {\n        return text.replace(/^\\s+|\\s+$/, '');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('mid', function (text, start, length) {\n        return text.substr(start - 1, length);\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*start',\n            'integer++'\n        ],\n        [\n            '*length',\n            'integer+'\n        ]\n    ]);\n    defineFunction('proper', function (text) {\n        return text.toLowerCase().replace(/\\b./g, function (s) {\n            return s.toUpperCase();\n        });\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('replace', function (text, start, length, newText) {\n        return text.substr(0, --start) + newText + text.substr(start + length);\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*start',\n            'integer++'\n        ],\n        [\n            '*length',\n            'integer+'\n        ],\n        [\n            '*newText',\n            'string'\n        ]\n    ]);\n    defineFunction('rept', function (text, number) {\n        var out = '';\n        while (number-- > 0) {\n            out += text;\n        }\n        return out;\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*number',\n            'integer+'\n        ]\n    ]);\n    defineFunction('search', function (substring, string, start) {\n        var pos = string.toLowerCase().indexOf(substring.toLowerCase(), start - 1);\n        return pos < 0 ? new CalcError('VALUE') : pos + 1;\n    }).args([\n        [\n            '*substring',\n            'string'\n        ],\n        [\n            '*string',\n            'string'\n        ],\n        [\n            '*start',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('substitute', function (text, oldText, newText, nth) {\n        if (oldText === newText) {\n            return text;\n        }\n        var pos = -1;\n        function replace() {\n            text = text.substring(0, pos) + newText + text.substring(pos + oldText.length);\n        }\n        while ((pos = text.indexOf(oldText, pos + 1)) >= 0) {\n            if (nth == null) {\n                replace();\n            } else if (--nth === 0) {\n                replace();\n                break;\n            }\n        }\n        return text;\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*oldText',\n            'string'\n        ],\n        [\n            '*newText',\n            'string'\n        ],\n        [\n            '*nth',\n            [\n                'or',\n                'integer++',\n                'null'\n            ]\n        ]\n    ]);\n    defineFunction('t', function (value) {\n        return typeof value == 'string' ? value : '';\n    }).args([[\n            '*value',\n            'anyvalue'\n        ]]);\n    defineFunction('text', function (value, format) {\n        return spreadsheet.formatting.text(value, format);\n    }).args([\n        [\n            '*value',\n            'anyvalue'\n        ],\n        [\n            '*format',\n            'string'\n        ]\n    ]);\n    defineFunction('value', function (value) {\n        if (typeof value == 'number') {\n            return value;\n        }\n        if (typeof value == 'boolean') {\n            return +value;\n        }\n        value = (value + '').replace(/[$€,]/g, '');\n        value = parseFloat(value);\n        return isNaN(value) ? new CalcError('VALUE') : value;\n    }).args([[\n            '*value',\n            'anyvalue'\n        ]]);\n    defineFunction('iferror', function (value, valueIfError) {\n        return value instanceof CalcError ? valueIfError : value;\n    }).args([\n        [\n            '*value',\n            'forced!'\n        ],\n        [\n            '*value_if_error',\n            'anyvalue'\n        ]\n    ]);\n    var parseCriteria = function () {\n        var RXCACHE = Object.create(null);\n        function makeComparator(cmp, x) {\n            if (typeof x == 'string') {\n                var num = parseFloat(x);\n                if (!isNaN(num) && num == x) {\n                    x = num;\n                }\n            }\n            return function (a) {\n                var b = x;\n                if (typeof a == 'string' && typeof b == 'string') {\n                    a = a.toLowerCase();\n                    b = b.toLowerCase();\n                }\n                return cmp(a, b);\n            };\n        }\n        function lc(a) {\n            if (typeof a == 'string') {\n                return a.toLowerCase();\n            }\n            return a;\n        }\n        function compLT(a, b) {\n            return lc(a) < lc(b);\n        }\n        function compLTE(a, b) {\n            return lc(a) <= lc(b);\n        }\n        function compGT(a, b) {\n            return lc(a) > lc(b);\n        }\n        function compGTE(a, b) {\n            return lc(a) >= lc(b);\n        }\n        function compNE(a, b) {\n            return lc(a) != lc(b);\n        }\n        function compEQ(a, b) {\n            if (b instanceof RegExp) {\n                return b.test(a);\n            }\n            return lc(a) == lc(b);\n        }\n        return function (cmp) {\n            if (typeof cmp == 'function') {\n                return cmp;\n            }\n            var m;\n            if (m = /^=(.*)$/.exec(cmp)) {\n                return makeComparator(compEQ, m[1]);\n            }\n            if (m = /^<>(.*)$/.exec(cmp)) {\n                return makeComparator(compNE, m[1]);\n            }\n            if (m = /^<=(.*)$/.exec(cmp)) {\n                return makeComparator(compLTE, m[1]);\n            }\n            if (m = /^<(.*)$/.exec(cmp)) {\n                return makeComparator(compLT, m[1]);\n            }\n            if (m = /^>=(.*)$/.exec(cmp)) {\n                return makeComparator(compGTE, m[1]);\n            }\n            if (m = /^>(.*)$/.exec(cmp)) {\n                return makeComparator(compGT, m[1]);\n            }\n            if (/[?*]/.exec(cmp)) {\n                var rx = RXCACHE[cmp];\n                if (!rx) {\n                    rx = cmp.replace(/(~\\?|~\\*|[\\]({\\+\\.\\|\\^\\$\\\\})\\[]|[?*])/g, function (s) {\n                        switch (s) {\n                        case '~?':\n                            return '\\\\?';\n                        case '~*':\n                            return '\\\\*';\n                        case '?':\n                            return '.';\n                        case '*':\n                            return '.*';\n                        default:\n                            return '\\\\' + s;\n                        }\n                    });\n                    rx = RXCACHE[cmp] = new RegExp('^' + rx + '$', 'i');\n                }\n                return makeComparator(compEQ, rx);\n            }\n            return makeComparator(compEQ, cmp);\n        };\n    }();\n    function numericPredicate(val) {\n        return typeof val == 'number' || typeof val == 'boolean' || val == null || val === '';\n    }\n    function ascending(a, b) {\n        return a === b ? 0 : a < b ? -1 : 1;\n    }\n    function descending(a, b) {\n        return a === b ? 0 : a < b ? 1 : -1;\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/runtime.functions.2', ['spreadsheet/runtime'], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var calc = spreadsheet.calc;\n    var runtime = calc.runtime;\n    var defineFunction = runtime.defineFunction;\n    var CalcError = runtime.CalcError;\n    var packDate = runtime.packDate;\n    var unpackDate = runtime.unpackDate;\n    var isLeapYear = runtime.isLeapYear;\n    var daysInMonth = runtime.daysInMonth;\n    var _days_360 = runtime._days_360;\n    defineFunction('ERF', function (ll, ul) {\n        if (ul == null) {\n            return ERF(ll);\n        }\n        return ERF(ul) - ERF(ll);\n    }).args([\n        [\n            'lower_limit',\n            'number'\n        ],\n        [\n            'upper_limit',\n            [\n                'or',\n                'number',\n                'null'\n            ]\n        ]\n    ]);\n    defineFunction('ERFC', ERFC).args([[\n            'x',\n            'number'\n        ]]);\n    defineFunction('GAMMALN', GAMMALN).args([[\n            'x',\n            'number++'\n        ]]);\n    defineFunction('GAMMA', GAMMA).args([[\n            'x',\n            'number'\n        ]]);\n    defineFunction('GAMMA.DIST', GAMMA_DIST).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('GAMMA.INV', GAMMA_INV).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ]\n    ]);\n    defineFunction('NORM.S.DIST', NORM_S_DIST).args([\n        [\n            'z',\n            'number'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('NORM.S.INV', NORM_S_INV).args([[\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ]]);\n    defineFunction('NORM.DIST', NORM_DIST).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'mean',\n            'number'\n        ],\n        [\n            'stddev',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('NORM.INV', NORM_INV).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'mean',\n            'number'\n        ],\n        [\n            'stddev',\n            'number++'\n        ]\n    ]);\n    defineFunction('BETADIST', BETADIST).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ],\n        [\n            'A',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'B',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$x >= $A',\n                'NUM'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$x <= $B',\n                'NUM'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$A < $B',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('BETA.DIST', BETA_DIST).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ],\n        [\n            'A',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'B',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$x >= $A',\n                'NUM'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$x <= $B',\n                'NUM'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$A < $B',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('BETA.INV', BETA_INV).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ],\n        [\n            'A',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'B',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('CHISQ.DIST', chisq_left).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('CHISQ.DIST.RT', chisq_right).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('CHISQ.INV', chisq_left_inv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('CHISQ.INV.RT', chisq_right_inv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('CHISQ.TEST', function (ac, ex) {\n        return chisq_test(ac.data, ex.data);\n    }).args([\n        [\n            'actual_range',\n            'matrix'\n        ],\n        [\n            'expected_range',\n            'matrix'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$actual_range.width == $expected_range.width'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$actual_range.height == $expected_range.height'\n            ]\n        ]\n    ]);\n    defineFunction('EXPON.DIST', expon).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'lambda',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('POISSON.DIST', poisson).args([\n        [\n            'x',\n            'integer+'\n        ],\n        [\n            'mean',\n            'number+'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('F.DIST', Fdist).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom1',\n            'integer++'\n        ],\n        [\n            'deg_freedom2',\n            'integer++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('F.DIST.RT', Fdist_right).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom1',\n            'integer++'\n        ],\n        [\n            'deg_freedom2',\n            'integer++'\n        ]\n    ]);\n    defineFunction('F.INV', Finv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom1',\n            'integer++'\n        ],\n        [\n            'deg_freedom2',\n            'integer++'\n        ]\n    ]);\n    defineFunction('F.INV.RT', Finv_right).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom1',\n            'integer++'\n        ],\n        [\n            'deg_freedom2',\n            'integer++'\n        ]\n    ]);\n    defineFunction('F.TEST', Ftest).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length >= 2',\n                'DIV/0'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array2.length >= 2',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('FISHER', fisher).args([[\n            'x',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    -1,\n                    1\n                ]\n            ]\n        ]]);\n    defineFunction('FISHERINV', fisherinv).args([[\n            'y',\n            'number'\n        ]]);\n    defineFunction('T.DIST', Tdist).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('T.DIST.RT', Tdist_right).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('T.DIST.2T', Tdist_2tail).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('T.INV', Tdist_inv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '(between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('T.INV.2T', Tdist_2tail_inv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '(between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('T.TEST', Tdist_test).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'tails',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2,\n                    3\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$type != 1 || $array1.length == $array2.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length >= 2',\n                'DIV/0'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array2.length >= 2',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('CONFIDENCE.T', confidence_t).args([\n        [\n            'alpha',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'standard_dev',\n            'number++'\n        ],\n        [\n            'size',\n            [\n                'and',\n                'integer++',\n                [\n                    'assert',\n                    '$size != 1',\n                    'DIV/0'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('CONFIDENCE.NORM', confidence_norm).args([\n        [\n            'alpha',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'standard_dev',\n            'number++'\n        ],\n        [\n            'size',\n            [\n                'and',\n                'integer++'\n            ]\n        ]\n    ]);\n    defineFunction('GAUSS', gauss).args([[\n            'z',\n            'number'\n        ]]);\n    defineFunction('PHI', phi).args([[\n            'x',\n            'number'\n        ]]);\n    defineFunction('LOGNORM.DIST', lognorm_dist).args([\n        [\n            'x',\n            'number++'\n        ],\n        [\n            'mean',\n            'number'\n        ],\n        [\n            'standard_dev',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('LOGNORM.INV', lognorm_inv).args([\n        [\n            'probability',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'mean',\n            'number'\n        ],\n        [\n            'standard_dev',\n            'number++'\n        ]\n    ]);\n    defineFunction('PROB', prob).args([\n        [\n            'x_range',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'prob_range',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'lower_limit',\n            'number'\n        ],\n        [\n            'upper_limit',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    '$lower_limit'\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$prob_range.length == $x_range.length',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('SLOPE', slope).args([\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length > 0 && $known_y.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('INTERCEPT', intercept).args([\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length > 0 && $known_y.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('PEARSON', pearson).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array2.length == $array1.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array2.length > 0 && $array1.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('RSQ', rsq).args([\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length > 0 && $known_y.length > 0',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length != 1 && $known_y.length != 1',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('STEYX', steyx).args([\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length >= 3 && $known_y.length >= 3',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('FORECAST', forecast).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length > 0 && $known_y.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('LINEST', linest).args([\n        [\n            'known_y',\n            'matrix'\n        ],\n        [\n            'known_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'const',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ],\n        [\n            'stats',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('LOGEST', logest).args([\n        [\n            'known_y',\n            'matrix'\n        ],\n        [\n            'known_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'const',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ],\n        [\n            'stats',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('TREND', trend).args([\n        [\n            'known_y',\n            'matrix'\n        ],\n        [\n            'known_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'new_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'const',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('GROWTH', growth).args([\n        [\n            'known_y',\n            'matrix'\n        ],\n        [\n            'known_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'new_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'const',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('FV', FV).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'nper',\n            'number'\n        ],\n        [\n            'pmt',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'pv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$pmt || $pv'\n            ]\n        ]\n    ]);\n    defineFunction('PV', PV).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'nper',\n            'number'\n        ],\n        [\n            'pmt',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$pmt || $fv'\n            ]\n        ]\n    ]);\n    defineFunction('PMT', PMT).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'nper',\n            'number'\n        ],\n        [\n            'pmt',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('NPER', NPER).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'pmt',\n            'number'\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('RATE', RATE).args([\n        [\n            'nper',\n            'number'\n        ],\n        [\n            'pmt',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'guess',\n            [\n                'or',\n                'number++',\n                [\n                    'null',\n                    0.01\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$pmt || $fv'\n            ]\n        ]\n    ]);\n    defineFunction('IPMT', IPMT).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'per',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$per >= 1 && $per <= $nper'\n            ]\n        ]\n    ]);\n    defineFunction('PPMT', PPMT).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'per',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$per >= 1 && $per <= $nper'\n            ]\n        ]\n    ]);\n    defineFunction('CUMPRINC', CUMPRINC).args([\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number++'\n        ],\n        [\n            'start_period',\n            'number++'\n        ],\n        [\n            'end_period',\n            'number++'\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$end_period >= $start_period',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('CUMIPMT', CUMIPMT).args([\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number++'\n        ],\n        [\n            'start_period',\n            'number++'\n        ],\n        [\n            'end_period',\n            'number++'\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$end_period >= $start_period',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('NPV', NPV).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'values',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$values.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('IRR', IRR).args([\n        [\n            'values',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'guess',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0.1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('EFFECT', EFFECT).args([\n        [\n            'nominal_rate',\n            'number++'\n        ],\n        [\n            'npery',\n            'integer++'\n        ]\n    ]);\n    defineFunction('NOMINAL', NOMINAL).args([\n        [\n            'effect_rate',\n            'number++'\n        ],\n        [\n            'npery',\n            'integer++'\n        ]\n    ]);\n    defineFunction('XNPV', XNPV).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'values',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'dates',\n            [\n                'collect',\n                'date',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$values.length == $dates.length',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('XIRR', XIRR).args([\n        [\n            'values',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'dates',\n            [\n                'collect',\n                'date',\n                1\n            ]\n        ],\n        [\n            'guess',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0.1\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$values.length == $dates.length',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('ISPMT', ISPMT).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'per',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$per >= 1 && $per <= $nper'\n            ]\n        ]\n    ]);\n    defineFunction('DB', DB).args([\n        [\n            'cost',\n            'number'\n        ],\n        [\n            'salvage',\n            'number'\n        ],\n        [\n            'life',\n            'number++'\n        ],\n        [\n            'period',\n            'number++'\n        ],\n        [\n            'month',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    12\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('DDB', DDB).args([\n        [\n            'cost',\n            'number'\n        ],\n        [\n            'salvage',\n            'number'\n        ],\n        [\n            'life',\n            'number++'\n        ],\n        [\n            'period',\n            'number++'\n        ],\n        [\n            'factor',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    2\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('SLN', SLN).args([\n        [\n            'cost',\n            'number'\n        ],\n        [\n            'salvage',\n            'number'\n        ],\n        [\n            'life',\n            'number++'\n        ]\n    ]);\n    defineFunction('SYD', SYD).args([\n        [\n            'cost',\n            'number'\n        ],\n        [\n            'salvage',\n            'number'\n        ],\n        [\n            'life',\n            'number++'\n        ],\n        [\n            'per',\n            'number++'\n        ]\n    ]);\n    defineFunction('VDB', VDB).args([\n        [\n            'cost',\n            'number+'\n        ],\n        [\n            'salvage',\n            'number+'\n        ],\n        [\n            'life',\n            'number++'\n        ],\n        [\n            'start_period',\n            'number+'\n        ],\n        [\n            'end_period',\n            'number+'\n        ],\n        [\n            'factor',\n            [\n                'or',\n                'number+',\n                [\n                    'null',\n                    2\n                ]\n            ]\n        ],\n        [\n            'no_switch',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$end_period >= $start_period',\n                'NUM'\n            ]\n        ]\n    ]);\n    var COUPS_ARGS = [\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'frequency',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2,\n                    4\n                ]\n            ]\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ];\n    defineFunction('COUPDAYBS', COUPDAYBS).args(COUPS_ARGS);\n    defineFunction('COUPDAYS', COUPDAYS).args(COUPS_ARGS);\n    defineFunction('COUPDAYSNC', COUPDAYSNC).args(COUPS_ARGS);\n    defineFunction('COUPPCD', COUPPCD).args(COUPS_ARGS);\n    defineFunction('COUPNCD', COUPNCD).args(COUPS_ARGS);\n    defineFunction('COUPNUM', COUPNUM).args(COUPS_ARGS);\n    defineFunction('ACCRINTM', ACCRINTM).args([\n        [\n            'issue',\n            'date'\n        ],\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'par',\n            [\n                'or',\n                [\n                    'null',\n                    1000\n                ],\n                'number++'\n            ]\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$issue < $settlement',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('ACCRINT', ACCRINT).args([\n        [\n            'issue',\n            'date'\n        ],\n        [\n            'first_interest',\n            'date'\n        ],\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'par',\n            [\n                'or',\n                [\n                    'null',\n                    1000\n                ],\n                'number++'\n            ]\n        ],\n        [\n            'frequency',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2,\n                    4\n                ]\n            ]\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            'calc_method',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$issue < $settlement',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('DISC', DISC).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'pr',\n            'number++'\n        ],\n        [\n            'redemption',\n            'number++'\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('INTRATE', INTRATE).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'investment',\n            'number++'\n        ],\n        [\n            'redemption',\n            'number++'\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('RECEIVED', RECEIVED).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'investment',\n            'number++'\n        ],\n        [\n            'discount',\n            'number++'\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('PRICE', PRICE).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'yld',\n            'number++'\n        ],\n        [\n            'redemption',\n            'number++'\n        ],\n        [\n            'frequency',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2,\n                    4\n                ]\n            ]\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('PRICEDISC', PRICEDISC).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'discount',\n            'number++'\n        ],\n        [\n            'redemption',\n            'number++'\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    var MAX_IT = 300, EPS = 2.2204e-16, FP_MIN = 1e-30, f_abs = Math.abs;\n    function ERF(x) {\n        if (f_abs(x) >= 3.3) {\n            return 1 - ERFC(x);\n        }\n        var S = x > 0 ? 1 : -1;\n        if (S == -1) {\n            x = -x;\n        }\n        var m = 0, an = 1;\n        for (var n = 1; n < 100; n++) {\n            m += an;\n            an *= 2 * x * x / (2 * n + 1);\n        }\n        return S * 2 / Math.sqrt(Math.PI) * x * Math.exp(-x * x) * m;\n    }\n    function ERFC(x) {\n        if (f_abs(x) < 3.3) {\n            return 1 - ERF(x);\n        }\n        var s = 1;\n        if (x < 0) {\n            s = -1;\n            x = -x;\n        }\n        var frac = x;\n        for (var n = 8; n >= 1; n -= 0.5) {\n            frac = x + n / frac;\n        }\n        frac = 1 / (x + frac);\n        return s == 1 ? Math.exp(-x * x) / Math.sqrt(Math.PI) * frac : 2 - Math.exp(-x * x) / Math.sqrt(Math.PI) * frac;\n    }\n    function GAMMALN(x) {\n        var cof = [\n            1.000000000190015,\n            76.18009172947146,\n            -86.50532032941678,\n            24.01409824083091,\n            -1.231739572450155,\n            0.001208650973866179,\n            -0.000005395239384953\n        ];\n        var y = x, tmp = x + 5.5, ser = cof[0];\n        tmp -= (x + 0.5) * Math.log(tmp);\n        for (var j = 1; j <= 6; j++) {\n            y += 1;\n            ser += cof[j] / y;\n        }\n        return -tmp + Math.log(Math.sqrt(2 * Math.PI) * ser / x);\n    }\n    function GAMMA(x) {\n        if (x > 0) {\n            return Math.exp(GAMMALN(x));\n        }\n        var pi = Math.PI, y = -x;\n        return -pi / (y * GAMMA(y) * Math.sin(pi * y));\n    }\n    function BETALN(a, b) {\n        return GAMMALN(a) + GAMMALN(b) - GAMMALN(a + b);\n    }\n    function BETA(a, b) {\n        return Math.exp(BETALN(a, b));\n    }\n    function gamma_inc(a, x) {\n        return x < a + 1 ? g_series(a, x) : 1 - g_contfrac(a, x);\n    }\n    function g_series(a, x) {\n        var sum = 1 / a, frac = sum, ap = a;\n        var gln = GAMMALN(a), n;\n        for (n = 1; n <= MAX_IT; n++) {\n            ap++;\n            frac *= x / ap;\n            sum += frac;\n            if (f_abs(frac) < f_abs(sum) * EPS) {\n                break;\n            }\n        }\n        return sum * Math.exp(-x + a * Math.log(x) - gln);\n    }\n    function g_contfrac(a, x) {\n        var f = FP_MIN, c = f, d = 0, aj = 1, bj = x + 1 - a;\n        var gln = GAMMALN(a);\n        for (var i = 1; i <= MAX_IT; i++) {\n            d = bj + aj * d;\n            if (f_abs(d) < FP_MIN) {\n                d = FP_MIN;\n            }\n            c = bj + aj / c;\n            if (f_abs(c) < FP_MIN) {\n                c = FP_MIN;\n            }\n            d = 1 / d;\n            var delta = c * d;\n            f *= delta;\n            if (f_abs(delta - 1) < EPS) {\n                break;\n            }\n            bj += 2;\n            aj = -i * (i - a);\n        }\n        return f * Math.exp(-x - gln + a * Math.log(x));\n    }\n    function GAMMA_DIST(x, a, b, cumulative) {\n        if (!cumulative) {\n            return Math.pow(x / b, a - 1) * Math.exp(-x / b) / (b * GAMMA(a));\n        }\n        return gamma_inc(a, x / b);\n    }\n    function GAMMA_INV(p, a, b) {\n        if (p === 0) {\n            return 0;\n        }\n        if (p == 1) {\n            return Infinity;\n        }\n        var m = 0, M = 10, x = 0, ab = a * b;\n        if (ab > 1) {\n            M *= ab;\n        }\n        for (var i = 0; i < MAX_IT; i++) {\n            x = 0.5 * (m + M);\n            var q = GAMMA_DIST(x, a, b, true);\n            if (f_abs(p - q) < 1e-16) {\n                break;\n            }\n            if (q > p) {\n                M = x;\n            } else {\n                m = x;\n            }\n        }\n        return x;\n    }\n    function NORM_S_DIST(x, cumulative) {\n        if (!cumulative) {\n            return Math.exp(-x * x / 2) / Math.sqrt(2 * Math.PI);\n        }\n        return 0.5 + 0.5 * ERF(x / Math.sqrt(2));\n    }\n    function NORM_S_INV(p) {\n        var a = [\n                -39.69683028665376,\n                220.9460984245205,\n                -275.9285104469687,\n                138.357751867269,\n                -30.66479806614716,\n                2.506628277459239\n            ], b = [\n                -54.47609879822406,\n                161.5858368580409,\n                -155.6989798598866,\n                66.80131188771972,\n                -13.28068155288572\n            ], c = [\n                -0.007784894002430293,\n                -0.3223964580411365,\n                -2.400758277161838,\n                -2.549732539343734,\n                4.374664141464968,\n                2.938163982698783\n            ], d = [\n                0.007784695709041462,\n                0.3224671290700398,\n                2.445134137142996,\n                3.754408661907416\n            ];\n        var plow = 0.02425, phigh = 1 - plow;\n        var q, r;\n        if (p < plow) {\n            q = Math.sqrt(-2 * Math.log(p));\n            return (((((c[0] * q + c[1]) * q + c[2]) * q + c[3]) * q + c[4]) * q + c[5]) / ((((d[0] * q + d[1]) * q + d[2]) * q + d[3]) * q + 1);\n        }\n        if (phigh < p) {\n            q = Math.sqrt(-2 * Math.log(1 - p));\n            return -(((((c[0] * q + c[1]) * q + c[2]) * q + c[3]) * q + c[4]) * q + c[5]) / ((((d[0] * q + d[1]) * q + d[2]) * q + d[3]) * q + 1);\n        }\n        q = p - 0.5;\n        r = q * q;\n        return (((((a[0] * r + a[1]) * r + a[2]) * r + a[3]) * r + a[4]) * r + a[5]) * q / (((((b[0] * r + b[1]) * r + b[2]) * r + b[3]) * r + b[4]) * r + 1);\n    }\n    function NORM_DIST(x, m, s, cumulative) {\n        if (!cumulative) {\n            return Math.exp(-(x - m) * (x - m) / (2 * s * s)) / (s * Math.sqrt(2 * Math.PI));\n        }\n        return NORM_S_DIST((x - m) / s, true);\n    }\n    function NORM_INV(p, m, s) {\n        return m + s * NORM_S_INV(p);\n    }\n    function betastd_pdf(x, a, b) {\n        return Math.exp((a - 1) * Math.log(x) + (b - 1) * Math.log(1 - x) - BETALN(a, b));\n    }\n    function betastd_cdf(x, a, b) {\n        var k = Math.exp(a * Math.log(x) + b * Math.log(1 - x) - BETALN(a, b));\n        return x < (a + 1) / (a + b + 2) ? k * beta_lentz(a, b, x) / a : 1 - k * beta_lentz(b, a, 1 - x) / b;\n    }\n    function beta_lentz(a, b, x) {\n        var m, m2;\n        var aa, c, d, del, h, qab, qam, qap;\n        qab = a + b;\n        qap = a + 1;\n        qam = a - 1;\n        c = 1;\n        d = 1 - qab * x / qap;\n        if (f_abs(d) < FP_MIN) {\n            d = FP_MIN;\n        }\n        d = 1 / d;\n        h = d;\n        for (m = 1; m <= MAX_IT; m++) {\n            m2 = 2 * m;\n            aa = m * (b - m) * x / ((qam + m2) * (a + m2));\n            d = 1 + aa * d;\n            if (f_abs(d) < FP_MIN) {\n                d = FP_MIN;\n            }\n            c = 1 + aa / c;\n            if (f_abs(c) < FP_MIN) {\n                c = FP_MIN;\n            }\n            d = 1 / d;\n            h *= d * c;\n            aa = -(a + m) * (qab + m) * x / ((a + m2) * (qap + m2));\n            d = 1 + aa * d;\n            if (f_abs(d) < FP_MIN) {\n                d = FP_MIN;\n            }\n            c = 1 + aa / c;\n            if (f_abs(c) < FP_MIN) {\n                c = FP_MIN;\n            }\n            d = 1 / d;\n            del = d * c;\n            h *= del;\n            if (f_abs(del - 1) < EPS) {\n                break;\n            }\n        }\n        return h;\n    }\n    function betastd_inv(p, a, b) {\n        var m = 0, M = 1, x = 0;\n        for (var i = 0; i < MAX_IT; i++) {\n            x = 0.5 * (m + M);\n            var q = betastd_cdf(x, a, b);\n            if (f_abs(p - q) < EPS) {\n                break;\n            }\n            if (q > p) {\n                M = x;\n            } else {\n                m = x;\n            }\n        }\n        return x;\n    }\n    function BETADIST(x, a, b, m, M) {\n        return betastd_cdf((x - m) / (M - m), a, b);\n    }\n    function BETA_DIST(x, a, b, cdf, m, M) {\n        if (cdf) {\n            return betastd_cdf((x - m) / (M - m), a, b);\n        }\n        return betastd_pdf((x - m) / (M - m), a, b) / (M - m);\n    }\n    function BETA_INV(p, a, b, m, M) {\n        return m + (M - m) * betastd_inv(p, a, b);\n    }\n    function chisq_left(x, n, cds) {\n        return GAMMA_DIST(x, n / 2, 2, cds);\n    }\n    function chisq_right(x, n) {\n        return 1 - chisq_left(x, n, true);\n    }\n    function chisq_left_inv(p, n) {\n        return GAMMA_INV(p, n / 2, 2);\n    }\n    function chisq_right_inv(p, n) {\n        return chisq_left_inv(1 - p, n);\n    }\n    function chisq_test(obsv, expect) {\n        var rows = obsv.length, cols = obsv[0].length;\n        var x = 0, i, j;\n        for (i = 0; i < rows; i++) {\n            for (j = 0; j < cols; j++) {\n                var eij = expect[i][j];\n                var delta = obsv[i][j] - eij;\n                delta *= delta;\n                x += delta / eij;\n            }\n        }\n        var n = (rows - 1) * (cols - 1);\n        return chisq_right(x, n);\n    }\n    function expon(x, r, cdf) {\n        if (cdf) {\n            return 1 - Math.exp(-r * x);\n        }\n        return r * Math.exp(-r * x);\n    }\n    function poisson(k, m, cdf) {\n        if (cdf) {\n            return 1 - chisq_left(2 * m, 2 * (k + 1), true);\n        }\n        var lnf = 0;\n        for (var i = 2; i <= k; i++) {\n            lnf += Math.log(i);\n        }\n        return Math.exp(k * Math.log(m) - m - lnf);\n    }\n    function Fdist(x, n, d, cdf) {\n        if (cdf) {\n            return betastd_cdf(n * x / (d + n * x), n / 2, d / 2);\n        }\n        var u = n / d;\n        n /= 2;\n        d /= 2;\n        return u / BETA(n, d) * Math.pow(u * x, n - 1) / Math.pow(1 + u * x, n + d);\n    }\n    function Fdist_right(x, n, d) {\n        return 1 - Fdist(x, n, d, true);\n    }\n    function Finv_right(p, n, d) {\n        return d / n * (1 / BETA_INV(p, d / 2, n / 2, 0, 1) - 1);\n    }\n    function Finv(p, n, d) {\n        return d / n * (1 / BETA_INV(1 - p, d / 2, n / 2, 0, 1) - 1);\n    }\n    function _mean(arr) {\n        var me = 0, n = arr.length;\n        for (var i = 0; i < n; i++) {\n            me += arr[i];\n        }\n        return me / n;\n    }\n    function _var_sq(arr, m) {\n        var v = 0, n = arr.length;\n        for (var i = 0; i < n; i++) {\n            var delta = arr[i] - m;\n            v += delta * delta;\n        }\n        return v / (n - 1);\n    }\n    function Ftest(arr1, arr2) {\n        var n1 = arr1.length - 1, n2 = arr2.length - 1;\n        var va1 = _var_sq(arr1, _mean(arr1)), va2 = _var_sq(arr2, _mean(arr2));\n        if (!va1 || !va2) {\n            throw new CalcError('DIV/0');\n        }\n        return 2 * Fdist(va1 / va2, n1, n2, true);\n    }\n    function fisher(x) {\n        return 0.5 * Math.log((1 + x) / (1 - x));\n    }\n    function fisherinv(x) {\n        var e2 = Math.exp(2 * x);\n        return (e2 - 1) / (e2 + 1);\n    }\n    function Tdist(x, n, cdf) {\n        if (cdf) {\n            return 1 - 0.5 * betastd_cdf(n / (x * x + n), n / 2, 0.5);\n        }\n        return 1 / (Math.sqrt(n) * BETA(0.5, n / 2)) * Math.pow(1 + x * x / n, -(n + 1) / 2);\n    }\n    function Tdist_right(x, n) {\n        return 1 - Tdist(x, n, true);\n    }\n    function Tdist_2tail(x, n) {\n        if (x < 0) {\n            x = -x;\n        }\n        return 2 * Tdist_right(x, n);\n    }\n    function Tdist_inv(p, n) {\n        var x = betastd_inv(2 * Math.min(p, 1 - p), n / 2, 0.5);\n        x = Math.sqrt(n * (1 - x) / x);\n        return p > 0.5 ? x : -x;\n    }\n    function Tdist_2tail_inv(p, n) {\n        return Tdist_inv(1 - p / 2, n);\n    }\n    function Tdist_test(gr1, gr2, tail, type) {\n        var n1 = gr1.length, n2 = gr2.length;\n        var t_st, df;\n        if (type == 1) {\n            var d = 0, d2 = 0;\n            for (var i = 0; i < n1; i++) {\n                var delta = gr1[i] - gr2[i];\n                d += delta;\n                d2 += delta * delta;\n            }\n            var md = d / n1;\n            t_st = md / Math.sqrt((d2 - d * md) / (n1 * (n1 - 1)));\n            return tail == 1 ? Tdist_right(t_st, n1 - 1) : Tdist_2tail(t_st, n1 - 1);\n        }\n        var m1 = _mean(gr1), m2 = _mean(gr2), v1 = _var_sq(gr1, m1), v2 = _var_sq(gr2, m2);\n        if (type == 3) {\n            var u1 = v1 / n1, u2 = v2 / n2, u = u1 + u2;\n            var q1 = u1 / u, q2 = u2 / u;\n            df = 1 / (q1 * q1 / (n1 - 1) + q2 * q2 / (n2 - 1));\n            t_st = f_abs(m1 - m2) / Math.sqrt(u);\n            return tail == 1 ? Tdist_right(t_st, df) : Tdist_2tail(t_st, df);\n        } else {\n            df = n1 + n2 - 2;\n            t_st = f_abs(m1 - m2) * Math.sqrt(df * n1 * n2 / ((n1 + n2) * ((n1 - 1) * v1 + (n2 - 1) * v2)));\n            return tail == 1 ? Tdist_right(t_st, df) : Tdist_2tail(t_st, df);\n        }\n    }\n    function confidence_t(alpha, stddev, size) {\n        return -Tdist_inv(alpha / 2, size - 1) * stddev / Math.sqrt(size);\n    }\n    function confidence_norm(alpha, stddev, size) {\n        return -NORM_S_INV(alpha / 2) * stddev / Math.sqrt(size);\n    }\n    function gauss(z) {\n        return NORM_S_DIST(z, true) - 0.5;\n    }\n    function phi(x) {\n        return NORM_S_DIST(x);\n    }\n    function lognorm_dist(x, m, s, cumulative) {\n        if (cumulative) {\n            return 0.5 + 0.5 * ERF((Math.log(x) - m) / (s * Math.sqrt(2)));\n        }\n        var t = Math.log(x) - m;\n        return Math.exp(-t * t / (2 * s * s)) / (x * s * Math.sqrt(2 * Math.PI));\n    }\n    function lognorm_inv(p, m, s) {\n        return Math.exp(NORM_INV(p, m, s));\n    }\n    function prob(x_, p_, lw, up) {\n        var n = x_.length;\n        var s = 0, i;\n        for (i = 0; i < n; i++) {\n            if (p_[i] <= 0 || p_[i] > 1) {\n                throw new CalcError('NUM');\n            }\n            s += p_[i];\n        }\n        if (s != 1) {\n            throw new CalcError('NUM');\n        }\n        var res = 0;\n        for (i = 0; i < n; i++) {\n            var x = x_[i];\n            if (x >= lw && x <= up) {\n                res += p_[i];\n            }\n        }\n        return res;\n    }\n    function slope(y_, x_) {\n        var mx = _mean(x_), my = _mean(y_), b1 = 0, b2 = 0;\n        for (var i = 0, n = y_.length; i < n; i++) {\n            var t = x_[i] - mx;\n            b1 += t * (y_[i] - my);\n            b2 += t * t;\n        }\n        return b1 / b2;\n    }\n    function intercept(y_, x_) {\n        var mx = _mean(x_), my = _mean(y_);\n        var b1 = 0, b2 = 0;\n        for (var i = 0, n = y_.length; i < n; i++) {\n            var t = x_[i] - mx;\n            b1 += t * (y_[i] - my);\n            b2 += t * t;\n        }\n        return my - b1 * mx / b2;\n    }\n    function pearson(x_, y_) {\n        var mx = _mean(x_), my = _mean(y_);\n        var s1 = 0, s2 = 0, s3 = 0;\n        for (var i = 0, n = x_.length; i < n; i++) {\n            var t1 = x_[i] - mx, t2 = y_[i] - my;\n            s1 += t1 * t2;\n            s2 += t1 * t1;\n            s3 += t2 * t2;\n        }\n        return s1 / Math.sqrt(s2 * s3);\n    }\n    function rsq(x_, y_) {\n        var r = pearson(x_, y_);\n        return r * r;\n    }\n    function steyx(y_, x_) {\n        var n = x_.length;\n        var mx = _mean(x_), my = _mean(y_);\n        var s1 = 0, s2 = 0, s3 = 0;\n        for (var i = 0; i < n; i++) {\n            var t1 = x_[i] - mx, t2 = y_[i] - my;\n            s1 += t2 * t2;\n            s2 += t1 * t2;\n            s3 += t1 * t1;\n        }\n        return Math.sqrt((s1 - s2 * s2 / s3) / (n - 2));\n    }\n    function forecast(x, y_, x_) {\n        var mx = _mean(x_), my = _mean(y_);\n        var s1 = 0, s2 = 0;\n        for (var i = 0, n = x_.length; i < n; i++) {\n            var t1 = x_[i] - mx, t2 = y_[i] - my;\n            s1 += t1 * t2;\n            s2 += t1 * t1;\n        }\n        if (s2 === 0) {\n            throw new CalcError('N/A');\n        }\n        var b = s1 / s2, a = my - b * mx;\n        return a + b * x;\n    }\n    function _mat_mean(Mat) {\n        var n = Mat.height, sum = 0;\n        for (var i = 0; i < n; i++) {\n            sum += Mat.data[i][0];\n        }\n        return sum / n;\n    }\n    function _mat_devsq(Mat, mean) {\n        var n = Mat.height, sq = 0;\n        for (var i = 0; i < n; i++) {\n            var x = Mat.data[i][0] - mean;\n            sq += x * x;\n        }\n        return sq;\n    }\n    function linest(Y, X, konst, stats) {\n        var i = 0;\n        if (!X) {\n            X = Y.map(function () {\n                return ++i;\n            });\n        }\n        if (konst) {\n            X = X.clone();\n            X.eachRow(function (row) {\n                X.data[row].unshift(1);\n            });\n            ++X.width;\n        }\n        var Xt = X.transpose();\n        var B = Xt.multiply(X).inverse().multiply(Xt).multiply(Y);\n        var line_1 = [];\n        for (i = B.height - 1; i >= 0; i--) {\n            line_1.push(B.data[i][0]);\n        }\n        if (!konst) {\n            line_1.push(0);\n        }\n        if (!stats) {\n            return this.asMatrix([line_1]);\n        }\n        var Y1 = X.multiply(B);\n        var y_y1 = Y.adds(Y1, true);\n        var mp = !konst ? 0 : _mat_mean(Y1);\n        var SSreg = _mat_devsq(Y1, mp);\n        var me = !konst ? 0 : _mat_mean(y_y1);\n        var SSresid = _mat_devsq(y_y1, me);\n        var line_5 = [];\n        line_5.push(SSreg, SSresid);\n        var R2 = SSreg / (SSreg + SSresid);\n        var degfre = Y.height - X.width;\n        var err_est = Math.sqrt(SSresid / degfre);\n        var line_3 = [];\n        line_3.push(R2, err_est);\n        var F_sta = !konst ? R2 / X.width / ((1 - R2) / degfre) : SSreg / (X.width - 1) / (SSresid / degfre);\n        var line_4 = [];\n        line_4.push(F_sta, degfre);\n        var SCP = Xt.multiply(X).inverse();\n        var line_2 = [];\n        for (i = SCP.height - 1; i >= 0; i--) {\n            line_2.push(Math.sqrt(SCP.data[i][i] * SSresid / degfre));\n        }\n        return this.asMatrix([\n            line_1,\n            line_2,\n            line_3,\n            line_4,\n            line_5\n        ]);\n    }\n    function logest(Y, X, konst, stats) {\n        return linest.call(this, Y.map(Math.log), X, konst, stats).map(Math.exp);\n    }\n    function trend(Y, X, W, konst) {\n        var i = 0;\n        if (!X) {\n            X = Y.map(function () {\n                return ++i;\n            });\n        }\n        if (konst) {\n            X = X.clone();\n            X.eachRow(function (row) {\n                X.data[row].unshift(1);\n            });\n            ++X.width;\n        }\n        var Xt = X.transpose();\n        var B = Xt.multiply(X).inverse().multiply(Xt).multiply(Y);\n        if (!W) {\n            W = X;\n        } else {\n            if (konst) {\n                W = W.clone();\n                W.eachRow(function (row) {\n                    W.data[row].unshift(1);\n                });\n                ++W.width;\n            }\n        }\n        return W.multiply(B);\n    }\n    function growth(Y, X, new_X, konst) {\n        return trend.call(this, Y.map(Math.log), X, new_X, konst).map(Math.exp);\n    }\n    function root_newton(func, guess, max_it, eps) {\n        var MAX_IT = max_it || 20, EPS = eps || 1e-7;\n        var root = guess;\n        for (var j = 1; j <= MAX_IT; j++) {\n            var f_d = func(root), f = f_d[0], df = f_d[1];\n            var dx = f / df;\n            root -= dx;\n            if (Math.abs(dx) < EPS) {\n                return root;\n            }\n        }\n        return new CalcError('NUM');\n    }\n    function FV(rate, nper, pmt, pv, type) {\n        var h1 = Math.pow(1 + rate, nper);\n        var h2 = rate ? (h1 - 1) / rate : nper;\n        return -(pv * h1 + pmt * h2 * (1 + rate * type));\n    }\n    function PV(rate, nper, pmt, fv, type) {\n        if (!rate) {\n            return -fv - pmt * nper;\n        }\n        var h1 = Math.pow(1 + rate, nper);\n        return -(fv + pmt * (h1 - 1) / rate * (1 + rate * type)) / h1;\n    }\n    function PMT(rate, nper, pv, fv, type) {\n        if (!rate) {\n            return -(fv + pv) / nper;\n        }\n        var h1 = Math.pow(1 + rate, nper);\n        return -rate * (fv + pv * h1) / ((1 + rate * type) * (h1 - 1));\n    }\n    function NPER(rate, pmt, pv, fv, type) {\n        if (!rate) {\n            return -(fv + pv) / pmt;\n        }\n        var h1 = pmt * (1 + rate * type);\n        return Math.log((h1 - fv * rate) / (h1 + pv * rate)) / Math.log(1 + rate);\n    }\n    function RATE(nper, pmt, pv, fv, type, guess) {\n        function xfd(x) {\n            var h2 = Math.pow(1 + x, nper - 1), h1 = h2 * (1 + x);\n            return [\n                pv * h1 + pmt * (1 / x + type) * (h1 - 1) + fv,\n                nper * pv * h2 + pmt * (-(h1 - 1) / (x * x) + (1 / x + type) * nper * h2)\n            ];\n        }\n        return root_newton(xfd, guess);\n    }\n    function IPMT(rate, per, nper, pv, fv, type) {\n        if (type == 1 && per == 1) {\n            return 0;\n        }\n        var pmt = PMT(rate, nper, pv, fv, type);\n        var ipmt = FV(rate, per - 1, pmt, pv, type) * rate;\n        return type ? ipmt / (1 + rate) : ipmt;\n    }\n    function PPMT(rate, per, nper, pv, fv, type) {\n        var pmt = PMT(rate, nper, pv, fv, type);\n        return pmt - IPMT(rate, per, nper, pv, fv, type);\n    }\n    function CUMPRINC(rate, nper, pv, start, end, type) {\n        if (type == 1) {\n            start--;\n            end--;\n        }\n        var tn = Math.pow(1 + rate, nper), ts = Math.pow(1 + rate, start - 1), te = Math.pow(1 + rate, end);\n        var monthlyPayment = rate * pv * tn / (tn - 1);\n        var remainingBalanceAtStart = ts * pv - (ts - 1) / rate * monthlyPayment;\n        var remainingBalanceAtEnd = te * pv - (te - 1) / rate * monthlyPayment;\n        return remainingBalanceAtEnd - remainingBalanceAtStart;\n    }\n    function CUMIPMT(rate, nper, pv, start, end, type) {\n        var cip = 0;\n        for (var i = start; i <= end; i++) {\n            cip += IPMT(rate, i, nper, pv, 0, type);\n        }\n        return cip;\n    }\n    function NPV(rate, flows) {\n        var npv = 0;\n        for (var i = 0, n = flows.length; i < n; i++) {\n            npv += flows[i] * Math.pow(1 + rate, -i - 1);\n        }\n        return npv;\n    }\n    function IRR(flows, guess) {\n        function xfd(x) {\n            var npv = 0, npv1 = 0;\n            for (var j = 0, n = flows.length; j < n; j++) {\n                npv += flows[j] * Math.pow(1 + x, -j - 1);\n                npv1 += -j * flows[j] * Math.pow(1 + x, -j - 2);\n            }\n            return [\n                npv,\n                npv1\n            ];\n        }\n        return root_newton(xfd, guess);\n    }\n    function EFFECT(nominal_rate, npery) {\n        return Math.pow(1 + nominal_rate / npery, npery) - 1;\n    }\n    function NOMINAL(effect_rate, npery) {\n        return npery * (Math.pow(effect_rate + 1, 1 / npery) - 1);\n    }\n    function XNPV(rate, values, dates) {\n        var npv = 0;\n        for (var i = 0, n = values.length; i < n; i++) {\n            npv += values[i] * Math.pow(1 + rate, (dates[0] - dates[i]) / 365);\n        }\n        return npv;\n    }\n    function XIRR(values, dates, guess) {\n        function xfd(x) {\n            var npv = values[0], npv1 = 0;\n            for (var j = 1, n = values.length; j < n; j++) {\n                var delta = (dates[0] - dates[j]) / 365;\n                npv += values[j] * Math.pow(1 + x, delta);\n                npv1 += delta * values[j] * Math.pow(1 + x, delta - 1);\n            }\n            return [\n                npv,\n                npv1\n            ];\n        }\n        return root_newton(xfd, guess);\n    }\n    function ISPMT(rate, per, nper, pv) {\n        var tmp = -pv * rate;\n        return tmp * (1 - per / nper);\n    }\n    function DB(cost, salvage, life, period, month) {\n        var rate = 1 - Math.pow(salvage / cost, 1 / life);\n        rate = Math.floor(rate * 1000 + 0.5) / 1000;\n        var db = cost * rate * month / 12;\n        if (period == 1) {\n            return db;\n        }\n        for (var i = 1; i < life; i++) {\n            if (i == period - 1) {\n                return (cost - db) * rate;\n            }\n            db += (cost - db) * rate;\n        }\n        return (cost - db) * rate * (12 - month) / 12;\n    }\n    function DDB(cost, salvage, life, period, factor) {\n        var f = factor / life;\n        var prior = -cost * (Math.pow(1 - f, period - 1) - 1);\n        var dep = (cost - prior) * f;\n        dep = Math.min(dep, Math.max(0, cost - prior - salvage));\n        return dep;\n    }\n    function SLN(cost, salvage, life) {\n        return (cost - salvage) / life;\n    }\n    function SYD(cost, salvage, life, per) {\n        return (cost - salvage) * (life - per + 1) * 2 / (life * (life + 1));\n    }\n    function VDB(cost, salvage, life, start, end, factor, no_switch) {\n        var interest = factor >= life ? 1 : factor / life;\n        function _getGDA(value, period) {\n            var gda, oldValue, newValue;\n            if (interest == 1) {\n                oldValue = period == 1 ? value : 0;\n            } else {\n                oldValue = value * Math.pow(1 - interest, period - 1);\n            }\n            newValue = value * Math.pow(1 - interest, period);\n            gda = newValue < salvage ? oldValue - salvage : oldValue - newValue;\n            return gda < 0 ? 0 : gda;\n        }\n        function _interVDB(cost, life1, period) {\n            var remValue = cost - salvage;\n            var intEnd = Math.ceil(period);\n            var term, lia = 0, vdb = 0, nowLia = false;\n            for (var i = 1; i <= intEnd; i++) {\n                if (!nowLia) {\n                    var gda = _getGDA(cost, i);\n                    lia = remValue / (life1 - i + 1);\n                    if (lia > gda) {\n                        term = lia;\n                        nowLia = true;\n                    } else {\n                        term = gda;\n                        remValue -= gda;\n                    }\n                } else {\n                    term = lia;\n                }\n                if (i == intEnd) {\n                    term *= period + 1 - intEnd;\n                }\n                vdb += term;\n            }\n            return vdb;\n        }\n        var intStart = Math.floor(start), intEnd = Math.ceil(end);\n        var vdb = 0;\n        if (no_switch) {\n            for (var i = intStart + 1; i <= intEnd; i++) {\n                var term = _getGDA(cost, i);\n                if (i == intStart + 1) {\n                    term *= Math.min(end, intStart + 1) - start;\n                } else {\n                    if (i == intEnd) {\n                        term *= end + 1 - intEnd;\n                    }\n                }\n                vdb += term;\n            }\n        } else {\n            var life1 = life;\n            if (start != Math.floor(start)) {\n                if (factor > 1) {\n                    if (start >= life / 2) {\n                        var part = start - life / 2;\n                        start = life / 2;\n                        end -= part;\n                        life1 += 1;\n                    }\n                }\n            }\n            cost -= _interVDB(cost, life1, start);\n            vdb = _interVDB(cost, life - start, end - start);\n        }\n        return vdb;\n    }\n    function _edate(base, months) {\n        var d = unpackDate(base);\n        var m = d.month + months;\n        var y = d.year + Math.floor(m / 12);\n        m %= 12;\n        if (m < 0) {\n            m += 12;\n        }\n        d = Math.min(d.date, daysInMonth(y, m));\n        return packDate(y, m, d);\n    }\n    function _daysBetween(from, to, basis) {\n        if (basis == 1 || basis == 2 || basis == 3) {\n            return to - from;\n        }\n        return _days_360(from, to, basis);\n    }\n    function _borderCoupons(settlement, maturity, freq) {\n        var sett = unpackDate(settlement), base = unpackDate(maturity);\n        var periods = base.year - sett.year;\n        if (periods > 0) {\n            periods = (periods - 1) * freq;\n        }\n        var prev, next, months = 12 / freq;\n        do {\n            periods++;\n            prev = _edate(maturity, -periods * months);\n        } while (settlement < prev);\n        periods--;\n        next = _edate(maturity, -periods * months);\n        return [\n            prev,\n            next\n        ];\n    }\n    function _borderCoupons_fw(first, settlement, freq) {\n        var sett = unpackDate(settlement), base = unpackDate(first);\n        var periods = sett.year - base.year;\n        if (periods > 0) {\n            periods = (periods - 1) * freq;\n        }\n        var prev = first, next, months = 12 / freq;\n        while (settlement > prev) {\n            next = prev;\n            periods++;\n            prev = _edate(first, periods * months);\n        }\n        return [\n            next,\n            prev\n        ];\n    }\n    function COUPDAYBS(settlement, maturity, frequency, basis) {\n        var prev = _borderCoupons(settlement, maturity, frequency)[0];\n        return _daysBetween(prev, settlement, basis);\n    }\n    function COUPDAYS(settl, matur, freq, basis) {\n        if (basis == 1) {\n            var borders = _borderCoupons(settl, matur, freq);\n            return _daysBetween(borders[0], borders[1], 1);\n        }\n        if (basis == 3) {\n            return 365 / freq;\n        }\n        return 360 / freq;\n    }\n    function COUPDAYSNC(settl, matur, freq, basis) {\n        var next = _borderCoupons(settl, matur, freq)[1];\n        return _daysBetween(settl, next, basis);\n    }\n    function COUPPCD(settl, matur, freq) {\n        return _borderCoupons(settl, matur, freq)[0];\n    }\n    function COUPNCD(settl, matur, freq) {\n        return _borderCoupons(settl, matur, freq)[1];\n    }\n    function COUPNUM(settl, matur, freq) {\n        var sett = unpackDate(settl), mat = unpackDate(matur);\n        var months = 12 * (mat.year - sett.year) + mat.month - sett.month;\n        return 1 + (months * freq / 12 | 0);\n    }\n    function daysInYear(yr, basis) {\n        if (basis == 3) {\n            return 365;\n        }\n        if (basis == 1) {\n            return isLeapYear(yr) ? 366 : 365;\n        }\n        return 360;\n    }\n    function ACCRINTM(issue, maturity, rate, par, basis) {\n        var year_days = daysInYear(unpackDate(maturity).year, basis);\n        return rate * par * _daysBetween(issue, maturity, basis) / year_days;\n    }\n    function ACCRINT(issue, first, settl, rate, par, freq, basis, calc) {\n        var accr = 0, cost = par * rate / freq;\n        var brace, prev, next, prev1, next1, nrc;\n        var annual = basis % 2 === 0 ? 360 : 365;\n        function _numCoupons(from, to) {\n            return (to - from) * freq / annual | 0;\n        }\n        if (settl <= first) {\n            brace = _borderCoupons(settl, first, freq);\n            prev = brace[0];\n            next = brace[1];\n            if (prev <= issue) {\n                return cost * _daysBetween(issue, settl, basis) / _daysBetween(prev, next, basis);\n            }\n            brace = _borderCoupons(issue, prev, freq);\n            prev1 = brace[0];\n            next1 = brace[1];\n            nrc = _numCoupons(next1, settl);\n            return cost * (nrc + _daysBetween(issue, next1, basis) / _daysBetween(prev1, next1, basis) + (settl < next ? _daysBetween(prev, settl, basis) / _daysBetween(prev, next, basis) : 0));\n        } else {\n            brace = _borderCoupons_fw(first, settl, freq);\n            prev = brace[0];\n            next = brace[1];\n            nrc = _numCoupons(first, settl);\n            if (next == settl) {\n                accr = cost * nrc;\n            } else {\n                accr = cost * (nrc + _daysBetween(prev, settl, basis) / _daysBetween(prev, next, basis));\n            }\n            if (!calc) {\n                return accr;\n            }\n            brace = _borderCoupons(issue, first, freq);\n            prev = brace[0];\n            next = brace[1];\n            nrc = _numCoupons(issue, first);\n            accr += cost * (nrc + _daysBetween(issue, next, basis) / _daysBetween(prev, next, basis));\n            return accr;\n        }\n    }\n    function DISC(settl, matur, pr, redemption, basis) {\n        var annual = basis % 2 === 0 ? 360 : isLeapYear(unpackDate(settl).year) ? 366 : 365;\n        return (redemption - pr) / redemption * annual / _daysBetween(settl, matur, basis);\n    }\n    function INTRATE(settl, matur, investment, redemption, basis) {\n        var annual = basis % 2 === 0 ? 360 : isLeapYear(unpackDate(settl).year) ? 366 : 365;\n        return (redemption - investment) / investment * annual / _daysBetween(settl, matur, basis);\n    }\n    function RECEIVED(settl, matur, investment, discount, basis) {\n        var annual = basis % 2 === 0 ? 360 : isLeapYear(unpackDate(settl).year) ? 366 : 365;\n        return investment / (1 - discount * _daysBetween(settl, matur, basis) / annual);\n    }\n    function PRICE(settl, matur, rate, yld, redemption, freq, basis) {\n        var N = 1 + ((matur - settl) * freq / (basis % 2 === 0 ? 360 : 365) | 0);\n        var brace = _borderCoupons(settl, matur, freq), prev = brace[0], next = brace[1];\n        var beg_settl = _daysBetween(prev, settl, basis), settl_end = _daysBetween(settl, next, basis), beg_end = _daysBetween(prev, next, basis);\n        var den = 100 * rate / freq, yf = yld / freq, frac = settl_end / beg_end;\n        if (N == 1) {\n            return (redemption + den) / (1 + frac * yf) - beg_settl / beg_end * den;\n        }\n        return redemption / Math.pow(1 + yf, N - 1 + frac) + den * Math.pow(1 + yf, 1 - N - frac) * (Math.pow(1 + yf, N) - 1) / yf - beg_settl / beg_end * den;\n    }\n    function PRICEDISC(settl, matur, discount, redemption, basis) {\n        var dsm = _daysBetween(settl, matur, basis), dy = daysInYear(unpackDate(matur).year, basis);\n        return redemption - discount * redemption * dsm / dy;\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/borderpalette', [\n        'kendo.core',\n        'kendo.colorpicker',\n        'kendo.popup'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var BORDER_TYPES = [\n            'allBorders',\n            'insideBorders',\n            'insideHorizontalBorders',\n            'insideVerticalBorders',\n            'outsideBorders',\n            'leftBorder',\n            'topBorder',\n            'rightBorder',\n            'bottomBorder',\n            'noBorders'\n        ];\n        var BORDER_PALETTE_MESSAGES = kendo.spreadsheet.messages.borderPalette = {\n            allBorders: 'All borders',\n            insideBorders: 'Inside borders',\n            insideHorizontalBorders: 'Inside horizontal borders',\n            insideVerticalBorders: 'Inside vertical borders',\n            outsideBorders: 'Outside borders',\n            leftBorder: 'Left border',\n            topBorder: 'Top border',\n            rightBorder: 'Right border',\n            bottomBorder: 'Bottom border',\n            noBorders: 'No border',\n            reset: 'Reset color',\n            customColor: 'Custom color...',\n            apply: 'Apply',\n            cancel: 'Cancel'\n        };\n        var ColorChooser = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                kendo.ui.Widget.call(this, element, options);\n                this.element = element;\n                this.color = options.color;\n                this._resetButton();\n                this._colorPalette();\n                this._customColorPalette();\n                this._customColorButton();\n                this.resetButton.on('click', this.resetColor.bind(this));\n                this.customColorButton.on('click', this.customColor.bind(this));\n            },\n            options: { name: 'ColorChooser' },\n            events: ['change'],\n            destroy: function () {\n                kendo.unbind(this.dialog.element.find('.k-action-buttons'));\n                this.dialog.destroy();\n                this.colorPalette.destroy();\n                this.resetButton.off('click');\n                this.customColorButton.off('click');\n            },\n            value: function (value) {\n                if (value !== undefined) {\n                    this.color = value;\n                    this.customColorButton.find('.k-icon').css('background-color', this.color);\n                    this.colorPalette.value(null);\n                    this.flatColorPicker.value(this.color);\n                } else {\n                    return this.color;\n                }\n            },\n            _change: function (value) {\n                this.color = value;\n                this.trigger('change', { value: value });\n            },\n            _colorPalette: function () {\n                var element = $('<div />', { 'class': 'k-spreadsheet-color-palette' });\n                var colorPalette = this.colorPalette = $('<div />').kendoColorPalette({\n                    palette: [\n                        '#ffffff',\n                        '#000000',\n                        '#d6ecff',\n                        '#4e5b6f',\n                        '#7fd13b',\n                        '#ea157a',\n                        '#feb80a',\n                        '#00addc',\n                        '#738ac8',\n                        '#1ab39f',\n                        '#f2f2f2',\n                        '#7f7f7f',\n                        '#a7d6ff',\n                        '#d9dde4',\n                        '#e5f5d7',\n                        '#fad0e4',\n                        '#fef0cd',\n                        '#c5f2ff',\n                        '#e2e7f4',\n                        '#c9f7f1',\n                        '#d8d8d8',\n                        '#595959',\n                        '#60b5ff',\n                        '#b3bcca',\n                        '#cbecb0',\n                        '#f6a1c9',\n                        '#fee29c',\n                        '#8be6ff',\n                        '#c7d0e9',\n                        '#94efe3',\n                        '#bfbfbf',\n                        '#3f3f3f',\n                        '#007dea',\n                        '#8d9baf',\n                        '#b2e389',\n                        '#f272af',\n                        '#fed46b',\n                        '#51d9ff',\n                        '#aab8de',\n                        '#5fe7d5',\n                        '#a5a5a5',\n                        '#262626',\n                        '#003e75',\n                        '#3a4453',\n                        '#5ea226',\n                        '#af0f5b',\n                        '#c58c00',\n                        '#0081a5',\n                        '#425ea9',\n                        '#138677',\n                        '#7f7f7f',\n                        '#0c0c0c',\n                        '#00192e',\n                        '#272d37',\n                        '#3f6c19',\n                        '#750a3d',\n                        '#835d00',\n                        '#00566e',\n                        '#2c3f71',\n                        '#0c594f'\n                    ],\n                    value: this.color,\n                    change: function (e) {\n                        this.customColorButton.find('.k-icon').css('background-color', 'transparent');\n                        this.flatColorPicker.value(null);\n                        this._change(e.value);\n                    }.bind(this)\n                }).data('kendoColorPalette');\n                element.append(colorPalette.wrapper).appendTo(this.element);\n            },\n            _customColorPalette: function () {\n                var element = $('<div />', {\n                    'class': 'k-spreadsheet-window',\n                    'html': '<div></div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>' + BORDER_PALETTE_MESSAGES.apply + '</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>' + BORDER_PALETTE_MESSAGES.cancel + '</button>' + '</div>'\n                });\n                var dialog = this.dialog = element.appendTo(document.body).kendoWindow({\n                    animation: false,\n                    scrollable: false,\n                    resizable: false,\n                    maximizable: false,\n                    modal: true,\n                    visible: false,\n                    width: 268,\n                    open: function () {\n                        this.center();\n                    }\n                }).data('kendoWindow');\n                dialog.one('activate', function () {\n                    this.element.find('[data-role=flatcolorpicker]').data('kendoFlatColorPicker')._hueSlider.resize();\n                });\n                var flatColorPicker = this.flatColorPicker = dialog.element.children().first().kendoFlatColorPicker().data('kendoFlatColorPicker');\n                var viewModel = kendo.observable({\n                    apply: function () {\n                        this.customColorButton.find('.k-icon').css('background-color', flatColorPicker.value());\n                        this.colorPalette.value(null);\n                        this._change(flatColorPicker.value());\n                        dialog.close();\n                    }.bind(this),\n                    close: function () {\n                        flatColorPicker.value(null);\n                        dialog.close();\n                    }\n                });\n                kendo.bind(dialog.element.find('.k-action-buttons'), viewModel);\n            },\n            _resetButton: function () {\n                this.resetButton = $('<a class=\\'k-button k-reset-color\\' href=\\'#\\'>' + '<span class=\\'k-icon k-font-icon k-i-reset-color\\'></span>' + BORDER_PALETTE_MESSAGES.reset + '</a>').appendTo(this.element);\n            },\n            _customColorButton: function () {\n                this.customColorButton = $('<a class=\\'k-button k-custom-color\\' href=\\'#\\'>' + '<span class=\\'k-icon\\'></span>' + BORDER_PALETTE_MESSAGES.customColor + '</a>').appendTo(this.element);\n            },\n            resetColor: function () {\n                this.colorPalette.value(null);\n                this.flatColorPicker.value(null);\n                this._change(null);\n            },\n            customColor: function () {\n                this.dialog.open();\n            }\n        });\n        var BorderPalette = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                kendo.ui.Widget.call(this, element, options);\n                this.element = element;\n                this.color = '#000';\n                this.element.addClass('k-spreadsheet-border-palette');\n                this._borderTypePalette();\n                this._borderColorPalette();\n                this.element.on('click', '.k-spreadsheet-border-type-palette .k-button', this._click.bind(this));\n            },\n            options: { name: 'BorderPalette' },\n            events: ['change'],\n            destroy: function () {\n                this.colorChooser.destroy();\n                this.element.off('click');\n            },\n            _borderTypePalette: function () {\n                var messages = BORDER_PALETTE_MESSAGES;\n                var buttons = BORDER_TYPES.map(function (type) {\n                    return '<a title=\"' + messages[type] + '\" href=\"#\" data-border-type=\"' + type + '\" class=\"k-button k-button-icon\">' + '<span class=\"k-sprite k-font-icon k-icon k-i-' + kendo.toHyphens(type) + '\"></span>' + '</a>';\n                }).join('');\n                var element = $('<div />', {\n                    'class': 'k-spreadsheet-border-type-palette',\n                    'html': buttons\n                });\n                element.appendTo(this.element);\n            },\n            _borderColorPalette: function () {\n                var element = $('<div />', { 'class': 'k-spreadsheet-border-color-palette' });\n                element.appendTo(this.element);\n                this.colorChooser = new ColorChooser(element, {\n                    color: this.color,\n                    change: this._colorChange.bind(this)\n                });\n            },\n            _click: function (e) {\n                this.type = $(e.currentTarget).data('borderType');\n                this.trigger('change', {\n                    type: this.type,\n                    color: this.color\n                });\n            },\n            _colorChange: function (e) {\n                this.color = e.value;\n                if (this.type) {\n                    this.trigger('change', {\n                        type: this.type,\n                        color: this.color\n                    });\n                }\n            }\n        });\n        kendo.spreadsheet.ColorChooser = ColorChooser;\n        kendo.spreadsheet.BorderPalette = BorderPalette;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/toolbar', [\n        'kendo.toolbar',\n        'kendo.colorpicker',\n        'kendo.combobox',\n        'kendo.dropdownlist',\n        'kendo.popup',\n        'spreadsheet/borderpalette'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var ToolBar = kendo.ui.ToolBar;\n        var MESSAGES = kendo.spreadsheet.messages.toolbar = {\n            addColumnLeft: 'Add column left',\n            addColumnRight: 'Add column right',\n            addRowAbove: 'Add row above',\n            addRowBelow: 'Add row below',\n            alignment: 'Alignment',\n            alignmentButtons: {\n                justtifyLeft: 'Align left',\n                justifyCenter: 'Center',\n                justifyRight: 'Align right',\n                justifyFull: 'Justify',\n                alignTop: 'Align top',\n                alignMiddle: 'Align middle',\n                alignBottom: 'Align bottom'\n            },\n            backgroundColor: 'Background',\n            bold: 'Bold',\n            borders: 'Borders',\n            colorPicker: {\n                reset: 'Reset color',\n                customColor: 'Custom color...'\n            },\n            copy: 'Copy',\n            cut: 'Cut',\n            deleteColumn: 'Delete column',\n            deleteRow: 'Delete row',\n            filter: 'Filter',\n            fontFamily: 'Font',\n            fontSize: 'Font size',\n            format: 'Custom format...',\n            formatTypes: {\n                automatic: 'Automatic',\n                number: 'Number',\n                percent: 'Percent',\n                financial: 'Financial',\n                currency: 'Currency',\n                date: 'Date',\n                time: 'Time',\n                dateTime: 'Date time',\n                duration: 'Duration',\n                moreFormats: 'More formats...'\n            },\n            formatDecreaseDecimal: 'Decrease decimal',\n            formatIncreaseDecimal: 'Increase decimal',\n            freeze: 'Freeze panes',\n            freezeButtons: {\n                freezePanes: 'Freeze panes',\n                freezeRows: 'Freeze rows',\n                freezeColumns: 'Freeze columns',\n                unfreeze: 'Unfreeze panes'\n            },\n            italic: 'Italic',\n            merge: 'Merge cells',\n            mergeButtons: {\n                mergeCells: 'Merge all',\n                mergeHorizontally: 'Merge horizontally',\n                mergeVertically: 'Merge vertically',\n                unmerge: 'Unmerge'\n            },\n            open: 'Open...',\n            paste: 'Paste',\n            quickAccess: {\n                redo: 'Redo',\n                undo: 'Undo'\n            },\n            exportAs: 'Export...',\n            sortAsc: 'Sort ascending',\n            sortDesc: 'Sort descending',\n            sortButtons: {\n                sortSheetAsc: 'Sort sheet A to Z',\n                sortSheetDesc: 'Sort sheet Z to A',\n                sortRangeAsc: 'Sort range A to Z',\n                sortRangeDesc: 'Sort range Z to A'\n            },\n            textColor: 'Text Color',\n            textWrap: 'Wrap text',\n            underline: 'Underline',\n            validation: 'Data validation...'\n        };\n        var defaultTools = {\n            home: [\n                'open',\n                'exportAs',\n                [\n                    'cut',\n                    'copy',\n                    'paste'\n                ],\n                [\n                    'bold',\n                    'italic',\n                    'underline'\n                ],\n                'backgroundColor',\n                'textColor',\n                'borders',\n                'fontSize',\n                'fontFamily',\n                'alignment',\n                'textWrap',\n                [\n                    'formatDecreaseDecimal',\n                    'formatIncreaseDecimal'\n                ],\n                'format',\n                'merge',\n                'freeze',\n                'filter'\n            ],\n            insert: [\n                [\n                    'addColumnLeft',\n                    'addColumnRight',\n                    'addRowBelow',\n                    'addRowAbove'\n                ],\n                [\n                    'deleteColumn',\n                    'deleteRow'\n                ]\n            ],\n            data: [\n                'sort',\n                'filter',\n                'validation'\n            ]\n        };\n        var toolDefaults = {\n            open: {\n                type: 'open',\n                overflow: 'never',\n                iconClass: 'xlsa'\n            },\n            exportAs: {\n                type: 'exportAsDialog',\n                dialogName: 'exportAs',\n                overflow: 'never',\n                text: '',\n                iconClass: 'xlsa'\n            },\n            bold: {\n                type: 'button',\n                command: 'PropertyChangeCommand',\n                property: 'bold',\n                value: true,\n                iconClass: 'bold',\n                togglable: true\n            },\n            italic: {\n                type: 'button',\n                command: 'PropertyChangeCommand',\n                property: 'italic',\n                value: true,\n                iconClass: 'italic',\n                togglable: true\n            },\n            underline: {\n                type: 'button',\n                command: 'PropertyChangeCommand',\n                property: 'underline',\n                value: true,\n                iconClass: 'underline',\n                togglable: true\n            },\n            formatDecreaseDecimal: {\n                type: 'button',\n                command: 'AdjustDecimalsCommand',\n                value: -1,\n                iconClass: 'decrease-decimal'\n            },\n            formatIncreaseDecimal: {\n                type: 'button',\n                command: 'AdjustDecimalsCommand',\n                value: +1,\n                iconClass: 'increase-decimal'\n            },\n            textWrap: {\n                type: 'button',\n                command: 'TextWrapCommand',\n                property: 'wrap',\n                value: true,\n                iconClass: 'text-wrap',\n                togglable: true\n            },\n            cut: {\n                type: 'button',\n                command: 'ToolbarCutCommand',\n                iconClass: 'cut'\n            },\n            copy: {\n                type: 'button',\n                command: 'ToolbarCopyCommand',\n                iconClass: 'copy'\n            },\n            paste: {\n                type: 'button',\n                command: 'ToolbarPasteCommand',\n                iconClass: 'paste'\n            },\n            separator: { type: 'separator' },\n            alignment: {\n                type: 'alignment',\n                iconClass: 'justify-left'\n            },\n            backgroundColor: {\n                type: 'colorPicker',\n                property: 'background',\n                iconClass: 'background'\n            },\n            textColor: {\n                type: 'colorPicker',\n                property: 'color',\n                iconClass: 'text'\n            },\n            fontFamily: {\n                type: 'fontFamily',\n                property: 'fontFamily',\n                iconClass: 'text'\n            },\n            fontSize: {\n                type: 'fontSize',\n                property: 'fontSize',\n                iconClass: 'font-size'\n            },\n            format: {\n                type: 'format',\n                property: 'format',\n                iconClass: 'format-number'\n            },\n            filter: {\n                type: 'filter',\n                property: 'hasFilter',\n                iconClass: 'filter'\n            },\n            merge: {\n                type: 'merge',\n                iconClass: 'merge-cells'\n            },\n            freeze: {\n                type: 'freeze',\n                iconClass: 'freeze-panes'\n            },\n            borders: {\n                type: 'borders',\n                iconClass: 'all-borders'\n            },\n            formatCells: {\n                type: 'dialog',\n                dialogName: 'formatCells',\n                overflow: 'never'\n            },\n            addColumnLeft: {\n                type: 'button',\n                command: 'AddColumnCommand',\n                value: 'left',\n                iconClass: 'add-column-left'\n            },\n            addColumnRight: {\n                type: 'button',\n                command: 'AddColumnCommand',\n                value: 'right',\n                iconClass: 'add-column-right'\n            },\n            addRowBelow: {\n                type: 'button',\n                command: 'AddRowCommand',\n                value: 'below',\n                iconClass: 'add-row-below'\n            },\n            addRowAbove: {\n                type: 'button',\n                command: 'AddRowCommand',\n                value: 'above',\n                iconClass: 'add-row-above'\n            },\n            deleteColumn: {\n                type: 'button',\n                command: 'DeleteColumnCommand',\n                iconClass: 'delete-column'\n            },\n            deleteRow: {\n                type: 'button',\n                command: 'DeleteRowCommand',\n                iconClass: 'delete-row'\n            },\n            sort: {\n                type: 'sort',\n                iconClass: 'sort-desc'\n            },\n            validation: {\n                type: 'dialog',\n                dialogName: 'validation',\n                iconClass: 'exception',\n                overflow: 'never'\n            }\n        };\n        var SpreadsheetToolBar = ToolBar.extend({\n            init: function (element, options) {\n                options.items = this._expandTools(options.tools || SpreadsheetToolBar.prototype.options.tools[options.toolbarName]);\n                ToolBar.fn.init.call(this, element, options);\n                var handleClick = this._click.bind(this);\n                this.element.addClass('k-spreadsheet-toolbar');\n                this._addSeparators(this.element);\n                this.bind({\n                    click: handleClick,\n                    toggle: handleClick\n                });\n            },\n            _addSeparators: function (element) {\n                var groups = element.children('.k-widget, a.k-button, .k-button-group');\n                groups.before('<span class=\\'k-separator\\' />');\n            },\n            _expandTools: function (tools) {\n                function expandTool(toolName) {\n                    var options = $.isPlainObject(toolName) ? toolName : toolDefaults[toolName] || {};\n                    var spriteCssClass = 'k-icon k-font-icon k-i-' + options.iconClass;\n                    var type = options.type;\n                    var typeDefaults = {\n                        splitButton: { spriteCssClass: spriteCssClass },\n                        button: { showText: 'overflow' },\n                        colorPicker: { toolIcon: spriteCssClass }\n                    };\n                    var tool = $.extend({\n                        name: options.name || toolName,\n                        text: MESSAGES[options.name || toolName],\n                        spriteCssClass: spriteCssClass,\n                        attributes: { title: MESSAGES[options.name || toolName] }\n                    }, typeDefaults[type], options);\n                    if (type == 'splitButton') {\n                        tool.menuButtons = tool.menuButtons.map(expandTool);\n                    }\n                    tool.attributes['data-tool'] = toolName;\n                    if (options.property) {\n                        tool.attributes['data-property'] = options.property;\n                    }\n                    return tool;\n                }\n                return tools.reduce(function (tools, tool) {\n                    if ($.isArray(tool)) {\n                        tools.push({\n                            type: 'buttonGroup',\n                            buttons: tool.map(expandTool)\n                        });\n                    } else {\n                        tools.push(expandTool.call(this, tool));\n                    }\n                    return tools;\n                }, []);\n            },\n            _click: function (e) {\n                var toolName = e.target.attr('data-tool');\n                var tool = toolDefaults[toolName] || {};\n                var commandType = tool.command;\n                if (!commandType) {\n                    return;\n                }\n                var args = {\n                    command: commandType,\n                    options: {\n                        property: tool.property || null,\n                        value: tool.value || null\n                    }\n                };\n                if (typeof args.options.value === 'boolean') {\n                    args.options.value = e.checked ? true : null;\n                }\n                this.action(args);\n            },\n            events: [\n                'click',\n                'toggle',\n                'open',\n                'close',\n                'overflowOpen',\n                'overflowClose',\n                'action',\n                'dialog'\n            ],\n            options: {\n                name: 'SpreadsheetToolBar',\n                resizable: true,\n                tools: defaultTools\n            },\n            action: function (args) {\n                this.trigger('action', args);\n            },\n            dialog: function (args) {\n                this.trigger('dialog', args);\n            },\n            refresh: function (activeCell) {\n                var range = activeCell;\n                var tools = this._tools();\n                function setToggle(tool, value) {\n                    var toolbar = tool.toolbar;\n                    var overflow = tool.overflow;\n                    var togglable = toolbar && toolbar.options.togglable || overflow && overflow.options.togglable;\n                    if (!togglable) {\n                        return;\n                    }\n                    var toggle = false;\n                    if (typeof value === 'boolean') {\n                        toggle = value;\n                    } else if (typeof value === 'string') {\n                        toggle = toolbar.options.value === value;\n                    }\n                    toolbar.toggle(toggle);\n                    if (overflow) {\n                        overflow.toggle(toggle);\n                    }\n                }\n                function update(tool, value) {\n                    var toolbar = tool.toolbar;\n                    var overflow = tool.overflow;\n                    if (toolbar && toolbar.update) {\n                        toolbar.update(value);\n                    }\n                    if (overflow && overflow.update) {\n                        overflow.update(value);\n                    }\n                }\n                for (var i = 0; i < tools.length; i++) {\n                    var property = tools[i].property;\n                    var tool = tools[i].tool;\n                    var value = kendo.isFunction(range[property]) ? range[property]() : range;\n                    if (tool.type === 'button') {\n                        setToggle(tool, value);\n                    } else {\n                        update(tool, value);\n                    }\n                }\n            },\n            _tools: function () {\n                return this.element.find('[data-property]').toArray().reduce(function (tools, element) {\n                    element = $(element);\n                    var property = element.attr('data-property');\n                    tools.push({\n                        property: property,\n                        tool: this._getItem(element)\n                    });\n                    return tools;\n                }.bind(this), []);\n            },\n            destroy: function () {\n                this.element.find('[data-command],.k-button').each(function () {\n                    var element = $(this);\n                    var instance = element.data('instance');\n                    if (instance && instance.destroy) {\n                        instance.destroy();\n                    }\n                });\n                ToolBar.fn.destroy.call(this);\n            }\n        });\n        kendo.spreadsheet.ToolBar = SpreadsheetToolBar;\n        var DropDownTool = kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                var dropDownList = $('<select />').kendoDropDownList({ height: 'auto' }).data('kendoDropDownList');\n                this.dropDownList = dropDownList;\n                this.element = dropDownList.wrapper;\n                this.options = options;\n                this.toolbar = toolbar;\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowAttr();\n                dropDownList.bind('open', this._open.bind(this));\n                dropDownList.bind('change', this._change.bind(this));\n                this.element.width(options.width).attr({\n                    'data-command': 'PropertyChangeCommand',\n                    'data-property': options.property\n                });\n            },\n            _open: function () {\n                var ddl = this.dropDownList;\n                var list = ddl.list;\n                var listWidth;\n                list.css({\n                    whiteSpace: 'nowrap',\n                    width: 'auto'\n                });\n                listWidth = list.width();\n                if (listWidth) {\n                    listWidth += 20;\n                } else {\n                    listWidth = ddl._listWidth;\n                }\n                list.css('width', listWidth + kendo.support.scrollbar());\n                ddl._listWidth = listWidth;\n            },\n            _change: function (e) {\n                var instance = e.sender;\n                var value = instance.value();\n                var dataItem = instance.dataItem();\n                var popupName = dataItem ? dataItem.popup : undefined;\n                if (popupName) {\n                    this.toolbar.dialog({ name: popupName });\n                } else {\n                    this.toolbar.action({\n                        command: 'PropertyChangeCommand',\n                        options: {\n                            property: this.options.property,\n                            value: value == 'null' ? null : value\n                        }\n                    });\n                }\n            },\n            value: function (value) {\n                if (value !== undefined) {\n                    this.dropDownList.value(value);\n                } else {\n                    return this.dropDownList.value();\n                }\n            }\n        });\n        var PopupTool = kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                this.element = $('<a href=\\'#\\' class=\\'k-button k-button-icon\\'>' + '<span class=\\'' + options.spriteCssClass + '\\'>' + '</span><span class=\\'k-icon k-i-arrow-s\\'></span>' + '</a>');\n                this.element.on('click', this.open.bind(this)).attr('data-command', options.command);\n                this.options = options;\n                this.toolbar = toolbar;\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowAttr();\n                this._popup();\n            },\n            destroy: function () {\n                this.popup.destroy();\n            },\n            open: function () {\n                this.popup.toggle();\n            },\n            _popup: function () {\n                var element = this.element;\n                this.popup = $('<div class=\\'k-spreadsheet-popup\\' />').appendTo(element).kendoPopup({ anchor: element }).data('kendoPopup');\n            }\n        });\n        kendo.toolbar.registerComponent('dialog', kendo.toolbar.ToolBarButton.extend({\n            init: function (options, toolbar) {\n                kendo.toolbar.ToolBarButton.fn.init.call(this, options, toolbar);\n                this._dialogName = options.dialogName;\n                this.element.bind('click', this.open.bind(this)).data('instance', this);\n            },\n            open: function () {\n                this.toolbar.dialog({ name: this._dialogName });\n            }\n        }));\n        kendo.toolbar.registerComponent('exportAsDialog', kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                this._dialogName = options.dialogName;\n                this.toolbar = toolbar;\n                this.element = $('<button class=\\'k-button k-button-icon\\' title=\\'' + options.attributes.title + '\\'>' + '<span class=\\'k-icon k-font-icon k-i-xls\\' />' + '</button>').data('instance', this);\n                this.element.bind('click', this.open.bind(this)).data('instance', this);\n            },\n            open: function () {\n                this.toolbar.dialog({ name: this._dialogName });\n            }\n        }));\n        var OverflowDialogButton = kendo.toolbar.OverflowButton.extend({\n            init: function (options, toolbar) {\n                kendo.toolbar.OverflowButton.fn.init.call(this, options, toolbar);\n                this.element.on('click', this._click.bind(this));\n                this.message = this.options.text;\n                var instance = this.element.data('button');\n                this.element.data(this.options.type, instance);\n            },\n            _click: $.noop\n        });\n        var ColorPicker = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this.popup.element.addClass('k-spreadsheet-colorpicker');\n                this.colorChooser = new kendo.spreadsheet.ColorChooser(this.popup.element, { change: this._colorChange.bind(this) });\n                this.element.attr({ 'data-property': options.property });\n                this.element.data({\n                    type: 'colorPicker',\n                    colorPicker: this,\n                    instance: this\n                });\n            },\n            destroy: function () {\n                this.colorChooser.destroy();\n                PopupTool.fn.destroy.call(this);\n            },\n            update: function (value) {\n                this.value(value);\n            },\n            value: function (value) {\n                this.colorChooser.value(value);\n            },\n            _colorChange: function (e) {\n                this.toolbar.action({\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: this.options.property,\n                        value: e.sender.value()\n                    }\n                });\n                this.popup.close();\n            }\n        });\n        var ColorPickerButton = OverflowDialogButton.extend({\n            init: function (options, toolbar) {\n                options.iconName = 'text';\n                OverflowDialogButton.fn.init.call(this, options, toolbar);\n            },\n            _click: function () {\n                this.toolbar.dialog({\n                    name: 'colorPicker',\n                    options: {\n                        title: this.options.property,\n                        property: this.options.property\n                    }\n                });\n            }\n        });\n        kendo.toolbar.registerComponent('colorPicker', ColorPicker, ColorPickerButton);\n        var FONT_SIZES = [\n            8,\n            9,\n            10,\n            11,\n            12,\n            13,\n            14,\n            16,\n            18,\n            20,\n            22,\n            24,\n            26,\n            28,\n            36,\n            48,\n            72\n        ];\n        var DEFAULT_FONT_SIZE = 12;\n        var FontSize = kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                var comboBox = $('<input />').kendoComboBox({\n                    change: this._valueChange.bind(this),\n                    dataSource: options.fontSizes || FONT_SIZES,\n                    value: DEFAULT_FONT_SIZE\n                }).data('kendoComboBox');\n                this.comboBox = comboBox;\n                this.element = comboBox.wrapper;\n                this.options = options;\n                this.toolbar = toolbar;\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowAttr();\n                this.element.width(options.width).attr({\n                    'data-command': 'PropertyChangeCommand',\n                    'data-property': options.property\n                });\n                this.element.data({\n                    type: 'fontSize',\n                    fontSize: this\n                });\n            },\n            _valueChange: function (e) {\n                this.toolbar.action({\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: this.options.property,\n                        value: kendo.parseInt(e.sender.value())\n                    }\n                });\n            },\n            update: function (value) {\n                this.value(kendo.parseInt(value) || DEFAULT_FONT_SIZE);\n            },\n            value: function (value) {\n                if (value !== undefined) {\n                    this.comboBox.value(value);\n                } else {\n                    return this.comboBox.value();\n                }\n            }\n        });\n        var FontSizeButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({\n                    name: 'fontSize',\n                    options: {\n                        sizes: FONT_SIZES,\n                        defaultSize: DEFAULT_FONT_SIZE\n                    }\n                });\n            },\n            update: function (value) {\n                this._value = value || DEFAULT_FONT_SIZE;\n                this.element.find('.k-text').text(this.message + ' (' + this._value + ') ...');\n            }\n        });\n        kendo.toolbar.registerComponent('fontSize', FontSize, FontSizeButton);\n        var FONT_FAMILIES = [\n            'Arial',\n            'Courier New',\n            'Georgia',\n            'Times New Roman',\n            'Trebuchet MS',\n            'Verdana'\n        ];\n        var DEFAULT_FONT_FAMILY = 'Arial';\n        var FontFamily = DropDownTool.extend({\n            init: function (options, toolbar) {\n                DropDownTool.fn.init.call(this, options, toolbar);\n                var ddl = this.dropDownList;\n                ddl.setDataSource(options.fontFamilies || FONT_FAMILIES);\n                ddl.value(DEFAULT_FONT_FAMILY);\n                this.element.data({\n                    type: 'fontFamily',\n                    fontFamily: this\n                });\n            },\n            update: function (value) {\n                this.value(value || DEFAULT_FONT_FAMILY);\n            }\n        });\n        var FontFamilyButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({\n                    name: 'fontFamily',\n                    options: {\n                        fonts: FONT_FAMILIES,\n                        defaultFont: DEFAULT_FONT_FAMILY\n                    }\n                });\n            },\n            update: function (value) {\n                this._value = value || DEFAULT_FONT_FAMILY;\n                this.element.find('.k-text').text(this.message + ' (' + this._value + ') ...');\n            }\n        });\n        kendo.toolbar.registerComponent('fontFamily', FontFamily, FontFamilyButton);\n        var defaultFormats = kendo.spreadsheet.formats = {\n            automatic: null,\n            number: '#,0.00',\n            percent: '0.00%',\n            financial: '_(\"$\"* #,##0.00_);_(\"$\"* (#,##0.00);_(\"$\"* \"-\"??_);_(@_)',\n            currency: '$#,##0.00;[Red]$#,##0.00',\n            date: 'm/d/yyyy',\n            time: 'h:mm:ss AM/PM',\n            dateTime: 'm/d/yyyy h:mm',\n            duration: '[h]:mm:ss'\n        };\n        var Format = DropDownTool.extend({\n            _revertTitle: function (e) {\n                e.sender.value('');\n                e.sender.wrapper.width('auto');\n            },\n            init: function (options, toolbar) {\n                DropDownTool.fn.init.call(this, options, toolbar);\n                var ddl = this.dropDownList;\n                var icon = '<span class=\\'k-icon k-font-icon k-i-' + options.iconClass + '\\' style=\\'line-height: 1em; width: 1.35em;\\'></span>';\n                ddl.bind('change', this._revertTitle.bind(this));\n                ddl.bind('dataBound', this._revertTitle.bind(this));\n                ddl.setOptions({\n                    dataValueField: 'format',\n                    dataTextField: 'name',\n                    dataValuePrimitive: true,\n                    valueTemplate: icon,\n                    template: '# if (data.sample) { #' + '<span class=\\'k-spreadsheet-sample\\'>#: data.sample #</span>' + '# } #' + '#: data.name #'\n                });\n                ddl.text(icon);\n                ddl.setDataSource([\n                    {\n                        format: defaultFormats.automatic,\n                        name: MESSAGES.formatTypes.automatic\n                    },\n                    {\n                        format: defaultFormats.number,\n                        name: MESSAGES.formatTypes.number,\n                        sample: '1,499.99'\n                    },\n                    {\n                        format: defaultFormats.percent,\n                        name: MESSAGES.formatTypes.percent,\n                        sample: '14.50%'\n                    },\n                    {\n                        format: defaultFormats.financial,\n                        name: MESSAGES.formatTypes.financial,\n                        sample: '(1,000.12)'\n                    },\n                    {\n                        format: defaultFormats.currency,\n                        name: MESSAGES.formatTypes.currency,\n                        sample: '$1,499.99'\n                    },\n                    {\n                        format: defaultFormats.date,\n                        name: MESSAGES.formatTypes.date,\n                        sample: '4/21/2012'\n                    },\n                    {\n                        format: defaultFormats.time,\n                        name: MESSAGES.formatTypes.time,\n                        sample: '5:49:00 PM'\n                    },\n                    {\n                        format: defaultFormats.dateTime,\n                        name: MESSAGES.formatTypes.dateTime,\n                        sample: '4/21/2012 5:49:00'\n                    },\n                    {\n                        format: defaultFormats.duration,\n                        name: MESSAGES.formatTypes.duration,\n                        sample: '168:05:00'\n                    },\n                    {\n                        popup: 'formatCells',\n                        name: MESSAGES.formatTypes.moreFormats\n                    }\n                ]);\n                this.element.data({\n                    type: 'format',\n                    format: this\n                });\n            }\n        });\n        var FormatButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'formatCells' });\n            }\n        });\n        kendo.toolbar.registerComponent('format', Format, FormatButton);\n        var BorderChangeTool = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this._borderPalette();\n                this.element.data({\n                    type: 'borders',\n                    instance: this\n                });\n            },\n            destroy: function () {\n                this.borderPalette.destroy();\n                PopupTool.fn.destroy.call(this);\n            },\n            _borderPalette: function () {\n                var element = $('<div />').appendTo(this.popup.element);\n                this.borderPalette = new kendo.spreadsheet.BorderPalette(element, { change: this._action.bind(this) });\n            },\n            _action: function (e) {\n                this.toolbar.action({\n                    command: 'BorderChangeCommand',\n                    options: {\n                        border: e.type,\n                        style: {\n                            size: 1,\n                            color: e.color\n                        }\n                    }\n                });\n            }\n        });\n        var BorderChangeButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'borders' });\n            }\n        });\n        kendo.toolbar.registerComponent('borders', BorderChangeTool, BorderChangeButton);\n        var AlignmentTool = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this.element.attr({ 'data-property': 'alignment' });\n                this._commandPalette();\n                this.popup.element.on('click', '.k-button', function (e) {\n                    this._action($(e.currentTarget));\n                }.bind(this));\n                this.element.data({\n                    type: 'alignment',\n                    alignment: this,\n                    instance: this\n                });\n            },\n            buttons: [\n                {\n                    property: 'textAlign',\n                    value: 'left',\n                    iconClass: 'justify-left',\n                    text: MESSAGES.alignmentButtons.justtifyLeft\n                },\n                {\n                    property: 'textAlign',\n                    value: 'center',\n                    iconClass: 'justify-center',\n                    text: MESSAGES.alignmentButtons.justifyCenter\n                },\n                {\n                    property: 'textAlign',\n                    value: 'right',\n                    iconClass: 'justify-right',\n                    text: MESSAGES.alignmentButtons.justifyRight\n                },\n                {\n                    property: 'textAlign',\n                    value: 'justify',\n                    iconClass: 'justify-full',\n                    text: MESSAGES.alignmentButtons.justifyFull\n                },\n                {\n                    property: 'verticalAlign',\n                    value: 'top',\n                    iconClass: 'align-top',\n                    text: MESSAGES.alignmentButtons.alignTop\n                },\n                {\n                    property: 'verticalAlign',\n                    value: 'center',\n                    iconClass: 'align-middle',\n                    text: MESSAGES.alignmentButtons.alignMiddle\n                },\n                {\n                    property: 'verticalAlign',\n                    value: 'bottom',\n                    iconClass: 'align-bottom',\n                    text: MESSAGES.alignmentButtons.alignBottom\n                }\n            ],\n            destroy: function () {\n                this.popup.element.off();\n                PopupTool.fn.destroy.call(this);\n            },\n            update: function (range) {\n                var textAlign = range.textAlign();\n                var verticalAlign = range.verticalAlign();\n                this.popup.element.find('.k-button').removeClass('k-state-active');\n                if (textAlign) {\n                    this.popup.element.find('.k-button[data-value=' + textAlign + ']').addClass('k-state-active');\n                }\n                if (verticalAlign) {\n                    this.popup.element.find('.k-button[data-value=' + verticalAlign + ']').addClass('k-state-active');\n                }\n            },\n            _commandPalette: function () {\n                var buttons = this.buttons;\n                var element = $('<div />').appendTo(this.popup.element);\n                buttons.forEach(function (options, index) {\n                    var button = '<a title=\\'' + options.text + '\\' data-property=\\'' + options.property + '\\' data-value=\\'' + options.value + '\\' class=\\'k-button k-button-icon\\'>' + '<span class=\\'k-icon k-font-icon k-i-' + options.iconClass + '\\'></span>' + '</a>';\n                    if (index !== 0 && buttons[index - 1].property !== options.property) {\n                        element.append($('<span class=\\'k-separator\\' />'));\n                    }\n                    element.append(button);\n                });\n            },\n            _action: function (button) {\n                var property = button.attr('data-property');\n                var value = button.attr('data-value');\n                this.toolbar.action({\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: property,\n                        value: value\n                    }\n                });\n            }\n        });\n        var AlignmentButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'alignment' });\n            }\n        });\n        kendo.toolbar.registerComponent('alignment', AlignmentTool, AlignmentButton);\n        var MergeTool = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this._commandPalette();\n                this.popup.element.on('click', '.k-button', function (e) {\n                    this._action($(e.currentTarget));\n                }.bind(this));\n                this.element.data({\n                    type: 'merge',\n                    merge: this,\n                    instance: this\n                });\n            },\n            buttons: [\n                {\n                    value: 'cells',\n                    iconClass: 'merge-cells',\n                    text: MESSAGES.mergeButtons.mergeCells\n                },\n                {\n                    value: 'horizontally',\n                    iconClass: 'merge-horizontally',\n                    text: MESSAGES.mergeButtons.mergeHorizontally\n                },\n                {\n                    value: 'vertically',\n                    iconClass: 'merge-vertically',\n                    text: MESSAGES.mergeButtons.mergeVertically\n                },\n                {\n                    value: 'unmerge',\n                    iconClass: 'normal-layout',\n                    text: MESSAGES.mergeButtons.unmerge\n                }\n            ],\n            destroy: function () {\n                this.popup.element.off();\n                PopupTool.fn.destroy.call(this);\n            },\n            _commandPalette: function () {\n                var element = $('<div />').appendTo(this.popup.element);\n                this.buttons.forEach(function (options) {\n                    var button = '<a title=\\'' + options.text + '\\' data-value=\\'' + options.value + '\\' class=\\'k-button k-button-icontext\\'>' + '<span class=\\'k-icon k-font-icon k-i-' + options.iconClass + '\\'></span>' + options.text + '</a>';\n                    element.append(button);\n                });\n            },\n            _action: function (button) {\n                var value = button.attr('data-value');\n                this.toolbar.action({\n                    command: 'MergeCellCommand',\n                    options: { value: value }\n                });\n            }\n        });\n        var MergeButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'merge' });\n            }\n        });\n        kendo.toolbar.registerComponent('merge', MergeTool, MergeButton);\n        var FreezeTool = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this._commandPalette();\n                this.popup.element.on('click', '.k-button', function (e) {\n                    this._action($(e.currentTarget));\n                }.bind(this));\n                this.element.data({\n                    type: 'freeze',\n                    freeze: this,\n                    instance: this\n                });\n            },\n            buttons: [\n                {\n                    value: 'panes',\n                    iconClass: 'freeze-panes',\n                    text: MESSAGES.freezeButtons.freezePanes\n                },\n                {\n                    value: 'rows',\n                    iconClass: 'freeze-row',\n                    text: MESSAGES.freezeButtons.freezeRows\n                },\n                {\n                    value: 'columns',\n                    iconClass: 'freeze-col',\n                    text: MESSAGES.freezeButtons.freezeColumns\n                },\n                {\n                    value: 'unfreeze',\n                    iconClass: 'normal-layout',\n                    text: MESSAGES.freezeButtons.unfreeze\n                }\n            ],\n            destroy: function () {\n                this.popup.element.off();\n                PopupTool.fn.destroy.call(this);\n            },\n            _commandPalette: function () {\n                var element = $('<div />').appendTo(this.popup.element);\n                this.buttons.forEach(function (options) {\n                    var button = '<a title=\\'' + options.text + '\\' data-value=\\'' + options.value + '\\' class=\\'k-button k-button-icontext\\'>' + '<span class=\\'k-icon k-font-icon k-i-' + options.iconClass + '\\'></span>' + options.text + '</a>';\n                    element.append(button);\n                });\n            },\n            _action: function (button) {\n                var value = button.attr('data-value');\n                this.toolbar.action({\n                    command: 'FreezePanesCommand',\n                    options: { value: value }\n                });\n            }\n        });\n        var FreezeButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'freeze' });\n            }\n        });\n        kendo.toolbar.registerComponent('freeze', FreezeTool, FreezeButton);\n        var Sort = DropDownTool.extend({\n            _revertTitle: function (e) {\n                e.sender.value('');\n                e.sender.wrapper.width('auto');\n            },\n            init: function (options, toolbar) {\n                DropDownTool.fn.init.call(this, options, toolbar);\n                var ddl = this.dropDownList;\n                ddl.bind('change', this._revertTitle.bind(this));\n                ddl.bind('dataBound', this._revertTitle.bind(this));\n                ddl.setOptions({\n                    valueTemplate: '<span class=\\'k-icon k-font-icon k-i-' + options.iconClass + '\\' style=\\'line-height: 1em; width: 1.35em;\\'></span>',\n                    template: '<span class=\\'k-icon k-font-icon k-i-#= iconClass #\\' style=\\'line-height: 1em; width: 1.35em;\\'></span>#=text#',\n                    dataTextField: 'text',\n                    dataValueField: 'value'\n                });\n                ddl.setDataSource([\n                    {\n                        value: 'asc',\n                        sheet: false,\n                        text: MESSAGES.sortButtons.sortRangeAsc,\n                        iconClass: 'sort-asc'\n                    },\n                    {\n                        value: 'desc',\n                        sheet: false,\n                        text: MESSAGES.sortButtons.sortRangeDesc,\n                        iconClass: 'sort-desc'\n                    }\n                ]);\n                ddl.select(0);\n                this.element.data({\n                    type: 'sort',\n                    sort: this\n                });\n            },\n            _change: function (e) {\n                var instance = e.sender;\n                var dataItem = instance.dataItem();\n                if (dataItem) {\n                    this.toolbar.action({\n                        command: 'SortCommand',\n                        options: {\n                            value: dataItem.value,\n                            sheet: dataItem.sheet\n                        }\n                    });\n                }\n            },\n            value: $.noop\n        });\n        var SortButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'sort' });\n            }\n        });\n        kendo.toolbar.registerComponent('sort', Sort, SortButton);\n        var Filter = kendo.toolbar.ToolBarButton.extend({\n            init: function (options, toolbar) {\n                options.showText = 'overflow';\n                kendo.toolbar.ToolBarButton.fn.init.call(this, options, toolbar);\n                this.element.on('click', this._click.bind(this));\n                this.element.data({\n                    type: 'filter',\n                    filter: this\n                });\n            },\n            _click: function () {\n                this.toolbar.action({ command: 'FilterCommand' });\n            },\n            update: function (value) {\n                this.toggle(value);\n            }\n        });\n        var FilterButton = OverflowDialogButton.extend({\n            init: function (options, toolbar) {\n                OverflowDialogButton.fn.init.call(this, options, toolbar);\n                this.element.data({\n                    type: 'filter',\n                    filter: this\n                });\n            },\n            _click: function () {\n                this.toolbar.action({ command: 'FilterCommand' });\n            },\n            update: function (value) {\n                this.toggle(value);\n            }\n        });\n        kendo.toolbar.registerComponent('filter', Filter, FilterButton);\n        var Open = kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                this.toolbar = toolbar;\n                this.element = $('<div class=\\'k-button k-upload-button k-button-icon\\'>' + '<span class=\\'k-icon k-font-icon k-i-folder-open\\' />' + '</div>').data('instance', this);\n                this._title = options.attributes.title;\n                this._reset();\n            },\n            _reset: function () {\n                this.element.remove('input');\n                $('<input type=\\'file\\' autocomplete=\\'off\\' accept=\\'.xlsx\\'/>').attr('title', this._title).one('change', this._change.bind(this)).appendTo(this.element);\n            },\n            _change: function (e) {\n                this.toolbar.action({\n                    command: 'OpenCommand',\n                    options: { file: e.target.files[0] }\n                });\n                this._reset();\n            }\n        });\n        kendo.toolbar.registerComponent('open', Open);\n        kendo.spreadsheet.TabStrip = kendo.ui.TabStrip.extend({\n            init: function (element, options) {\n                kendo.ui.TabStrip.fn.init.call(this, element, options);\n                element.addClass('k-spreadsheet-tabstrip');\n                this._quickAccessButtons();\n                this.quickAccessToolBar.on('click', '.k-button', function (e) {\n                    var action = $(e.currentTarget).attr('title').toLowerCase();\n                    this.trigger('action', { action: action });\n                }.bind(this));\n                this.toolbars = {};\n                var tabs = options.dataSource;\n                this.contentElements.each(function (idx, element) {\n                    this._toolbar($(element), tabs[idx].id, options.toolbarOptions[tabs[idx].id]);\n                }.bind(this));\n                this.one('activate', function () {\n                    this.toolbars[this.options.dataSource[0].id].resize();\n                });\n            },\n            events: kendo.ui.TabStrip.fn.events.concat([\n                'action',\n                'dialog'\n            ]),\n            destroy: function () {\n                this.quickAccessToolBar.off('click');\n                kendo.ui.TabStrip.fn.destroy.call(this);\n                for (var name in this.toolbars) {\n                    this.toolbars[name].destroy();\n                }\n            },\n            action: function (args) {\n                this.trigger('action', args);\n            },\n            dialog: function (args) {\n                this.trigger('dialog', args);\n            },\n            refreshTools: function (range) {\n                var toolbars = this.toolbars;\n                for (var name in toolbars) {\n                    if (toolbars.hasOwnProperty(name)) {\n                        toolbars[name].refresh(range);\n                    }\n                }\n            },\n            _quickAccessButtons: function () {\n                var buttons = [\n                    {\n                        title: MESSAGES.quickAccess.undo,\n                        iconClass: 'undo-large',\n                        action: 'undo'\n                    },\n                    {\n                        title: MESSAGES.quickAccess.redo,\n                        iconClass: 'redo-large',\n                        action: 'redo'\n                    }\n                ];\n                var buttonTemplate = kendo.template('<a href=\\'\\\\#\\' title=\\'#= title #\\' data-action=\\'#= action #\\' class=\\'k-button k-button-icon\\'><span class=\\'k-icon k-font-icon k-i-#=iconClass#\\'></span></a>');\n                this.quickAccessToolBar = $('<div />', {\n                    'class': 'k-spreadsheet-quick-access-toolbar',\n                    'html': kendo.render(buttonTemplate, buttons)\n                }).insertBefore(this.wrapper);\n                this.quickAccessToolBar.on('click', '.k-button', function (e) {\n                    e.preventDefault();\n                    var action = $(e.currentTarget).attr('title').toLowerCase();\n                    this.action({ action: action });\n                }.bind(this));\n                this.quickAccessAdjust();\n            },\n            quickAccessAdjust: function () {\n                this.tabGroup.css('padding-left', this.quickAccessToolBar.outerWidth());\n            },\n            _toolbar: function (container, name, tools) {\n                var element;\n                var options;\n                if (this.toolbars[name]) {\n                    this.toolbars[name].destroy();\n                    container.children('.k-toolbar').remove();\n                }\n                if (tools) {\n                    element = container.html('<div />').children('div');\n                    options = {\n                        tools: typeof tools === 'boolean' ? undefined : tools,\n                        toolbarName: name,\n                        action: this.action.bind(this),\n                        dialog: this.dialog.bind(this)\n                    };\n                    this.toolbars[name] = new kendo.spreadsheet.ToolBar(element, options);\n                }\n            }\n        });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/dialogs', [\n        'kendo.core',\n        'kendo.binder',\n        'kendo.validator'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var ObservableObject = kendo.data.ObservableObject;\n        var MESSAGES = kendo.spreadsheet.messages.dialogs = {\n            apply: 'Apply',\n            save: 'Save',\n            cancel: 'Cancel',\n            remove: 'Remove',\n            okText: 'OK',\n            formatCellsDialog: {\n                title: 'Format',\n                categories: {\n                    number: 'Number',\n                    currency: 'Currency',\n                    date: 'Date'\n                }\n            },\n            fontFamilyDialog: { title: 'Font' },\n            fontSizeDialog: { title: 'Font size' },\n            bordersDialog: { title: 'Borders' },\n            alignmentDialog: {\n                title: 'Alignment',\n                buttons: {\n                    justtifyLeft: 'Align left',\n                    justifyCenter: 'Center',\n                    justifyRight: 'Align right',\n                    justifyFull: 'Justify',\n                    alignTop: 'Align top',\n                    alignMiddle: 'Align middle',\n                    alignBottom: 'Align bottom'\n                }\n            },\n            mergeDialog: {\n                title: 'Merge cells',\n                buttons: {\n                    mergeCells: 'Merge all',\n                    mergeHorizontally: 'Merge horizontally',\n                    mergeVertically: 'Merge vertically',\n                    unmerge: 'Unmerge'\n                }\n            },\n            freezeDialog: {\n                title: 'Freeze panes',\n                buttons: {\n                    freezePanes: 'Freeze panes',\n                    freezeRows: 'Freeze rows',\n                    freezeColumns: 'Freeze columns',\n                    unfreeze: 'Unfreeze panes'\n                }\n            },\n            validationDialog: {\n                title: 'Data Validation',\n                hintMessage: 'Please enter a valid {0} value {1}.',\n                hintTitle: 'Validation {0}',\n                criteria: {\n                    any: 'Any value',\n                    number: 'Number',\n                    text: 'Text',\n                    date: 'Date',\n                    custom: 'Custom Formula',\n                    list: 'List'\n                },\n                comparers: {\n                    greaterThan: 'greater than',\n                    lessThan: 'less than',\n                    between: 'between',\n                    notBetween: 'not between',\n                    equalTo: 'equal to',\n                    notEqualTo: 'not equal to',\n                    greaterThanOrEqualTo: 'greater than or equal to',\n                    lessThanOrEqualTo: 'less than or equal to'\n                },\n                comparerMessages: {\n                    greaterThan: 'greater than {0}',\n                    lessThan: 'less than {0}',\n                    between: 'between {0} and {1}',\n                    notBetween: 'not between {0} and {1}',\n                    equalTo: 'equal to {0}',\n                    notEqualTo: 'not equal to {0}',\n                    greaterThanOrEqualTo: 'greater than or equal to {0}',\n                    lessThanOrEqualTo: 'less than or equal to {0}',\n                    custom: 'that satisfies the formula: {0}'\n                },\n                labels: {\n                    criteria: 'Criteria',\n                    comparer: 'Comparer',\n                    min: 'Min',\n                    max: 'Max',\n                    value: 'Value',\n                    start: 'Start',\n                    end: 'End',\n                    onInvalidData: 'On invalid data',\n                    rejectInput: 'Reject input',\n                    showWarning: 'Show warning',\n                    showHint: 'Show hint',\n                    hintTitle: 'Hint title',\n                    hintMessage: 'Hint message',\n                    ignoreBlank: 'Ignore blank'\n                },\n                placeholders: {\n                    typeTitle: 'Type title',\n                    typeMessage: 'Type message'\n                }\n            },\n            exportAsDialog: {\n                title: 'Export...',\n                labels: {\n                    scale: 'Scale',\n                    fit: 'Fit to page',\n                    fileName: 'File name',\n                    saveAsType: 'Save as type',\n                    exportArea: 'Export',\n                    paperSize: 'Paper size',\n                    margins: 'Margins',\n                    orientation: 'Orientation',\n                    print: 'Print',\n                    guidelines: 'Guidelines',\n                    center: 'Center',\n                    horizontally: 'Horizontally',\n                    vertically: 'Vertically'\n                }\n            },\n            modifyMergedDialog: { errorMessage: 'Cannot change part of a merged cell.' },\n            overflowDialog: { errorMessage: 'Cannot paste, because the copy area and the paste area are not the same size and shape.' },\n            useKeyboardDialog: {\n                title: 'Copying and pasting',\n                errorMessage: 'These actions cannot be invoked through the menu. Please use the keyboard shortcuts instead:',\n                labels: {\n                    forCopy: 'for copy',\n                    forCut: 'for cut',\n                    forPaste: 'for paste'\n                }\n            },\n            unsupportedSelectionDialog: { errorMessage: 'That action cannot be performed on multiple selection.' }\n        };\n        var registry = {};\n        kendo.spreadsheet.dialogs = {\n            register: function (name, dialogClass) {\n                registry[name] = dialogClass;\n            },\n            create: function (name, options) {\n                var dialogClass = registry[name];\n                if (dialogClass) {\n                    return new dialogClass(options);\n                }\n            }\n        };\n        var SpreadsheetDialog = kendo.spreadsheet.SpreadsheetDialog = kendo.Observable.extend({\n            init: function (options) {\n                kendo.Observable.fn.init.call(this, options);\n                this.options = $.extend(true, {}, this.options, options);\n                this.bind(this.events, options);\n            },\n            events: [\n                'close',\n                'activate'\n            ],\n            dialog: function () {\n                if (!this._dialog) {\n                    this._dialog = $('<div class=\\'k-spreadsheet-window k-action-window\\' />').addClass(this.options.className || '').append(kendo.template(this.options.template)({ messages: kendo.spreadsheet.messages.dialogs || MESSAGES })).appendTo(document.body).kendoWindow({\n                        scrollable: false,\n                        resizable: false,\n                        maximizable: false,\n                        modal: true,\n                        visible: false,\n                        width: this.options.width || 320,\n                        title: this.options.title,\n                        open: function () {\n                            this.center();\n                        },\n                        close: this._onDialogClose.bind(this),\n                        activate: this._onDialogActivate.bind(this),\n                        deactivate: this._onDialogDeactivate.bind(this)\n                    }).data('kendoWindow');\n                }\n                return this._dialog;\n            },\n            _onDialogClose: function () {\n                this.trigger('close');\n            },\n            _onDialogActivate: function () {\n                this.trigger('activate');\n            },\n            _onDialogDeactivate: function () {\n                this.trigger('deactivate');\n                this.destroy();\n            },\n            destroy: function () {\n                if (this._dialog) {\n                    this._dialog.destroy();\n                    this._dialog = null;\n                }\n            },\n            open: function () {\n                this.dialog().open();\n            },\n            apply: function () {\n                this.close();\n            },\n            close: function () {\n                this.dialog().close();\n            }\n        });\n        function formattedValue(value, format) {\n            return kendo.spreadsheet.formatting.text(value, format);\n        }\n        var FormatCellsViewModel = kendo.spreadsheet.FormatCellsViewModel = ObservableObject.extend({\n            init: function (options) {\n                ObservableObject.fn.init.call(this, options);\n                this.useCategory(this.category);\n            },\n            useCategory: function (category) {\n                var type = category && category.type || 'number';\n                var formatCurrency = type == 'currency';\n                this.category = category;\n                this.set('showCurrencyFilter', formatCurrency && this.currencies.length > 1);\n                if (!formatCurrency) {\n                    this.set('formats', this.allFormats[type + 'Formats']);\n                } else {\n                    this.currency(this.currencies[0]);\n                }\n                this.useFirstFormat();\n            },\n            useFirstFormat: function () {\n                if (this.formats.length) {\n                    this.set('format', this.formats[0].value);\n                }\n            },\n            currency: function (currency) {\n                if (currency !== undefined) {\n                    this._currency = currency;\n                    var info = currency.value;\n                    var formats = [\n                        {\n                            currency: info,\n                            decimals: true\n                        },\n                        {\n                            currency: info,\n                            decimals: true,\n                            iso: true\n                        },\n                        {\n                            currency: info,\n                            decimals: false\n                        }\n                    ];\n                    formats = formats.map(function (format) {\n                        format = FormatCellsViewModel.convert.currency(format);\n                        return {\n                            value: format,\n                            name: formattedValue(1000, format)\n                        };\n                    });\n                    this.set('formats', formats);\n                    this.useFirstFormat();\n                }\n                return this._currency || this.currencies[0];\n            },\n            categoryFilter: function (category) {\n                if (category !== undefined) {\n                    this.useCategory(category);\n                }\n                return this.category;\n            },\n            preview: function () {\n                var format = this.get('format');\n                var value = this.value || 0;\n                if (format && format.length) {\n                    return formattedValue(value, format);\n                } else {\n                    return value;\n                }\n            }\n        });\n        FormatCellsViewModel.convert = {\n            currency: function (options) {\n                function repeat(token, n) {\n                    return new Array(n + 1).join(token);\n                }\n                var info = options.currency;\n                var format = info.pattern[1];\n                if (options.decimals) {\n                    format = format.replace(/n/g, 'n' + info['.'] + repeat('0', info.decimals));\n                }\n                if (options.iso) {\n                    format = '\"' + info.abbr + '\" ' + format.replace(/\\s*\\$\\s*/g, '');\n                } else {\n                    format = format.replace(/\\$/g, info.symbol);\n                }\n                format = format.replace(/n/g, '?');\n                return format;\n            },\n            date: function (format) {\n                if (/T|Z/.test(format)) {\n                    return '';\n                }\n                return format.toLowerCase().replace(/tt/g, 'AM/PM').replace(/'/g, '\"');\n            }\n        };\n        function uniqueBy(field, array) {\n            var result = [];\n            var values = [];\n            for (var i = 0; i < array.length; i++) {\n                if ($.inArray(array[i][field], values) == -1) {\n                    result.push(array[i]);\n                    values.push(array[i][field]);\n                }\n            }\n            return result;\n        }\n        var FormatCellsDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.formatCellsDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    categories: [\n                        {\n                            type: 'number',\n                            name: messages.categories.number\n                        },\n                        {\n                            type: 'currency',\n                            name: messages.categories.currency\n                        },\n                        {\n                            type: 'date',\n                            name: messages.categories.date\n                        }\n                    ]\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n                this._generateFormats();\n            },\n            options: {\n                className: 'k-spreadsheet-format-cells',\n                template: '<div class=\\'k-root-tabs\\' data-role=\\'tabstrip\\' ' + 'data-text-field=\\'name\\' ' + 'data-bind=\\'source: categories, value: categoryFilter\\' ' + 'data-animation=\\'false\\' />' + '<div class=\\'k-spreadsheet-preview\\' data-bind=\\'text: preview\\' />' + '<script type=\\'text/x-kendo-template\\' id=\\'format-item-template\\'>' + '\\\\#: data.name \\\\#' + '</script>' + '<select data-role=\\'dropdownlist\\' class=\\'k-format-filter\\' ' + 'data-text-field=\\'description\\' ' + 'data-value-field=\\'value.name\\' ' + 'data-bind=\\'visible: showCurrencyFilter, value: currency, source: currencies\\' />' + '<ul data-role=\\'staticlist\\' tabindex=\\'0\\' ' + 'class=\\'k-list k-reset\\' ' + 'data-template=\\'format-item-template\\' ' + 'data-value-primitive=\\'true\\' ' + 'data-value-field=\\'value\\' ' + 'data-bind=\\'source: formats, value: format\\' />' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>#: messages.apply #</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>#: messages.cancel #</button>' + '</div>'\n            },\n            _generateFormats: function () {\n                var options = this.options;\n                if (!options.currencies) {\n                    options.currencies = FormatCellsDialog.currenciesFrom(kendo.cultures);\n                }\n                if (!options.numberFormats) {\n                    options.numberFormats = [\n                        {\n                            value: '#.00%',\n                            name: '100.00%'\n                        },\n                        {\n                            value: '#%',\n                            name: '100%'\n                        },\n                        {\n                            value: '#.00',\n                            name: '1024.00'\n                        },\n                        {\n                            value: '#,###.00',\n                            name: '1,024.00'\n                        }\n                    ];\n                }\n                if (!options.dateFormats) {\n                    var calendarPatterns = kendo.cultures.current.calendars.standard.patterns;\n                    options.dateFormats = uniqueBy('value', $.map(calendarPatterns, function (format) {\n                        format = FormatCellsViewModel.convert.date(format);\n                        if (!format) {\n                            return;\n                        }\n                        return {\n                            value: format,\n                            name: formattedValue(34567.7678, format)\n                        };\n                    }));\n                }\n            },\n            open: function (range) {\n                var options = this.options;\n                var value = range.value();\n                var categories = options.categories.slice(0);\n                var element;\n                this.viewModel = new FormatCellsViewModel({\n                    currencies: options.currencies.slice(0),\n                    allFormats: {\n                        numberFormats: options.numberFormats.slice(0),\n                        dateFormats: options.dateFormats.slice(0)\n                    },\n                    categories: categories,\n                    format: range.format(),\n                    category: value instanceof Date ? categories[2] : categories[0],\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this),\n                    value: value\n                });\n                SpreadsheetDialog.fn.open.call(this);\n                element = this.dialog().element;\n                kendo.bind(element, this.viewModel);\n                var currencyFilter = element.find('select.k-format-filter').data('kendoDropDownList');\n                if (options.currencies.length > 10) {\n                    currencyFilter.setOptions({ filter: 'contains' });\n                }\n                element.find(kendo.roleSelector('staticlist')).parent().addClass('k-list-wrapper');\n            },\n            apply: function () {\n                var format = this.viewModel.format;\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: 'format',\n                        value: format\n                    }\n                });\n            }\n        });\n        FormatCellsDialog.currenciesFrom = function (cultures) {\n            return uniqueBy('description', $.map(cultures, function (culture, name) {\n                if (!/-/.test(name)) {\n                    return;\n                }\n                var currency = culture.numberFormat.currency;\n                var description = kendo.format('{0} ({1}, {2})', currency.name, currency.abbr, currency.symbol);\n                return {\n                    description: description,\n                    value: currency\n                };\n            }));\n        };\n        kendo.spreadsheet.dialogs.register('formatCells', FormatCellsDialog);\n        kendo.spreadsheet.dialogs.FormatCellsDialog = FormatCellsDialog;\n        var MessageDialog = SpreadsheetDialog.extend({\n            options: {\n                className: 'k-spreadsheet-message',\n                title: '',\n                messageId: '',\n                text: '',\n                template: '<div class=\\'k-spreadsheet-message-content\\' data-bind=\\'text: text\\' />' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: close\\'>' + '#= messages.okText #' + '</button>' + '</div>'\n            },\n            open: function () {\n                SpreadsheetDialog.fn.open.call(this);\n                var options = this.options;\n                var text = options.text;\n                if (options.messageId) {\n                    text = kendo.getter(options.messageId, true)(kendo.spreadsheet.messages.dialogs);\n                }\n                kendo.bind(this.dialog().element, {\n                    text: text,\n                    close: this.close.bind(this)\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('message', MessageDialog);\n        var FontFamilyDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.fontFamilyDialog || MESSAGES;\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n                this._list();\n            },\n            options: { template: '<ul class=\\'k-list k-reset\\'></ul>' },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                var fonts = this.options.fonts;\n                var defaultFont = this.options.defaultFont;\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: fonts }),\n                    template: '#: data #',\n                    value: defaultFont,\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: 'fontFamily',\n                        value: e.sender.value()[0]\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('fontFamily', FontFamilyDialog);\n        var FontSizeDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.fontSizeDialog || MESSAGES;\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n                this._list();\n            },\n            options: { template: '<ul class=\\'k-list k-reset\\'></ul>' },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                var sizes = this.options.sizes;\n                var defaultSize = this.options.defaultSize;\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: sizes }),\n                    template: '#: data #',\n                    value: defaultSize,\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: 'fontSize',\n                        value: kendo.parseInt(e.sender.value()[0])\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('fontSize', FontSizeDialog);\n        var BordersDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.bordersDialog || MESSAGES;\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n                this.element = this.dialog().element;\n                this._borderPalette();\n                this.viewModel = kendo.observable({\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this)\n                });\n                kendo.bind(this.element.find('.k-action-buttons'), this.viewModel);\n            },\n            options: {\n                width: 177,\n                template: '<div></div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>#: messages.apply #</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>#: messages.cancel #</button>' + '</div>'\n            },\n            apply: function () {\n                SpreadsheetDialog.fn.apply.call(this);\n                var state = this.value();\n                this.trigger('action', {\n                    command: 'BorderChangeCommand',\n                    options: {\n                        border: state.type,\n                        style: {\n                            size: 1,\n                            color: state.color\n                        }\n                    }\n                });\n            },\n            _borderPalette: function () {\n                var element = this.dialog().element.find('div:first');\n                this.borderPalette = new kendo.spreadsheet.BorderPalette(element, { change: this.value.bind(this) });\n            },\n            value: function (state) {\n                if (state === undefined) {\n                    return this._state;\n                } else {\n                    this._state = state;\n                }\n            }\n        });\n        kendo.spreadsheet.dialogs.register('borders', BordersDialog);\n        var ColorChooser = SpreadsheetDialog.extend({\n            init: function (options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n                this.element = this.dialog().element;\n                this.property = options.property;\n                this.options.title = options.title;\n                this.viewModel = kendo.observable({\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this)\n                });\n                kendo.bind(this.element.find('.k-action-buttons'), this.viewModel);\n            },\n            options: { template: '<div></div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>#: messages.apply #</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>#: messages.cancel #</button>' + '</div>' },\n            apply: function () {\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: this.property,\n                        value: this.value()\n                    }\n                });\n            },\n            value: function (e) {\n                if (e === undefined) {\n                    return this._value;\n                } else {\n                    this._value = e.value;\n                }\n            }\n        });\n        var ColorPickerDialog = ColorChooser.extend({\n            init: function (options) {\n                options.width = 177;\n                ColorChooser.fn.init.call(this, options);\n                this._colorPalette();\n            },\n            _colorPalette: function () {\n                var element = this.dialog().element.find('div:first');\n                this.colorPalette = element.kendoColorPalette({\n                    palette: [\n                        '#ffffff',\n                        '#000000',\n                        '#d6ecff',\n                        '#4e5b6f',\n                        '#7fd13b',\n                        '#ea157a',\n                        '#feb80a',\n                        '#00addc',\n                        '#738ac8',\n                        '#1ab39f',\n                        '#f2f2f2',\n                        '#7f7f7f',\n                        '#a7d6ff',\n                        '#d9dde4',\n                        '#e5f5d7',\n                        '#fad0e4',\n                        '#fef0cd',\n                        '#c5f2ff',\n                        '#e2e7f4',\n                        '#c9f7f1',\n                        '#d8d8d8',\n                        '#595959',\n                        '#60b5ff',\n                        '#b3bcca',\n                        '#cbecb0',\n                        '#f6a1c9',\n                        '#fee29c',\n                        '#8be6ff',\n                        '#c7d0e9',\n                        '#94efe3',\n                        '#bfbfbf',\n                        '#3f3f3f',\n                        '#007dea',\n                        '#8d9baf',\n                        '#b2e389',\n                        '#f272af',\n                        '#fed46b',\n                        '#51d9ff',\n                        '#aab8de',\n                        '#5fe7d5',\n                        '#a5a5a5',\n                        '#262626',\n                        '#003e75',\n                        '#3a4453',\n                        '#5ea226',\n                        '#af0f5b',\n                        '#c58c00',\n                        '#0081a5',\n                        '#425ea9',\n                        '#138677',\n                        '#7f7f7f',\n                        '#0c0c0c',\n                        '#00192e',\n                        '#272d37',\n                        '#3f6c19',\n                        '#750a3d',\n                        '#835d00',\n                        '#00566e',\n                        '#2c3f71',\n                        '#0c594f'\n                    ],\n                    change: this.value.bind(this)\n                }).data('kendoColorPalette');\n            }\n        });\n        kendo.spreadsheet.dialogs.register('colorPicker', ColorPickerDialog);\n        var CustomColorDialog = ColorChooser.extend({\n            init: function (options) {\n                options.width = 268;\n                ColorChooser.fn.init.call(this, options);\n                this.dialog().setOptions({ animation: false });\n                this.dialog().one('activate', this._colorPicker.bind(this));\n            },\n            _colorPicker: function () {\n                var element = this.dialog().element.find('div:first');\n                this.colorPicker = element.kendoFlatColorPicker({ change: this.value.bind(this) }).data('kendoFlatColorPicker');\n            }\n        });\n        kendo.spreadsheet.dialogs.register('customColor', CustomColorDialog);\n        var AlignmentDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.alignmentDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    buttons: [\n                        {\n                            property: 'textAlign',\n                            value: 'left',\n                            iconClass: 'justify-left',\n                            text: messages.buttons.justtifyLeft\n                        },\n                        {\n                            property: 'textAlign',\n                            value: 'center',\n                            iconClass: 'justify-center',\n                            text: messages.buttons.justifyCenter\n                        },\n                        {\n                            property: 'textAlign',\n                            value: 'right',\n                            iconClass: 'justify-right',\n                            text: messages.buttons.justifyRight\n                        },\n                        {\n                            property: 'textAlign',\n                            value: 'justify',\n                            iconClass: 'justify-full',\n                            text: messages.buttons.justifyFull\n                        },\n                        {\n                            property: 'verticalAlign',\n                            value: 'top',\n                            iconClass: 'align-top',\n                            text: messages.buttons.alignTop\n                        },\n                        {\n                            property: 'verticalAlign',\n                            value: 'center',\n                            iconClass: 'align-middle',\n                            text: messages.buttons.alignMiddle\n                        },\n                        {\n                            property: 'verticalAlign',\n                            value: 'bottom',\n                            iconClass: 'align-bottom',\n                            text: messages.buttons.alignBottom\n                        }\n                    ]\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n                this._list();\n            },\n            options: { template: '<ul class=\\'k-list k-reset\\'></ul>' },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                    template: '<a title=\\'#=text#\\' data-property=\\'#=property#\\' data-value=\\'#=value#\\'>' + '<span class=\\'k-icon k-font-icon k-i-#=iconClass#\\'></span>' + '#=text#' + '</a>',\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                var dataItem = e.sender.value()[0];\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: dataItem.property,\n                        value: dataItem.value\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('alignment', AlignmentDialog);\n        var MergeDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.mergeDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    buttons: [\n                        {\n                            value: 'cells',\n                            iconClass: 'merge-cells',\n                            text: messages.buttons.mergeCells\n                        },\n                        {\n                            value: 'horizontally',\n                            iconClass: 'merge-horizontally',\n                            text: messages.buttons.mergeHorizontally\n                        },\n                        {\n                            value: 'vertically',\n                            iconClass: 'merge-vertically',\n                            text: messages.buttons.mergeVertically\n                        },\n                        {\n                            value: 'unmerge',\n                            iconClass: 'normal-layout',\n                            text: messages.buttons.unmerge\n                        }\n                    ]\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n                this._list();\n            },\n            options: { template: '<ul class=\\'k-list k-reset\\'></ul>' },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                    template: '<a title=\\'#=text#\\' data-value=\\'#=value#\\'>' + '<span class=\\'k-icon k-font-icon k-i-#=iconClass#\\'></span>#=text#' + '</a>',\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                var dataItem = e.sender.value()[0];\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'MergeCellCommand',\n                    options: { value: dataItem.value }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('merge', MergeDialog);\n        var FreezeDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.freezeDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    buttons: [\n                        {\n                            value: 'panes',\n                            iconClass: 'freeze-panes',\n                            text: messages.buttons.freezePanes\n                        },\n                        {\n                            value: 'rows',\n                            iconClass: 'freeze-row',\n                            text: messages.buttons.freezeRows\n                        },\n                        {\n                            value: 'columns',\n                            iconClass: 'freeze-col',\n                            text: messages.buttons.freezeColumns\n                        },\n                        {\n                            value: 'unfreeze',\n                            iconClass: 'normal-layout',\n                            text: messages.buttons.unfreeze\n                        }\n                    ]\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n                this._list();\n            },\n            options: { template: '<ul class=\\'k-list k-reset\\'></ul>' },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                    template: '<a title=\\'#=text#\\' data-value=\\'#=value#\\'>' + '<span class=\\'k-icon k-font-icon k-i-#=iconClass#\\'></span>#=text#' + '</a>',\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                var dataItem = e.sender.value()[0];\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'FreezePanesCommand',\n                    options: { value: dataItem.value }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('freeze', FreezeDialog);\n        var ValidationViewModel = kendo.spreadsheet.ValidationCellsViewModel = ObservableObject.extend({\n            init: function (options) {\n                ObservableObject.fn.init.call(this, options);\n                this.bind('change', function (e) {\n                    if (e.field === 'criterion') {\n                        this.reset();\n                        if (this.criterion === 'custom' || this.criterion === 'list') {\n                            this.setHintMessageTemplate();\n                        }\n                    }\n                    if (e.field === 'comparer') {\n                        this.setHintMessageTemplate();\n                    }\n                    if ((e.field == 'hintMessage' || e.field == 'hintTitle') && !this._mute) {\n                        this.shouldBuild = false;\n                    }\n                    if ((e.field == 'from' || e.field == 'to' || e.field == 'hintMessageTemplate' || e.field == 'type') && this.shouldBuild) {\n                        this.buildMessages();\n                    }\n                }.bind(this));\n                this.reset();\n            },\n            buildMessages: function () {\n                this._mute = true;\n                this.set('hintTitle', this.hintTitleTemplate ? kendo.format(this.hintTitleTemplate, this.type) : '');\n                this.set('hintMessage', this.hintMessageTemplate ? kendo.format(this.hintMessageTemplate, this.from, this.to) : '');\n                this._mute = false;\n            },\n            reset: function () {\n                this.setComparers();\n                this.set('comparer', this.comparers[0].type);\n                this.set('from', null);\n                this.set('to', null);\n                this.set('useCustomMessages', false);\n                this.shouldBuild = true;\n                this.hintTitleTemplate = this.defaultHintTitle;\n                this.buildMessages();\n            },\n            setComparers: function () {\n                var all = this.defaultComparers;\n                var comparers = [];\n                if (this.criterion === 'text') {\n                    var text_comparers = [\n                        'equalTo',\n                        'notEqualTo'\n                    ];\n                    for (var idx = 0; idx < all.length; idx++) {\n                        if (text_comparers[0] == all[idx].type) {\n                            comparers.push(all[idx]);\n                            text_comparers.shift();\n                        }\n                    }\n                } else {\n                    comparers = all.slice();\n                }\n                this.set('comparers', comparers);\n            },\n            setHintMessageTemplate: function () {\n                if (this.criterion !== 'custom' && this.criterion !== 'list') {\n                    this.set('hintMessageTemplate', kendo.format(this.defaultHintMessage, this.criterion, this.comparerMessages[this.comparer]));\n                } else {\n                    this.set('hintMessageTemplate', '');\n                    this.set('hintMessage', '');\n                }\n            },\n            isAny: function () {\n                return this.get('criterion') === 'any';\n            },\n            isNumber: function () {\n                return this.get('criterion') === 'number';\n            },\n            showToForNumber: function () {\n                return this.showTo() && this.isNumber();\n            },\n            showToForDate: function () {\n                return this.showTo() && this.isDate();\n            },\n            isText: function () {\n                return this.get('criterion') === 'text';\n            },\n            isDate: function () {\n                return this.get('criterion') === 'date';\n            },\n            isList: function () {\n                return this.get('criterion') === 'list';\n            },\n            isCustom: function () {\n                return this.get('criterion') === 'custom';\n            },\n            showRemove: function () {\n                return this.get('hasValidation');\n            },\n            showTo: function () {\n                return this.get('comparer') == 'between' || this.get('comparer') == 'notBetween';\n            },\n            update: function (validation) {\n                this.set('hasValidation', !!validation);\n                if (validation) {\n                    this.fromValidationObject(validation);\n                }\n            },\n            fromValidationObject: function (validation) {\n                this.set('criterion', validation.dataType);\n                this.set('comparer', validation.comparerType);\n                this.set('from', validation.from);\n                this.set('to', validation.to);\n                this.set('type', validation.type);\n                this.set('ignoreBlank', validation.allowNulls);\n                if (validation.messageTemplate || validation.titleTemplate) {\n                    this.hintMessageTemplate = validation.messageTemplate;\n                    this.hintMessage = validation.messageTemplate;\n                    this.hintTitleTemplate = validation.titleTemplate;\n                    this.hintTitle = validation.titleTemplate;\n                    this.useCustomMessages = true;\n                    this.buildMessages();\n                } else {\n                    this.useCustomMessages = false;\n                }\n            },\n            toValidationObject: function () {\n                if (this.criterion === 'any') {\n                    return null;\n                }\n                var options = {\n                    type: this.type,\n                    dataType: this.criterion,\n                    comparerType: this.comparer,\n                    from: this.from,\n                    to: this.to,\n                    allowNulls: this.ignoreBlank\n                };\n                if (this.useCustomMessages) {\n                    options.messageTemplate = this.shouldBuild ? this.hintMessageTemplate : this.hintMessage;\n                    options.titleTemplate = this.hintTitle;\n                }\n                return options;\n            }\n        });\n        var ValidationDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.validationDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    hintMessage: messages.hintMessage,\n                    hintTitle: messages.hintTitle,\n                    criteria: [\n                        {\n                            type: 'any',\n                            name: messages.criteria.any\n                        },\n                        {\n                            type: 'number',\n                            name: messages.criteria.number\n                        },\n                        {\n                            type: 'text',\n                            name: messages.criteria.text\n                        },\n                        {\n                            type: 'date',\n                            name: messages.criteria.date\n                        },\n                        {\n                            type: 'custom',\n                            name: messages.criteria.custom\n                        },\n                        {\n                            type: 'list',\n                            name: messages.criteria.list\n                        }\n                    ],\n                    comparers: [\n                        {\n                            type: 'greaterThan',\n                            name: messages.comparers.greaterThan\n                        },\n                        {\n                            type: 'lessThan',\n                            name: messages.comparers.lessThan\n                        },\n                        {\n                            type: 'between',\n                            name: messages.comparers.between\n                        },\n                        {\n                            type: 'notBetween',\n                            name: messages.comparers.notBetween\n                        },\n                        {\n                            type: 'equalTo',\n                            name: messages.comparers.equalTo\n                        },\n                        {\n                            type: 'notEqualTo',\n                            name: messages.comparers.notEqualTo\n                        },\n                        {\n                            type: 'greaterThanOrEqualTo',\n                            name: messages.comparers.greaterThanOrEqualTo\n                        },\n                        {\n                            type: 'lessThanOrEqualTo',\n                            name: messages.comparers.lessThanOrEqualTo\n                        }\n                    ],\n                    comparerMessages: messages.comparerMessages\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n            },\n            options: {\n                width: 420,\n                criterion: 'any',\n                type: 'reject',\n                ignoreBlank: true,\n                useCustomMessages: false,\n                errorTemplate: '<div class=\"k-widget k-tooltip k-tooltip-validation\" style=\"margin:0.5em\"><span class=\"k-icon k-warning\"> </span>' + '#= message #<div class=\"k-callout k-callout-n\"></div></div>',\n                template: '<div class=\"k-edit-form-container\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.criteria #:</label></div>' + '<div class=\"k-edit-field\">' + '<select data-role=\"dropdownlist\" ' + 'data-text-field=\"name\" ' + 'data-value-field=\"type\" ' + 'data-bind=\"value: criterion, source: criteria\" />' + '</div>' + '<div data-bind=\"visible: isNumber\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.comparer #:</label></div>' + '<div class=\"k-edit-field\">' + '<select data-role=\"dropdownlist\" ' + 'data-text-field=\"name\" ' + 'data-value-field=\"type\" ' + 'data-bind=\"value: comparer, source: comparers\" />' + '</div>' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.min #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.min #\" placeholder=\"e.g. 10\" class=\"k-textbox\" data-bind=\"value: from, enabled: isNumber\" required=\"required\" />' + '</div>' + '<div data-bind=\"visible: showTo\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.max #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.max #\" placeholder=\"e.g. 100\" class=\"k-textbox\" data-bind=\"value: to, enabled: showToForNumber\" required=\"required\" />' + '</div>' + '</div>' + '</div>' + '<div data-bind=\"visible: isText\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.comparer #:</label></div>' + '<div class=\"k-edit-field\">' + '<select data-role=\"dropdownlist\" ' + 'data-text-field=\"name\" ' + 'data-value-field=\"type\" ' + 'data-bind=\"value: comparer, source: comparers\" />' + '</div>' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.value #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.value #\" class=\"k-textbox\" data-bind=\"value: from, enabled: isText\" required=\"required\" />' + '</div>' + '</div>' + '<div data-bind=\"visible: isDate\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.comparer #:</label></div>' + '<div class=\"k-edit-field\">' + '<select data-role=\"dropdownlist\" ' + 'data-text-field=\"name\" ' + 'data-value-field=\"type\" ' + 'data-bind=\"value: comparer, source: comparers\" />' + '</div>' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.start #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.start #\" class=\"k-textbox\" data-bind=\"value: from, enabled: isDate\" required=\"required\" />' + '</div>' + '<div data-bind=\"visible: showTo\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.end #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.end #\" class=\"k-textbox\" data-bind=\"value: to, enabled: showToForDate\" required=\"required\" />' + '</div>' + '</div>' + '</div>' + '<div data-bind=\"visible: isCustom\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.value #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.value #\" class=\"k-textbox\" data-bind=\"value: from, enabled: isCustom\" required=\"required\" />' + '</div>' + '</div>' + '<div data-bind=\"visible: isList\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.value #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.value #\" class=\"k-textbox\" data-bind=\"value: from, enabled: isList\" required=\"required\" />' + '</div>' + '</div>' + '<div data-bind=\"invisible: isAny\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.ignoreBlank #:</label></div>' + '<div class=\"k-edit-field\">' + '<input type=\"checkbox\" name=\"ignoreBlank\" id=\"ignoreBlank\" class=\"k-checkbox\" data-bind=\"checked: ignoreBlank\"/>' + '<label class=\"k-checkbox-label\" for=\"ignoreBlank\"></label>' + '</div>' + '</div>' + '<div data-bind=\"invisible: isAny\">' + '<div class=\"k-action-buttons\"></div>' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.onInvalidData #:</label></div>' + '<div class=\"k-edit-field\">' + '<input type=\"radio\" id=\"validationTypeReject\" name=\"validationType\" value=\"reject\" data-bind=\"checked: type\" class=\"k-radio\" />' + '<label for=\"validationTypeReject\" class=\"k-radio-label\">' + '#: messages.validationDialog.labels.rejectInput #' + '</label> ' + '<input type=\"radio\" id=\"validationTypeWarning\" name=\"validationType\" value=\"warning\" data-bind=\"checked: type\" class=\"k-radio\" />' + '<label for=\"validationTypeWarning\" class=\"k-radio-label\">' + '#: messages.validationDialog.labels.showWarning #' + '</label>' + '</div>' + '</div>' + '<div data-bind=\"invisible: isAny\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.showHint #:</label></div>' + '<div class=\"k-edit-field\">' + '<input type=\"checkbox\" name=\"useCustomMessages\" id=\"useCustomMessages\" class=\"k-checkbox\" data-bind=\"checked: useCustomMessages\" />' + '<label class=\"k-checkbox-label\" for=\"useCustomMessages\"></label>' + '</div>' + '<div data-bind=\"visible: useCustomMessages\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.hintTitle #:</label></div>' + '<div class=\"k-edit-field\">' + '<input class=\"k-textbox\" placeholder=\"#: messages.validationDialog.placeholders.typeTitle #\" data-bind=\"value: hintTitle\" />' + '</div>' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.hintMessage #:</label></div>' + '<div class=\"k-edit-field\">' + '<input class=\"k-textbox\" placeholder=\"#: messages.validationDialog.placeholders.typeMessage #\" data-bind=\"value: hintMessage\" />' + '</div>' + '</div>' + '</div>' + '<div class=\"k-action-buttons\">' + '<button class=\"k-button\" data-bind=\"visible: showRemove, click: remove\">#: messages.remove #</button>' + '<button class=\"k-button k-primary\" data-bind=\"click: apply\">#: messages.apply #</button>' + '<button class=\"k-button\" data-bind=\"click: close\">#: messages.cancel #</button>' + '</div>' + '</div>'\n            },\n            open: function (range) {\n                var options = this.options;\n                var element;\n                this.viewModel = new ValidationViewModel({\n                    type: options.type,\n                    defaultHintMessage: options.hintMessage,\n                    defaultHintTitle: options.hintTitle,\n                    defaultComparers: options.comparers.slice(0),\n                    comparerMessages: options.comparerMessages,\n                    criteria: options.criteria.slice(0),\n                    criterion: options.criterion,\n                    ignoreBlank: options.ignoreBlank,\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this),\n                    remove: this.remove.bind(this)\n                });\n                this.viewModel.update(range.validation());\n                SpreadsheetDialog.fn.open.call(this);\n                element = this.dialog().element;\n                if (this.validatable) {\n                    this.validatable.destroy();\n                }\n                kendo.bind(element, this.viewModel);\n                this.validatable = new kendo.ui.Validator(element.find('.k-edit-form-container'), {\n                    validateOnBlur: false,\n                    errorTemplate: this.options.errorTemplate || undefined\n                });\n            },\n            apply: function () {\n                if (this.validatable.validate()) {\n                    SpreadsheetDialog.fn.apply.call(this);\n                    this.trigger('action', {\n                        command: 'EditValidationCommand',\n                        options: { value: this.viewModel.toValidationObject() }\n                    });\n                }\n            },\n            remove: function () {\n                this.viewModel.set('criterion', 'any');\n                this.apply();\n            }\n        });\n        kendo.spreadsheet.dialogs.register('validation', ValidationDialog);\n        kendo.spreadsheet.dialogs.ValidationDialog = ValidationDialog;\n        var ExportAsDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.exportAsDialog || MESSAGES;\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n                this.viewModel = kendo.observable({\n                    title: this.options.title,\n                    name: this.options.name,\n                    extension: this.options.extension,\n                    fileFormats: this.options.fileFormats,\n                    excel: options.excelExport,\n                    pdf: {\n                        proxyURL: options.pdfExport.proxyURL,\n                        forceProxy: options.pdfExport.forceProxy,\n                        title: options.pdfExport.title,\n                        author: options.pdfExport.author,\n                        subject: options.pdfExport.subject,\n                        keywords: options.pdfExport.keywords,\n                        creator: options.pdfExport.creator,\n                        date: options.pdfExport.date,\n                        fitWidth: this.options.pdf.fitWidth,\n                        area: this.options.pdf.area,\n                        areas: this.options.pdf.areas,\n                        paperSize: this.options.pdf.paperSize,\n                        paperSizes: this.options.pdf.paperSizes,\n                        margin: this.options.pdf.margin,\n                        margins: this.options.pdf.margins,\n                        landscape: this.options.pdf.landscape,\n                        guidelines: this.options.pdf.guidelines,\n                        hCenter: this.options.pdf.hCenter,\n                        vCenter: this.options.pdf.vCenter\n                    },\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this)\n                });\n                this.viewModel.bind('change', function (e) {\n                    if (e.field === 'extension') {\n                        this.set('showPdfOptions', this.extension === '.pdf' ? true : false);\n                    }\n                });\n                kendo.bind(this.dialog().element, this.viewModel);\n            },\n            options: {\n                name: 'Workbook',\n                extension: '.xlsx',\n                fileFormats: [\n                    {\n                        description: 'Excel Workbook (.xlsx)',\n                        extension: '.xlsx'\n                    },\n                    {\n                        description: 'Portable Document Format(.pdf)',\n                        extension: '.pdf'\n                    }\n                ],\n                pdf: {\n                    fitWidth: true,\n                    area: 'workbook',\n                    areas: [\n                        {\n                            area: 'workbook',\n                            text: 'Entire Workbook'\n                        },\n                        {\n                            area: 'sheet',\n                            text: 'Active Sheet'\n                        },\n                        {\n                            area: 'selection',\n                            text: 'Selection'\n                        }\n                    ],\n                    paperSize: 'a4',\n                    paperSizes: [\n                        {\n                            value: 'a2',\n                            text: 'A2 (420 mm \\xD7 594 mm)     '\n                        },\n                        {\n                            value: 'a3',\n                            text: 'A3 (297 mm x 420 mm)     '\n                        },\n                        {\n                            value: 'a4',\n                            text: 'A4 (210 mm x 297 mm)     '\n                        },\n                        {\n                            value: 'a5',\n                            text: 'A5 (148 mm x 210 mm)     '\n                        },\n                        {\n                            value: 'b3',\n                            text: 'B3 (353 mm \\xD7 500 mm)     '\n                        },\n                        {\n                            value: 'b4',\n                            text: 'B4 (250 mm x 353 mm)     '\n                        },\n                        {\n                            value: 'b5',\n                            text: 'B5 (176 mm x 250 mm)     '\n                        },\n                        {\n                            value: 'folio',\n                            text: 'Folio (8.5\" x 13\")       '\n                        },\n                        {\n                            value: 'legal',\n                            text: 'Legal (8.5\" x 14\")       '\n                        },\n                        {\n                            value: 'letter',\n                            text: 'Letter (8.5\" x 11\")      '\n                        },\n                        {\n                            value: 'tabloid',\n                            text: 'Tabloid (11\" x 17\")      '\n                        },\n                        {\n                            value: 'executive',\n                            text: 'Executive (7.25\" x 10.5\")'\n                        }\n                    ],\n                    margin: {\n                        bottom: '0.75in',\n                        left: '0.7in',\n                        right: '0.7in',\n                        top: '0.75in'\n                    },\n                    margins: [\n                        {\n                            value: {\n                                bottom: '0.75in',\n                                left: '0.7in',\n                                right: '0.7in',\n                                top: '0.75in'\n                            },\n                            text: 'Normal'\n                        },\n                        {\n                            value: {\n                                bottom: '0.75in',\n                                left: '0.25in',\n                                right: '0.25in',\n                                top: '0.75in'\n                            },\n                            text: 'Narrow'\n                        },\n                        {\n                            value: {\n                                bottom: '1in',\n                                left: '1in',\n                                right: '1in',\n                                top: '1in'\n                            },\n                            text: 'Wide'\n                        }\n                    ],\n                    landscape: true,\n                    guidelines: true,\n                    hCenter: true,\n                    vCenter: true\n                },\n                width: 520,\n                template: '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.fileName #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input class=\\'k-textbox\\' data-bind=\\'value: name\\' />' + '</div>' + '<div >' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.saveAsType #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<select data-role=\\'dropdownlist\\' class=\\'k-file-format\\' ' + 'data-text-field=\\'description\\' ' + 'data-value-field=\\'extension\\' ' + 'data-bind=\\'value: extension, source: fileFormats\\' />' + '</div>' + '</div>' + '<div class=\\'export-config\\' data-bind=\\'visible: showPdfOptions\\'>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.exportArea #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<select data-role=\\'dropdownlist\\' class=\\'k-file-format\\' ' + 'data-text-field=\\'text\\' ' + 'data-value-field=\\'area\\' ' + 'data-bind=\\'value: pdf.area, source: pdf.areas\\' />' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.paperSize#:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<select data-role=\\'dropdownlist\\' class=\\'k-file-format\\' ' + 'data-text-field=\\'text\\' ' + 'data-value-field=\\'value\\' ' + 'data-bind=\\'value: pdf.paperSize, source: pdf.paperSizes\\' />' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.margins #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<select data-role=\\'dropdownlist\\' class=\\'k-file-format\\' ' + 'data-value-primitive=\\'true\\'' + 'data-text-field=\\'text\\' ' + 'data-value-field=\\'value\\' ' + 'data-bind=\\'value: pdf.margin, source: pdf.margins\\' />' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.orientation #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input type=\\'radio\\' id=\\'k-orientation-portrait\\' name=\\'orientation\\' data-type=\\'boolean\\' data-bind=\\'checked: pdf.landscape\\' value=\\'false\\' /><label class=\\'k-orientation-label k-orientation-portrait-label\\' for=\\'k-orientation-portrait\\'></label>' + '<input type=\\'radio\\' id=\\'k-orientation-landscape\\' name=\\'orientation\\' data-type=\\'boolean\\' data-bind=\\'checked: pdf.landscape\\' value=\\'true\\' /><label class=\\'k-orientation-label k-orientation-landscape-label\\' for=\\'k-orientation-landscape\\'></label>' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.print #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input class=\\'k-checkbox\\' id=\\'guidelines\\' type=\\'checkbox\\' data-bind=\\'checked: pdf.guidelines\\'/><label class=\\'k-checkbox-label\\' for=\\'guidelines\\'>#: messages.exportAsDialog.labels.guidelines#</label>' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.scale #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input class=\\'k-checkbox\\' id=\\'fitWidth\\' type=\\'checkbox\\' data-bind=\\'checked: pdf.fitWidth\\'/><label class=\\'k-checkbox-label\\' for=\\'fitWidth\\'>#: messages.exportAsDialog.labels.fit #</label>' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.center #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input class=\\'k-checkbox\\' id=\\'hCenter\\' type=\\'checkbox\\' data-bind=\\'checked: pdf.hCenter\\'/><label class=\\'k-checkbox-label\\' for=\\'hCenter\\'>#: messages.exportAsDialog.labels.horizontally #</label>' + '<input class=\\'k-checkbox\\' id=\\'vCenter\\' type=\\'checkbox\\' data-bind=\\'checked: pdf.vCenter\\'/><label class=\\'k-checkbox-label\\' for=\\'vCenter\\'>#: messages.exportAsDialog.labels.vertically #</label>' + '</div>' + '<div class=\\'k-page-orientation\\' data-bind=\\'css: {k-page-landscape: pdf.landscape}\\'>' + '<div class=\\'k-margins-horizontal\\'></div>' + '<div class=\\'k-margins-vertical\\'></div>' + '</div>' + '</div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>#: messages.save #</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>#: messages.cancel #</button>' + '</div>'\n            },\n            apply: function () {\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'SaveAsCommand',\n                    options: this.viewModel\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('exportAs', ExportAsDialog);\n        var ModifyMergedDialog = MessageDialog.extend({ options: { messageId: 'modifyMergedDialog.errorMessage' } });\n        kendo.spreadsheet.dialogs.register('modifyMerged', ModifyMergedDialog);\n        var OverflowDialog = MessageDialog.extend({ options: { messageId: 'overflowDialog.errorMessage' } });\n        kendo.spreadsheet.dialogs.register('overflow', OverflowDialog);\n        var UseKeyboardDialog = MessageDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.useKeyboardDialog || MESSAGES;\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n            },\n            options: { template: '#: messages.useKeyboardDialog.errorMessage #' + '<div>Ctrl+C #: messages.useKeyboardDialog.labels.forCopy #</div>' + '<div>Ctrl+X #: messages.useKeyboardDialog.labels.forCut #</div>' + '<div>Ctrl+V #: messages.useKeyboardDialog.labels.forPaste #</div>' + '<div class=\"k-action-buttons\">' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: close\\'>' + '#= messages.okText #' + '</button>' + '</div>' }\n        });\n        kendo.spreadsheet.dialogs.register('useKeyboard', UseKeyboardDialog);\n        var UnsupportedSelectionDialog = MessageDialog.extend({ options: { messageId: 'unsupportedSelectionDialog.errorMessage' } });\n        kendo.spreadsheet.dialogs.register('unsupportedSelection', UnsupportedSelectionDialog);\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/sheetbinder', [\n        'kendo.core',\n        'kendo.data',\n        'spreadsheet/sheet'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var SheetDataSourceBinder = kendo.Class.extend({\n            init: function (options) {\n                this.options = $.extend({}, this.options, options);\n                this.columns = this._normalizeColumns(this.options.columns);\n                this._sheet();\n                this._dataSource();\n                this._header();\n                this.dataSource.fetch();\n            },\n            _sheet: function () {\n                this.sheet = this.options.sheet;\n                this._sheetChangeHandler = this._sheetChange.bind(this);\n                this._sheetDeleteRowHandler = this._sheetDeleteRow.bind(this);\n                this._sheetInsertRowHandler = this._sheetInsertRow.bind(this);\n                this.sheet.bind('change', this._sheetChangeHandler).bind('deleteRow', this._sheetDeleteRowHandler).bind('insertRow', this._sheetInsertRowHandler);\n            },\n            _sheetInsertRow: function (e) {\n                if (e.index !== undefined) {\n                    this.dataSource.insert(Math.max(e.index - 1, 0), {});\n                }\n            },\n            _sheetDeleteRow: function (e) {\n                if (e.index !== undefined) {\n                    var dataSource = this.dataSource;\n                    var model = dataSource.view()[e.index - 1];\n                    if (model) {\n                        dataSource.remove(model);\n                    }\n                }\n            },\n            _header: function () {\n                this.sheet.batch(function () {\n                    this.columns.forEach(function (column, index) {\n                        this.sheet.range(0, index).value(column.title);\n                    }.bind(this));\n                }.bind(this));\n            },\n            _sheetChange: function (e) {\n                if (e.recalc && e.ref) {\n                    var dataSource = this.dataSource;\n                    var data = dataSource.view();\n                    var columns = this.columns;\n                    if (!columns.length && data.length) {\n                        columns = Object.keys(data[0].toJSON());\n                    }\n                    this._skipRebind = true;\n                    var values = this.sheet.range(e.ref).values();\n                    e.ref.forEach(function (ref) {\n                        ref = ref.toRangeRef();\n                        var record;\n                        var valueIndex = 0;\n                        for (var ri = ref.topLeft.row; ri <= ref.bottomRight.row; ri++) {\n                            record = data[ri - 1];\n                            if (!record) {\n                                record = dataSource.insert(ri - 1, {});\n                                data = dataSource.view();\n                            }\n                            var colValueIndex = 0;\n                            for (var ci = ref.topLeft.col; ci <= ref.bottomRight.col && ci < columns.length; ci++) {\n                                record.set(columns[ci].field, values[valueIndex][colValueIndex++]);\n                            }\n                            valueIndex++;\n                        }\n                    });\n                    this._skipRebind = false;\n                }\n            },\n            _normalizeColumns: function (columns) {\n                return columns.map(function (column) {\n                    var field = column.field || column;\n                    return {\n                        field: field,\n                        title: column.title || field\n                    };\n                });\n            },\n            _dataSource: function () {\n                var options = this.options;\n                var dataSource = options.dataSource;\n                dataSource = Array.isArray(dataSource) ? { data: dataSource } : dataSource;\n                if (this.dataSource && this._changeHandler) {\n                    this.dataSource.unbind('change', this._changeHandler);\n                } else {\n                    this._changeHandler = this._change.bind(this);\n                }\n                this.dataSource = kendo.data.DataSource.create(dataSource).bind('change', this._changeHandler);\n            },\n            _change: function () {\n                if (this._skipRebind) {\n                    return;\n                }\n                var data = this.dataSource.view();\n                var columns = this.columns;\n                if (!columns.length && data.length) {\n                    this.columns = columns = this._normalizeColumns(Object.keys(data[0].toJSON()));\n                    this._header();\n                }\n                var getters = columns.map(function (column) {\n                    return kendo.getter(column.field);\n                });\n                this.sheet.batch(function () {\n                    for (var idx = 0, length = data.length; idx < length; idx++) {\n                        for (var getterIdx = 0; getterIdx < getters.length; getterIdx++) {\n                            this.sheet.range(idx + 1, getterIdx).value(getters[getterIdx](data[idx]));\n                        }\n                    }\n                }.bind(this));\n            },\n            destroy: function () {\n                this.dataSource.unbind('change', this._changeHandler);\n                this.sheet.unbind('change', this._sheetChangeHandler).unbind('deleteRow', this._sheetDeleteRowHandler).unbind('insertRow', this._sheetInsertRowHandler);\n            },\n            options: { columns: [] }\n        });\n        kendo.spreadsheet.SheetDataSourceBinder = SheetDataSourceBinder;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/filtermenu', [\n        'kendo.core',\n        'kendo.popup',\n        'kendo.treeview',\n        'kendo.numerictextbox',\n        'kendo.datepicker',\n        'kendo.datetimepicker'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Widget = kendo.ui.Widget;\n        var classNames = {\n            details: 'k-details',\n            button: 'k-button',\n            detailsSummary: 'k-details-summary',\n            detailsContent: 'k-details-content',\n            icon: 'k-icon k-font-icon',\n            iconCollapse: 'k-i-collapse-se',\n            iconExpand: 'k-i-expand-e',\n            iconSearch: 'k-i-search',\n            textbox: 'k-textbox',\n            wrapper: 'k-spreadsheet-filter-menu',\n            filterByCondition: 'k-spreadsheet-condition-filter',\n            filterByValue: 'k-spreadsheet-value-filter',\n            valuesTreeViewWrapper: 'k-spreadsheet-value-treeview-wrapper',\n            actionButtons: 'k-action-buttons'\n        };\n        var Details = Widget.extend({\n            init: function (element, options) {\n                Widget.fn.init.call(this, element, options);\n                this.element.addClass(FilterMenu.classNames.details);\n                this._summary = this.element.find('.' + FilterMenu.classNames.detailsSummary).on('click', this._toggle.bind(this));\n                var iconClass = options.expanded ? FilterMenu.classNames.iconCollapse : FilterMenu.classNames.iconExpand;\n                this._icon = $('<span />', { 'class': FilterMenu.classNames.icon + ' ' + iconClass }).prependTo(this._summary);\n                this._container = kendo.wrap(this._summary.next(), true);\n                if (!options.expanded) {\n                    this._container.hide();\n                }\n            },\n            options: { name: 'Details' },\n            events: ['toggle'],\n            visible: function () {\n                return this.options.expanded;\n            },\n            toggle: function (show) {\n                var animation = kendo.fx(this._container).expand('vertical');\n                animation.stop()[show ? 'reverse' : 'play']();\n                this._icon.toggleClass(FilterMenu.classNames.iconExpand, show).toggleClass(FilterMenu.classNames.iconCollapse, !show);\n                this.options.expanded = !show;\n            },\n            _toggle: function () {\n                var show = this.visible();\n                this.toggle(show);\n                this.trigger('toggle', { show: show });\n            }\n        });\n        var FILTERMENU_MESSAGES = kendo.spreadsheet.messages.filterMenu = {\n            sortAscending: 'Sort range A to Z',\n            sortDescending: 'Sort range Z to A',\n            filterByValue: 'Filter by value',\n            filterByCondition: 'Filter by condition',\n            apply: 'Apply',\n            search: 'Search',\n            addToCurrent: 'Add to current selection',\n            clear: 'Clear',\n            blanks: '(Blanks)',\n            operatorNone: 'None',\n            and: 'AND',\n            or: 'OR',\n            operators: {\n                string: {\n                    contains: 'Text contains',\n                    doesnotcontain: 'Text does not contain',\n                    startswith: 'Text starts with',\n                    endswith: 'Text ends with'\n                },\n                date: {\n                    eq: 'Date is',\n                    neq: 'Date is not',\n                    lt: 'Date is before',\n                    gt: 'Date is after'\n                },\n                number: {\n                    eq: 'Is equal to',\n                    neq: 'Is not equal to',\n                    gte: 'Is greater than or equal to',\n                    gt: 'Is greater than',\n                    lte: 'Is less than or equal to',\n                    lt: 'Is less than'\n                }\n            }\n        };\n        kendo.data.binders.spreadsheetFilterValue = kendo.data.Binder.extend({\n            init: function (element, bindings, options) {\n                kendo.data.Binder.fn.init.call(this, element, bindings, options);\n                this._change = $.proxy(this.change, this);\n                $(this.element).on('change', this._change);\n            },\n            refresh: function () {\n                var that = this, value = that.bindings.spreadsheetFilterValue.get();\n                $(that.element).val(value instanceof Date ? '' : value);\n            },\n            change: function () {\n                var value = this.element.value;\n                this.bindings.spreadsheetFilterValue.set(value);\n            }\n        });\n        kendo.data.binders.widget.spreadsheetFilterValue = kendo.data.Binder.extend({\n            init: function (widget, bindings, options) {\n                kendo.data.Binder.fn.init.call(this, widget.element[0], bindings, options);\n                this.widget = widget;\n                this._change = $.proxy(this.change, this);\n                this.widget.first('change', this._change);\n            },\n            refresh: function () {\n                var binding = this.bindings.spreadsheetFilterValue, value = binding.get(), type = $(this.widget.element).data('filterType');\n                if (type === 'date' && value instanceof Date || type === 'number' && !isNaN(value)) {\n                    this.widget.value(value);\n                } else {\n                    this.widget.value(null);\n                }\n            },\n            change: function () {\n                var value = this.widget.value(), binding = this.bindings.spreadsheetFilterValue;\n                binding.set(value);\n            }\n        });\n        var templates = {\n            filterByValue: '<div class=\\'' + classNames.detailsSummary + '\\'>#= messages.filterByValue #</div>' + '<div class=\\'' + classNames.detailsContent + '\\'>' + '<div class=\\'k-textbox k-space-right\\'>' + '<input placeholder=\\'#= messages.search #\\' data-#=ns#bind=\\'events: { input: filterValues }\\' />' + '<span class=\\'k-icon k-font-icon k-i-search\\' />' + '</div>' + '<div data-#=ns#bind=\\'visible: hasActiveSearch\\'><input class=\\'k-checkbox\\' type=\\'checkbox\\' data-#=ns#bind=\\'checked: appendToSearch\\' id=\\'_#=guid#\\' /><label class=\\'k-checkbox-label\\' for=\\'_#=guid#\\'>#= messages.addToCurrent #</label></div>' + '<div class=\\'' + classNames.valuesTreeViewWrapper + '\\'>' + '<div data-#=ns#role=\\'treeview\\' ' + 'data-#=ns#checkboxes=\\'{ checkChildren: true }\\' ' + 'data-#=ns#bind=\\'source: valuesDataSource, events: { check: valuesChange, select: valueSelect }\\' ' + '/>' + '</div>' + '</div>',\n            filterByCondition: '<div class=\\'' + classNames.detailsSummary + '\\'>#= messages.filterByCondition #</div>' + '<div class=\\'' + classNames.detailsContent + '\\'>' + '<div>' + '<select ' + 'data-#=ns#role=\"dropdownlist\"' + 'data-#=ns#bind=\"value: operator, source: operators, events: { change: operatorChange } \"' + 'data-value-primitive=\"false\"' + 'data-option-label=\"#=messages.operatorNone#\"' + 'data-height=\"auto\"' + 'data-text-field=\"text\"' + 'data-value-field=\"unique\">' + '</select>' + '</div>' + '<div data-#=ns#bind=\"visible: isString\">' + '<input data-filter-type=\"string\" data-#=ns#bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" class=\"k-textbox\" />' + '</div>' + '<div data-#=ns#bind=\"visible: isNumber\">' + '<input data-filter-type=\"number\" data-#=ns#role=\"numerictextbox\" data-#=ns#bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" />' + '</div>' + '<div data-#=ns#bind=\"visible: isDate\">' + '<input data-filter-type=\"date\" data-#=ns#role=\"datepicker\" data-#=ns#bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" />' + '</div>' + '</div>',\n            menuItem: '<li data-command=\\'#=command#\\' data-dir=\\'#=dir#\\'>' + '<span class=\\'k-icon k-font-icon k-i-#=iconClass#\\'></span>#=text#' + '</li>',\n            actionButtons: '<button data-#=ns#bind=\\'click: apply\\' class=\\'k-button k-primary\\'>#=messages.apply#</button>' + '<button data-#=ns#bind=\\'click: clear\\' class=\\'k-button\\'>#=messages.clear#</button>'\n        };\n        function distinctValues(values) {\n            var hash = {};\n            var result = [];\n            for (var i = 0; i < values.length; i++) {\n                if (!hash[values[i].value]) {\n                    hash[values[i].value] = values[i];\n                    result.push(values[i]);\n                } else if (!hash[values[i].value].checked && values[i].checked) {\n                    hash[values[i].value].checked = true;\n                }\n            }\n            return result;\n        }\n        function filter(dataSource, query) {\n            var hasVisibleChildren = false;\n            var data = dataSource instanceof kendo.data.HierarchicalDataSource && dataSource.data();\n            for (var i = 0; i < data.length; i++) {\n                var item = data[i];\n                var text = item.text.toString().toLowerCase();\n                var itemVisible = query === true || query === '' || text.indexOf(query) >= 0;\n                var anyVisibleChildren = filter(item.children, itemVisible || query);\n                hasVisibleChildren = hasVisibleChildren || anyVisibleChildren || itemVisible;\n                item.hidden = !itemVisible && !anyVisibleChildren;\n                item.checked = !item.hidden;\n            }\n            if (data) {\n                dataSource.filter({\n                    field: 'hidden',\n                    operator: 'neq',\n                    value: true\n                });\n            }\n            return hasVisibleChildren;\n        }\n        function uncheckAll(dataSource) {\n            var data = dataSource instanceof kendo.data.HierarchicalDataSource && dataSource.data();\n            for (var i = 0; i < data.length; i++) {\n                var item = data[i];\n                item.checked = false;\n                if (item.hasChildren) {\n                    uncheckAll(item.children);\n                }\n            }\n        }\n        var FilterMenuViewModel = kendo.spreadsheet.FilterMenuViewModel = kendo.data.ObservableObject.extend({\n            valuesChange: function (e) {\n                var dataSource = e ? e.sender.dataSource : this.valuesDataSource;\n                var checked = function (item) {\n                    return item.checked && item.value;\n                };\n                var value = function (item) {\n                    return item.dataType === 'date' ? kendo.spreadsheet.dateToNumber(item.value) : item.value;\n                };\n                var unique = function (value, index, array) {\n                    return array.lastIndexOf(value) === index;\n                };\n                var data = dataSource.data();\n                var values = data[0].children.data().toJSON();\n                var blanks = values.filter(function (item) {\n                    return item.dataType === 'blank';\n                });\n                blanks = blanks.length ? blanks[0].checked : false;\n                values = values.filter(checked).map(value);\n                if (this.appendToSearch && this.valueFilter && this.valueFilter.values.length) {\n                    values = values.concat(this.valueFilter.values.toJSON()).sort().filter(unique);\n                }\n                this.set('valueFilter', {\n                    values: values,\n                    blanks: blanks\n                });\n            },\n            valueSelect: function (e) {\n                e.preventDefault();\n                var node = e.sender.dataItem(e.node);\n                node.set('checked', !node.checked);\n            },\n            hasActiveSearch: false,\n            appendToSearch: false,\n            filterValues: function (e) {\n                var query = typeof e == 'string' ? e : $(e.target).val().toLowerCase();\n                var dataSource = this.valuesDataSource;\n                this.set('hasActiveSearch', !!query);\n                uncheckAll(dataSource);\n                filter(dataSource, query);\n            },\n            reset: function () {\n                this.set('customFilter', {\n                    logic: 'and',\n                    criteria: [{\n                            operator: null,\n                            value: null\n                        }]\n                });\n                this.set('valueFilter', { values: [] });\n            },\n            operatorChange: function (e) {\n                var dataItem = e.sender.dataItem();\n                this.set('operatorType', dataItem.type);\n                this.set('customFilter.criteria[0].operator', dataItem.value);\n            },\n            isNone: function () {\n                return this.get('operatorType') === undefined;\n            },\n            isString: function () {\n                return this.get('operatorType') === 'string';\n            },\n            isNumber: function () {\n                return this.get('operatorType') === 'number';\n            },\n            isDate: function () {\n                return this.get('operatorType') === 'date';\n            }\n        });\n        function flattenOperators(operators) {\n            var messages = FILTERMENU_MESSAGES.operators;\n            var result = [];\n            for (var type in operators) {\n                if (!operators.hasOwnProperty(type)) {\n                    continue;\n                }\n                for (var operator in operators[type]) {\n                    if (!operators[type].hasOwnProperty(operator)) {\n                        continue;\n                    }\n                    result.push({\n                        text: messages[type][operator],\n                        value: operator,\n                        unique: type + '_' + operator,\n                        type: type\n                    });\n                }\n            }\n            return result;\n        }\n        var FilterMenuController = kendo.spreadsheet.FilterMenuController = {\n            valuesTree: function (range, column) {\n                return [{\n                        text: 'All',\n                        expanded: true,\n                        checked: true,\n                        items: this.values(range.resize({ top: 1 }), column)\n                    }];\n            },\n            values: function (range, column) {\n                var values = [];\n                var messages = FILTERMENU_MESSAGES;\n                var columnRange = range.column(column);\n                var sheet = range.sheet();\n                columnRange.forEachCell(function (row, col, cell) {\n                    if (cell.value === undefined) {\n                        cell.dataType = 'blank';\n                    } else if (cell.format) {\n                        cell.dataType = kendo.spreadsheet.formatting.type(cell.value, cell.format);\n                    } else {\n                        cell.dataType = typeof cell.value;\n                    }\n                    if (cell.value !== null && cell.format) {\n                        cell.text = kendo.spreadsheet.formatting.text(cell.value, cell.format);\n                    } else {\n                        cell.text = cell.value ? cell.value : messages.blanks;\n                    }\n                    if (cell.dataType === 'percent') {\n                        cell.dataType = 'number';\n                    }\n                    if (cell.dataType === 'date') {\n                        cell.value = kendo.spreadsheet.numberToDate(cell.value);\n                    }\n                    if (cell.hasOwnProperty('wrap')) {\n                        delete cell.wrap;\n                    }\n                    cell.checked = !sheet.isHiddenRow(row);\n                    values.push(cell);\n                });\n                values = distinctValues(values);\n                values.sort(function (a, b) {\n                    if (a.dataType === b.dataType) {\n                        return 0;\n                    }\n                    if (a.dataType === 'blank' || b.dataType === 'blank') {\n                        return a.dataType === 'blank' ? -1 : 1;\n                    }\n                    if (a.dataType === 'number' || b.dataType === 'number') {\n                        return a.dataType === 'number' ? -1 : 1;\n                    }\n                    if (a.dataType === 'date' || b.dataType === 'date') {\n                        return a.dataType === 'date' ? -1 : 1;\n                    }\n                    return 0;\n                });\n                return values;\n            },\n            filterType: function (range, column) {\n                var sheet = range.sheet();\n                var filter = this.filterForColumn(column, sheet);\n                var type;\n                filter = filter && filter.filter.toJSON();\n                if (filter && filter.filter == 'custom') {\n                    var value = filter.criteria[0].value;\n                    if (value instanceof Date) {\n                        type = 'date';\n                    } else if (typeof value == 'string') {\n                        type = 'string';\n                    } else if (typeof value == 'number') {\n                        type = 'number';\n                    }\n                }\n                if (!type) {\n                    var topValue = this.values(range.row(1), column)[0];\n                    type = topValue && topValue.dataType;\n                    if (type == 'blank') {\n                        type = null;\n                    }\n                }\n                return type;\n            },\n            filterForColumn: function (column, sheet) {\n                var allFilters = sheet.filter();\n                var filters;\n                if (allFilters) {\n                    filters = allFilters.columns.filter(function (item) {\n                        return item.index === column;\n                    })[0];\n                }\n                return filters;\n            },\n            filter: function (column, sheet) {\n                var columnFilters = this.filterForColumn(column, sheet);\n                if (!columnFilters) {\n                    return;\n                }\n                var options = columnFilters.filter.toJSON();\n                var type = options.filter;\n                delete options.filter;\n                var result = {\n                    type: type,\n                    options: options\n                };\n                var criteria = options.criteria;\n                if (criteria && criteria.length) {\n                    result.operator = criteria[0].operator;\n                }\n                return result;\n            }\n        };\n        var FilterMenu = Widget.extend({\n            init: function (element, options) {\n                Widget.call(this, element, options);\n                this.element.addClass(FilterMenu.classNames.wrapper);\n                this.viewModel = new FilterMenuViewModel({\n                    active: 'value',\n                    operator: null,\n                    operators: flattenOperators(this.options.operators),\n                    clear: this.clear.bind(this),\n                    apply: this.apply.bind(this)\n                });\n                this._filterInit();\n                this._popup();\n                this._sort();\n                this._filterByCondition();\n                this._filterByValue();\n                this._actionButtons();\n            },\n            options: {\n                name: 'FilterMenu',\n                column: 0,\n                range: null,\n                operators: {\n                    string: {\n                        contains: 'Text contains',\n                        doesnotcontain: 'Text does not contain',\n                        startswith: 'Text starts with',\n                        endswith: 'Text ends with'\n                    },\n                    date: {\n                        eq: 'Date is',\n                        neq: 'Date is not',\n                        lt: 'Date is before',\n                        gt: 'Date is after'\n                    },\n                    number: {\n                        eq: 'Is equal to',\n                        neq: 'Is not equal to',\n                        gte: 'Is greater than or equal to',\n                        gt: 'Is greater than',\n                        lte: 'Is less than or equal to',\n                        lt: 'Is less than'\n                    }\n                }\n            },\n            events: ['action'],\n            destroy: function () {\n                Widget.fn.destroy.call(this);\n                this.menu.destroy();\n                this.valuesTreeView.destroy();\n                this.popup.destroy();\n            },\n            openFor: function (anchor) {\n                this.popup.setOptions({ anchor: anchor });\n                this.popup.open();\n            },\n            close: function () {\n                this.popup.close();\n            },\n            clear: function () {\n                this.action({\n                    command: 'ClearFilterCommand',\n                    options: { column: this.options.column }\n                });\n                this.viewModel.reset();\n                this.close();\n            },\n            apply: function () {\n                this._active();\n                var options = {\n                    operatingRange: this.options.range,\n                    column: this.options.column\n                };\n                var valueFilter;\n                var customFilter;\n                if (this.viewModel.active === 'value') {\n                    this.viewModel.valuesChange({ sender: this.valuesTreeView });\n                    valueFilter = this.viewModel.valueFilter.toJSON();\n                    if (valueFilter.values && valueFilter.values.length) {\n                        options.valueFilter = valueFilter;\n                    }\n                } else if (this.viewModel.active === 'custom') {\n                    customFilter = this.viewModel.customFilter.toJSON();\n                    if (customFilter.criteria.length && customFilter.criteria[0].value !== null) {\n                        options.customFilter = customFilter;\n                    }\n                }\n                if (options.valueFilter || options.customFilter) {\n                    this.action({\n                        command: 'ApplyFilterCommand',\n                        options: options\n                    });\n                }\n            },\n            action: function (options) {\n                this.trigger('action', $.extend({}, options));\n            },\n            _filterInit: function () {\n                var column = this.options.column;\n                var range = this.options.range;\n                var sheet = range.sheet();\n                var activeFilter = FilterMenuController.filter(column, sheet);\n                if (activeFilter) {\n                    var filterType = FilterMenuController.filterType(range, column);\n                    this.viewModel.set('active', activeFilter.type);\n                    this.viewModel.set(activeFilter.type + 'Filter', activeFilter.options);\n                    if (activeFilter.type == 'custom') {\n                        this.viewModel.set('operator', filterType + '_' + activeFilter.operator);\n                        this.viewModel.set('operatorType', filterType);\n                    }\n                } else {\n                    this.viewModel.reset();\n                }\n            },\n            _popup: function () {\n                this.popup = this.element.kendoPopup({ copyAnchorStyles: false }).data('kendoPopup');\n            },\n            _sort: function () {\n                var template = kendo.template(FilterMenu.templates.menuItem);\n                var messages = FILTERMENU_MESSAGES;\n                var items = [\n                    {\n                        command: 'sort',\n                        dir: 'asc',\n                        text: messages.sortAscending,\n                        iconClass: 'sort-asc'\n                    },\n                    {\n                        command: 'sort',\n                        dir: 'desc',\n                        text: messages.sortDescending,\n                        iconClass: 'sort-desc'\n                    }\n                ];\n                var ul = $('<ul />', { 'html': kendo.render(template, items) }).appendTo(this.element);\n                this.menu = ul.kendoMenu({\n                    orientation: 'vertical',\n                    select: function (e) {\n                        var dir = $(e.item).data('dir');\n                        var range = this.options.range.resize({ top: 1 });\n                        var options = {\n                            value: dir,\n                            sheet: false,\n                            operatingRange: range,\n                            column: this.options.column\n                        };\n                        if (range.isSortable()) {\n                            this.action({\n                                command: 'SortCommand',\n                                options: options\n                            });\n                        } else {\n                            this.close();\n                        }\n                    }.bind(this)\n                }).data('kendoMenu');\n            },\n            _appendTemplate: function (template, className, details, expanded) {\n                var compiledTemplate = kendo.template(template);\n                var wrapper = $('<div class=\\'' + className + '\\'/>').html(compiledTemplate({\n                    messages: FILTERMENU_MESSAGES,\n                    guid: kendo.guid(),\n                    ns: kendo.ns\n                }));\n                this.element.append(wrapper);\n                if (details) {\n                    details = new Details(wrapper, {\n                        expanded: expanded,\n                        toggle: this._detailToggle.bind(this)\n                    });\n                }\n                kendo.bind(wrapper, this.viewModel);\n                return wrapper;\n            },\n            _detailToggle: function (e) {\n                this.element.find('[data-role=details]').not(e.sender.element).data('kendoDetails').toggle(!e.show);\n            },\n            _filterByCondition: function () {\n                var isExpanded = this.viewModel.active === 'custom';\n                this._appendTemplate(FilterMenu.templates.filterByCondition, FilterMenu.classNames.filterByCondition, true, isExpanded);\n            },\n            _filterByValue: function () {\n                var isExpanded = this.viewModel.active === 'value';\n                var wrapper = this._appendTemplate(FilterMenu.templates.filterByValue, FilterMenu.classNames.filterByValue, true, isExpanded);\n                this.valuesTreeView = wrapper.find('[data-role=treeview]').data('kendoTreeView');\n                var values = FilterMenuController.valuesTree(this.options.range, this.options.column);\n                this.viewModel.set('valuesDataSource', new kendo.data.HierarchicalDataSource({ data: values }));\n            },\n            _actionButtons: function () {\n                this._appendTemplate(FilterMenu.templates.actionButtons, FilterMenu.classNames.actionButtons, false);\n            },\n            _active: function () {\n                var activeContainer = this.element.find('[data-role=details]').filter(function (index, element) {\n                    return $(element).data('kendoDetails').visible();\n                });\n                if (activeContainer.hasClass(FilterMenu.classNames.filterByValue)) {\n                    this.viewModel.set('active', 'value');\n                } else if (activeContainer.hasClass(FilterMenu.classNames.filterByCondition)) {\n                    this.viewModel.set('active', 'custom');\n                }\n            }\n        });\n        kendo.spreadsheet.FilterMenu = FilterMenu;\n        $.extend(true, FilterMenu, {\n            classNames: classNames,\n            templates: templates\n        });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/editor', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var SheetEditor = kendo.Observable.extend({\n            init: function (view) {\n                kendo.Observable.fn.init.call(this);\n                this.view = view;\n                this.formulaBar = view.formulaBar;\n                this.barInput = view.formulaBar.formulaInput;\n                this.cellInput = view.formulaInput;\n                this.barInput.syncWith(this.cellInput);\n                this.cellInput.syncWith(this.barInput);\n                this.barInput.bind('keyup', this._triggerUpdate.bind(this));\n                this.cellInput.bind('keyup', this._triggerUpdate.bind(this));\n                this.barInput.bind('focus', this._focus.bind(this));\n                this.cellInput.bind('focus', this._focus.bind(this));\n            },\n            events: [\n                'activate',\n                'deactivate',\n                'change',\n                'update'\n            ],\n            _focus: function (e) {\n                this.lastActive = e.sender == this.barInput ? 'bar' : 'cell';\n            },\n            _triggerUpdate: function () {\n                this.trigger('update', { value: this.value() });\n            },\n            activeEditor: function () {\n                var editor = null;\n                var activeElement = kendo._activeElement();\n                if (this.barElement()[0] === activeElement) {\n                    editor = this.barInput;\n                } else if (this.cellElement()[0] === activeElement) {\n                    editor = this.cellInput;\n                }\n                return editor;\n            },\n            activate: function (options) {\n                this._active = true;\n                this._rect = options.rect;\n                this.cellInput.position(options.rect);\n                this.cellInput.resize(options.rect);\n                this.cellInput.tooltip(options.tooltip);\n                this.cellInput.activeCell = this.barInput.activeCell = options.range.topLeft;\n                this.trigger('activate');\n                return this;\n            },\n            deactivate: function () {\n                var cellInput = this.cellInput;\n                if (!this._active) {\n                    return;\n                }\n                if (cellInput.value() != this._value) {\n                    if (this.trigger('change', { value: cellInput.value() })) {\n                        return;\n                    }\n                }\n                this._active = false;\n                this._rect = null;\n                cellInput.hide();\n                this.trigger('deactivate');\n            },\n            enable: function (enable) {\n                this.barInput.enable(enable);\n            },\n            barElement: function () {\n                return this.barInput.element;\n            },\n            cellElement: function () {\n                return this.cellInput.element;\n            },\n            focusLastActive: function () {\n                this.focus(this.lastActive);\n            },\n            focus: function (inputType) {\n                inputType = inputType || 'cell';\n                if (inputType === 'cell') {\n                    this.cellInput.element.focus();\n                    this.cellInput.end();\n                } else {\n                    this.barInput.element.focus();\n                }\n            },\n            isActive: function () {\n                return this._active;\n            },\n            isFiltered: function () {\n                return this.barInput.popup.visible() || this.cellInput.popup.visible();\n            },\n            canInsertRef: function (isKeyboardAction) {\n                var editor = this.activeEditor();\n                return editor && editor.canInsertRef(isKeyboardAction);\n            },\n            highlightedRefs: function () {\n                var editor = this.activeEditor();\n                var refs = [];\n                if (editor) {\n                    refs = editor.highlightedRefs();\n                }\n                return refs;\n            },\n            scale: function () {\n                this.cellInput.scale();\n            },\n            toggleTooltip: function (rect) {\n                this.cellInput.toggleTooltip(notEqual(this._rect, rect));\n            },\n            value: function (value) {\n                if (value === undefined) {\n                    return this.barInput.value();\n                }\n                if (value === null) {\n                    value = '';\n                }\n                this._value = value;\n                this.barInput.value(value);\n                this.cellInput.value(value);\n            }\n        });\n        function notEqual(oldRect, newRect) {\n            return oldRect && (oldRect.top !== newRect.top || oldRect.left !== newRect.left);\n        }\n        kendo.spreadsheet.SheetEditor = SheetEditor;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/autofill', [\n        'spreadsheet/runtime',\n        'spreadsheet/range'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var Range = spreadsheet.Range;\n    var runtime = spreadsheet.calc.runtime;\n    var Formula = runtime.Formula;\n    var MSG_INCOMPATIBLE = 'Incompatible ranges in fillFrom';\n    var MSG_NO_DIRECTION = 'Cannot determine fill direction';\n    Range.prototype._previewFillFrom = function (srcRange, direction) {\n        var destRange = this, sheet = destRange._sheet;\n        if (typeof srcRange == 'string') {\n            srcRange = sheet.range(srcRange);\n        }\n        var src = srcRange._ref.toRangeRef();\n        var dest = destRange._ref.toRangeRef();\n        if (src.intersects(dest)) {\n            if (src.eq(dest)) {\n                return null;\n            }\n            dest = dest.clone();\n            if (src.topLeft.eq(dest.topLeft)) {\n                if (src.width() == dest.width()) {\n                    dest.topLeft.row += src.height();\n                    direction = 0;\n                } else if (src.height() == dest.height()) {\n                    dest.topLeft.col += src.width();\n                    direction = 1;\n                } else {\n                    throw new Error(MSG_INCOMPATIBLE);\n                }\n            } else if (src.bottomRight.eq(dest.bottomRight)) {\n                if (src.width() == dest.width()) {\n                    dest.bottomRight.row -= src.height();\n                    direction = 2;\n                } else if (src.height() == dest.height()) {\n                    dest.bottomRight.col -= src.width();\n                    direction = 3;\n                } else {\n                    throw new Error(MSG_INCOMPATIBLE);\n                }\n            } else {\n                throw new Error(MSG_INCOMPATIBLE);\n            }\n            return sheet.range(dest)._previewFillFrom(srcRange, direction);\n        }\n        if (direction == null) {\n            if (src.topLeft.col == dest.topLeft.col) {\n                direction = src.topLeft.row < dest.topLeft.row ? 0 : 2;\n            } else if (src.topLeft.row == dest.topLeft.row) {\n                direction = src.topLeft.col < dest.topLeft.col ? 1 : 3;\n            } else {\n                throw new Error(MSG_NO_DIRECTION);\n            }\n        }\n        var horizontal = direction & 1;\n        var descending = direction & 2;\n        if (horizontal && src.height() != dest.height() || !horizontal && src.width() != dest.width()) {\n            throw new Error(MSG_INCOMPATIBLE);\n        }\n        var data = srcRange._properties(), n;\n        if (!horizontal) {\n            data = transpose(data);\n            n = dest.height();\n        } else {\n            n = dest.width();\n        }\n        var fill = new Array(data.length);\n        for (var i = 0; i < data.length; ++i) {\n            var s = data[i];\n            var f = findSeries(s);\n            var a = fill[i] = new Array(n);\n            for (var j = 0; j < n; ++j) {\n                var idx = descending ? -j - 1 : s.length + j;\n                var srcIdx = descending ? s.length - j % s.length - 1 : j % s.length;\n                a[descending ? n - j - 1 : j] = f(idx, srcIdx);\n            }\n        }\n        if (!horizontal) {\n            fill = transpose(fill);\n        }\n        return {\n            props: fill,\n            direction: direction,\n            dest: destRange\n        };\n    };\n    Range.prototype.fillFrom = function (srcRange, direction) {\n        var x = this._previewFillFrom(srcRange, direction);\n        x.dest._properties(x.props);\n        return x.dest;\n    };\n    function linearRegression(data) {\n        var N = data.length;\n        var mx = (N + 1) / 2, my = data.reduce(function (a, b) {\n                return a + b;\n            }, 0) / N;\n        var s1 = 0, s2 = 0;\n        for (var i = 0; i < N; i++) {\n            var t1 = i + 1 - mx, t2 = data[i] - my;\n            s1 += t1 * t2;\n            s2 += t1 * t1;\n        }\n        if (!s2) {\n            return function (N) {\n                return data[N % data.length];\n            };\n        }\n        var b = s1 / s2, a = my - b * mx;\n        return function (N) {\n            return a + b * (N + 1);\n        };\n    }\n    function findSeries(properties) {\n        function findStep(a) {\n            var diff = a[1] - a[0];\n            for (var i = 2; i < a.length; ++i) {\n                if (a[i] - a[i - 1] != diff) {\n                    return null;\n                }\n            }\n            return diff;\n        }\n        function getData(a) {\n            return a.map(function (v) {\n                return v.number;\n            });\n        }\n        var series = [];\n        var data = properties.map(function (x) {\n            return x.formula || x.value;\n        });\n        forEachSeries(data, function (begin, end, type, a) {\n            var f, values;\n            if (type == 'number') {\n                values = getData(a);\n                if (values.length == 1 && (begin > 0 || end < data.length || formatType(values[0], properties[begin].format) == 'date')) {\n                    values.push(values[0] + 1);\n                }\n                f = linearRegression(values);\n            } else if (type == 'string' || type == 'formula' || type == 'boolean') {\n                f = function (N, i) {\n                    return data[i];\n                };\n            } else if (Array.isArray(type)) {\n                if (a.length == 1) {\n                    f = function (N) {\n                        return type[(a[0].number + N) % type.length];\n                    };\n                } else {\n                    var diff = findStep(getData(a));\n                    if (diff == null) {\n                        f = function (N) {\n                            return a[N % a.length].value;\n                        };\n                    } else {\n                        f = function (N) {\n                            var idx = a[0].number + diff * N;\n                            return type[idx % type.length];\n                        };\n                    }\n                }\n            } else if (type != 'null') {\n                values = getData(a);\n                if (values.length == 1) {\n                    values.push(values[0] + 1);\n                }\n                values = linearRegression(values);\n                f = function (N, i) {\n                    return data[i].replace(/^(.*\\D)\\d+/, '$1' + values(N, i));\n                };\n            } else {\n                f = function () {\n                    return null;\n                };\n            }\n            var s = {\n                f: f,\n                begin: begin,\n                end: end,\n                len: end - begin\n            };\n            for (var i = begin; i < end; ++i) {\n                series[i] = s;\n            }\n        });\n        return function (N, i) {\n            var s = series[i];\n            var q = N / data.length | 0;\n            var r = N % data.length;\n            var n = q * s.len + r - s.begin;\n            var value = s.f(n, i);\n            var props = clone(properties[i]);\n            if (value instanceof Formula) {\n                props.formula = value;\n            } else {\n                props.value = value;\n            }\n            return props;\n        };\n    }\n    function formatType(value, format) {\n        if (format != null) {\n            return spreadsheet.formatting.type(value, format);\n        }\n    }\n    function clone(obj) {\n        var copy = {};\n        Object.keys(obj || {}).forEach(function (key) {\n            copy[key] = obj[key];\n        });\n        return copy;\n    }\n    function forEachSeries(data, f) {\n        var prev = null, start = 0, a = [], type;\n        for (var i = 0; i < data.length; ++i) {\n            type = getType(data[i]);\n            a.push(type);\n            if (prev != null && type.type !== prev.type) {\n                f(start, i, prev.type, a.slice(start, i));\n                start = i;\n            }\n            prev = type;\n        }\n        f(start, i, prev.type, a.slice(start, i));\n    }\n    function getType(el) {\n        if (typeof el == 'number') {\n            return {\n                type: 'number',\n                number: el\n            };\n        }\n        if (typeof el == 'string') {\n            var lst = findStringList(el);\n            if (lst) {\n                return lst;\n            }\n            var m = /^(.*\\D)(\\d+)/.exec(el);\n            if (m) {\n                el = el.replace(/^(.*\\D)\\d+/, '$1-######');\n                return {\n                    type: el,\n                    match: m,\n                    number: parseFloat(m[2])\n                };\n            }\n            return { type: 'string' };\n        }\n        if (typeof el == 'boolean') {\n            return { type: 'boolean' };\n        }\n        if (el == null) {\n            return { type: 'null' };\n        }\n        if (el instanceof Formula) {\n            return { type: 'formula' };\n        }\n        window.console.error(el);\n        throw new Error('Cannot fill data');\n    }\n    function stringLists() {\n        var culture = kendo.culture();\n        return [\n            culture.calendars.standard.days.namesAbbr,\n            culture.calendars.standard.days.names,\n            culture.calendars.standard.months.namesAbbr,\n            culture.calendars.standard.months.names\n        ];\n    }\n    function findStringList(str) {\n        var strl = str.toLowerCase();\n        var lists = stringLists();\n        for (var i = 0; i < lists.length; ++i) {\n            var a = lists[i];\n            for (var j = a.length; --j >= 0;) {\n                var el = a[j].toLowerCase();\n                if (el == strl) {\n                    return {\n                        type: a,\n                        number: j,\n                        value: str\n                    };\n                }\n            }\n        }\n    }\n    function transpose(a) {\n        var height = a.length, width = a[0].length;\n        var t = [];\n        for (var i = 0; i < width; ++i) {\n            t[i] = [];\n            for (var j = 0; j < height; ++j) {\n                t[i][j] = a[j][i];\n            }\n        }\n        return t;\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/print', [\n        'kendo.pdf',\n        'spreadsheet/sheet',\n        'spreadsheet/range',\n        'spreadsheet/references',\n        'spreadsheet/numformat',\n        'util/text-metrics'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var CellRef = spreadsheet.CellRef;\n    var drawing = kendo.drawing;\n    var formatting = spreadsheet.formatting;\n    var geo = kendo.geometry;\n    var GUIDELINE_WIDTH = 0.8;\n    function distributeCoords(heights, pageHeight) {\n        var curr = 0;\n        var out = [];\n        var threshold = 0.2 * pageHeight;\n        var bottom = pageHeight;\n        heights.forEach(function (h) {\n            if (pageHeight && curr + h > bottom) {\n                if (bottom - curr < threshold) {\n                    curr = pageHeight * Math.ceil(curr / pageHeight);\n                }\n                bottom += pageHeight * Math.ceil(h / pageHeight);\n            }\n            out.push(curr);\n            curr += h;\n        });\n        out.push(curr);\n        return out;\n    }\n    function getMergedCells(sheet, range) {\n        var grid = sheet._grid;\n        var primary = {};\n        var secondary = {};\n        sheet.forEachMergedCell(range, function (ref) {\n            var topLeft = ref.topLeft;\n            grid.forEach(ref, function (cellRef) {\n                if (topLeft.eq(cellRef)) {\n                    primary[cellRef.print()] = ref;\n                } else if (range.contains(cellRef)) {\n                    secondary[cellRef.print()] = topLeft;\n                }\n            });\n        });\n        return {\n            primary: primary,\n            secondary: secondary\n        };\n    }\n    function doLayout(sheet, range, options) {\n        var cells = [];\n        var rowHeights = [];\n        var colWidths = [];\n        var mergedCells = getMergedCells(sheet, range);\n        var maxRow = -1, maxCol = -1;\n        sheet.forEach(range, function (row, col, cell) {\n            var relrow = row - range.topLeft.row;\n            var relcol = col - range.topLeft.col;\n            if (!relcol) {\n                rowHeights.push(sheet.rowHeight(row));\n            }\n            if (!relrow) {\n                colWidths.push(sheet.columnWidth(col));\n            }\n            if (sheet.isHiddenColumn(col) || sheet.isHiddenRow(row)) {\n                return;\n            }\n            var nonEmpty = options.forScreen || shouldDrawCell(cell);\n            if (!(options.emptyCells || nonEmpty)) {\n                return;\n            }\n            var id = new CellRef(row, col).print();\n            if (mergedCells.secondary[id]) {\n                return;\n            }\n            if (nonEmpty) {\n                maxRow = Math.max(maxRow, relrow);\n                maxCol = Math.max(maxCol, relcol);\n            } else {\n                cell.empty = true;\n            }\n            var m = mergedCells.primary[id];\n            if (m) {\n                delete mergedCells.primary[id];\n                cell.merged = true;\n                cell.rowspan = m.height();\n                cell.colspan = m.width();\n                if (options.forScreen) {\n                    cell.width = sheet._columns.sum(m.topLeft.col, m.bottomRight.col);\n                    cell.height = sheet._rows.sum(m.topLeft.row, m.bottomRight.row);\n                }\n            } else {\n                cell.rowspan = 1;\n                cell.colspan = 1;\n            }\n            cell.row = relrow;\n            cell.col = relcol;\n            cells.push(cell);\n        });\n        rowHeights = rowHeights.slice(0, maxRow + 1);\n        colWidths = colWidths.slice(0, maxCol + 1);\n        var pageWidth = options.pageWidth;\n        var pageHeight = options.pageHeight;\n        var scaleFactor = 1;\n        if (options.fitWidth) {\n            var width = colWidths.reduce(sum, 0);\n            if (width > pageWidth) {\n                scaleFactor = pageWidth / width;\n                pageWidth /= scaleFactor;\n                pageHeight /= scaleFactor;\n            }\n        }\n        var yCoords = distributeCoords(rowHeights, pageHeight || 0);\n        var xCoords = distributeCoords(colWidths, pageWidth || 0);\n        var boxWidth = 0;\n        var boxHeight = 0;\n        cells = cells.filter(function (cell) {\n            if (cell.empty && (cell.row > maxRow || cell.col > maxCol)) {\n                return false;\n            }\n            cell.left = xCoords[cell.col];\n            cell.top = yCoords[cell.row];\n            if (cell.merged) {\n                if (!options.forScreen) {\n                    cell.right = orlast(xCoords, cell.col + cell.colspan);\n                    cell.bottom = orlast(yCoords, cell.row + cell.rowspan);\n                    cell.width = cell.right - cell.left;\n                    cell.height = cell.bottom - cell.top;\n                } else {\n                    cell.right = cell.left + cell.width;\n                    cell.bottom = cell.top + cell.height;\n                }\n            } else {\n                cell.width = colWidths[cell.col];\n                cell.height = rowHeights[cell.row];\n                cell.bottom = cell.top + cell.height;\n                cell.right = cell.left + cell.width;\n            }\n            boxWidth = Math.max(boxWidth, cell.right);\n            boxHeight = Math.max(boxHeight, cell.bottom);\n            return true;\n        });\n        Object.keys(mergedCells.primary).forEach(function (id) {\n            var ref = mergedCells.primary[id];\n            sheet.forEach(ref.topLeft.toRangeRef(), function (row, col, cell) {\n                var relrow = row - range.topLeft.row;\n                var relcol = col - range.topLeft.col;\n                cell.merged = true;\n                cell.colspan = ref.height();\n                cell.rowspan = ref.width();\n                if (relrow < 0) {\n                    cell.top = -sheet._rows.sum(row, row - relrow - 1);\n                } else {\n                    cell.top = yCoords[relrow];\n                }\n                if (relcol < 0) {\n                    cell.left = -sheet._columns.sum(col, col - relcol - 1);\n                } else {\n                    cell.left = xCoords[relcol];\n                }\n                cell.height = sheet._rows.sum(ref.topLeft.row, ref.bottomRight.row);\n                cell.width = sheet._columns.sum(ref.topLeft.col, ref.bottomRight.col);\n                cell.right = cell.left + cell.width;\n                cell.bottom = cell.top + cell.height;\n                cells.push(cell);\n            });\n        });\n        return {\n            width: boxWidth,\n            height: boxHeight,\n            cells: cells.sort(normalOrder),\n            scale: scaleFactor,\n            xCoords: xCoords,\n            yCoords: yCoords\n        };\n    }\n    function sum(a, b) {\n        return a + b;\n    }\n    function orlast(a, i) {\n        return i < a.length ? a[i] : a[a.length - 1];\n    }\n    function shouldDrawCell(cell) {\n        return cell.value != null || cell.merged || cell.background != null || cell.borderTop != null || cell.borderRight != null || cell.borderBottom != null || cell.borderLeft != null;\n    }\n    function normalOrder(a, b) {\n        if (a.top < b.top) {\n            return -1;\n        } else if (a.top == b.top) {\n            if (a.left < b.left) {\n                return -1;\n            } else if (a.left == b.left) {\n                return 0;\n            } else {\n                return 1;\n            }\n        } else {\n            return 1;\n        }\n    }\n    function drawLayout(layout, group, options) {\n        var ncols = Math.ceil(layout.width / options.pageWidth);\n        var nrows = Math.ceil(layout.height / options.pageHeight);\n        var pageWidth = options.pageWidth / layout.scale;\n        var pageHeight = options.pageHeight / layout.scale;\n        for (var i = 0; i < ncols; ++i) {\n            for (var j = 0; j < nrows; ++j) {\n                addPage(j, i);\n            }\n        }\n        function addPage(row, col) {\n            var left = col * pageWidth;\n            var right = left + pageWidth;\n            var top = row * pageHeight;\n            var bottom = top + pageHeight;\n            var endbottom = 0, endright = 0;\n            var cells = layout.cells.filter(function (cell) {\n                if (cell.right <= left || cell.left >= right || cell.bottom <= top || cell.top >= bottom) {\n                    return false;\n                }\n                endbottom = Math.max(cell.bottom, endbottom);\n                endright = Math.max(cell.right, endright);\n                return true;\n            });\n            if (cells.length > 0) {\n                var page = new drawing.Group();\n                group.append(page);\n                page.clip(drawing.Path.fromRect(new geo.Rect([\n                    0,\n                    0\n                ], [\n                    options.pageWidth,\n                    options.pageHeight\n                ])));\n                var content = new drawing.Group();\n                page.append(content);\n                var matrix = geo.Matrix.scale(layout.scale, layout.scale).multiplyCopy(geo.Matrix.translate(-left, -top));\n                if (options.hCenter || options.vCenter) {\n                    matrix = matrix.multiplyCopy(geo.Matrix.translate(options.hCenter ? (right - endright) / 2 : 0, options.vCenter ? (bottom - endbottom) / 2 : 0));\n                }\n                content.transform(matrix);\n                if (options.guidelines) {\n                    var prev = null;\n                    layout.xCoords.forEach(function (x) {\n                        x = Math.min(x, endright);\n                        if (x !== prev && x >= left && x <= right) {\n                            prev = x;\n                            content.append(new drawing.Path().moveTo(x, top).lineTo(x, endbottom).close().stroke('#999', GUIDELINE_WIDTH));\n                        }\n                    });\n                    var prev = null;\n                    layout.yCoords.forEach(function (y) {\n                        y = Math.min(y, endbottom);\n                        if (y !== prev && y >= top && y <= bottom) {\n                            prev = y;\n                            content.append(new drawing.Path().moveTo(left, y).lineTo(endright, y).close().stroke('#999', GUIDELINE_WIDTH));\n                        }\n                    });\n                }\n                var borders = new drawing.Group();\n                cells.forEach(function (cell) {\n                    drawCell(cell, content, borders, options);\n                });\n                content.append(borders);\n            }\n        }\n    }\n    function drawCell(cell, content, borders, options) {\n        var g = new drawing.Group();\n        content.append(g);\n        var rect = new geo.Rect([\n            cell.left,\n            cell.top\n        ], [\n            cell.width,\n            cell.height\n        ]);\n        if (cell.background || cell.merged) {\n            var r2d2 = rect;\n            if (options.guidelines) {\n                r2d2 = rect.clone();\n                r2d2.origin.x += GUIDELINE_WIDTH / 2;\n                r2d2.origin.y += GUIDELINE_WIDTH / 2;\n                r2d2.size.width -= GUIDELINE_WIDTH;\n                r2d2.size.height -= GUIDELINE_WIDTH;\n            }\n            g.append(new drawing.Rect(r2d2).fill(cell.background || '#fff').stroke(null));\n        }\n        if (cell.borderLeft) {\n            borders.append(new drawing.Path().moveTo(cell.left, cell.top).lineTo(cell.left, cell.bottom).close().stroke(cell.borderLeft.color, cell.borderLeft.size));\n        }\n        if (cell.borderTop) {\n            borders.append(new drawing.Path().moveTo(cell.left, cell.top).lineTo(cell.right, cell.top).close().stroke(cell.borderTop.color, cell.borderTop.size));\n        }\n        if (cell.borderRight) {\n            borders.append(new drawing.Path().moveTo(cell.right, cell.top).lineTo(cell.right, cell.bottom).close().stroke(cell.borderRight.color, cell.borderRight.size));\n        }\n        if (cell.borderBottom) {\n            borders.append(new drawing.Path().moveTo(cell.left, cell.bottom).lineTo(cell.right, cell.bottom).close().stroke(cell.borderBottom.color, cell.borderBottom.size));\n        }\n        var val = cell.value;\n        if (val != null) {\n            var type = typeof val == 'number' ? 'number' : null;\n            var clip = new drawing.Group();\n            clip.clip(drawing.Path.fromRect(rect));\n            g.append(clip);\n            var f;\n            if (cell.format) {\n                f = formatting.textAndColor(val, cell.format);\n                val = f.text;\n                if (f.type) {\n                    type = f.type;\n                }\n            } else {\n                val += '';\n            }\n            if (!cell.textAlign) {\n                switch (type) {\n                case 'number':\n                case 'date':\n                case 'percent':\n                    cell.textAlign = 'right';\n                    break;\n                case 'boolean':\n                    cell.textAlign = 'center';\n                    break;\n                }\n            }\n            drawText(val, f && f.color || cell.color || '#000', cell, clip);\n        }\n    }\n    function drawText(text, color, cell, group) {\n        var rect_left = cell.left + 2;\n        var rect_top = cell.top + 2;\n        var rect_width = cell.width - 4;\n        var rect_height = cell.height - 4;\n        var font = makeFontDef(cell);\n        var style = { font: font };\n        var props = {\n            font: font,\n            fill: { color: color }\n        };\n        var lines = [], text_height = 0, top = rect_top;\n        if (cell.wrap) {\n            lineBreak(text, style, rect_width).forEach(function (line) {\n                var tmp = new drawing.Text(line.text, [\n                    rect_left,\n                    top\n                ], props);\n                top += line.box.height;\n                lines.push({\n                    el: tmp,\n                    box: line.box\n                });\n            });\n            text_height = top - rect_top;\n        } else {\n            var tmp = new drawing.Text(text, [\n                rect_left,\n                top\n            ], props);\n            var box = kendo.util.measureText(text, style);\n            lines.push({\n                el: tmp,\n                box: box\n            });\n            text_height = box.height;\n        }\n        var cont = new drawing.Group();\n        group.append(cont);\n        var vtrans = 0;\n        switch (cell.verticalAlign) {\n        case 'center':\n            vtrans = rect_height - text_height >> 1;\n            break;\n        case undefined:\n        case null:\n        case 'bottom':\n            vtrans = rect_height - text_height;\n            break;\n        }\n        if (vtrans < 0) {\n            vtrans = 0;\n        }\n        lines.forEach(function (line) {\n            cont.append(line.el);\n            var htrans = 0;\n            switch (cell.textAlign) {\n            case 'center':\n                htrans = rect_width - line.box.width >> 1;\n                break;\n            case 'right':\n                htrans = rect_width - line.box.width;\n                break;\n            }\n            if (htrans < 0) {\n                htrans = 0;\n            }\n            if (htrans || vtrans) {\n                line.el.transform(geo.Matrix.translate(htrans, vtrans));\n            }\n        });\n    }\n    function lineBreak(text, style, width) {\n        var lines = [];\n        var len = text.length;\n        var start = 0;\n        while (start < len) {\n            split(start, len, len);\n        }\n        return lines;\n        function split(min, eol, max) {\n            var sub = text.substring(start, eol).trim();\n            var box = kendo.util.measureText(sub, style);\n            if (box.width <= width) {\n                if (eol < max - 1) {\n                    split(eol, eol + max >> 1, max);\n                } else {\n                    lines.push({\n                        text: sub,\n                        box: box\n                    });\n                    start = eol;\n                }\n            } else if (min < eol) {\n                split(min, min + eol >> 1, eol);\n            }\n        }\n    }\n    function makeFontDef(cell) {\n        var font = [];\n        if (cell.italic) {\n            font.push('italic');\n        }\n        if (cell.bold) {\n            font.push('bold');\n        }\n        font.push((cell.fontSize || 12) + 'px');\n        font.push(cell.fontFamily || 'Arial');\n        return font.join(' ');\n    }\n    function draw(sheet, range, options, callback) {\n        if (options == null && callback == null) {\n            callback = range;\n            options = {};\n            range = spreadsheet.SHEETREF;\n        }\n        if (callback == null) {\n            callback = options;\n            if (range instanceof spreadsheet.Range || range instanceof spreadsheet.Ref || typeof range == 'string') {\n                options = {};\n            } else {\n                options = range;\n                range = spreadsheet.SHEETREF;\n            }\n        }\n        options = kendo.jQuery.extend({\n            paperSize: 'A4',\n            landscape: true,\n            margin: '1cm',\n            guidelines: true,\n            emptyCells: true,\n            fitWidth: false,\n            center: false\n        }, options);\n        var group = new drawing.Group();\n        var paper = kendo.pdf.getPaperOptions(options);\n        group.options.set('pdf', {\n            author: options.author,\n            creator: options.creator,\n            date: options.date,\n            keywords: options.keywords,\n            margin: paper.margin,\n            multiPage: true,\n            paperSize: paper.paperSize,\n            subject: options.subject,\n            title: options.title\n        });\n        var pageWidth = paper.paperSize[0];\n        var pageHeight = paper.paperSize[1];\n        if (paper.margin) {\n            pageWidth -= paper.margin.left + paper.margin.right;\n            pageHeight -= paper.margin.top + paper.margin.bottom;\n        }\n        options.pageWidth = pageWidth;\n        options.pageHeight = pageHeight;\n        var layout = doLayout(sheet, sheet._ref(range), options);\n        drawLayout(layout, group, options);\n        callback(group);\n    }\n    spreadsheet.Sheet.prototype.draw = function (range, options, callback) {\n        var sheet = this;\n        if (sheet._workbook) {\n            sheet.recalc(sheet._workbook._context, function () {\n                draw(sheet, range, options, callback);\n            });\n        } else {\n            draw(sheet, range, options, callback);\n        }\n    };\n    spreadsheet.draw = {\n        doLayout: doLayout,\n        drawLayout: drawLayout,\n        shouldDrawCell: shouldDrawCell\n    };\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('kendo.spreadsheet', [\n        'util/undoredostack',\n        'util/text-metrics',\n        'util/parse-xml',\n        'kendo.excel',\n        'kendo.progressbar',\n        'kendo.pdf',\n        'spreadsheet/commands',\n        'spreadsheet/formulabar',\n        'spreadsheet/formulainput',\n        'spreadsheet/eventlistener',\n        'spreadsheet/rangelist',\n        'spreadsheet/propertybag',\n        'spreadsheet/references',\n        'spreadsheet/navigator',\n        'spreadsheet/axismanager',\n        'spreadsheet/clipboard',\n        'spreadsheet/range',\n        'spreadsheet/sheet',\n        'spreadsheet/sheetsbar',\n        'spreadsheet/excel-reader',\n        'spreadsheet/workbook',\n        'spreadsheet/formulacontext',\n        'spreadsheet/controller',\n        'spreadsheet/view',\n        'spreadsheet/grid',\n        'spreadsheet/axis',\n        'spreadsheet/filter',\n        'spreadsheet/sorter',\n        'spreadsheet/runtime',\n        'spreadsheet/calc',\n        'spreadsheet/numformat',\n        'spreadsheet/runtime.functions',\n        'spreadsheet/runtime.functions.2',\n        'spreadsheet/toolbar',\n        'spreadsheet/dialogs',\n        'spreadsheet/sheetbinder',\n        'spreadsheet/filtermenu',\n        'spreadsheet/editor',\n        'spreadsheet/autofill',\n        'spreadsheet/print'\n    ], f);\n}(function () {\n    var __meta__ = {\n        id: 'spreadsheet',\n        name: 'Spreadsheet',\n        category: 'web',\n        description: 'Spreadsheet component',\n        depends: [\n            'core',\n            'binder',\n            'colorpicker',\n            'combobox',\n            'data',\n            'dom',\n            'dropdownlist',\n            'menu',\n            'ooxml',\n            'popup',\n            'sortable',\n            'tabstrip',\n            'toolbar',\n            'treeview',\n            'window',\n            'validator',\n            'excel',\n            'pdf',\n            'drawing'\n        ]\n    };\n    (function (kendo, undefined) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Widget = kendo.ui.Widget;\n        var Workbook = kendo.spreadsheet.Workbook;\n        var Controller = kendo.spreadsheet.Controller;\n        var View = kendo.spreadsheet.View;\n        var NS = '.kendoSpreadsheet';\n        var ALL_REASONS = {\n            recalc: true,\n            selection: true,\n            activeCell: true,\n            layout: true,\n            sheetSelection: true,\n            resize: true,\n            editorChange: false,\n            editorClose: false\n        };\n        var classNames = { wrapper: 'k-widget k-spreadsheet' };\n        var Spreadsheet = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                Widget.fn.init.call(this, element, options);\n                this.element.addClass(Spreadsheet.classNames.wrapper);\n                this._view = new View(this.element, {\n                    toolbar: this.options.toolbar,\n                    sheetsbar: this.options.sheetsbar\n                });\n                this._workbook = new Workbook(this.options, this._view);\n                this._controller = new Controller(this._view, this._workbook);\n                this._autoRefresh = true;\n                this._bindWorkbookEvents();\n                this._view.workbook(this._workbook);\n                this.refresh();\n                this._resizeHandler = function () {\n                    this.resize();\n                }.bind(this);\n                $(window).on('resize' + NS, this._resizeHandler);\n            },\n            _resize: function () {\n                this.refresh({ layout: true });\n            },\n            _workbookChange: function (e) {\n                if (this._autoRefresh) {\n                    this.refresh(e);\n                }\n                if (e.recalc && e.ref) {\n                    var range = new kendo.spreadsheet.Range(e.ref, this.activeSheet());\n                    this.trigger('change', { range: range });\n                }\n            },\n            activeSheet: function (sheet) {\n                return this._workbook.activeSheet(sheet);\n            },\n            moveSheetToIndex: function (sheet, index) {\n                return this._workbook.moveSheetToIndex(sheet, index);\n            },\n            insertSheet: function (options) {\n                return this._workbook.insertSheet(options);\n            },\n            sheets: function () {\n                return this._workbook.sheets();\n            },\n            removeSheet: function (sheet) {\n                return this._workbook.removeSheet(sheet);\n            },\n            sheetByName: function (sheetName) {\n                return this._workbook.sheetByName(sheetName);\n            },\n            sheetIndex: function (sheet) {\n                return this._workbook.sheetIndex(sheet);\n            },\n            sheetByIndex: function (index) {\n                return this._workbook.sheetByIndex(index);\n            },\n            renameSheet: function (sheet, newSheetName) {\n                return this._workbook.renameSheet(sheet, newSheetName);\n            },\n            refresh: function (reason) {\n                if (!reason) {\n                    reason = ALL_REASONS;\n                }\n                if (!reason.editorClose) {\n                    this._view.sheet(this._workbook.activeSheet());\n                    this._controller.sheet(this._workbook.activeSheet());\n                    this._workbook.refresh(reason);\n                }\n                if (!reason.editorChange) {\n                    this._view.refresh(reason);\n                    this._controller.refresh();\n                    this._view.render();\n                    this.trigger('render');\n                }\n                return this;\n            },\n            openDialog: function (name, options) {\n                return this._view.openDialog(name, options);\n            },\n            autoRefresh: function (value) {\n                if (value !== undefined) {\n                    this._autoRefresh = value;\n                    if (value === true) {\n                        this.refresh();\n                    }\n                    return this;\n                }\n                return this._autoRefresh;\n            },\n            toJSON: function () {\n                return this._workbook.toJSON();\n            },\n            fromJSON: function (json) {\n                if (json.sheets) {\n                    this._workbook.destroy();\n                    this._workbook = new Workbook($.extend({}, this.options, json));\n                    this._bindWorkbookEvents();\n                    this._view.workbook(this._workbook);\n                    this._controller.workbook(this._workbook);\n                    this.activeSheet(this.activeSheet());\n                } else {\n                    this.refresh();\n                }\n            },\n            fromFile: function (blob, name) {\n                return this._workbook.fromFile(blob, name);\n            },\n            saveAsPDF: function (options) {\n                this._workbook.saveAsPDF($.extend({}, this.options.pdf, options, { workbook: this._workbook }));\n            },\n            saveAsExcel: function (options) {\n                this._workbook.saveAsExcel(options);\n            },\n            draw: function (options, callback) {\n                this._workbook.draw(options, callback);\n            },\n            _workbookExcelExport: function (e) {\n                if (this.trigger('excelExport', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookExcelImport: function (e) {\n                if (this.trigger('excelImport', e)) {\n                    e.preventDefault();\n                } else {\n                    this._initProgress(e.promise);\n                }\n            },\n            _initProgress: function (deferred) {\n                var loading = $('<div class=\\'k-loading-mask\\' ' + 'style=\\'width: 100%; height: 100%; top: 0;\\'>' + '<div class=\\'k-loading-color\\'/>' + '</div>').appendTo(this.element);\n                var pb = $('<div class=\\'k-loading-progress\\'>').appendTo(loading).kendoProgressBar({\n                    type: 'chunk',\n                    chunkCount: 10,\n                    min: 0,\n                    max: 1,\n                    value: 0\n                }).data('kendoProgressBar');\n                deferred.progress(function (e) {\n                    pb.value(e.progress);\n                }).always(function () {\n                    kendo.destroy(loading);\n                    loading.remove();\n                });\n            },\n            _workbookPdfExport: function (e) {\n                if (this.trigger('pdfExport', e)) {\n                    e.preventDefault();\n                }\n            },\n            _bindWorkbookEvents: function () {\n                this._workbook.bind('change', this._workbookChange.bind(this));\n                this._workbook.bind('excelExport', this._workbookExcelExport.bind(this));\n                this._workbook.bind('excelImport', this._workbookExcelImport.bind(this));\n                this._workbook.bind('pdfExport', this._workbookPdfExport.bind(this));\n            },\n            destroy: function () {\n                kendo.ui.Widget.fn.destroy.call(this);\n                this._workbook.destroy();\n                this._controller.destroy();\n                this._view.destroy();\n                if (this._resizeHandler) {\n                    $(window).off('resize' + NS, this._resizeHandler);\n                }\n            },\n            options: {\n                name: 'Spreadsheet',\n                toolbar: true,\n                sheetsbar: true,\n                rows: 200,\n                columns: 50,\n                rowHeight: 20,\n                columnWidth: 64,\n                headerHeight: 20,\n                headerWidth: 32,\n                excel: {\n                    proxyURL: '',\n                    fileName: 'Workbook.xlsx'\n                },\n                pdf: {\n                    area: 'workbook',\n                    fileName: 'Workbook.pdf',\n                    proxyURL: '',\n                    paperSize: 'a4',\n                    landscape: true,\n                    margin: null,\n                    title: null,\n                    author: null,\n                    subject: null,\n                    keywords: null,\n                    creator: 'Kendo UI PDF Generator v.' + kendo.version,\n                    date: null\n                }\n            },\n            events: [\n                'pdfExport',\n                'excelExport',\n                'excelImport',\n                'change',\n                'render'\n            ]\n        });\n        kendo.spreadsheet.ALL_REASONS = ALL_REASONS;\n        kendo.ui.plugin(Spreadsheet);\n        $.extend(true, Spreadsheet, { classNames: classNames });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));"],"sourceRoot":"/source/"}